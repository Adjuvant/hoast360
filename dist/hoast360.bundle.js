!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=301)}([function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(17))},function(e,t,n){(function(t){var i,r=void 0!==t?t:"undefined"!=typeof window?window:{},a=n(280);"undefined"!=typeof document?i=document:(i=r["__GLOBAL_DOCUMENT_CACHE@4"])||(i=r["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=i}).call(this,n(17))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=void 0,t=[],n={},i={};function r(e,n){for(var i in t){var r=t[i];if(r.context===e&&r.name===n)return r.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,i){var r=void 0,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},i);for(var l in r=t.apply({context:n},i),s=s.apply({context:n,factory:e,parent:r},i))r.hasOwnProperty(l)&&(r[l]=s[l])}else r=t.apply({context:n},i);return r.getClassName=function(){return a},r}return e={extend:function(e,t,n,i){!i[e]&&t&&(i[e]={instance:t,override:n})},getSingletonInstance:r,setSingletonInstance:function(e,n,i){for(var r in t){var a=t[r];if(a.context===e&&a.name===n)return void(t[r].instance=i)}t.push({name:n,context:e,instance:i})},getSingletonFactory:function(e){var i=a(e.__dashjs_factory_name,n);return i||(i=function(n){var i=void 0;return void 0===n&&(n={}),{getInstance:function(){return i||(i=r(n,e.__dashjs_factory_name)),i||(i=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:i})),i}}},n[e.__dashjs_factory_name]=i),i},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,i);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},i[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,i)},updateClassFactory:function(e,t){o(e,t,i)}}}();t.default=i},function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},function(e,t,n){"use strict";var i=n(0),r=n.n(i),a=n(1),o=n.n(a),s=n(34),l=n.n(s),u=n(6),c=n.n(u),h=(n(281),n(283),n(3)),d=n.n(h),f=n(115),p=n.n(f),m=n(5),g=n.n(m),v=n(76),y=n.n(v),_=n(77),b=n.n(_),E=n(116),T=n.n(E),w=n(117),x=n.n(w),A=n(47),S=n.n(A);
/*! @name m3u8-parser @version 4.4.0 @license Apache-2.0 */
function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function C(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var R=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t,n,i,r=this.listeners[e];if(r)if(2===arguments.length)for(n=r.length,t=0;t<n;++t)r[t].call(this,arguments[1]);else for(i=Array.prototype.slice.call(arguments,1),n=r.length,t=0;t<n;++t)r[t].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),I=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return C(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(R),P=function(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i={},r=n.length;r--;)""!==n[r]&&((t=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),i[t[0]]=t[1]);return i},L=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}C(t,e);var n=t.prototype;return n.push=function(e){var t,n,i=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(t,n){var i=n(e);return i===e?t:t.concat([i])}),[e]).forEach((function(e){for(var r=0;r<i.customParsers.length;r++)if(i.customParsers[r].call(i,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))i.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void i.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"totalduration"},t[1]&&(n.duration=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void i.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void i.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"byterange"},t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),void i.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"map"},t[1]){var a=P(t[1]);if(a.URI&&(n.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],l=o[1];n.byterange={},s&&(n.byterange.length=parseInt(s,10)),l&&(n.byterange.offset=parseInt(l,10))}}i.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=P(t[1]),n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION.split("x"),c={};u[0]&&(c.width=parseInt(u[0],10)),u[1]&&(c.height=parseInt(u[1],10)),n.attributes.RESOLUTION=c}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}i.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=P(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e))i.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))i.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void i.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=P(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void i.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=P(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void i.trigger("data",n);i.trigger("data",{type:"tag",data:e.slice(4)})}}}else i.trigger("data",{type:"comment",text:e.slice(1)})})):this.trigger("data",{type:"uri",uri:e}))},n.addParser=function(e){var t=this,n=e.expression,i=e.customType,r=e.dataParser,a=e.segment;"function"!=typeof r&&(r=function(e){return e}),this.customParsers.push((function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:r(e),customType:i,segment:a}),!0}))},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push((function(e){return t.test(e)?n(e):e}))},t}(R);function D(e){for(var t=r.a.atob(e||""),n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}var O=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new I,t.parseStream=new L,t.lineStream.pipe(t.parseStream);var n,i,r=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),a=[],o={},s=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",(function(e){var t,c;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(o.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:D(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),i={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(i.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else i=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,u=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||l,e.attributes?(o.attributes||(o.attributes={}),M(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],(c={default:/yes/i.test(e.attributes.DEFAULT)}).default?c.autoselect=!0:c.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(c.language=e.attributes.LANGUAGE),e.attributes.URI&&(c.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(c.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(c.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(c.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=c}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){u+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data}}[e.tagType]||s).call(r)},uri:function(){o.uri=e.uri,a.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),i&&(o.key=i),o.timeline=u,n&&(o.map=n),o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(r)})),t}C(t,e);var n=t.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(R),N=n(48),k=n.n(N),F=n(118),B=n.n(F),U=n(119),j=function(e){return!!e&&"object"==typeof e},G=function e(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.reduce((function(t,n){return Object.keys(n).forEach((function(i){Array.isArray(t[i])&&Array.isArray(n[i])?t[i]=t[i].concat(n[i]):j(t[i])&&j(n[i])?t[i]=e(t[i],n[i]):t[i]=n[i]})),t}),{})},z=function(e){return e.reduce((function(e,t){return e.concat(t)}),[])},H=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},V="INVALID_NUMBER_OF_PERIOD",W="DASH_EMPTY_MANIFEST",q="DASH_INVALID_XML",Y="NO_BASE_URL",X="SEGMENT_TIME_UNSPECIFIED",K="UNSUPPORTED_UTC_TIMING_SCHEME",Q=function(e){var t=e.baseUrl,n=void 0===t?"":t,i=e.source,r=void 0===i?"":i,a=e.range,o=void 0===a?"":a,s=e.indexRange,l=void 0===s?"":s,u={uri:r,resolvedUri:k()(n||"",r)};if(o||l){var c=(o||l).split("-"),h=parseInt(c[0],10),d=parseInt(c[1],10);u.byterange={length:d-h+1,offset:h}}return u},Z={static:function(e){var t=e.duration,n=e.timescale,i=void 0===n?1:n,r=e.sourceDuration;return{start:0,end:Math.ceil(r/(t/i))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,i=e.availabilityStartTime,r=e.timescale,a=void 0===r?1:r,o=e.duration,s=e.start,l=void 0===s?0:s,u=e.minimumUpdatePeriod,c=void 0===u?0:u,h=e.timeShiftBufferDepth,d=void 0===h?1/0:h,f=(t+n)/1e3,p=i+l,m=f+c-p,g=Math.ceil(m*a/o),v=Math.floor((f-p-d)*a/o),y=Math.floor((f-p)*a/o);return{start:Math.max(0,v),end:Math.min(g,y)}}},J=function(e){var t=e.type,n=void 0===t?"static":t,i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.sourceDuration,s=Z[n](e),l=function(e,t){for(var n=[],i=e;i<t;i++)n.push(i);return n}(s.start,s.end).map(function(e){return function(t,n){var i=e.duration,r=e.timescale,a=void 0===r?1:r,o=e.periodIndex,s=e.startNumber;return{number:(void 0===s?1:s)+t,duration:i/a,timeline:o,time:n*i}}}(e));if("static"===n){var u=l.length-1;l[u].duration=o-i/a*u}return l},$=function(e){var t=e.baseUrl,n=e.initialization,i=void 0===n?{}:n,r=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,l=void 0===s?"":s,u=e.duration;if(!t)throw new Error(Y);var c=Q({baseUrl:t,source:i.sourceURL,range:i.range}),h=Q({baseUrl:t,source:t,indexRange:l});if(h.map=c,u){var d=J(e);d.length&&(h.duration=d[0].duration,h.timeline=d[0].timeline)}else r&&(h.duration=r/o,h.timeline=0);return h.number=0,[h]},ee=function(e,t,n){for(var i=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,l=t.timescale,u=t.references.filter((function(e){return 1!==e.referenceType})),c=[],h=s+t.firstOffset,d=0;d<u.length;d++){var f=t.references[d],p=f.referencedSize,m=f.subsegmentDuration,g=$({baseUrl:n,timescale:l,timeline:a,periodIndex:a,duration:m,sourceDuration:r,indexRange:h+"-"+(h+p-1)})[0];i&&(g.map=i),c.push(g),h+=p}return e.segments=c,e},te=function(e){var t;return(t=e.reduce((function(e,t){var n,i=t.attributes.id+(t.attributes.lang||"");return e[i]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[i].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[i].attributes.contentProtection=t.attributes.contentProtection)):e[i]=t,e}),{}),Object.keys(t).map((function(e){return t[e]}))).map((function(e){var t,n;return e.discontinuityStarts=(t=e.segments,n="discontinuity",t.reduce((function(e,t,i){return t[n]&&e.push(i),e}),[])),e}))},ne=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var i=e[n];if(i.sidx){var r=i.sidx.uri+"-"+(o=i.sidx.byterange,s=void 0,s=o.offset+o.length-1,o.offset+"-"+s),a=t[r]&&t[r].sidx;i.sidx&&a&&ee(i,a,i.sidx.resolvedUri)}}var o,s;return e},ie=function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a},re=function(e){var t,n=e.attributes,i=e.segments,r=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:i,mediaSequence:i.length?i[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),r&&(a.sidx=r),a},ae=function(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var i=e[0].attributes,r=i.sourceDuration,a=i.type,o=void 0===a?"static":a,s=i.suggestedPresentationDelay,l=i.minimumUpdatePeriod,u=void 0===l?0:l,c=te(e.filter((function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType}))).map(re),h=te(e.filter((function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType}))),d=e.filter((function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType})),f={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:r,playlists:ne(c,t),minimumUpdatePeriod:1e3*u};return"dynamic"===o&&(f.suggestedPresentationDelay=s),h.length&&(f.mediaGroups.AUDIO.audio=function(e,t){var n;void 0===t&&(t={});var i=e.reduce((function(e,i){var r=i.attributes.role&&i.attributes.role.value||"",a=i.attributes.lang||"",o="main";if(a){var s=r?" ("+r+")":"";o=""+i.attributes.lang+s}return e[o]&&e[o].playlists[0].attributes.BANDWIDTH>i.attributes.bandwidth||(e[o]={language:a,autoselect:!0,default:"main"===r,playlists:ne([ie(i)],t),uri:""},void 0===n&&"main"===r&&((n=i).default=!0)),e}),{});n||(i[Object.keys(i)[0]].default=!0);return i}(h,t)),d.length&&(f.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),e.reduce((function(e,n){var i,r,a,o,s=n.attributes.lang||"text";return e[s]||(e[s]={language:s,default:!1,autoselect:!1,playlists:ne([(i=n,a=i.attributes,o=i.segments,void 0===o&&(o=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}],a.duration=a.sourceDuration),{attributes:(r={NAME:a.id,BANDWIDTH:a.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:o,mediaSequence:o.length?o[0].number:1})],t),uri:""}),e}),{})}(d,t)),f},oe=function(e,t,n){var i=e.NOW,r=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,l=e.start,u=void 0===l?0:l,c=e.minimumUpdatePeriod,h=(i+r)/1e3+(void 0===c?0:c)-(a+u);return Math.ceil((h*s-t)/n)},se=function(e,t){for(var n=e.type,i=void 0===n?"static":n,r=e.minimumUpdatePeriod,a=void 0===r?0:r,o=e.media,s=void 0===o?"":o,l=e.sourceDuration,u=e.timescale,c=void 0===u?1:u,h=e.startNumber,d=void 0===h?1:h,f=e.periodIndex,p=[],m=-1,g=0;g<t.length;g++){var v=t[g],y=v.d,_=v.r||0,b=v.t||0;m<0&&(m=b),b&&b>m&&(m=b);var E=void 0;if(_<0){var T=g+1;E=T===t.length?"dynamic"===i&&a>0&&s.indexOf("$Number$")>0?oe(e,m,y):(l*c-m)/y:(t[T].t-m)/y}else E=_+1;for(var w=d+p.length+E,x=d+p.length;x<w;)p.push({number:x,duration:y/c,time:m,timeline:f}),m+=y,x++}return p},le=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,ue=function(e,t){return e.replace(le,function(e){return function(t,n,i,r){if("$$"===t)return"$";if(void 0===e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(r=i?parseInt(r,10):1,a.length>=r?a:""+new Array(r-a.length+1).join("0")+a)}}(t))},ce=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},i=e.initialization,r=void 0===i?{sourceURL:"",range:""}:i,a=Q({baseUrl:e.baseUrl,source:ue(r.sourceURL,n),range:r.range});return function(e,t){return e.duration||t?e.duration?J(e):se(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map((function(t){n.Number=t.number,n.Time=t.time;var i=ue(e.media||"",n);return{uri:i,timeline:t.timeline,duration:t.duration,resolvedUri:k()(e.baseUrl||"",i),map:a,number:t.number}}))},he=function(e,t){var n=e.duration,i=e.segmentUrls,r=void 0===i?[]:i;if(!n&&!t||n&&t)throw new Error(X);var a,o=r.map((function(t){return function(e,t){var n=e.baseUrl,i=e.initialization,r=void 0===i?{}:i,a=Q({baseUrl:n,source:r.sourceURL,range:r.range}),o=Q({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(e,t)}));return n&&(a=J(e)),t&&(a=se(e,t)),a.map((function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}})).filter((function(e){return e}))},de=function(e){var t,n,i=e.attributes,r=e.segmentInfo;r.template?(n=ce,t=G(i,r.template)):r.base?(n=$,t=G(i,r.base)):r.list&&(n=he,t=G(i,r.list));var a={attributes:i};if(!n)return a;var o=n(t,r.timeline);if(t.duration){var s=t,l=s.duration,u=s.timescale,c=void 0===u?1:u;t.duration=l/c}else o.length?t.duration=o.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0):t.duration=0;return a.attributes=t,a.segments=o,r.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},fe=function(e,t){return H(e.childNodes).filter((function(e){return e.tagName===t}))},pe=function(e){return e.textContent.trim()},me=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5];return 31536e3*parseFloat(i||0)+2592e3*parseFloat(r||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(l||0)},ge={mediaPresentationDuration:function(e){return me(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return me(e)},suggestedPresentationDelay:function(e){return me(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return me(e)},start:function(e){return me(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?me(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},ve=function(e){return e&&e.attributes?H(e.attributes).reduce((function(e,t){var n=ge[t.name]||ge.DEFAULT;return e[t.name]=n(t.value),e}),{}):{}},ye={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},_e=function(e,t){return t.length?z(e.map((function(e){return t.map((function(t){return k()(e,pe(t))}))}))):e},be=function(e){var t=fe(e,"SegmentTemplate")[0],n=fe(e,"SegmentList")[0],i=n&&fe(n,"SegmentURL").map((function(e){return G({tag:"SegmentURL"},ve(e))})),r=fe(e,"SegmentBase")[0],a=n||t,o=a&&fe(a,"SegmentTimeline")[0],s=n||r||t,l=s&&fe(s,"Initialization")[0],u=t&&ve(t);u&&l?u.initialization=l&&ve(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:o&&fe(o,"S").map((function(e){return ve(e)})),list:n&&G(ve(n),{segmentUrls:i,initialization:ve(l)}),base:r&&G(ve(r),{initialization:ve(l)})};return Object.keys(c).forEach((function(e){c[e]||delete c[e]})),c},Ee=function(e,t,n){return function(i){var r=ve(i),a=_e(t,fe(i,"BaseURL")),o=fe(i,"Role")[0],s={role:ve(o)},l=G(e,r,s),u=fe(i,"ContentProtection").reduce((function(e,t){var n=ve(t),i=ye[n.schemeIdUri];if(i){e[i]={attributes:n};var r=fe(t,"cenc:pssh")[0];if(r){var a=pe(r),o=a&&B()(a);e[i].pssh=o}}return e}),{});Object.keys(u).length&&(l=G(l,{contentProtection:u}));var c=be(i),h=fe(i,"Representation"),d=G(n,c);return z(h.map(function(e,t,n){return function(i){var r=fe(i,"BaseURL"),a=_e(t,r),o=G(e,ve(i)),s=be(i);return a.map((function(e){return{segmentInfo:G(n,s),attributes:G(o,{baseUrl:e})}}))}}(l,a,d)))}},Te=function(e,t){void 0===t&&(t={});var n=t,i=n.manifestUri,a=void 0===i?"":i,o=n.NOW,s=void 0===o?Date.now():o,l=n.clientOffset,u=void 0===l?0:l,c=fe(e,"Period");if(!c.length)throw new Error(V);var h=ve(e),d=_e([a],fe(e,"BaseURL"));return h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=s,h.clientOffset=u,z(c.map(function(e,t){return function(n,i){var a=_e(t,fe(n,"BaseURL")),o=ve(n),s=parseInt(o.id,10),l=r.a.isNaN(s)?i:s,u=G(e,{periodIndex:l}),c=fe(n,"AdaptationSet"),h=be(n);return z(c.map(Ee(u,a,h)))}}(h,d)))},we=function(e){if(""===e)throw new Error(W);var t=(new U.DOMParser).parseFromString(e,"application/xml"),n=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(q);return n},xe=function(e,t){return void 0===t&&(t={}),ae(Te(we(e),t).map(de),t.sidxMapping)},Ae=function(e){return function(e){var t=fe(e,"UTCTiming")[0];if(!t)return null;var n=ve(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(K)}return n}(we(e))},Se=n(46),Me=n.n(Se),Ce=n(28),Re=n.n(Ce),Ie=n(120),Pe=n.n(Ie),Le=n(121),De=n.n(Le);var Oe=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),ke=null,Fe=function(){function e(t){Oe(this,e),ke||(ke=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,h=void 0,d=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(d=(d=s^s<<1^s<<2^s<<3^s<<4)>>8^255&d^99,i[o]=d,r[d]=o,p=16843009*l[h=l[c=l[o]]]^65537*h^257*c^16843008*o,f=257*l[d]^16843008*d,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][d]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}()),this._tables=[[ke[0][0].slice(),ke[0][1].slice(),ke[0][2].slice(),ke[0][3].slice(),ke[0][4].slice()],[ke[1][0].slice(),ke[1][1].slice(),ke[1][2].slice(),ke[1][3].slice(),ke[1][4].slice()]];var n=void 0,i=void 0,r=void 0,a=void 0,o=void 0,s=this._tables[0][4],l=this._tables[1],u=t.length,c=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size");for(a=t.slice(0),o=[],this._key=[a,o],n=u;n<4*u+28;n++)r=a[n-1],(n%u==0||8===u&&n%u==4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],n%u==0&&(r=r<<8^r>>>24^c<<24,c=c<<1^283*(c>>7))),a[n]=a[n-u]^r;for(i=0;n;i++,n--)r=a[3&i?n:n-4],o[i]=n<=4||i<4?r:l[0][s[r>>>24]]^l[1][s[r>>16&255]]^l[2][s[r>>8&255]]^l[3][s[255&r]]}return e.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],h=void 0,d=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)h=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^E[255&c]^o[g],d=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&l]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^E[255&u]^o[g+3],g+=4,s=h,l=d,u=f;for(m=0;m<4;m++)r[(3&-m)+a]=T[s>>>24]<<24^T[l>>16&255]<<16^T[u>>8&255]<<8^T[255&c]^o[g++],h=s,s=l,l=u,u=c,c=h},e}(),Be=function(){function e(){Oe(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),Ue=function(e){function t(){Oe(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,Be));return n.jobs=[],n.delay=1,n.timeout_=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(Be),je=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Ge=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new Fe(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0;for(s=n[0],l=n[1],u=n[2],c=n[3],m=0;m<i.length;m+=4)h=je(i[m]),d=je(i[m+1]),f=je(i[m+2]),p=je(i[m+3]),r.decrypt(h,d,f,p,o,m),o[m]=je(o[m]^s),o[m+1]=je(o[m+1]^l),o[m+2]=je(o[m+2]^u),o[m+3]=je(o[m+3]^c),s=h,l=d,u=f,c=p;return a},ze=function(){function e(t,n,i,r){Oe(this,e);var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),l=0;for(this.asyncStream_=new Ue,this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s)),l=a;l<o.length;l+=a)i=new Uint32Array([je(o[l-4]),je(o[l-3]),je(o[l-2]),je(o[l-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(l,l+a),n,i,s));this.asyncStream_.push((function(){var e;r(null,(e=s).subarray(0,e.byteLength-e[e.byteLength-1]))}))}return e.prototype.decryptChunk_=function(e,t,n,i){return function(){var r=Ge(e,t,n);i.set(r,e.byteOffset)}},Ne(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),He=[];var Ve=function e(t){var n,i="info",a=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n("log",i,t)};return n=function(e,t){return function(n,i,a){var o=t.levels[i],s=new RegExp("^("+o+")$");if("log"!==n&&a.unshift(n.toUpperCase()+":"),a.unshift(e+":"),He){He.push([].concat(a));var l=He.length-1e3;He.splice(0,l>0?l:0)}if(r.a.console){var u=r.a.console[n];u||"debug"!==n||(u=r.a.console.info||r.a.console.log),u&&o&&s.test(n)&&u[Array.isArray(a)?"apply":"call"](r.a.console,a)}}}(t,a),a.createLogger=function(n){return e(t+": "+n)},a.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},a.level=function(e){if("string"==typeof e){if(!a.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');i=e}return i},(a.history=function(){return He?[].concat(He):[]}).filter=function(e){return(He||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))},a.history.clear=function(){He&&(He.length=0)},a.history.disable=function(){null!==He&&(He.length=0,He=null)},a.history.enable=function(){null===He&&(He=[])},a.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("error",i,t)},a.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("warn",i,t)},a.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n("debug",i,t)},a}("VIDEOJS"),We=Ve.createLogger,qe=Object.prototype.toString,Ye=function(e){return Qe(e)?Object.keys(e):[]};function Xe(e,t){Ye(e).forEach((function(n){return t(e[n],n)}))}function Ke(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.assign?l.a.apply(void 0,[e].concat(n)):(n.forEach((function(t){t&&Xe(t,(function(t,n){e[n]=t}))})),e)}function Qe(e){return!!e&&"object"==typeof e}function Ze(e){return Qe(e)&&"[object Object]"===qe.call(e)&&e.constructor===Object}function Je(e,t){if(!e||!t)return"";if("function"==typeof r.a.getComputedStyle){var n=r.a.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:""}return""}function $e(e){return"string"==typeof e&&Boolean(e.trim())}function et(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function tt(){return o.a===r.a.document}function nt(e){return Qe(e)&&1===e.nodeType}function it(){try{return r.a.parent!==r.a.self}catch(e){return!0}}function rt(e){return function(t,n){if(!$e(t))return o.a[e](null);$e(n)&&(n=o.a.querySelector(n));var i=nt(n)?n:o.a;return i[e]&&i[e](t)}}function at(e,t,n,i){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n={});var r=o.a.createElement(e);return Object.getOwnPropertyNames(t).forEach((function(e){var n=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(Ve.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+n+"."),r.setAttribute(e,n)):"textContent"===e?ot(r,n):r[e]!==n&&(r[e]=n)})),Object.getOwnPropertyNames(n).forEach((function(e){r.setAttribute(e,n[e])})),i&&At(r,i),r}function ot(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function st(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function lt(e,t){return et(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function ut(e,t){return e.classList?e.classList.add(t):lt(e,t)||(e.className=(e.className+" "+t).trim()),e}function ct(e,t){return e.classList?e.classList.remove(t):(et(t),e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")),e}function ht(e,t,n){var i=lt(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!i),n!==i)return n?ut(e,t):ct(e,t),e}function dt(e,t){Object.getOwnPropertyNames(t).forEach((function(n){var i=t[n];null==i||!1===i?e.removeAttribute(n):e.setAttribute(n,!0===i?"":i)}))}function ft(e){var t={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&e.attributes.length>0)for(var i=e.attributes,r=i.length-1;r>=0;r--){var a=i[r].name,o=i[r].value;"boolean"!=typeof e[a]&&-1===n.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function pt(e,t){return e.getAttribute(t)}function mt(e,t,n){e.setAttribute(t,n)}function gt(e,t){e.removeAttribute(t)}function vt(){o.a.body.focus(),o.a.onselectstart=function(){return!1}}function yt(){o.a.onselectstart=function(){return!0}}function _t(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat(Je(e,"height"))),n.width||(n.width=parseFloat(Je(e,"width"))),n}}function bt(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=o.a.documentElement,i=o.a.body,a=n.clientLeft||i.clientLeft||0,s=r.a.pageXOffset||i.scrollLeft,l=t.left+s-a,u=n.clientTop||i.clientTop||0,c=r.a.pageYOffset||i.scrollTop,h=t.top+c-u;return{left:Math.round(l),top:Math.round(h)}}function Et(e,t){var n={},i=bt(e),r=e.offsetWidth,a=e.offsetHeight,o=i.top,s=i.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-l+a)/a)),n.x=Math.max(0,Math.min(1,(u-s)/r)),n}function Tt(e){return Qe(e)&&3===e.nodeType}function wt(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function xt(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"==typeof e&&(e=e()),nt(e)||Tt(e)?e:"string"==typeof e&&/\S/.test(e)?o.a.createTextNode(e):void 0})).filter((function(e){return e}))}function At(e,t){return xt(t).forEach((function(t){return e.appendChild(t)})),e}function St(e,t){return At(wt(e),t)}function Mt(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var Ct,Rt=rt("querySelector"),It=rt("querySelectorAll"),Pt=Object.freeze({__proto__:null,isReal:tt,isEl:nt,isInFrame:it,createEl:at,textContent:ot,prependTo:st,hasClass:lt,addClass:ut,removeClass:ct,toggleClass:ht,setAttributes:dt,getAttributes:ft,getAttribute:pt,setAttribute:mt,removeAttribute:gt,blockTextSelection:vt,unblockTextSelection:yt,getBoundingClientRect:_t,findPosition:bt,getPointerPosition:Et,isTextNode:Tt,emptyEl:wt,normalizeContent:xt,appendContent:At,insertContent:St,isSingleLeftClick:Mt,$:Rt,$$:It}),Lt=!1,Dt=function(){if(tt()&&!1!==Ct.options.autoSetup){var e=Array.prototype.slice.call(o.a.getElementsByTagName("video")),t=Array.prototype.slice.call(o.a.getElementsByTagName("audio")),n=Array.prototype.slice.call(o.a.getElementsByTagName("video-js")),i=e.concat(t,n);if(i&&i.length>0)for(var r=0,a=i.length;r<a;r++){var s=i[r];if(!s||!s.getAttribute){Ot(1);break}void 0===s.player&&null!==s.getAttribute("data-setup")&&Ct(s)}else Lt||Ot(1)}};function Ot(e,t){t&&(Ct=t),r.a.setTimeout(Dt,e)}function Nt(){Lt=!0,r.a.removeEventListener("load",Nt)}tt()&&("complete"===o.a.readyState?Nt():r.a.addEventListener("load",Nt));var kt,Ft=function(e){var t=o.a.createElement("style");return t.className=e,t},Bt=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},Ut=3;function jt(){return Ut++}r.a.WeakMap||(kt=function(){function e(){this.vdata="vdata"+Math.floor(r.a.performance&&r.a.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||jt();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];Ve("We have no data for this element",e)},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var Gt,zt=r.a.WeakMap?new WeakMap:new kt;function Ht(e,t){if(zt.has(e)){var n=zt.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&zt.delete(e)}}function Vt(e,t,n,i){n.forEach((function(n){e(t,n,i)}))}function Wt(e){if(e.fixed_)return e;function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var i=e||r.a.event;for(var a in e={},i)"layerX"!==a&&"layerY"!==a&&"keyLocation"!==a&&"webkitMovementX"!==a&&"webkitMovementY"!==a&&("returnValue"===a&&i.preventDefault||(e[a]=i[a]));if(e.target||(e.target=e.srcElement||o.a),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){i.preventDefault&&i.preventDefault(),e.returnValue=!1,i.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),e.cancelBubble=!0,i.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var s=o.a.documentElement,l=o.a.body;e.pageX=e.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0),e.pageY=e.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var qt=["touchstart","touchmove"];function Yt(e,t,n){if(Array.isArray(t))return Vt(Yt,e,t,n);zt.has(e)||zt.set(e,{});var i=zt.get(e);if(i.handlers||(i.handlers={}),i.handlers[t]||(i.handlers[t]=[]),n.guid||(n.guid=jt()),i.handlers[t].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(t,n){if(!i.disabled){t=Wt(t);var r=i.handlers[t.type];if(r)for(var a=r.slice(0),o=0,s=a.length;o<s&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(e){Ve.error(e)}}}),1===i.handlers[t].length)if(e.addEventListener){var a=!1;(function(){if("boolean"!=typeof Gt){Gt=!1;try{var e=Object.defineProperty({},"passive",{get:function(){Gt=!0}});r.a.addEventListener("test",null,e),r.a.removeEventListener("test",null,e)}catch(e){}}return Gt})()&&qt.indexOf(t)>-1&&(a={passive:!0}),e.addEventListener(t,i.dispatcher,a)}else e.attachEvent&&e.attachEvent("on"+t,i.dispatcher)}function Xt(e,t,n){if(zt.has(e)){var i=zt.get(e);if(i.handlers){if(Array.isArray(t))return Vt(Xt,e,t,n);var r=function(e,t){i.handlers[t]=[],Ht(e,t)};if(void 0!==t){var a=i.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);Ht(e,t)}else r(e,t)}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&r(e,s)}}}function Kt(e,t,n){var i=zt.has(e)?zt.get(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=Wt(t),i.dispatcher&&i.dispatcher.call(e,t,n),r&&!t.isPropagationStopped()&&!0===t.bubbles)Kt.call(null,r,t,n);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){zt.has(t.target)||zt.set(t.target,{});var a=zt.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function Qt(e,t,n){if(Array.isArray(t))return Vt(Qt,e,t,n);var i=function i(){Xt(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||jt(),Yt(e,t,i)}function Zt(e,t,n){var i=function i(){Xt(e,t,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||jt(),Yt(e,t,i)}var Jt,$t=Object.freeze({__proto__:null,fixEvent:Wt,on:Yt,off:Xt,trigger:Kt,one:Qt,any:Zt}),en=function(e,t,n){t.guid||(t.guid=jt());var i=t.bind(e);return i.guid=n?n+"_"+t.guid:t.guid,i},tn=function(e,t){var n=r.a.performance.now();return function(){var i=r.a.performance.now();i-n>=t&&(e.apply(void 0,arguments),n=i)}},nn=function(){};nn.prototype.allowedEvents_={},nn.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Yt(this,e,t),this.addEventListener=n},nn.prototype.addEventListener=nn.prototype.on,nn.prototype.off=function(e,t){Xt(this,e,t)},nn.prototype.removeEventListener=nn.prototype.off,nn.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Qt(this,e,t),this.addEventListener=n},nn.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Zt(this,e,t),this.addEventListener=n},nn.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=Wt(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Kt(this,e)},nn.prototype.dispatchEvent=nn.prototype.trigger,nn.prototype.queueTrigger=function(e){var t=this;Jt||(Jt=new Map);var n=e.type||e,i=Jt.get(this);i||(i=new Map,Jt.set(this,i));var a=i.get(n);i.delete(n),r.a.clearTimeout(a);var o=r.a.setTimeout((function(){0===i.size&&(i=null,Jt.delete(t)),t.trigger(e)}),0);i.set(n,o)};var rn=function(e){return e instanceof nn||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(t){return"function"==typeof e[t]}))},an=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},on=function(e){if(!e.nodeName&&!rn(e))throw new Error("Invalid target; must be a DOM node or evented object.")},sn=function(e){if(!an(e))throw new Error("Invalid event type; must be a non-empty string or array.")},ln=function(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")},un=function(e,t){var n,i,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return a?(n=e.eventBusEl_,t.length>=3&&t.shift(),i=t[0],r=t[1]):(n=t[0],i=t[1],r=t[2]),on(n),sn(i),ln(r),{isTargetingSelf:a,target:n,type:i,listener:r=en(e,r)}},cn=function(e,t,n,i){on(e),e.nodeName?$t[t](e,n,i):e[t](n,i)},hn={on:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=un(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(cn(o,"on",s,l),!a){var u=function(){return e.off(o,s,l)};u.guid=l.guid;var c=function(){return e.off("dispose",u)};c.guid=l.guid,cn(this,"on","dispose",u),cn(o,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=un(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)cn(o,"one",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,cn(o,"one",s,u)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=un(this,n),a=r.isTargetingSelf,o=r.target,s=r.type,l=r.listener;if(a)cn(o,"any",s,l);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];l.apply(null,i)};u.guid=l.guid,cn(o,"any",s,u)}},off:function(e,t,n){if(!e||an(e))Xt(this.eventBusEl_,e,t);else{var i=e,r=t;on(i),sn(r),ln(n),n=en(this,n),this.off("dispose",n),i.nodeName?(Xt(i,r,n),Xt(i,"dispose",n)):rn(i)&&(i.off(r,n),i.off("dispose",n))}},trigger:function(e,t){return Kt(this.eventBusEl_,e,t)}};function dn(e,t){void 0===t&&(t={});var n=t.eventBusKey;if(n){if(!e[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');e.eventBusEl_=e[n]}else e.eventBusEl_=at("span",{className:"vjs-event-bus"});return Ke(e,hn),e.eventedCallbacks&&e.eventedCallbacks.forEach((function(e){e()})),e.on("dispose",(function(){e.off(),r.a.setTimeout((function(){e.eventBusEl_=null}),0)})),e}var fn={state:{},setState:function(e){var t,n=this;return"function"==typeof e&&(e=e()),Xe(e,(function(e,i){n.state[i]!==e&&((t=t||{})[i]={from:n.state[i],to:e}),n.state[i]=e})),t&&rn(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function pn(e,t){return Ke(e,fn),e.state=Ke({},e.state,t),"function"==typeof e.handleStateChanged&&rn(e)&&e.on("statechanged",e.handleStateChanged),e}var mn=function(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toLowerCase()}))},gn=function(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))};function vn(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){t&&Xe(t,(function(t,n){Ze(t)?(Ze(e[n])||(e[n]={}),e[n]=vn(e[n],t)):e[n]=t}))})),e}var yn=function(){function e(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=vn({},this.options_),t=this.options_=vn(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var i=e&&e.id&&e.id()||"no_player";this.id_=i+"_component_"+jt()}var a;this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&dn(this,{eventBusKey:this.el_?"el_":null}),pn(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},r.a.Set||(a=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var n in this.set_)e.call(t,n,n,this)},e}()),this.setTimeoutIds_=r.a.Set?new Set:new a,this.setIntervalIds_=r.a.Set?new Set:new a,this.rafIds_=r.a.Set?new Set:new a,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var t=e.prototype;return t.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),zt.has(this.el_)&&zt.delete(this.el_),this.el_=null),this.player_=null}},t.isDisposed=function(){return Boolean(this.isDisposed_)},t.player=function(){return this.player_},t.options=function(e){return e?(this.options_=vn(this.options_,e),this.options_):this.options_},t.el=function(){return this.el_},t.createEl=function(e,t,n){return at(e,t,n)},t.localize=function(e,t,n){void 0===n&&(n=e);var i=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[i],o=i&&i.split("-")[0],s=r&&r[o],l=n;return a&&a[e]?l=a[e]:s&&s[e]&&(l=s[e]),t&&(l=l.replace(/\{(\d+)\}/g,(function(e,n){var i=t[n-1],r=i;return void 0===i&&(r=e),r}))),l},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(e){return this.childIndex_[e]},t.getChild=function(e){if(e)return this.childNameIndex_[e]},t.getDescendant=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce((function(e,t){return e.concat(t)}),[]);for(var i=this,r=0;r<t.length;r++)if(!(i=i.getChild(t[r]))||!i.getChild)return;return i},t.addChild=function(t,n,i){var r,a;if(void 0===n&&(n={}),void 0===i&&(i=this.children_.length),"string"==typeof t){a=gn(t);var o=n.componentClass||a;n.name=a;var s=e.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!=typeof s)return null;r=new s(this.player_||this,n)}else r=t;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(i,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(a=a||r.name&&gn(r.name()))&&(this.childNameIndex_[a]=r,this.childNameIndex_[mn(a)]=r),"function"==typeof r.el&&r.el()){var l=null;this.children_[i+1]&&(this.children_[i+1].el_?l=this.children_[i+1].el_:nt(this.children_[i+1])&&(l=this.children_[i+1])),this.contentEl().insertBefore(r.el(),l)}return r},t.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[gn(e.name())]=null,this.childNameIndex_[mn(e.name())]=null;var i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},t.initChildren=function(){var t=this,n=this.options_.children;if(n){var i,r=this.options_,a=e.getComponent("Tech");(i=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter((function(e){return!i.some((function(t){return"string"==typeof t?e===t:e===t.name}))}))).map((function(e){var i,r;return"string"==typeof e?r=n[i=e]||t.options_[i]||{}:(i=e.name,r=e),{name:i,opts:r}})).filter((function(t){var n=e.getComponent(t.opts.componentClass||gn(t.name));return n&&!a.isTech(n)})).forEach((function(e){var n=e.name,i=e.opts;if(void 0!==r[n]&&(i=r[n]),!1!==i){!0===i&&(i={}),i.playerOptions=t.options_.playerOptions;var a=t.addChild(n,i);a&&(t[n]=a)}}))}},t.buildCSSClass=function(){return""},t.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},t.triggerReady=function(){this.isReady_=!0,this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)},t.$=function(e,t){return Rt(e,t||this.contentEl())},t.$$=function(e,t){return It(e,t||this.contentEl())},t.hasClass=function(e){return lt(this.el_,e)},t.addClass=function(e){ut(this.el_,e)},t.removeClass=function(e){ct(this.el_,e)},t.toggleClass=function(e,t){ht(this.el_,e,t)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(e){return pt(this.el_,e)},t.setAttribute=function(e,t){mt(this.el_,e,t)},t.removeAttribute=function(e){gt(this.el_,e)},t.width=function(e,t){return this.dimension("width",e,t)},t.height=function(e,t){return this.dimension("height",e,t)},t.dimensions=function(e,t){this.width(e,!0),this.height(t)},t.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[e],r=i.indexOf("px");return-1!==r?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+gn(e)],10)},t.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=Je(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+gn(e);t=this.el_[n]}return t},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},t.handleKeyPress=function(e){this.handleKeyDown(e)},t.emitTapEvents=function(){var e,t=0,n=null;this.on("touchstart",(function(i){1===i.touches.length&&(n={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},t=r.a.performance.now(),e=!0)})),this.on("touchmove",(function(t){if(t.touches.length>1)e=!1;else if(n){var i=t.touches[0].pageX-n.pageX,r=t.touches[0].pageY-n.pageY;Math.sqrt(i*i+r*r)>10&&(e=!1)}}));var i=function(){e=!1};this.on("touchleave",i),this.on("touchcancel",i),this.on("touchend",(function(i){(n=null,!0===e)&&(r.a.performance.now()-t<200&&(i.preventDefault(),this.trigger("tap")))}))},t.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=en(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}));var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.setTimeout=function(e,t){var n,i=this;return e=en(this,e),this.clearTimersOnDispose_(),n=r.a.setTimeout((function(){i.setTimeoutIds_.has(n)&&i.setTimeoutIds_.delete(n),e()}),t),this.setTimeoutIds_.add(n),n},t.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),r.a.clearTimeout(e)),e},t.setInterval=function(e,t){e=en(this,e),this.clearTimersOnDispose_();var n=r.a.setInterval(e,t);return this.setIntervalIds_.add(n),n},t.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),r.a.clearInterval(e)),e},t.requestAnimationFrame=function(e){var t,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=en(this,e),t=r.a.requestAnimationFrame((function(){n.rafIds_.has(t)&&n.rafIds_.delete(t),e()})),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},t.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),r.a.cancelAnimationFrame(e)),e):this.clearTimeout(e)},t.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(t){var n=t[0],i=t[1];e[n].forEach(e[i],e)})),e.clearingTimersOnDispose_=!1})))},e.registerComponent=function(t,n){if("string"!=typeof t||!t)throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.');var i,r=e.getComponent("Tech"),a=r&&r.isTech(n),o=e===n||e.prototype.isPrototypeOf(n.prototype);if(a||!o)throw i=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+t+'"; '+i+".");t=gn(t),e.components_||(e.components_={});var s=e.getComponent("Player");if("Player"===t&&s&&s.players){var l=s.players,u=Object.keys(l);if(l&&u.length>0&&u.map((function(e){return l[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return e.components_[t]=n,e.components_[mn(t)]=n,n},e.getComponent=function(t){if(t&&e.components_)return e.components_[t]},e}();yn.prototype.supportsRaf_="function"==typeof r.a.requestAnimationFrame&&"function"==typeof r.a.cancelAnimationFrame,yn.registerComponent("Component",yn);var _n,bn=r.a.navigator&&r.a.navigator.userAgent||"",En=/AppleWebKit\/([\d.]+)/i.exec(bn),Tn=En?parseFloat(En.pop()):null,wn=/iPod/i.test(bn),xn=(_n=bn.match(/OS (\d+)_/i))&&_n[1]?_n[1]:null,An=/Android/i.test(bn),Sn=function(){var e=bn.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Mn=An&&Sn<5&&Tn<537,Cn=/Firefox/i.test(bn),Rn=/Edg/i.test(bn),In=!Rn&&(/Chrome/i.test(bn)||/CriOS/i.test(bn)),Pn=function(){var e=bn.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Ln=function(){var e=/MSIE\s(\d+)\.\d/.exec(bn),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(bn)&&/rv:11.0/.test(bn)&&(t=11),t}(),Dn=/Safari/i.test(bn)&&!In&&!An&&!Rn,On=/Windows/i.test(bn),Nn=tt()&&("ontouchstart"in r.a||r.a.navigator.maxTouchPoints||r.a.DocumentTouch&&r.a.document instanceof r.a.DocumentTouch),kn=/iPad/i.test(bn)||Dn&&Nn&&!/iPhone/i.test(bn),Fn=/iPhone/i.test(bn)&&!kn,Bn=Fn||kn||wn,Un=(Dn||Bn)&&!In,jn=Object.freeze({__proto__:null,IS_IPOD:wn,IOS_VERSION:xn,IS_ANDROID:An,ANDROID_VERSION:Sn,IS_NATIVE_ANDROID:Mn,IS_FIREFOX:Cn,IS_EDGE:Rn,IS_CHROME:In,CHROME_VERSION:Pn,IE_VERSION:Ln,IS_SAFARI:Dn,IS_WINDOWS:On,TOUCH_ENABLED:Nn,IS_IPAD:kn,IS_IPHONE:Fn,IS_IOS:Bn,IS_ANY_SAFARI:Un});function Gn(e,t,n,i){return function(e,t,n){if("number"!=typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,i,n.length-1),n[i][t]}function zn(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:Gn.bind(null,"start",0,e),end:Gn.bind(null,"end",1,e)}}function Hn(e,t){return Array.isArray(e)?zn(e):void 0===e||void 0===t?zn():zn([[e,t]])}function Vn(e,t){var n,i,r=0;if(!t)return 0;e&&e.length||(e=Hn(0,0));for(var a=0;a<e.length;a++)n=e.start(a),(i=e.end(a))>t&&(i=t),r+=i-n;return r/t}for(var Wn,qn={prefixed:!0},Yn=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Xn=Yn[0],Kn=0;Kn<Yn.length;Kn++)if(Yn[Kn][1]in o.a){Wn=Yn[Kn];break}if(Wn){for(var Qn=0;Qn<Wn.length;Qn++)qn[Xn[Qn]]=Wn[Qn];qn.prefixed=Wn[0]!==Xn[0]}function Zn(e){if(e instanceof Zn)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:Qe(e)&&("number"==typeof e.code&&(this.code=e.code),Ke(this,e)),this.message||(this.message=Zn.defaultMessages[this.code]||"")}Zn.prototype.code=0,Zn.prototype.message="",Zn.prototype.status=null,Zn.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Zn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Jn=0;Jn<Zn.errorTypes.length;Jn++)Zn[Zn.errorTypes[Jn]]=Jn,Zn.prototype[Zn.errorTypes[Jn]]=Jn;function $n(e){return null!=e&&"function"==typeof e.then}function ei(e){$n(e)&&e.then(null,(function(e){}))}var ti=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(t,n,i){return e[n]&&(t[n]=e[n]),t}),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))})},ni=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,(function(e){return e.track}));return Array.prototype.map.call(t,(function(e){var t=ti(e.track);return e.src&&(t.src=e.src),t})).concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===n.indexOf(e)})).map(ti))},ii=function(e,t){return e.forEach((function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((function(e){return n.addCue(e)}))})),t.textTracks()},ri=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).opened_=i.hasBeenOpened_=i.hasBeenFilled_=!1,i.closeable(!i.options_.uncloseable),i.content(i.options_.content),i.contentEl_=at("div",{className:"vjs-modal-dialog-content"},{role:"document"}),i.descEl_=at("p",{className:"vjs-modal-dialog-description vjs-control-text",id:i.el().getAttribute("aria-describedby")}),ot(i.descEl_,i.description()),i.el_.appendChild(i.descEl_),i.el_.appendChild(i.contentEl_),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-modal-dialog vjs-hidden "+e.prototype.buildCSSClass.call(this)},n.label=function(){return this.localize(this.options_.label||"Modal Window")},n.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},n.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var i=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},n.fill=function(){this.fillWith(this.content())},n.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,i=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),St(t,e),this.trigger("modalfill"),i?n.insertBefore(t,i):n.appendChild(t);var r=this.getChild("closeButton");r&&n.appendChild(r.el_)},n.empty=function(){this.trigger("beforemodalempty"),wt(this.contentEl()),this.trigger("modalempty")},n.content=function(e){return void 0!==e&&(this.content_=e),this.content_},n.conditionalFocus_=function(){var e=o.a.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())},n.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},n.handleKeyDown=function(e){if(e.stopPropagation(),g.a.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(g.a.isEventKey(e,"Tab")){for(var t,n=this.focusableEls_(),i=this.el_.querySelector(":focus"),r=0;r<n.length;r++)if(i===n[r]){t=r;break}o.a.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||t!==n.length-1||(n[0].focus(),e.preventDefault())}},n.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(function(e){return(e instanceof r.a.HTMLAnchorElement||e instanceof r.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof r.a.HTMLInputElement||e instanceof r.a.HTMLSelectElement||e instanceof r.a.HTMLTextAreaElement||e instanceof r.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof r.a.HTMLIFrameElement||e instanceof r.a.HTMLObjectElement||e instanceof r.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")}))},t}(yn);ri.prototype.options_={pauseOnOpen:!0,temporary:!0},yn.registerComponent("ModalDialog",ri);var ai=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(c()(n),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<t.length;i++)n.addTrack(t[i]);return n}d()(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},n.removeTrack=function(e){for(var t,n=0,i=this.length;n<i;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},t}(nn);for(var oi in ai.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},ai.prototype.allowedEvents_)ai.prototype["on"+oi]=null;var si=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},li=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].enabled){si(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,n}d()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&si(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,si(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(ai),ui=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},ci=function(e){function t(t){var n;void 0===t&&(t=[]);for(var i=t.length-1;i>=0;i--)if(t[i].selected){ui(t,t[i]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(c()(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}d()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&ui(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,ui(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(ai),hi=function(e){function t(){return e.apply(this,arguments)||this}d()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(ai),di=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,i=this.trackElements_.length;n<i;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),fi=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,i=e.length;this.cues_=e,this.length_=e.length;var r=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<i)for(n=t;n<i;n++)r.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===e){t=r;break}}return t},e}(),pi={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},mi={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},gi={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},vi={disabled:"disabled",hidden:"hidden",showing:"showing"},yi=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var i={id:t.id||"vjs_track_"+jt(),kind:t.kind||"",label:t.label||"",language:t.language||""},r=function(e){Object.defineProperty(c()(n),e,{get:function(){return i[e]},set:function(){}})};for(var a in i)r(a);return n}return d()(t,e),t}(nn),_i=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],n=o.a.createElement("a");n.href=e;var i,a=""===n.host&&"file:"!==n.protocol;a&&((i=o.a.createElement("div")).innerHTML='<a href="'+e+'"></a>',n=i.firstChild,i.setAttribute("style","display:none; position:absolute;"),o.a.body.appendChild(i));for(var s={},l=0;l<t.length;l++)s[t[l]]=n[t[l]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=r.a.location.protocol),a&&o.a.body.removeChild(i),s},bi=function(e){if(!e.match(/^https?:\/\//)){var t=o.a.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},Ei=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},Ti=function(e,t){void 0===t&&(t=r.a.location);var n=_i(e);return(":"===n.protocol?t.protocol:n.protocol)+n.host!==t.protocol+t.host},wi=Object.freeze({__proto__:null,parseUrl:_i,getAbsoluteURL:bi,getFileExtension:Ei,isCrossOrigin:Ti}),xi=function(e,t){var n=new r.a.WebVTT.Parser(r.a,r.a.vttjs,r.a.WebVTT.StringDecoder()),i=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){i.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),i.length>0&&(r.a.console&&r.a.console.groupCollapsed&&r.a.console.groupCollapsed("Text Track parsing errors for "+t.src),i.forEach((function(e){return Ve.error(e)})),r.a.console&&r.a.console.groupEnd&&r.a.console.groupEnd()),n.flush()},Ai=function(e,t){var n={uri:e},i=Ti(e);i&&(n.cors=i),y()(n,en(this,(function(e,n,i){if(e)return Ve.error(e,n);t.loaded_=!0,"function"!=typeof r.a.WebVTT?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"!==e.type)return xi(i,t);Ve.error("vttjs failed to load, stopping trying to process "+t.src)})):xi(i,t)})))},Si=function(e){function t(t){var n;if(void 0===t&&(t={}),!t.tech)throw new Error("A tech was not provided.");var i=vn(t,{kind:gi[t.kind]||"subtitles",language:t.language||t.srclang||""}),r=vi[i.mode]||"disabled",a=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(r="hidden"),(n=e.call(this,i)||this).tech_=i.tech,n.cues_=[],n.activeCues_=[],n.preload_=!1!==n.tech_.preloadTextTracks;var o=new fi(n.cues_),s=new fi(n.activeCues_),l=!1,u=en(c()(n),(function(){this.activeCues=this.activeCues,l&&(this.trigger("cuechange"),l=!1)}));return"disabled"!==r&&n.tech_.ready((function(){n.tech_.on("timeupdate",u)}),!0),Object.defineProperties(c()(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;vi[e]&&(r=e,this.preload_||"disabled"===r||0!==this.cues.length||Ai(this.src,this),"disabled"!==r?this.tech_.ready((function(){t.tech_.on("timeupdate",u)}),!0):this.tech_.off("timeupdate",u),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?o:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],n=0,i=this.cues.length;n<i;n++){var r=this.cues[n];(r.startTime<=e&&r.endTime>=e||r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e)&&t.push(r)}if(l=!1,t.length!==this.activeCues_.length)l=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(l=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),i.src?(n.src=i.src,n.preload_||(n.loaded_=!0),(n.preload_||a||"subtitles"!==i.kind&&"captions"!==i.kind)&&Ai(n.src,c()(n))):n.loaded_=!0,n}d()(t,e);var n=t.prototype;return n.addCue=function(e){var t=e;if(r.a.vttjs&&!(e instanceof r.a.vttjs.VTTCue)){for(var n in t=new r.a.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}for(var i=this.tech_.textTracks(),a=0;a<i.length;a++)i[a]!==this&&i[a].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},n.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},t}(yi);Si.prototype.allowedEvents_={cuechange:"cuechange"};var Mi=function(e){function t(t){var n;void 0===t&&(t={});var i=vn(t,{kind:mi[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(c()(n),"enabled",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("enabledchange"))}}),i.enabled&&(n.enabled=i.enabled),n.loaded_=!0,n}return d()(t,e),t}(yi),Ci=function(e){function t(t){var n;void 0===t&&(t={});var i=vn(t,{kind:pi[t.kind]||""});n=e.call(this,i)||this;var r=!1;return Object.defineProperty(c()(n),"selected",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("selectedchange"))}}),i.selected&&(n.selected=i.selected),n}return d()(t,e),t}(yi),Ri=function(e){function t(t){var n,i;void 0===t&&(t={}),n=e.call(this)||this;var r=new Si(t);return n.kind=r.kind,n.src=r.src,n.srclang=r.language,n.label=r.label,n.default=r.default,Object.defineProperties(c()(n),{readyState:{get:function(){return i}},track:{get:function(){return r}}}),i=0,r.addEventListener("loadeddata",(function(){i=2,n.trigger({type:"load",target:c()(n)})})),n}return d()(t,e),t}(nn);Ri.prototype.allowedEvents_={load:"load"},Ri.NONE=0,Ri.LOADING=1,Ri.LOADED=2,Ri.ERROR=3;var Ii={audio:{ListClass:li,TrackClass:Mi,capitalName:"Audio"},video:{ListClass:ci,TrackClass:Ci,capitalName:"Video"},text:{ListClass:hi,TrackClass:Si,capitalName:"Text"}};Object.keys(Ii).forEach((function(e){Ii[e].getterName=e+"Tracks",Ii[e].privateName=e+"Tracks_"}));var Pi={remoteText:{ListClass:hi,TrackClass:Si,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:di,TrackClass:Ri,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Li=l()({},Ii,Pi);Pi.names=Object.keys(Pi),Ii.names=Object.keys(Ii),Li.names=[].concat(Pi.names).concat(Ii.names);var Di=function(e){function t(t,n){var i;return void 0===t&&(t={}),void 0===n&&(n=function(){}),t.reportTouchActivity=!1,(i=e.call(this,null,t,n)||this).hasStarted_=!1,i.on("playing",(function(){this.hasStarted_=!0})),i.on("loadstart",(function(){this.hasStarted_=!1})),Li.names.forEach((function(e){var n=Li[e];t&&t[n.getterName]&&(i[n.privateName]=t[n.getterName])})),i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(e){!1===t["native"+e+"Tracks"]&&(i["featuresNative"+e+"Tracks"]=!1)})),!1===t.nativeCaptions||!1===t.nativeTextTracks?i.featuresNativeTextTracks=!1:!0!==t.nativeCaptions&&!0!==t.nativeTextTracks||(i.featuresNativeTextTracks=!0),i.featuresNativeTextTracks||i.emulateTextTracks(),i.preloadTextTracks=!1!==t.preloadTextTracks,i.autoRemoteTextTracks_=new Li.text.ListClass,i.initTrackListeners(),t.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}d()(t,e);var n=t.prototype;return n.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",(function(){return t.setTimeout((function(){return t.triggerSourceset(e)}),1)})),this.trigger({src:e,type:"sourceset"})},n.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},n.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},n.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(en(this,(function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()})),500)},n.onDurationChange=function(e){this.duration_=this.duration()},n.buffered=function(){return Hn(0,0)},n.bufferedPercent=function(){return Vn(this.buffered(),this.duration_)},n.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},n.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},n.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},n.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)},n.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.dispose=function(){this.clearTracks(Ii.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},n.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach((function(e){for(var n=t[e+"Tracks"]()||[],i=n.length;i--;){var r=n[i];"text"===e&&t.removeRemoteTextTrack(r),n.removeTrack(r)}}))},n.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},n.reset=function(){},n.error=function(e){return void 0!==e&&(this.error_=new Zn(e),this.trigger("error")),this.error_},n.played=function(){return this.hasStarted_?Hn(0,0):Hn()},n.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.initTrackListeners=function(){var e=this;Ii.names.forEach((function(t){var n=Ii[t],i=function(){e.trigger(t+"trackchange")},r=e[n.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),e.on("dispose",(function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)}))}))},n.addWebVttScript_=function(){var e=this;if(!r.a.WebVTT)if(o.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&Ze(b.a)&&Object.keys(b.a).length>0)return void this.trigger("vttjsloaded");var t=o.a.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",(function(){t.onload=null,t.onerror=null})),r.a.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},n.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),i=function(e){return t.addTrack(e.track)},r=function(e){return t.removeTrack(e.track)};n.on("addtrack",i),n.on("removetrack",r),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",(function(){n.off("addtrack",i),n.off("removetrack",r),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){t[e].removeEventListener("cuechange",a)}}))},n.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,i,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,n&&(r.label=n),i&&(r.language=i),r.tech=e;var o=new Li.text.TrackClass(r);return a.addTrack(o),o}(this,e,t,n)},n.createRemoteTextTrack=function(e){var t=vn(e,{tech:this});return new Pi.remoteTextEl.TrackClass(t)},n.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var i=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(Ve.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!0!==t&&this.ready((function(){return n.autoRemoteTextTracks_.addTrack(i.track)})),i},n.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},n.getVideoPlaybackQuality=function(){return{}},n.requestPictureInPicture=function(){var e=this.options_.Promise||r.a.Promise;if(e)return e.reject()},n.setPoster=function(){},n.playsinline=function(){},n.setPlaysinline=function(){},n.overrideNativeAudioTracks=function(){},n.overrideNativeVideoTracks=function(){},n.canPlayType=function(){return""},t.canPlayType=function(){return""},t.canPlaySource=function(e,n){return t.canPlayType(e.type)},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,n){if(t.techs_||(t.techs_={}),!t.isTech(n))throw new Error("Tech "+e+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=gn(e),t.techs_[e]=n,t.techs_[mn(e)]=n,"Tech"!==e&&t.defaultTechOrder_.push(e),n},t.getTech=function(e){if(e)return t.techs_&&t.techs_[e]?t.techs_[e]:(e=gn(e),r.a&&r.a.videojs&&r.a.videojs[e]?(Ve.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),r.a.videojs[e]):void 0)},t}(yn);Li.names.forEach((function(e){var t=Li[e];Di.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}})),Di.prototype.featuresVolumeControl=!0,Di.prototype.featuresMuteControl=!0,Di.prototype.featuresFullscreenResize=!1,Di.prototype.featuresPlaybackRate=!1,Di.prototype.featuresProgressEvents=!1,Di.prototype.featuresSourceset=!1,Di.prototype.featuresTimeupdateEvents=!1,Di.prototype.featuresNativeTextTracks=!1,Di.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var i=e.sourceHandlers;i||(i=e.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,t)},e.canPlayType=function(t){for(var n,i=e.sourceHandlers||[],r=0;r<i.length;r++)if(n=i[r].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var i=e.sourceHandlers||[],r=0;r<i.length;r++)if(i[r].canHandleSource(t,n))return i[r];return null},e.canPlaySource=function(t,n){var i=e.selectSourceHandler(t,n);return i?i.canHandleSource(t,n):""};["seekable","seeking","duration"].forEach((function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:Ve.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},yn.registerComponent("Tech",Di),Di.registerTech("Tech",Di),Di.defaultTechOrder_=[];var Oi={},Ni={},ki={};function Fi(e,t,n){e.setTimeout((function(){return function e(t,n,i,r,a,o){void 0===t&&(t={});void 0===n&&(n=[]);void 0===a&&(a=[]);void 0===o&&(o=!1);var s=n,l=s[0],u=s.slice(1);if("string"==typeof l)e(t,Oi[l],i,r,a,o);else if(l){var c=function(e,t){var n=Ni[e.id()],i=null;if(null==n)return i=t(e),Ni[e.id()]=[[t,i]],i;for(var r=0;r<n.length;r++){var a=n[r],o=a[0],s=a[1];o===t&&(i=s)}null===i&&(i=t(e),n.push([t,i]));return i}(r,l);if(!c.setSource)return a.push(c),e(t,u,i,r,a,o);c.setSource(Ke({},t),(function(n,s){if(n)return e(t,u,i,r,a,o);a.push(c),e(s,t.type===s.type?u:Oi[s.type],i,r,a,o)}))}else u.length?e(t,u,i,r,a,o):o?i(t,a):e(t,Oi["*"],i,r,a,!0)}(t,Oi[t.type],n,e)}),1)}function Bi(e,t,n,i){void 0===i&&(i=null);var r="call"+gn(n),a=e.reduce(zi(r),i),o=a===ki,s=o?null:t[n](a);return function(e,t,n,i){for(var r=e.length-1;r>=0;r--){var a=e[r];a[t]&&a[t](i,n)}}(e,n,s,o),s}var Ui={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},ji={setCurrentTime:1,setMuted:1,setVolume:1},Gi={play:1,pause:1};function zi(e){return function(t,n){return t===ki?ki:n[e]?n[e](t):t}}var Hi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Vi=function(e){void 0===e&&(e="");var t=Ei(e);return Hi[t.toLowerCase()]||""};function Wi(e){if(!e.type){var t=Vi(e.src);t&&(e.type=t)}return e}var qi=function(e){function t(t,n,i){var r,a=vn({createEl:!1},n);if(r=e.call(this,t,a,i)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var l=gn(s[o]),u=Di.getTech(l);if(l||(u=yn.getComponent(l)),u&&u.isSupported()){t.loadTech_(l);break}}return r}return d()(t,e),t}(yn);yn.registerComponent("MediaLoader",qi);var Yi=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).emitTapEvents(),i.enable(),i}d()(t,e);var n=t.prototype;return n.createEl=function(t,n,i){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===i&&(i={}),n=Ke({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&Ve.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),i=Ke({role:"button"},i),this.tabIndex_=n.tabIndex;var r=e.prototype.createEl.call(this,t,n,i);return this.createControlTextEl(r),r},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=at("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,ot(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},n.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},n.handleKeyDown=function(t){g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(yn);yn.registerComponent("ClickableComponent",Yi);var Xi=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update(),t.on("posterchange",en(c()(i),i.update)),i}d()(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){return at("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(Ln||Rn)&&t||this.player_.tech(!0).focus(),this.player_.paused()?ei(this.player_.play()):this.player_.pause()}},t}(Yi);yn.registerComponent("PosterImage",Xi);var Ki={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Qi(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function Zi(e,t,n){try{e.style[t]=n}catch(e){return}}var Ji=function(e){function t(t,n,i){var a;a=e.call(this,t,n,i)||this;var o=en(c()(a),a.updateDisplay);return t.on("loadstart",en(c()(a),a.toggleDisplay)),t.on("texttrackchange",o),t.on("loadedmetadata",en(c()(a),a.preselectTrack)),t.ready(en(c()(a),(function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)this.hide();else{t.on("fullscreenchange",o),t.on("playerresize",o),r.a.addEventListener("orientationchange",o),t.on("dispose",(function(){return r.a.removeEventListener("orientationchange",o)}));for(var e=this.options_.playerOptions.tracks||[],n=0;n<e.length;n++)this.player_.addRemoteTextTrack(e[n],!0);this.preselectTrack()}}))),a}d()(t,e);var n=t.prototype;return n.preselectTrack=function(){for(var e,t,n,i={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<r.length;o++){var s=r[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in i?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s.default&&("descriptions"!==s.kind||e?s.kind in i&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},n.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},n.clearDisplay=function(){"function"==typeof r.a.WebVTT&&r.a.WebVTT.processCues(r.a,[],this.el_)},n.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],i=0;i<e.length;++i){var r=e[i];"showing"===r.mode&&n.push(r)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var l=e[s];"showing"===l.mode&&("descriptions"===l.kind?a=l:o=l)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},n.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),n=e.activeCues,i=n.length;i--;){var a=n[i];if(a){var o=a.displayState;if(t.color&&(o.firstChild.style.color=t.color),t.textOpacity&&Zi(o.firstChild,"color",Qi(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(o.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Zi(o.firstChild,"backgroundColor",Qi(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Zi(o,"backgroundColor",Qi(t.windowColor,t.windowOpacity)):o.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===t.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),t.fontPercent&&1!==t.fontPercent){var s=r.a.parseFloat(o.style.fontSize);o.style.fontSize=s*t.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=Ki[t.fontFamily])}}},n.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"==typeof r.a.WebVTT&&!e.every((function(e){return!e.activeCues}))){for(var t=[],n=0;n<e.length;++n)for(var i=e[n],a=0;a<i.activeCues.length;++a)t.push(i.activeCues[a]);r.a.WebVTT.processCues(r.a,t,this.el_);for(var o=0;o<e.length;++o){for(var s=e[o],l=0;l<s.activeCues.length;++l){var u=s.activeCues[l].displayState;ut(u,"vjs-text-track-cue"),ut(u,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},t}(yn);yn.registerComponent("TextTrackDisplay",Ji);var $i=function(e){function t(){return e.apply(this,arguments)||this}return d()(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),i=at("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),r=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(i),r},t}(yn);yn.registerComponent("LoadingSpinner",$i);var er=function(e){function t(){return e.apply(this,arguments)||this}d()(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=Ke({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=Ke({type:"button"},n);var i=yn.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(i),i},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return Ve.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),yn.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(Yi);yn.registerComponent("Button",er);var tr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).mouseused_=!1,i.on("mousedown",i.handleMouseDown),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return ei(t),void(!this.player_.tech(!0)||(Ln||Rn)&&n||this.player_.tech(!0).focus())}var i=this.player_.getChild("controlBar"),r=i&&i.getChild("playToggle");if(r){var a=function(){return r.focus()};$n(t)?t.then(a,(function(){})):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(er);tr.prototype.controlText_="Play Video",yn.registerComponent("BigPlayButton",tr);var nr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).controlText(n&&n.controlText||i.localize("Close")),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){g.a.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(er);yn.registerComponent("CloseButton",nr);var ir=function(e){function t(t,n){var i;return void 0===n&&(n={}),i=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,i.on(t,"play",i.handlePlay),i.on(t,"pause",i.handlePause),n.replay&&i.on(t,"ended",i.handleEnded),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(er);ir.prototype.controlText_="Play",yn.registerComponent("PlayToggle",ir);var rr=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),i=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=i=n="-"),(r=r>0||o>0?r+":":"")+(i=((r||a>=10)&&i<10?"0"+i:i)+":")+(n=n<10?"0"+n:n)},ar=rr;function or(e,t){return void 0===t&&(t=e),ar(e,t)}var sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,["timeupdate","ended"],i.updateContent),i.updateTextNode_(),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"</span>"});return this.contentEl_=at("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),n.appendChild(this.contentEl_),n},n.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},n.updateTextNode_=function(e){var t=this;void 0===e&&(e=0),e=or(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestAnimationFrame((function(){if(t.contentEl_){var e=t.textNode_;t.textNode_=o.a.createTextNode(t.formattedTime_),t.textNode_&&(e?t.contentEl_.replaceChild(t.textNode_,e):t.contentEl_.appendChild(t.textNode_))}})))},n.updateContent=function(e){},t}(yn);sr.prototype.labelText_="Time",sr.prototype.controlText_="Time",yn.registerComponent("TimeDisplay",sr);var lr=function(e){function t(){return e.apply(this,arguments)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(sr);lr.prototype.labelText_="Current Time",lr.prototype.controlText_="Current Time",yn.registerComponent("CurrentTimeDisplay",lr);var ur=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.updateContent),i.on(t,"loadstart",i.updateContent),i.on(t,"loadedmetadata",i.updateContent),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},t}(sr);ur.prototype.labelText_="Duration",ur.prototype.controlText_="Duration",yn.registerComponent("DurationDisplay",ur);var cr=function(e){function t(){return e.apply(this,arguments)||this}return d()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(yn);yn.registerComponent("TimeDivider",cr);var hr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"durationchange",i.updateContent),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(at("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){var t;"number"==typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},t}(sr);hr.prototype.labelText_="Remaining Time",hr.prototype.controlText_="Remaining Time",yn.registerComponent("RemainingTimeDisplay",hr);var dr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateShowing(),i.on(i.player(),"durationchange",i.updateShowing),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=at("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(yn);yn.registerComponent("LiveDisplay",dr);var fr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateLiveEdgeStatus(),i.player_.liveTracker&&i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=at("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(er);fr.prototype.controlText_="Seek to live, currently playing live",yn.registerComponent("SeekToLive",fr);var pr=function(e,t,n){return e=Number(e),Math.min(n,Math.max(t,isNaN(e)?t:e))},mr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.enable(),i}d()(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,i){return void 0===n&&(n={}),void 0===i&&(i={}),n.className=n.className+" vjs-slider",n=Ke({tabIndex:0},n),i=Ke({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),e.prototype.createEl.call(this,t,n,i)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||In||e.preventDefault(),vt(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;yt(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){var e=this;if(this.el_&&this.bar){var t=this.getProgress();return t===this.progress_||(this.progress_=t,this.requestAnimationFrame((function(){var n=e.vertical()?"height":"width";e.bar.el().style[n]=(100*t).toFixed(2)+"%"}))),t}},n.getProgress=function(){return Number(pr(this.getPercent(),0,1).toFixed(4))},n.calculateDistance=function(e){var t=Et(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){g.a.isEventKey(t,"Left")||g.a.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):g.a.isEventKey(t,"Right")||g.a.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(yn);yn.registerComponent("Slider",mr);var gr=function(e,t){return pr(e/t*100,0,100).toFixed(2)+"%"},vr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).partEls_=[],i.on(t,"progress",i.update),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),n=at("span",{className:"vjs-control-text"}),i=at("span",{textContent:this.localize("Loaded")}),r=o.a.createTextNode(": ");return this.percentageEl_=at("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(n),n.appendChild(i),n.appendChild(r),n.appendChild(this.percentageEl_),t},n.dispose=function(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this;this.requestAnimationFrame((function(){var e=t.player_.liveTracker,n=t.player_.buffered(),i=e&&e.isLive()?e.seekableEnd():t.player_.duration(),r=t.player_.bufferedEnd(),a=t.partEls_,o=gr(r,i);t.percent_!==o&&(t.el_.style.width=o,ot(t.percentageEl_,o),t.percent_=o);for(var s=0;s<n.length;s++){var l=n.start(s),u=n.end(s),c=a[s];c||(c=t.el_.appendChild(at()),a[s]=c),c.dataset.start===l&&c.dataset.end===u||(c.dataset.start=l,c.dataset.end=u,c.style.left=gr(l,r),c.style.width=gr(u-l,r))}for(var h=a.length;h>n.length;h--)t.el_.removeChild(a[h-1]);a.length=n.length}))},t}(yn);yn.registerComponent("LoadProgressBar",vr);var yr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=tn(en(c()(i),i.update),30),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var i=_t(this.el_),r=_t(this.player_.el()),a=e.width*t;if(r&&i){var o=e.left-r.left+a,s=e.width-a+(r.right-e.right),l=i.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px",this.write(n)}},n.write=function(e){ot(this.el_,e)},n.updateTime=function(e,t,n,i){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame((function(){var a,o=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var s=r.player_.liveTracker.liveWindow(),l=s-t*s;a=(l<1?"":"-")+or(l,s)}else a=or(n,o);r.update(e,t,a),i&&i()}))},t}(yn);yn.registerComponent("TimeTooltip",yr);var _r=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=tn(en(c()(i),i.update),30),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,i)}},t}(yn);_r.prototype.options_={children:[]},Bn||An||_r.prototype.options_.children.push("timeTooltip"),yn.registerComponent("PlayProgressBar",_r);var br=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).update=tn(en(c()(i),i.update),30),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,(function(){n.el_.style.left=e.width*t+"px"}))},t}(yn);br.prototype.options_={children:["timeTooltip"]},yn.registerComponent("MouseTimeDisplay",br);var Er=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).setEventHandlers_(),i}d()(t,e);var n=t.prototype;return n.setEventHandlers_=function(){this.update_=en(this,this.update),this.update=tn(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.on(o.a,"visibilitychange",this.toggleVisibility_)},n.toggleVisibility_=function(e){o.a.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},n.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},n.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update=function(t){var n=this,i=e.prototype.update.call(this);return this.requestAnimationFrame((function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),t=n.player_.liveTracker,r=n.player_.duration();t&&t.isLive()&&(r=n.player_.liveTracker.liveCurrentTime()),n.percent_!==i&&(n.el_.setAttribute("aria-valuenow",(100*i).toFixed(2)),n.percent_=i),n.currentTime_===e&&n.duration_===r||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[or(e,r),or(r,r)],"{1} of {2}")),n.currentTime_=e,n.duration_=r),n.bar&&n.bar.update(_t(n.el()),n.getProgress())})),i},n.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},n.handleMouseDown=function(t){Mt(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},n.handleMouseMove=function(e){if(Mt(e)){var t,n=this.calculateDistance(e),i=this.player_.liveTracker;if(i&&i.isLive()){if(n>=.99)return void i.seekToLiveEdge();var r=i.seekableStart(),a=i.liveCurrentTime();if((t=r+n*i.liveWindow())>=a&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?ei(this.player_.play()):this.update_()},n.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},n.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyDown=function(t){if(g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(g.a.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(g.a.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(g()(t))){t.preventDefault(),t.stopPropagation();var n=10*(g.a.codes[g()(t)]-g.a.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else g.a.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):g.a.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},n.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.off(o.a,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},t}(mr);Er.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Bn||An||Er.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),yn.registerComponent("SeekBar",Er);var Tr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).handleMouseMove=tn(en(c()(i),i.handleMouseMove),30),i.throttledHandleMouseSeek=tn(en(c()(i),i.handleMouseSeek),30),i.enable(),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("playProgressBar"),i=t.getChild("mouseTimeDisplay");if(n||i){var r=t.el(),a=_t(r),o=Et(r,e).x;o=pr(0,1,o),i&&i.update(a,o),n&&n.update(a,t.getProgress())}}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach((function(e){return e.disable&&e.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach((function(e){return e.enable&&e.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(yn);Tr.prototype.options_={children:["seekBar"]},yn.registerComponent("ProgressControl",Tr);var wr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,["enterpictureinpicture","leavepictureinpicture"],i.handlePictureInPictureChange),o.a.pictureInPictureEnabled||i.disable(),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},n.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},n.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},t}(er);wr.prototype.controlText_="Picture-in-Picture",yn.registerComponent("PictureInPictureToggle",wr);var xr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"fullscreenchange",i.handleFullscreenChange),!1===o.a[t.fsApi_.fullscreenEnabled]&&i.disable(),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},n.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},n.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(er);xr.prototype.controlText_="Fullscreen",yn.registerComponent("FullscreenToggle",xr);var Ar=function(e){function t(){return e.apply(this,arguments)||this}return d()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(yn);yn.registerComponent("VolumeLevel",Ar);var Sr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on("slideractive",i.updateLastVolume_),i.on(t,"volumechange",i.updateARIAAttributes),t.ready((function(){return i.updateARIAAttributes()})),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Mt(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Mt(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",(function(){0===e.player_.volume()&&e.player_.lastVolume_(t)}))},t}(mr);Sr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Sr.prototype.playerEvent="volumechange",yn.registerComponent("VolumeBar",Sr);var Mr=function(e){function t(t,n){var i;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||Ze(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),i=e.call(this,t,n)||this,function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(c()(i),t),i.throttledHandleMouseMove=tn(en(c()(i),i.handleMouseMove),30),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on(i.volumeBar,["focus","slideractive"],(function(){i.volumeBar.addClass("vjs-slider-active"),i.addClass("vjs-slider-active"),i.trigger("slideractive")})),i.on(i.volumeBar,["blur","sliderinactive"],(function(){i.volumeBar.removeClass("vjs-slider-active"),i.removeClass("vjs-slider-active"),i.trigger("sliderinactive")})),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(yn);Mr.prototype.options_={children:["volumeBar"]},yn.registerComponent("VolumeControl",Mr);var Cr=function(e){function t(t,n){var i;return i=e.call(this,t,n)||this,function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(c()(i),t),i.on(t,["loadstart","volumechange"],i.update),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var i=n<.1?.1:n;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;Bn&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)ct(this.el_,"vjs-vol-"+n);ut(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(er);Cr.prototype.controlText_="Mute",yn.registerComponent("MuteToggle",Cr);var Rr=function(e){function t(t,n){var i;return void 0===n&&(n={}),void 0!==n.inline?n.inline=n.inline:n.inline=!0,(void 0===n.volumeControl||Ze(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(i=e.call(this,t,n)||this).on(t,["loadstart"],i.volumePanelState_),i.on(i.muteToggle,"keyup",i.handleKeyPress),i.on(i.volumeControl,"keyup",i.handleVolumeControlKeyUp),i.on("keydown",i.handleKeyPress),i.on("mouseover",i.handleMouseOver),i.on("mouseout",i.handleMouseOut),i.on(i.volumeControl,["slideractive"],i.sliderActive_),i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_),i}d()(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},n.dispose=function(){this.handleMouseOut(),e.prototype.dispose.call(this)},n.handleVolumeControlKeyUp=function(e){g.a.isEventKey(e,"Esc")&&this.muteToggle.focus()},n.handleMouseOver=function(e){this.addClass("vjs-hover"),Yt(o.a,"keyup",en(this,this.handleKeyPress))},n.handleMouseOut=function(e){this.removeClass("vjs-hover"),Xt(o.a,"keyup",en(this,this.handleKeyPress))},n.handleKeyPress=function(e){g.a.isEventKey(e,"Esc")&&this.handleMouseOut()},t}(yn);Rr.prototype.options_={children:["muteToggle","volumeControl"]},yn.registerComponent("VolumePanel",Rr);var Ir=function(e){function t(t,n){var i;return i=e.call(this,t,n)||this,n&&(i.menuButton_=n.menuButton),i.focusedChild_=-1,i.on("keydown",i.handleKeyDown),i.boundHandleBlur_=en(c()(i),i.handleBlur),i.boundHandleTapClick_=en(c()(i),i.handleTapClick),i}d()(t,e);var n=t.prototype;return n.addEventListenerForItem=function(e){e instanceof yn&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},n.removeEventListenerForItem=function(e){e instanceof yn&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},n.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},n.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},n.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=at(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),Yt(n,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),n},n.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},n.handleBlur=function(e){var t=e.relatedTarget||o.a.activeElement;if(!this.children().some((function(e){return e.el()===t}))){var n=this.menuButton_;n&&n.buttonPressed_&&t!==n.el().firstChild&&n.unpressButton()}},n.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter((function(t){return t.el()===e.target}))[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},n.handleKeyDown=function(e){g.a.isEventKey(e,"Left")||g.a.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(g.a.isEventKey(e,"Right")||g.a.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},n.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(yn);yn.registerComponent("Menu",Ir);var Pr=function(e){function t(t,n){var i;void 0===n&&(n={}),(i=e.call(this,t,n)||this).menuButton_=new er(t,n),i.menuButton_.controlText(i.controlText_),i.menuButton_.el_.setAttribute("aria-haspopup","true");var r=er.prototype.buildCSSClass();return i.menuButton_.el_.className=i.buildCSSClass()+" "+r,i.menuButton_.removeClass("vjs-control"),i.addChild(i.menuButton_),i.update(),i.enabled_=!0,i.on(i.menuButton_,"tap",i.handleClick),i.on(i.menuButton_,"click",i.handleClick),i.on(i.menuButton_,"keydown",i.handleKeyDown),i.on(i.menuButton_,"mouseenter",(function(){i.addClass("vjs-hover"),i.menu.show(),Yt(o.a,"keyup",en(c()(i),i.handleMenuKeyUp))})),i.on("mouseleave",i.handleMouseLeave),i.on("keydown",i.handleSubmenuKeyDown),i}d()(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Ir(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=at("li",{className:"vjs-menu-title",innerHTML:gn(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new yn(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+er.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.dispose=function(){this.handleMouseLeave(),e.prototype.dispose.call(this)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.handleMouseLeave=function(e){this.removeClass("vjs-hover"),Xt(o.a,"keyup",en(this,this.handleMenuKeyUp))},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),g.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(g.a.isEventKey(e,"Up")||g.a.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleMenuKeyUp=function(e){(g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),g.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Bn&&it())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(yn);yn.registerComponent("MenuButton",Pr);var Lr=function(e){function t(t,n){var i,r=n.tracks;if((i=e.call(this,t,n)||this).items.length<=1&&i.hide(),!r)return c()(i);var a=en(c()(i),i.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),i.player_.on("ready",a),i.player_.on("dispose",(function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)})),i}return d()(t,e),t}(Pr);yn.registerComponent("TrackButton",Lr);var Dr=["Tab","Esc","Up","Down","Right","Left"],Or=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).selectable=n.selectable,i.isSelected_=n.selected||!1,i.multiSelectable=n.multiSelectable,i.selected(i.isSelected_),i.selectable?i.multiSelectable?i.el_.setAttribute("role","menuitemcheckbox"):i.el_.setAttribute("role","menuitemradio"):i.el_.setAttribute("role","menuitem"),i}d()(t,e);var n=t.prototype;return n.createEl=function(t,n,i){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",Ke({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),i)},n.handleKeyDown=function(t){Dr.some((function(e){return g.a.isEventKey(t,e)}))||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(Yi);yn.registerComponent("MenuItem",Or);var Nr=function(e){function t(t,n){var i,a=n.track,s=t.textTracks();n.label=a.label||a.language||"Unknown",n.selected="showing"===a.mode,(i=e.call(this,t,n)||this).track=a,i.kinds=(n.kinds||[n.kind||i.track.kind]).filter(Boolean);var l,u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.handleTracksChange.apply(c()(i),t)},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.handleSelectedLanguageChange.apply(c()(i),t)};(t.on(["loadstart","texttrackchange"],u),s.addEventListener("change",u),s.addEventListener("selectedlanguagechange",h),i.on("dispose",(function(){t.off(["loadstart","texttrackchange"],u),s.removeEventListener("change",u),s.removeEventListener("selectedlanguagechange",h)})),void 0===s.onchange)&&i.on(["tap","click"],(function(){if("object"!=typeof r.a.Event)try{l=new r.a.Event("change")}catch(e){}l||(l=o.a.createEvent("Event")).initEvent("change",!0,!0),s.dispatchEvent(l)}));return i.handleTracksChange(),i}d()(t,e);var n=t.prototype;return n.handleClick=function(t){var n=this.track,i=this.player_.textTracks();if(e.prototype.handleClick.call(this,t),i)for(var r=0;r<i.length;r++){var a=i[r];-1!==this.kinds.indexOf(a.kind)&&(a===n?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},n.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},n.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},n.dispose=function(){this.track=null,e.prototype.dispose.call(this)},t}(Or);yn.registerComponent("TextTrackMenuItem",Nr);var kr=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}d()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,i=0,r=t.length;i<r;i++){var a=t[i];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Nr);yn.registerComponent("OffTextTrackMenuItem",kr);var Fr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return d()(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=Nr),this.label_&&(n=this.label_+" off"),e.push(new kr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<i.length;r++){var a=i[r];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Lr);yn.registerComponent("TextTrackButton",Fr);var Br=function(e){function t(t,n){var i,r=n.track,a=n.cue,o=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=o&&o<a.endTime,(i=e.call(this,t,n)||this).track=r,i.cue=a,r.addEventListener("cuechange",en(c()(i),i.update)),i}d()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(Or);yn.registerComponent("ChaptersTrackMenuItem",Br);var Ur=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(gn(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,i=t.length;n<i;n++){var r=t[n],a=new Br(this.player_,{track:this.track_,cue:r});e.push(a)}return e},t}(Fr);Ur.prototype.kind_="chapters",Ur.prototype.controlText_="Chapters",yn.registerComponent("ChaptersButton",Ur);var jr=function(e){function t(t,n,i){var r;r=e.call(this,t,n,i)||this;var a=t.textTracks(),o=en(c()(r),r.handleTracksChange);return a.addEventListener("change",o),r.on("dispose",(function(){a.removeEventListener("change",o)})),r}d()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,i=0,r=t.length;i<r;i++){var a=t[i];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fr);jr.prototype.kind_="descriptions",jr.prototype.controlText_="Descriptions",yn.registerComponent("DescriptionsButton",jr);var Gr=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fr);Gr.prototype.kind_="subtitles",Gr.prototype.controlText_="Subtitles",yn.registerComponent("SubtitlesButton",Gr);var zr=function(e){function t(t,n){var i;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(i=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),i.controlText(", opens "+n.kind+" settings dialog"),i}return d()(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Nr);yn.registerComponent("CaptionSettingsMenuItem",zr);var Hr=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zr(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Fr);Hr.prototype.kind_="captions",Hr.prototype.controlText_="Captions",yn.registerComponent("CaptionsButton",Hr);var Vr=function(e){function t(){return e.apply(this,arguments)||this}return d()(t,e),t.prototype.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,Ke({innerHTML:r},n),i)},t}(Nr);yn.registerComponent("SubsCapsMenuItem",Vr);var Wr=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)>-1&&(i.label_="captions"),i.menuButton_.controlText(gn(i.label_)),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zr(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=e.prototype.createItems.call(this,t,Vr)},t}(Fr);Wr.prototype.kinds_=["captions","subtitles"],Wr.prototype.controlText_="Subtitles",yn.registerComponent("SubsCapsButton",Wr);var qr=function(e){function t(t,n){var i,r=n.track,a=t.audioTracks();n.label=r.label||r.language||"Unknown",n.selected=r.enabled,(i=e.call(this,t,n)||this).track=r,i.addClass("vjs-"+r.kind+"-menu-item");var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.handleTracksChange.apply(c()(i),t)};return a.addEventListener("change",o),i.on("dispose",(function(){a.removeEventListener("change",o)})),i}d()(t,e);var n=t.prototype;return n.createEl=function(t,n,i){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),r+="</span>",e.prototype.createEl.call(this,t,Ke({innerHTML:r},n),i)},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var i=0;i<n.length;i++){var r=n[i];r.enabled=r===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(Or);yn.registerComponent("AudioTrackMenuItem",qr);var Yr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var i=t[n];e.push(new qr(this.player_,{track:i,selectable:!0,multiSelectable:!1}))}return e},t}(Lr);Yr.prototype.controlText_="Audio Track",yn.registerComponent("AudioTrackButton",Yr);var Xr=function(e){function t(t,n){var i,r=n.rate,a=parseFloat(r,10);return n.label=r,n.selected=1===a,n.selectable=!0,n.multiSelectable=!1,(i=e.call(this,t,n)||this).label=r,i.rate=a,i.on(t,"ratechange",i.update),i}d()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(Or);Xr.prototype.contentElType="button",yn.registerComponent("PlaybackRateMenuItem",Xr);var Kr=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).updateVisibility(),i.updateLabel(),i.on(t,"loadstart",i.updateVisibility),i.on(t,"ratechange",i.updateLabel),i}d()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=at("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Ir(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new Xr(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),i=n[0],r=0;r<n.length;r++)if(n[r]>t){i=n[r];break}this.player().playbackRate(i)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Pr);Kr.prototype.controlText_="Playback Rate",yn.registerComponent("PlaybackRateMenuButton",Kr);var Qr=function(e){function t(){return e.apply(this,arguments)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(yn);yn.registerComponent("Spacer",Qr);var Zr=function(e){function t(){return e.apply(this,arguments)||this}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="",t},t}(Qr);yn.registerComponent("CustomControlSpacer",Zr);var Jr=function(e){function t(){return e.apply(this,arguments)||this}return d()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(yn);Jr.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in o.a&&Jr.prototype.options_.children.splice(Jr.prototype.options_.children.length-1,0,"pictureInPictureToggle"),yn.registerComponent("ControlBar",Jr);var $r=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).on(t,"error",i.open),i}d()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(ri);$r.prototype.options_=l()({},ri.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),yn.registerComponent("ErrorDisplay",$r);var ea=["#000","Black"],ta=["#00F","Blue"],na=["#0FF","Cyan"],ia=["#0F0","Green"],ra=["#F0F","Magenta"],aa=["#F00","Red"],oa=["#FFF","White"],sa=["#FF0","Yellow"],la=["1","Opaque"],ua=["0.5","Semi-Transparent"],ca=["0","Transparent"],ha={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ea,oa,aa,ia,ta,sa,ra,na]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[la,ua,ca]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[oa,ea,aa,ia,ta,sa,ra,na]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[la,ua]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[ca,ua,la]}};function da(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}ha.windowColor.options=ha.backgroundColor.options;var fa=function(e){function t(t,n){var i;return n.temporary=!1,(i=e.call(this,t,n)||this).updateDisplay=en(c()(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=at("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===n.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",(function(){i.saveSettings(),i.close()})),i.on(i.$(".vjs-default-button"),"click",(function(){i.setDefaults(),i.updateDisplay()})),Xe(ha,(function(e){i.on(i.$(e.selector),"change",i.updateDisplay)})),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}d()(t,e);var n=t.prototype;return n.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},n.createElSelect_=function(e,t,n){var i=this;void 0===t&&(t=""),void 0===n&&(n="label");var r=ha[e],a=r.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(r.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(r.options.map((function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',i.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")},n.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},n.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},n.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},n.createElColors_=function(){return at("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},n.createElFont_=function(){return at("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},n.createElControls_=function(){var e=this.localize("restore all settings to the default values");return at("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},n.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.label=function(){return this.localize("Caption Settings Dialog")},n.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.getValues=function(){var e,t,n,i=this;return t=function(e,t,n){var r,a,o=(r=i.$(t.selector),a=t.parser,da(r.options[r.options.selectedIndex].value,a));return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),Ye(e=ha).reduce((function(n,i){return t(n,e[i],i)}),n)},n.setValues=function(e){var t=this;Xe(ha,(function(n,i){!function(e,t,n){if(t)for(var i=0;i<e.options.length;i++)if(da(e.options[i].value,n)===t){e.selectedIndex=i;break}}(t.$(n.selector),e[i],n.parser)}))},n.setDefaults=function(){var e=this;Xe(ha,(function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n}))},n.restoreSettings=function(){var e;try{e=JSON.parse(r.a.localStorage.getItem("vjs-text-track-settings"))}catch(e){Ve.warn(e)}e&&this.setValues(e)},n.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?r.a.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):r.a.localStorage.removeItem("vjs-text-track-settings")}catch(e){Ve.warn(e)}}},n.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},t}(ri);yn.registerComponent("TextTrackSettings",fa);var pa=function(e){function t(t,n){var i,a=n.ResizeObserver||r.a.ResizeObserver;null===n.ResizeObserver&&(a=!1);var o=vn({createEl:!a,reportTouchActivity:!1},n);return(i=e.call(this,t,o)||this).ResizeObserver=n.ResizeObserver||r.a.ResizeObserver,i.loadListener_=null,i.resizeObserver_=null,i.debouncedHandler_=function(e,t,n,i){var a;void 0===i&&(i=r.a);var o=function(){var r=this,o=arguments,s=function(){a=null,s=null,n||e.apply(r,o)};!a&&n&&e.apply(r,o),i.clearTimeout(a),a=i.setTimeout(s,t)};return o.cancel=function(){i.clearTimeout(a),a=null},o}((function(){i.resizeHandler()}),100,!1,c()(i)),a?(i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_),i.resizeObserver_.observe(t.el())):(i.loadListener_=function(){if(i.el_&&i.el_.contentWindow){var e=i.debouncedHandler_,t=i.unloadListener_=function(){Xt(this,"resize",e),Xt(this,"unload",t),t=null};Yt(i.el_.contentWindow,"unload",t),Yt(i.el_.contentWindow,"resize",e)}},i.one("load",i.loadListener_)),i}d()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},n.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},n.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,e.prototype.dispose.call(this)},t}(yn);yn.registerComponent("ResizeManager",pa);var ma={trackingThreshold:30,liveTolerance:15},ga=function(e){function t(t,n){var i,r=vn(ma,n,{createEl:!1});return(i=e.call(this,t,r)||this).reset_(),i.on(i.player_,"durationchange",i.handleDurationchange),Ln&&"hidden"in o.a&&"visibilityState"in o.a&&i.on(o.a,"visibilitychange",i.handleVisibilityChange),i}d()(t,e);var n=t.prototype;return n.handleVisibilityChange=function(){this.player_.duration()===1/0&&(o.a.hidden?this.stopTracking():this.startTracking())},n.trackLive_=function(){var e=this.player_.seekable();if(e&&e.length){var t=Number(r.a.performance.now().toFixed(4)),n=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+n;var i=this.liveCurrentTime(),a=this.player_.currentTime(),o=this.player_.paused()||this.seekedBehindLive_||Math.abs(i-a)>this.options_.liveTolerance;this.timeupdateSeen_&&i!==1/0||(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}},n.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},n.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},n.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},n.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&e>2,this.skipNextSeeked_=!1,this.trackLive_()},n.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},n.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},n.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},n.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},n.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},n.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},n.isLive=function(){return this.isTracking()},n.atLiveEdge=function(){return!this.behindLiveEdge()},n.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},n.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},n.behindLiveEdge=function(){return this.behindLiveEdge_},n.isTracking=function(){return"number"==typeof this.trackingInterval_},n.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},n.dispose=function(){this.off(o.a,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),e.prototype.dispose.call(this)},t}(yn);yn.registerComponent("LiveTracker",ga);var va,ya=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),i=[],r="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===i.indexOf(o)&&i.push(o)}return!!i.length&&(1===i.length&&(r=i[0]),e.triggerSourceset(r),!0)},_a=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=o.a.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var n=o.a.createDocumentFragment();t.childNodes.length;)n.appendChild(t.childNodes[0]);return this.innerText="",r.a.Element.prototype.appendChild.call(this,n),this.innerHTML}}),ba=function(e,t){for(var n={},i=0;i<e.length&&!((n=Object.getOwnPropertyDescriptor(e[i],t))&&n.set&&n.get);i++);return n.enumerable=!0,n.configurable=!0,n},Ea=function(e){var t=e.el();if(!t.resetSourceWatch_){var n={},i=function(e){return ba([e.el(),r.a.HTMLMediaElement.prototype,r.a.Element.prototype,_a],"innerHTML")}(e),a=function(n){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=n.apply(t,r);return ya(e),o}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){t[e]&&(n[e]=t[e],t[e]=a(n[e]))})),Object.defineProperty(t,"innerHTML",vn(i,{set:a(i.set)})),t.resetSourceWatch_=function(){t.resetSourceWatch_=null,Object.keys(n).forEach((function(e){t[e]=n[e]})),Object.defineProperty(t,"innerHTML",i)},e.one("sourceset",t.resetSourceWatch_)}},Ta=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?bi(r.a.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return r.a.Element.prototype.setAttribute.call(this,"src",e),e}}),wa=function(e){if(e.featuresSourceset){var t=e.el();if(!t.resetSourceset_){var n=function(e){return ba([e.el(),r.a.HTMLMediaElement.prototype,Ta],"src")}(e),i=t.setAttribute,a=t.load;Object.defineProperty(t,"src",vn(n,{set:function(i){var r=n.set.call(t,i);return e.triggerSourceset(t.src),r}})),t.setAttribute=function(n,r){var a=i.call(t,n,r);return/src/i.test(n)&&e.triggerSourceset(t.src),a},t.load=function(){var n=a.call(t);return ya(e)||(e.triggerSourceset(""),Ea(e)),n},t.currentSrc?e.triggerSourceset(t.currentSrc):ya(e)||Ea(e),t.resetSourceset_=function(){t.resetSourceset_=null,t.load=a,t.setAttribute=i,Object.defineProperty(t,"src",n),t.resetSourceWatch_&&t.resetSourceWatch_()}}}},xa=function(e,t,n,i){void 0===i&&(i=!0);var r=function(n){return Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0})},a={configurable:!0,enumerable:!0,get:function(){var e=n();return r(e),e}};return i&&(a.set=r),Object.defineProperty(e,t,a)},Aa=function(e){function t(t,n){var i;i=e.call(this,t,n)||this;var r=t.source,a=!1;if(r&&(i.el_.currentSrc!==r.src||t.tag&&3===t.tag.initNetworkState_)?i.setSource(r):i.handleLateInit_(i.el_),t.enableSourceset&&i.setupSourcesetHandling_(),i.el_.hasChildNodes()){for(var o=i.el_.childNodes,s=o.length,l=[];s--;){var u=o[s];"track"===u.nodeName.toLowerCase()&&(i.featuresNativeTextTracks?(i.remoteTextTrackEls().addTrackElement_(u),i.remoteTextTracks().addTrack(u.track),i.textTracks().addTrack(u.track),a||i.el_.hasAttribute("crossorigin")||!Ti(u.src)||(a=!0)):l.push(u))}for(var c=0;c<l.length;c++)i.el_.removeChild(l[c])}return i.proxyNativeTracks_(),i.featuresNativeTextTracks&&a&&Ve.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),i.restoreMetadataTracksInIOSNativePlayer_(),(Nn||Fn||Mn)&&!0===t.nativeControlsForTouch&&i.setControls(!0),i.proxyWebkitFullscreen_(),i.triggerReady(),i}d()(t,e);var n=t.prototype;return n.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),t.disposeMediaElement(this.el_),this.options_=null,e.prototype.dispose.call(this)},n.setupSourcesetHandling_=function(){wa(this)},n.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var i=t[n];"metadata"===i.kind&&e.push({track:i,storedMode:i.mode})}};n(),t.addEventListener("change",n),this.on("dispose",(function(){return t.removeEventListener("change",n)}));var i=function n(){for(var i=0;i<e.length;i++){var r=e[i];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",(function(){t.removeEventListener("change",n),t.removeEventListener("change",i),t.addEventListener("change",i)})),this.on("webkitendfullscreen",(function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",i)}))},n.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var i=e.toLowerCase();this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach((function(e){n.el()[i+"Tracks"].removeEventListener(e,n[i+"TracksListeners_"][e])})),this["featuresNative"+e+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i)}},n.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},n.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},n.proxyNativeTracksForType_=function(e){var t=this,n=Ii[e],i=this.el()[n.getterName],r=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&i&&i.addEventListener){var a={change:function(n){var i={type:"change",target:r,currentTarget:r,srcElement:r};r.trigger(i),"text"===e&&t[Pi.remoteText.getterName]().trigger(i)},addtrack:function(e){r.addTrack(e.track)},removetrack:function(e){r.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<r.length;t++){for(var n=!1,a=0;a<i.length;a++)if(i[a]===r[t]){n=!0;break}n||e.push(r[t])}for(;e.length;)r.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach((function(e){var n=a[e];i.addEventListener(e,n),t.on("dispose",(function(t){return i.removeEventListener(e,n)}))})),this.on("loadstart",o),this.on("dispose",(function(e){return t.off("loadstart",o)}))}},n.proxyNativeTracks_=function(){var e=this;Ii.names.forEach((function(t){e.proxyNativeTracksForType_(t)}))},n.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),t.disposeMediaElement(e),e=n}else{e=o.a.createElement("video");var i=vn({},this.options_.tag&&ft(this.options_.tag));Nn&&!0===this.options_.nativeControlsForTouch||delete i.controls,dt(e,Ke(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&mt(e,"preload",this.options_.preload);for(var r=["loop","muted","playsinline","autoplay"],a=0;a<r.length;a++){var s=r[a],l=this.options_[s];void 0!==l&&(l?mt(e,s,s):gt(e,s),e[s]=l)}return e},n.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var i=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready((function(){this.off("loadstart",n),this.off("loadedmetadata",i),t||this.trigger("loadstart")}))}var r=["loadstart"];r.push("loadedmetadata"),e.readyState>=2&&r.push("loadeddata"),e.readyState>=3&&r.push("canplay"),e.readyState>=4&&r.push("canplaythrough"),this.ready((function(){r.forEach((function(e){this.trigger(e)}),this)}))}},n.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){Ve(e,"Video is not ready. (Video.js)")}},n.duration=function(){var e=this;if(this.el_.duration===1/0&&An&&In&&0===this.el_.currentTime){return this.on("timeupdate",(function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))})),NaN}return this.el_.duration||NaN},n.width=function(){return this.el_.offsetWidth},n.height=function(){return this.el_.offsetHeight},n.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",(function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)}))}},n.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=r.a.navigator&&r.a.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},n.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)ei(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}),0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},n.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},n.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},n.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},n.reset=function(){t.resetMediaElement(this.el_)},n.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},n.setControls=function(e){this.el_.controls=!!e},n.addTextTrack=function(t,n,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,n,i):e.prototype.addTextTrack.call(this,t,n,i)},n.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var n=o.a.createElement("track");return t.kind&&(n.kind=t.kind),t.label&&(n.label=t.label),(t.language||t.srclang)&&(n.srclang=t.language||t.srclang),t.default&&(n.default=t.default),t.id&&(n.id=t.id),t.src&&(n.src=t.src),n},n.addRemoteTextTrack=function(t,n){var i=e.prototype.addRemoteTextTrack.call(this,t,n);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},n.removeRemoteTextTrack=function(t){if(e.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var n=this.$$("track"),i=n.length;i--;)t!==n[i]&&t!==n[i].track||this.el().removeChild(n[i])},n.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),r.a.performance&&"function"==typeof r.a.performance.now?e.creationTime=r.a.performance.now():r.a.performance&&r.a.performance.timing&&"number"==typeof r.a.performance.timing.navigationStart&&(e.creationTime=r.a.Date.now()-r.a.performance.timing.navigationStart),e},t}(Di);xa(Aa,"TEST_VID",(function(){if(tt()){var e=o.a.createElement("video"),t=o.a.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}})),Aa.isSupported=function(){try{Aa.TEST_VID.volume=.5}catch(e){return!1}return!(!Aa.TEST_VID||!Aa.TEST_VID.canPlayType)},Aa.canPlayType=function(e){return Aa.TEST_VID.canPlayType(e)},Aa.canPlaySource=function(e,t){return Aa.canPlayType(e.type)},Aa.canControlVolume=function(){try{var e=Aa.TEST_VID.volume;return Aa.TEST_VID.volume=e/2+.1,e!==Aa.TEST_VID.volume}catch(e){return!1}},Aa.canMuteVolume=function(){try{var e=Aa.TEST_VID.muted;return Aa.TEST_VID.muted=!e,Aa.TEST_VID.muted?mt(Aa.TEST_VID,"muted","muted"):gt(Aa.TEST_VID,"muted"),e!==Aa.TEST_VID.muted}catch(e){return!1}},Aa.canControlPlaybackRate=function(){if(An&&In&&Pn<58)return!1;try{var e=Aa.TEST_VID.playbackRate;return Aa.TEST_VID.playbackRate=e/2+.1,e!==Aa.TEST_VID.playbackRate}catch(e){return!1}},Aa.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(o.a.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Aa.supportsNativeTextTracks=function(){return Un||Bn&&In},Aa.supportsNativeVideoTracks=function(){return!(!Aa.TEST_VID||!Aa.TEST_VID.videoTracks)},Aa.supportsNativeAudioTracks=function(){return!(!Aa.TEST_VID||!Aa.TEST_VID.audioTracks)},Aa.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[0],n=e[1];xa(Aa.prototype,t,(function(){return Aa[n]()}),!0)})),Aa.prototype.movingMediaElementInDOM=!Bn,Aa.prototype.featuresFullscreenResize=!0,Aa.prototype.featuresProgressEvents=!0,Aa.prototype.featuresTimeupdateEvents=!0,Aa.patchCanPlayType=function(){Sn>=4&&!Cn&&!In&&(va=Aa.TEST_VID&&Aa.TEST_VID.constructor.prototype.canPlayType,Aa.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e)?"maybe":va.call(this,e)})},Aa.unpatchCanPlayType=function(){var e=Aa.TEST_VID.constructor.prototype.canPlayType;return va&&(Aa.TEST_VID.constructor.prototype.canPlayType=va),e},Aa.patchCanPlayType(),Aa.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Aa.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){Aa.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){Aa.prototype["set"+gn(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){Aa.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","crossOrigin"].forEach((function(e){Aa.prototype["set"+gn(e)]=function(t){this.el_[e]=t}})),["pause","load","play"].forEach((function(e){Aa.prototype[e]=function(){return this.el_[e]()}})),Di.withSourceHandlers(Aa),Aa.nativeSourceHandler={},Aa.nativeSourceHandler.canPlayType=function(e){try{return Aa.TEST_VID.canPlayType(e)}catch(e){return""}},Aa.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Aa.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Ei(e.src);return Aa.nativeSourceHandler.canPlayType("video/"+n)}return""},Aa.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Aa.nativeSourceHandler.dispose=function(){},Aa.registerSourceHandler(Aa.nativeSourceHandler),Di.registerTech("Html5",Aa);var Sa=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ma={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ca=["tiny","xsmall","small","medium","large","xlarge","huge"],Ra={};Ca.forEach((function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Ra[e]="vjs-layout-"+t}));var Ia={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Pa=function(e){function t(n,i,r){var a;if(n.id=n.id||i.id||"vjs_video_"+jt(),(i=Ke(t.getTagSettings(n),i)).initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language)if("function"==typeof n.closest){var s=n.closest("[lang]");s&&s.getAttribute&&(i.language=s.getAttribute("lang"))}else for(var l=n;l&&1===l.nodeType;){if(ft(l).hasOwnProperty("lang")){i.language=l.getAttribute("lang");break}l=l.parentNode}if((a=e.call(this,null,i,r)||this).boundDocumentFullscreenChange_=en(c()(a),a.documentFullscreenChange_),a.boundFullWindowOnEscKey_=en(c()(a),a.fullWindowOnEscKey),a.isFullscreen_=!1,a.log=We(a.id_),a.fsApi_=qn,a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=n,a.tagAttributes=n&&ft(n),a.language(a.options_.language),i.languages){var u={};Object.getOwnPropertyNames(i.languages).forEach((function(e){u[e.toLowerCase()]=i.languages[e]})),a.languages_=u}else a.languages_=t.prototype.options_.languages;a.resetCache_(),a.poster_=i.poster||"",a.controls_=!!i.controls,n.controls=!1,n.removeAttribute("controls"),a.changingSrc_=!1,a.playCallbacks_=[],a.playTerminatedQueue_=[],n.hasAttribute("autoplay")?a.autoplay(!0):a.autoplay(a.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach((function(e){if("function"!=typeof a[e])throw new Error('plugin "'+e+'" does not exist')})),a.scrubbing_=!1,a.el_=a.createEl(),dn(c()(a),{eventBusKey:"el_"}),a.fsApi_.requestFullscreen&&(Yt(o.a,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_),a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)),a.fluid_&&a.on("playerreset",a.updateStyleEl_);var h=vn(a.options_);i.plugins&&Object.keys(i.plugins).forEach((function(e){a[e](i.plugins[e])})),a.options_.playerOptions=h,a.middleware_=[],a.initChildren(),a.isAudio("audio"===n.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),Nn&&a.addClass("vjs-touch-enabled"),Bn||a.addClass("vjs-workinghover"),t.players[a.id_]=c()(a);var d="7.8.4".split(".")[0];return a.addClass("vjs-v"+d),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("stageclick",a.handleStageClick_),a.on("keydown",a.handleKeyDown),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a}d()(t,e);var n=t.prototype;return n.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),Xt(o.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Xt(o.a,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Ni[this.id()]=null,Li.names.forEach((function(e){var t=Li[e],i=n[t.getterName]();i&&i.off&&i.off()})),e.prototype.dispose.call(this)},n.createEl=function(){var t,n=this.tag,i=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),a="video-js"===this.tag.tagName.toLowerCase();i?t=this.el_=n.parentNode:a||(t=this.el_=e.prototype.createEl.call(this,"div"));var s=ft(n);if(a){for(t=this.el_=n,n=this.tag=o.a.createElement("video");t.children.length;)n.appendChild(t.firstChild);lt(t,"video-js")||ut(t,"video-js"),t.appendChild(n),i=this.playerElIngest_=t,Object.keys(t).forEach((function(e){try{n[e]=t[e]}catch(e){}}))}if(n.setAttribute("tabindex","-1"),s.tabindex="-1",(Ln||In&&On)&&(n.setAttribute("role","application"),s.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach((function(e){a&&"class"===e||t.setAttribute(e,s[e]),a&&n.setAttribute(e,s[e])})),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=t.player=this,this.addClass("vjs-paused"),!0!==r.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Ft("vjs-styles-dimensions");var l=Rt(".vjs-styles-defaults"),u=Rt("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var c=n.getElementsByTagName("a"),h=0;h<c.length;h++){var d=c.item(h);ut(d,"vjs-hidden"),d.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!i&&n.parentNode.insertBefore(t,n),st(n,t),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=t,t},n.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):Ve.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},n.width=function(e){return this.dimension("width",e)},n.height=function(e){return this.dimension("height",e)},n.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t||"auto"===t)return this[n]=void 0,void this.updateStyleEl_();var i=parseFloat(t);isNaN(i)?Ve.error('Improper value "'+t+'" supplied for for '+e):(this[n]=i,this.updateStyleEl_())},n.fluid=function(e){if(void 0===e)return!!this.fluid_;var t,n;this.fluid_=!!e,rn(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),rn(t=function(){this.on("playerreset",this.updateStyleEl_)})?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},n.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},n.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},n.updateStyleEl_=function(){if(!0!==r.a.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,n,i=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=i[1]/i[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Bt(this.styleEl_,"\n      ."+n+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var o="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,l=this.tech_&&this.tech_.el();l&&(o>=0&&(l.width=o),s>=0&&(l.height=s))}},n.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var i=gn(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==i&&this.tag&&(Di.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Li.names.forEach((function(e){var t=Li[e];a[t.getterName]=n[t.privateName]})),Ke(a,this.options_[i]),Ke(a,this.options_[r]),Ke(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var o=Di.getTech(e);if(!o)throw new Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(en(this,this.handleTechReady_),!0),ii(this.textTracksJson_||[],this.tech_),Sa.forEach((function(e){n.on(n.tech_,e,n["handleTech"+gn(e)+"_"])})),Object.keys(Ma).forEach((function(e){n.on(n.tech_,e,(function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Ma[e]+"_"].bind(n),event:t}):n["handleTech"+Ma[e]+"_"](t)}))})),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||st(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},n.unloadTech_=function(){var e=this;Li.names.forEach((function(t){var n=Li[t];e[n.privateName]=e[n.getterName]()})),this.textTracksJson_=ni(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},n.tech=function(e){return void 0===e&&Ve.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},n.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},n.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},n.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},n.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},n.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var n,i=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var i=t.play();if($n(i))return i.catch(n)};if("any"===e&&!0!==this.muted()?$n(n=this.play())&&(n=n.catch(i)):n="muted"===e&&!0!==this.muted()?i():this.play(),$n(n))return n.then((function(){t.trigger({type:"autoplay-success",autoplay:e})})).catch((function(n){t.trigger({type:"autoplay-failure",autoplay:e})}))}},n.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter((function(e){return e.src===t}));if(n.length)return n[0].type;for(var i=e.$$("source"),r=0;r<i.length;r++){var a=i[r];if(a.type&&a.src&&a.src===t)return a.type}return Vi(t)}(this,t)),this.cache_.source=vn({},e,{src:t,type:n});for(var i=this.cache_.sources.filter((function(e){return e.src&&e.src===t})),r=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=ft(a[s]);r.push(l),l.src&&l.src===t&&o.push(l.src)}o.length&&!i.length?this.cache_.sources=r:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},n.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},i=this.currentSource().src,r=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==i)&&(n=function(){}),n(r),e.src||this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}}))}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},n.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},n.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},n.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},n.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",(function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))}))},n.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},n.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},n.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},n.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},n.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},n.handleTechFirstPlay_=function(){this.options_.starttime&&(Ve.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},n.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},n.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},n.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},n.handleTechClick_=function(e){Mt(e)&&this.controls_&&(this.paused()?ei(this.play()):this.pause())},n.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(t){return t.contains(e.target)}))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},n.handleTechTap_=function(){this.userActive(!this.userActive())},n.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},n.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},n.handleTechTouchEnd_=function(e){e.preventDefault()},n.handleStageClick_=function(){this.reportUserActivity()},n.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},n.documentFullscreenChange_=function(e){var t=e.target.player;if(!t||t===this){var n=this.el(),i=o.a[this.fsApi_.fullscreenElement]===n;!i&&n.matches?i=n.matches(":"+this.fsApi_.fullscreen):!i&&n.msMatchesSelector&&(i=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(i)}},n.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},n.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},n.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},n.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},n.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},n.handleTechError_=function(){var e=this.tech_.error();this.error(e)},n.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},n.getCache=function(){return this.cache_},n.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},n.techCall_=function(e,t){this.ready((function(){if(e in ji)return function(e,t,n,i){return t[n](e.reduce(zi(n),i))}(this.middleware_,this.tech_,e,t);if(e in Gi)return Bi(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw Ve(e),e}}),!0)},n.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in Ui)return function(e,t,n){return e.reduceRight(zi(n),t[n]())}(this.middleware_,this.tech_,e);if(e in Gi)return Bi(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw Ve("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw Ve("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw Ve(t),t}}},n.play=function(){var e=this,t=this.options_.Promise||r.a.Promise;return t?new t((function(t){e.play_(t)})):this.play_()},n.play_=function(e){var t=this;void 0===e&&(e=ei),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!Un&&!Bn||this.load());var i=this.techGet_("play");null===i?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)},n.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))},n.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach((function(t){t(e)}))},n.pause=function(){this.techCall_("pause")},n.paused=function(){return!1!==this.techGet_("paused")},n.played=function(){return this.techGet_("played")||Hn(0,0)},n.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},n.currentTime=function(e){return void 0!==e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},n.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},n.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},n.remainingTime=function(){return this.duration()-this.currentTime()},n.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},n.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=Hn(0,0)),e},n.bufferedPercent=function(){return Vn(this.buffered(),this.duration())},n.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},n.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},n.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},n.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},n.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},n.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},n.isFullscreen=function(e){if(void 0!==e){var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},n.requestFullscreen=function(e){var t=this.options_.Promise||r.a.Promise;if(t){var n=this;return new t((function(t,i){function r(){n.off("fullscreenerror",o),n.off("fullscreenchange",a)}function a(){r(),t()}function o(e,t){r(),i(t)}n.one("fullscreenchange",a),n.one("fullscreenerror",o);var s=n.requestFullscreenHelper_(e);if(s)return s.then(r,r),s}))}return this.requestFullscreenHelper_()},n.requestFullscreenHelper_=function(e){var t,n=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var i=this.el_[this.fsApi_.requestFullscreen](t);return i&&i.then((function(){return n.isFullscreen(!0)}),(function(){return n.isFullscreen(!1)})),i}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},n.exitFullscreen=function(){var e=this.options_.Promise||r.a.Promise;if(e){var t=this;return new e((function(e,n){function i(){t.off("fullscreenerror",a),t.off("fullscreenchange",r)}function r(){i(),e()}function a(e,t){i(),n(t)}t.one("fullscreenchange",r),t.one("fullscreenerror",a);var o=t.exitFullscreenHelper_();if(o)return o.then(i,i),o}))}return this.exitFullscreenHelper_()},n.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=o.a[this.fsApi_.exitFullscreen]();return t&&t.then((function(){return e.isFullscreen(!1)})),t}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},n.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=o.a.documentElement.style.overflow,Yt(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow="hidden",ut(o.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},n.fullWindowOnEscKey=function(e){g.a.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},n.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,Xt(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow=this.docOrigOverflow,ct(o.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},n.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},n.requestPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return this.techGet_("requestPictureInPicture")},n.exitPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return o.a.exitPictureInPicture()},n.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){(function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)})(this.el_.ownerDocument.activeElement)||("function"==typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},n.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},n=t.fullscreenKey,i=void 0===n?function(e){return g.a.isEventKey(e,"f")}:n,r=t.muteKey,a=void 0===r?function(e){return g.a.isEventKey(e,"m")}:r,s=t.playPauseKey,l=void 0===s?function(e){return g.a.isEventKey(e,"k")||g.a.isEventKey(e,"Space")}:s;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();var u=yn.getComponent("FullscreenToggle");!1!==o.a[this.fsApi_.fullscreenEnabled]&&u.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation(),yn.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(l.call(this,e)){e.preventDefault(),e.stopPropagation(),yn.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},n.canPlayType=function(e){for(var t,n=0,i=this.options_.techOrder;n<i.length;n++){var r=i[n],a=Di.getTech(r);if(a||(a=yn.getComponent(r)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else Ve.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},n.selectSource=function(e){var t,n=this,i=this.options_.techOrder.map((function(e){return[e,Di.getTech(e)]})).filter((function(e){var t=e[0],n=e[1];return n?n.isSupported():(Ve.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)})),r=function(e,t,n){var i;return e.some((function(e){return t.some((function(t){if(i=n(e,t))return!0}))})),i},a=function(e,t){var i=e[0];if(e[1].canPlaySource(t,n.options_[i.toLowerCase()]))return{source:t,tech:i}};return(this.options_.sourceOrder?r(e,i,(t=a,function(e,n){return t(n,e)})):r(i,e,a))||!1},n.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var n=function e(t){if(Array.isArray(t)){var n=[];t.forEach((function(t){t=e(t),Array.isArray(t)?n=n.concat(t):Qe(t)&&n.push(t)})),t=n}else t="string"==typeof t&&t.trim()?[Wi({src:t})]:Qe(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[Wi(t)]:[];return t}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),Fi(this,n[0],(function(e,i){var r,a;if(t.middleware_=i,t.cache_.sources=n,t.updateSourceCaches_(e),t.src_(e))return n.length>1?t.src(n.slice(1)):(t.changingSrc_=!1,t.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0),void t.triggerReady());r=i,a=t.tech_,r.forEach((function(e){return e.setTech&&e.setTech(a)}))}))):this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0)},n.src_=function(e){var t,n,i=this,r=this.selectSource([e]);return!r||(t=r.tech,n=this.techName_,gn(t)!==gn(n)?(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready((function(){i.changingSrc_=!1})),!1):(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0),!1))},n.load=function(){this.techCall_("load")},n.reset=function(){var e=this,t=this.options_.Promise||r.a.Promise;this.paused()||!t?this.doReset_():ei(this.play().then((function(){return e.doReset_()})))},n.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),rn(this)&&this.trigger("playerreset")},n.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},n.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},n.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},n.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},n.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},n.currentSource=function(){return this.cache_.source||{}},n.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},n.currentType=function(){return this.currentSource()&&this.currentSource().type||""},n.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},n.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},n.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},n.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},n.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},n.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},n.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},n.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},n.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",(function(){this.off(["click","touchstart"],t)}))}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Zn(e),this.addClass("vjs-error"),Ve.error("(CODE:"+this.error_.code+" "+Zn.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},n.reportUserActivity=function(e){this.userActivity_=!0},n.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},n.listenForUserActivity_=function(){var e,t,n,i=en(this,this.reportUserActivity),r=function(t){i(),this.clearInterval(e)};this.on("mousedown",(function(){i(),this.clearInterval(e),e=this.setInterval(i,250)})),this.on("mousemove",(function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,i())})),this.on("mouseup",r),this.on("mouseleave",r);var a,o=this.getChild("controlBar");!o||Bn||An||(o.on("mouseenter",(function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0})),o.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",i),this.on("keyup",i),this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}}),250)},n.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},n.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},n.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},n.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},n.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},n.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},n.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},n.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},n.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},n.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},n.languages=function(){return vn(t.prototype.options_.languages,this.languages_)},n.toJSON=function(){var e=vn(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var i=t[n];(i=vn(i)).player=void 0,e.tracks[n]=i}return e},n.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var i=new ri(this,t);return this.addChild(i),i.on("dispose",(function(){n.removeChild(i)})),i.open(),i},n.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Ca.length;n++){var i=Ca[n];if(t<=this.breakpoints_[i]){if(e===i)return;e&&this.removeClass(Ra[e]),this.addClass(Ra[i]),this.breakpoint_=i;break}}},n.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},n.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=Ke({},Ia,e),this.updateCurrentBreakpoint_()),Ke(this.breakpoints_)},n.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},n.currentBreakpoint=function(){return this.breakpoint_},n.currentBreakpointClass=function(){return Ra[this.breakpoint_]||""},n.loadMedia=function(e,t){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=vn(e);var i=this.cache_.media,r=i.artwork,a=i.poster,o=i.src,s=i.textTracks;!r&&a&&(this.cache_.media.artwork=[{src:a,type:Vi(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach((function(e){return n.addRemoteTextTrack(e,!1)})),this.ready(t)}},n.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}))};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:Vi(t.poster)}]),t}return vn(this.cache_.media)},t.getTagSettings=function(e){var t={sources:[],tracks:[]},n=ft(e),i=n["data-setup"];if(lt(e,"vjs-fill")&&(n.fill=!0),lt(e,"vjs-fluid")&&(n.fluid=!0),null!==i){var r=p()(i||"{}"),a=r[0],o=r[1];a&&Ve.error(a),Ke(n,o)}if(Ke(t,n),e.hasChildNodes())for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var c=s[l],h=c.nodeName.toLowerCase();"source"===h?t.sources.push(ft(c)):"track"===h&&t.tracks.push(ft(c))}return t},n.flexNotSupported_=function(){var e=o.a.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},t}(yn);Li.names.forEach((function(e){var t=Li[e];Pa.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}})),Pa.prototype.crossorigin=Pa.prototype.crossOrigin,Pa.players={};var La=r.a.navigator;Pa.prototype.options_={techOrder:Di.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:La&&(La.languages&&La.languages[0]||La.userLanguage||La.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach((function(e){Pa.prototype[e]=function(){return this.techGet_(e)}})),Sa.forEach((function(e){Pa.prototype["handleTech"+gn(e)+"_"]=function(){return this.trigger(e)}})),yn.registerComponent("Player",Pa);var Da={},Oa=function(e){return Da.hasOwnProperty(e)},Na=function(e){return Oa(e)?Da[e]:void 0},ka=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Fa=function(e,t,n){var i=(n?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Ba=function(e,t){return t.prototype.name=e,function(){Fa(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=T()(t,[this].concat(i));return this[e]=function(){return a},Fa(this,a.getEventHash()),a}},Ua=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,dn(this),delete this.trigger,pn(this,this.constructor.defaultState),ka(t,this.name),this.dispose=en(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),Kt(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Ba(e,Da[e])},e.isBasic=function(t){var n="string"==typeof t?Na(t):t;return"function"==typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Oa(t))Ve.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Pa.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Da[t]=n,"plugin"!==t&&(e.isBasic(n)?Pa.prototype[t]=function(e,t){var n=function(){Fa(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return ka(this,e),Fa(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}(t,n):Pa.prototype[t]=Ba(t,n)),n},e.deregisterPlugin=function(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");Oa(e)&&(delete Da[e],delete Pa.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Da)),e.forEach((function(e){var n=Na(e);n&&((t=t||{})[e]=n)})),t},e.getPluginVersion=function(e){var t=Na(e);return t&&t.VERSION||""},e}();Ua.getPlugin=Na,Ua.BASE_PLUGIN_NAME="plugin",Ua.registerPlugin("plugin",Ua),Pa.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},Pa.prototype.hasPlugin=function(e){return!!Oa(e)};var ja=function(e){return 0===e.indexOf("#")?e.slice(1):e};function Ga(e,t,n){var i=Ga.getPlayer(e);if(i)return t&&Ve.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&i.ready(n),i;var r="string"==typeof e?Rt("#"+ja(e)):e;if(!nt(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");r.ownerDocument.defaultView&&r.ownerDocument.body.contains(r)||Ve.warn("The element supplied is not included in the DOM"),t=t||{},Ga.hooks("beforesetup").forEach((function(e){var n=e(r,vn(t));Qe(n)&&!Array.isArray(n)?t=vn(t,n):Ve.error("please return an object in beforesetup hooks")}));var a=yn.getComponent("Player");return i=new a(r,t,n),Ga.hooks("setup").forEach((function(e){return e(i)})),i}if(Ga.hooks_={},Ga.hooks=function(e,t){return Ga.hooks_[e]=Ga.hooks_[e]||[],t&&(Ga.hooks_[e]=Ga.hooks_[e].concat(t)),Ga.hooks_[e]},Ga.hook=function(e,t){Ga.hooks(e,t)},Ga.hookOnce=function(e,t){Ga.hooks(e,[].concat(t).map((function(t){return function n(){return Ga.removeHook(e,n),t.apply(void 0,arguments)}})))},Ga.removeHook=function(e,t){var n=Ga.hooks(e).indexOf(t);return!(n<=-1)&&(Ga.hooks_[e]=Ga.hooks_[e].slice(),Ga.hooks_[e].splice(n,1),!0)},!0!==r.a.VIDEOJS_NO_DYNAMIC_STYLE&&tt()){var za=Rt(".vjs-styles-defaults");if(!za){za=Ft("vjs-styles-defaults");var Ha=Rt("head");Ha&&Ha.insertBefore(za,Ha.firstChild),Bt(za,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}Ot(1,Ga),Ga.VERSION="7.8.4",Ga.options=Pa.prototype.options_,Ga.getPlayers=function(){return Pa.players},Ga.getPlayer=function(e){var t,n=Pa.players;if("string"==typeof e){var i=ja(e),r=n[i];if(r)return r;t=Rt("#"+i)}else t=e;if(nt(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},Ga.getAllPlayers=function(){return Object.keys(Pa.players).map((function(e){return Pa.players[e]})).filter(Boolean)},Ga.players=Pa.players,Ga.getComponent=yn.getComponent,Ga.registerComponent=function(e,t){Di.isTech(t)&&Ve.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),yn.registerComponent.call(yn,e,t)},Ga.getTech=Di.getTech,Ga.registerTech=Di.registerTech,Ga.use=function(e,t){Oi[e]=Oi[e]||[],Oi[e].push(t)},Object.defineProperty(Ga,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Ga.middleware,"TERMINATOR",{value:ki,writeable:!1,enumerable:!0}),Ga.browser=jn,Ga.TOUCH_ENABLED=Nn,Ga.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},i={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),i=t):"function"==typeof t&&(n=t),x()(n,e),e&&(n.super_=e),i)i.hasOwnProperty(r)&&(n.prototype[r]=i[r]);return n},Ga.mergeOptions=vn,Ga.bind=en,Ga.registerPlugin=Ua.registerPlugin,Ga.deregisterPlugin=Ua.deregisterPlugin,Ga.plugin=function(e,t){return Ve.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Ua.registerPlugin(e,t)},Ga.getPlugins=Ua.getPlugins,Ga.getPlugin=Ua.getPlugin,Ga.getPluginVersion=Ua.getPluginVersion,Ga.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),Ga.options.languages=vn(Ga.options.languages,((n={})[e]=t,n)),Ga.options.languages[e]},Ga.log=Ve,Ga.createLogger=We,Ga.createTimeRange=Ga.createTimeRanges=Hn,Ga.formatTime=or,Ga.setFormatTime=function(e){ar=e},Ga.resetFormatTime=function(){ar=rr},Ga.parseUrl=_i,Ga.isCrossOrigin=Ti,Ga.EventTarget=nn,Ga.on=Yt,Ga.one=Qt,Ga.off=Xt,Ga.trigger=Kt,Ga.xhr=y.a,Ga.TextTrack=Si,Ga.AudioTrack=Mi,Ga.VideoTrack=Ci,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){Ga[e]=function(){return Ve.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Pt[e].apply(null,arguments)}})),Ga.computedStyle=Je,Ga.dom=Pt,Ga.url=wi,Ga.defineLazyProperty=xa;
/**
 * @videojs/http-streaming
 * @version 1.13.2
 * @copyright 2020 Brightcove, Inc
 * @license Apache-2.0
 */
var Va=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=S.a.buildAbsoluteURL(r.a.location.href,e)),S.a.buildAbsoluteURL(e,t))},Wa=function(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t},qa=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ya=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Xa=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Ka=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Qa=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Za=Ga.mergeOptions,Ja=Ga.EventTarget,$a=Ga.log,eo=function(e,t){["AUDIO","SUBTITLES"].forEach((function(n){for(var i in e.mediaGroups[n])for(var r in e.mediaGroups[n][i]){var a=e.mediaGroups[n][i][r];t(a,n,i,r)}}))},to=function(e,t){var n=Za(e,{}),i=n.playlists[t.id];if(!i)return null;if(i.segments&&t.segments&&i.segments.length===t.segments.length&&i.endList===t.endList&&i.mediaSequence===t.mediaSequence)return null;var r=Za(i,t);i.segments&&(r.segments=function(e,t,n){var i=t.slice();n=n||0;for(var r=Math.min(e.length,t.length+n),a=n;a<r;a++)i[a-n]=Za(e[a],i[a-n]);return i}(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),r.segments.forEach((function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=Va(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Va(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Va(t,e.map.uri))}(e,r.resolvedUri)}));for(var a=0;a<n.playlists.length;a++)n.playlists[a].id===t.id&&(n.playlists[a]=r);return n.playlists[t.id]=r,n.playlists[t.uri]=r,n},no=function(e,t){return e+"-"+t},io=function(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];n.resolvedUri=Va(e.uri,n.uri),n.id=no(t,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes||(n.attributes={},$a.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},ro=function(e){eo(e,(function(t){t.uri&&(t.resolvedUri=Va(e.uri,t.uri))}))},ao=function(e,t){var n=e.segments[e.segments.length-1];return t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)},oo=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qa(this,t);var r=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=i.withCredentials,o=void 0!==a&&a,s=i.handleManifestRedirects,l=void 0!==s&&s;r.srcUrl=e,r.hls_=n,r.withCredentials=o,r.handleManifestRedirects=l;var u=n.options_;if(r.customTagParsers=u&&u.customTagParsers||[],r.customTagMappers=u&&u.customTagMappers||[],!r.srcUrl)throw new Error("A non-empty playlist URL is required");return r.state="HAVE_NOTHING",r.on("mediaupdatetimeout",(function(){"HAVE_METADATA"===r.state&&(r.state="HAVE_CURRENT_METADATA",r.request=r.hls_.xhr({uri:Va(r.master.uri,r.media().uri),withCredentials:r.withCredentials},(function(e,t){if(r.request)return e?r.playlistRequestError(r.request,r.media(),"HAVE_METADATA"):void r.haveMetadata(r.request,r.media().uri,r.media().id)})))})),r}return Xa(t,e),Ya(t,[{key:"playlistRequestError",value:function(e,t,n){var i=t.uri,r=t.id;this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[r],status:e.status,message:"HLS playlist request error at URL: "+i+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t,n){var i=this;this.request=null,this.state="HAVE_METADATA";var a=new O;this.customTagParsers.forEach((function(e){return a.addParser(e)})),this.customTagMappers.forEach((function(e){return a.addTagMapper(e)})),a.push(e.responseText),a.end(),a.manifest.uri=t,a.manifest.id=n,a.manifest.attributes=a.manifest.attributes||{};var o=to(this.master,a.manifest);this.targetDuration=a.manifest.targetDuration,o?(this.master=o,this.media_=this.master.playlists[n]):this.trigger("playlistunchanged"),this.media().endList||(r.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=r.a.setTimeout((function(){i.trigger("mediaupdatetimeout")}),ao(this.media(),!!o))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),r.a.clearTimeout(this.mediaUpdateTimeout),r.a.clearTimeout(this.finalRenditionTimeout),this.off()}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(e,t){var n=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(r.a.clearTimeout(this.finalRenditionTimeout),t){var i=e.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=r.a.setTimeout(this.media.bind(this,e,!1),i)}else{var a=this.state,o=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(function(t,i){if(n.request){if(e.resolvedUri=Wa(n.handleManifestRedirects,e.resolvedUri,i),t)return n.playlistRequestError(n.request,e,a);n.haveMetadata(i,e.uri,e.id),"HAVE_MASTER"===a?n.trigger("loadedmetadata"):n.trigger("mediachange")}}))}}}},{key:"pause",value:function(){this.stopRequest(),r.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;r.a.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var i=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=r.a.setTimeout((function(){return t.load()}),i)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var e=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"HLS playlist request error at URL: "+e.srcUrl+".",responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");var i=new O;if(e.customTagParsers.forEach((function(e){return i.addParser(e)})),e.customTagMappers.forEach((function(e){return i.addTagMapper(e)})),i.push(n.responseText),i.end(),e.state="HAVE_MASTER",e.srcUrl=Wa(e.handleManifestRedirects,e.srcUrl,n),i.manifest.uri=e.srcUrl,i.manifest.playlists)return e.master=i.manifest,io(e.master),ro(e.master),e.trigger("loadedplaylist"),void(e.request||e.media(i.manifest.playlists[0]));var a=no(0,e.srcUrl);return e.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:r.a.location.href,playlists:[{uri:e.srcUrl,id:a,resolvedUri:e.srcUrl,attributes:{}}]},e.master.playlists[a]=e.master.playlists[0],e.master.playlists[e.srcUrl]=e.master.playlists[0],e.haveMetadata(n,e.srcUrl,a),e.trigger("loadedmetadata")}}))}}]),t}(Ja),so=Ga.createTimeRange,lo=function(e,t,n){var i,r;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(i=function(e,t){var n=0,i=t-e.mediaSequence,r=e.segments[i];if(r){if(void 0!==r.start)return{result:r.start,precise:!0};if(void 0!==r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(void 0!==(r=e.segments[i]).end)return{result:n+r.end,precise:!0};if(n+=r.duration,void 0!==r.start)return{result:n+r.start,precise:!0}}return{result:n,precise:!1}}(e,t)).precise?i.result:(r=function(e,t){for(var n=0,i=void 0,r=t-e.mediaSequence;r<e.segments.length;r++){if(void 0!==(i=e.segments[r]).start)return{result:i.start-n,precise:!0};if(n+=i.duration,void 0!==i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?r.result:i.result+n},uo=function(e,t,n){if(!e)return 0;if("number"!=typeof n&&(n=0),void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return r.a.Infinity}return lo(e,t,n)},co=function(e,t,n){var i=0;if(t>n){var r=[n,t];t=r[0],n=r[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)i+=e.targetDuration;t=0}for(var o=t;o<n;o++)i+=e.segments[o].duration;return i},ho=function(e,t){if(!e.segments.length)return 0;var n=e.segments.length,i=e.segments[n-1].duration||e.targetDuration,r="number"==typeof t?t:i+2*e.targetDuration;if(0===r)return n;for(var a=0;n--&&!((a+=e.segments[n].duration)>=r););return Math.max(0,n)},fo=function(e,t,n,i){if(!e||!e.segments)return null;if(e.endList)return uo(e);if(null===t)return null;t=t||0;var r=n?ho(e,i):e.segments.length;return lo(e,e.mediaSequence+r,t)},po=function(e){return e-Math.floor(e)==0},mo=function(e,t){if(po(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,i=1;i<=n;i++){var r=Math.pow(10,i),a=t*r;if(po(a)||i===n)return(a+e)/r}},go=mo.bind(null,1),vo=mo.bind(null,-1),yo=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},_o=function(e){return e.excludeUntil&&e.excludeUntil===1/0},bo=function(e){var t=yo(e);return!e.disabled&&!t},Eo=function(e,t){return t.attributes&&t.attributes[e]},To=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){return!!bo(e)&&(e.attributes.BANDWIDTH||0)<n})).length},wo={duration:uo,seekable:function(e,t,n){var i=t||0,r=fo(e,t,!0,n);return null===r?so():so(i,r)},safeLiveIndex:ho,getMediaInfoForTime:function(e,t,n,i){var r=void 0,a=void 0,o=e.segments.length,s=t-i;if(s<0){if(n>0)for(r=n-1;r>=0;r--)if(a=e.segments[r],(s+=vo(a.duration))>0)return{mediaIndex:r,startTime:i-co(e,n,r)};return{mediaIndex:0,startTime:t}}if(n<0){for(r=n;r<0;r++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};n=0}for(r=n;r<o;r++)if(a=e.segments[r],(s-=go(a.duration))<0)return{mediaIndex:r,startTime:i+co(e,n,r)};return{mediaIndex:o-1,startTime:t}},isEnabled:bo,isDisabled:function(e){return e.disabled},isBlacklisted:yo,isIncompatible:_o,playlistEnd:fo,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:Eo,estimateSegmentRequestTime:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!Eo("BANDWIDTH",n))return NaN;var r=e*n.attributes.BANDWIDTH;return(r-8*i)/t},isLowestEnabledRendition:To},xo=Ga.xhr,Ao=Ga.mergeOptions,So=function(){return function e(t,n){t=Ao({timeout:45e3},t);var i=e.beforeRequest||Ga.Hls.xhr.beforeRequest;if(i&&"function"==typeof i){var r=i(t);r&&(t=r)}var a=xo(t,(function(e,t){var i=a.response;!e&&i&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=i.byteLength||i.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(i||a.responseText)))),n(e,a)})),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},Mo=function(e){var t,n,i={};return e.byterange&&(i.Range=(t=e.byterange,n=t.offset+t.length-1,"bytes="+t.offset+"-"+n)),i},Co=function(e,t){return e.start(t)+"-"+e.end(t)},Ro=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Io=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},Po=function(e){var t={};return Object.keys(e).forEach((function(n){var i=e[n];ArrayBuffer.isView(i)?t[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:t[n]=i})),t},Lo=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Do=function(e){return e.resolvedUri},Oo=function(e){for(var t=Array.prototype.slice.call(e),n="",i=0;i<t.length/16;i++)n+=t.slice(16*i,16*i+16).map(Ro).join("")+" "+t.slice(16*i,16*i+16).map(Io).join("")+"\n";return n},No=Object.freeze({createTransferableMessage:Po,initSegmentId:Lo,segmentKeyId:Do,hexDump:Oo,tagDump:function(e){var t=e.bytes;return Oo(t)},textRanges:function(e){var t="",n=void 0;for(n=0;n<e.length;n++)t+=Co(e,n)+" ";return t}}),ko=function(e){var t=e.playlist,n=e.time,i=void 0===n?void 0:n,r=e.callback;if(!r)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===i)return r({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,i=void 0,r=0;r<t.segments.length&&!(e<=(n=(i=t.segments[r]).videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:n+i.duration));r++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+.25*a.duration)return null;i=a}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:n-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}}(i,t);if(!a)return r({message:"valid programTime was not found"});if("estimate"===a.type)return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:i},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,i=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*i)}(i,a.segment);return s&&(o.programDateTime=s.toISOString()),r(null,o)},Fo=function e(t){var n=t.programTime,i=t.playlist,r=t.retryCount,a=void 0===r?2:r,o=t.seekTo,s=t.pauseAfterSeek,l=void 0===s||s,u=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===n||!i||!o)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!u.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++){if(!e.segments[t].dateTimeObject)return!1}return!0}(i))return c({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var h=function(e,t){var n=void 0;try{n=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var i=t.segments[0];if(n<i.dateTimeObject)return null;for(var r=0;r<t.segments.length-1;r++){if(i=t.segments[r],n<t.segments[r+1].dateTimeObject)break}var a,o=t.segments[t.segments.length-1],s=o.dateTimeObject,l=o.videoTimingInfo?(a=o.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:o.duration+.25*o.duration;return n>new Date(s.getTime()+1e3*l)?null:(n>s&&(i=o),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:wo.duration(t,t.mediaSequence+t.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})}(n,i);if(!h)return c({message:n+" was not found in the stream"});var d=h.segment,f=function(e,t){var n=void 0,i=void 0;try{n=new Date(e),i=new Date(t)}catch(e){}var r=n.getTime();return(i.getTime()-r)/1e3}(d.dateTimeObject,n);if("estimate"===h.type)return 0===a?c({message:n+" is not buffered yet. Try again"}):(o(h.estimatedStart+f),void u.one("seeked",(function(){e({programTime:n,playlist:i,retryCount:a-1,seekTo:o,pauseAfterSeek:l,tech:u,callback:c})})));var p=d.start+f;u.one("seeked",(function(){return c(null,u.currentTime())})),l&&u.pause(),o(p)},Bo=function(e,t){var n=[],i=void 0;if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return Ga.createTimeRanges(n)},Uo=function(e,t){return Bo(e,(function(e,n){return e-.1<=t&&n+.1>=t}))},jo=function(e,t){return Bo(e,(function(e){return e-1/30>=t}))},Go=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},zo=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},Ho=function(e,t,n){var i=void 0,r=void 0;if(n&&n.cues)for(i=n.cues.length;i--;)(r=n.cues[i]).startTime<=t&&r.endTime>=e&&n.removeCue(r)},Vo=function(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e},Wo=function(e,t,n){var i=r.a.WebKitDataCue||r.a.VTTCue;if(t&&t.forEach((function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new i(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))}),e),n){var a=Vo(e.mediaSource_.duration);if(n.forEach((function(e){var t=e.cueTime+this.timestampOffset;!("number"!=typeof t||r.a.isNaN(t)||t<0)&&t<1/0&&e.frames.forEach((function(e){var n=new i(t,t,e.value||e.url||e.data||"");n.frame=e,n.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return Ga.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return Ga.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return Ga.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(n),this.metadataTrack_.addCue(n)}),this)}),e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var o=e.metadataTrack_.cues,s=[],l=0;l<o.length;l++)o[l]&&s.push(o[l]);var u=s.reduce((function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e}),{}),c=Object.keys(u).sort((function(e,t){return Number(e)-Number(t)}));c.forEach((function(e,t){var n=u[e],i=Number(c[t+1])||a;n.forEach((function(e){e.endTime=i}))}))}}},qo="undefined"!=typeof window?window:{},Yo="undefined"==typeof Symbol?"__target":Symbol(),Xo=qo.BlobBuilder||qo.WebKitBlobBuilder||qo.MozBlobBuilder||qo.MSBlobBuilder,Ko=qo.URL||qo.webkitURL||Ko&&Ko.msURL,Qo=qo.Worker;function Zo(e,t){return function(n){var i=this;if(!t)return new Qo(e);if(Qo&&!n){var r=ts(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[Yo]=new Qo(r),function(e,t){if(!e||!t)return;var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Ko.revokeObjectURL(e.objURL),n.call(e)}}(this[Yo],r),this[Yo]}var a={postMessage:function(e){i.onmessage&&setTimeout((function(){i.onmessage({data:e,target:a})}))}};t.call(a),this.postMessage=function(e){setTimeout((function(){a.onmessage({data:e,target:i})}))},this.isThisThread=!0}}if(Qo){var Jo,$o=ts("self.onmessage = function () {}"),es=new Uint8Array(1);try{(Jo=new Qo($o)).postMessage(es,[es.buffer])}catch(e){Qo=null}finally{Ko.revokeObjectURL($o),Jo&&Jo.terminate()}}function ts(e){try{return Ko.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(n){var t=new Xo;return t.append(e),Ko.createObjectURL(t.getBlob(type))}}var ns=new Zo("./transmuxer-worker.worker.js",(function(e,t){var n=this;!function(){var e=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};e.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var t,i,r,a,o,s,l,u,c,h,d,f,p,m,g,v,y,_,b,E,T,w,x,A,S,M,C,R,I,P,L,D,O,N,k,F,B,U,j,G,z=e,H=Math.pow(2,32)-1;!function(){var e;if(w={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in w)w.hasOwnProperty(e)&&(w[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);x=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),S=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),A=new Uint8Array([0,0,0,1]),M=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),C=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),R={video:M,audio:C},L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),P=new Uint8Array([0,0,0,0,0,0,0,0]),D=new Uint8Array([0,0,0,0,0,0,0,0]),O=D,N=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),k=D,I=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),t=function(e){var t,n,i=[],r=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=i.length;t--;)r+=i[t].byteLength;for(n=new Uint8Array(r+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,r=8;t<i.length;t++)n.set(i[t],r),r+=i[t].byteLength;return n},i=function(){return t(w.dinf,t(w.dref,L))},r=function(e){return t(w.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},g=function(e){return t(w.hdlr,R[e])},m=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(n[12]=e.samplerate>>>24&255,n[13]=e.samplerate>>>16&255,n[14]=e.samplerate>>>8&255,n[15]=255&e.samplerate),t(w.mdhd,n)},p=function(e){return t(w.mdia,m(e),g(e.type),s(e))},o=function(e){return t(w.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},s=function(e){return t(w.minf,"video"===e.type?t(w.vmhd,I):t(w.smhd,P),i(),y(e))},l=function(e,n){for(var i=[],r=n.length;r--;)i[r]=b(n[r]);return t.apply(null,[w.moof,o(e)].concat(i))},u=function(e){for(var n=e.length,i=[];n--;)i[n]=d(e[n]);return t.apply(null,[w.moov,h(4294967295)].concat(i).concat(c(e)))},c=function(e){for(var n=e.length,i=[];n--;)i[n]=E(e[n]);return t.apply(null,[w.mvex].concat(i))},h=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(w.mvhd,n)},v=function(e){var n,i,r=e.samples||[],a=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)n=r[i].flags,a[i+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t(w.sdtp,a)},y=function(e){return t(w.stbl,_(e),t(w.stts,k),t(w.stsc,O),t(w.stsz,N),t(w.stco,D))},_=function(e){return t(w.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?F(e):B(e))},F=function(e){var n,i,r=e.sps||[],a=e.pps||[],o=[],s=[];for(n=0;n<r.length;n++)o.push((65280&r[n].byteLength)>>>8),o.push(255&r[n].byteLength),o=o.concat(Array.prototype.slice.call(r[n]));for(n=0;n<a.length;n++)s.push((65280&a[n].byteLength)>>>8),s.push(255&a[n].byteLength),s=s.concat(Array.prototype.slice.call(a[n]));if(i=[w.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(w.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length],o,[a.length],s))),t(w.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var l=e.sarRatio[0],u=e.sarRatio[1];i.push(t(w.pasp,new Uint8Array([(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u])))}return t.apply(null,i)},B=function(e){return t(w.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),r(e))},f=function(e){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(w.tkhd,n)},b=function(e){var n,i,r,a,o,s;return n=t(w.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(e.baseMediaDecodeTime/(H+1)),s=Math.floor(e.baseMediaDecodeTime%(H+1)),i=t(w.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),92,"audio"===e.type?(r=T(e,92),t(w.traf,n,i,r)):(a=v(e),r=T(e,a.length+92),t(w.traf,n,i,r,a))},d=function(e){return e.duration=e.duration||4294967295,t(w.trak,f(e),p(e))},E=function(e){var n=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(n[n.length-1]=0),t(w.trex,n)},G=function(e,t){var n=0,i=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(i=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|i|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(e,n){var i,r,a,o;for(n+=20+16*(r=e.samples||[]).length,i=G(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return t(w.trun,new Uint8Array(i))},U=function(e,n){var i,r,a,o;for(n+=20+8*(r=e.samples||[]).length,i=G(r,n),o=0;o<r.length;o++)a=r[o],i=i.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return t(w.trun,new Uint8Array(i))},T=function(e,t){return"audio"===e.type?U(e,t):j(e,t)};a=function(){return t(w.ftyp,x,A,x,S)};var V,W,q,Y,X,K,Q,Z,J=function(e){return t(w.mdat,e)},$=l,ee=function(e){var t,n=a(),i=u(e);return(t=new Uint8Array(n.byteLength+i.byteLength)).set(n),t.set(i,n.byteLength),t},te=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},ne=function(e){var t,n,i=[],r=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,i.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.byteLength+=i.byteLength,r.nalCount+=i.length,r.duration+=i.duration,r.push(i)),(i=[n]).byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return r.length&&(!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.length,r.duration+=i.duration,r.push(i),r},ie=function(e){var t,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),(i=[n]).nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},re=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},ae=function(e,t){var n,i,r,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i++)o=a[i],s+=(r=te(o,s)).size,l.push(r);return l},oe=function(e){var t,n,i,r,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),h=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],n=0;n<r.length;n++)for(a=r[n],i=0;i<a.length;i++)o=a[i],h.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},se=[33,16,5,32,164,27],le=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ue=function(e){for(var t=[];e--;)t.push(0);return t},ce={96e3:[se,[227,64],ue(154),[56]],88200:[se,[231],ue(170),[56]],64e3:[se,[248,192],ue(240),[56]],48e3:[se,[255,192],ue(268),[55,148,128],ue(54),[112]],44100:[se,[255,192],ue(268),[55,163,128],ue(84),[112]],32e3:[se,[255,192],ue(268),[55,234],ue(226),[112]],24e3:[se,[255,192],ue(268),[55,255,128],ue(268),[111,112],ue(126),[224]],16e3:[se,[255,192],ue(268),[55,255,128],ue(268),[111,255],ue(269),[223,108],ue(195),[1,192]],12e3:[le,ue(268),[3,127,248],ue(268),[6,255,240],ue(268),[13,255,224],ue(268),[27,253,128],ue(259),[56]],11025:[le,ue(268),[3,127,248],ue(268),[6,255,240],ue(268),[13,255,224],ue(268),[27,255,192],ue(268),[55,175,128],ue(108),[112]],8e3:[le,ue(268),[3,121,16],ue(47),[7]]},he=(V=ce,Object.keys(V).reduce((function(e,t){return e[t]=new Uint8Array(V[t].reduce((function(e,t){return e.concat(t)}),[])),e}),{}));K=function(e,t){return W(X(e,t))},Q=function(e,t){return q(Y(e),t)},Z=function(e,t,n){return Y(n?e:e-t)};var de=9e4,fe=(W=function(e){return 9e4*e},q=function(e,t){return e*t},Y=function(e){return e/9e4},X=function(e,t){return e/t},K),pe=Q,me=Z,ge=function(e,t,n,i){var r,a,o,s,l,u=0,c=0,h=0;if(t.length&&(r=fe(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(de/(e.samplerate/1024)),n&&i&&(u=r-Math.max(n,i),h=(c=Math.floor(u/a))*a),!(c<1||h>de/2))){for((o=he[e.samplerate])||(o=t[0].data),s=0;s<c;s++)l=t[0],t.splice(0,0,{data:o,dts:l.dts-a,pts:l.pts-a});e.baseMediaDecodeTime-=Math.floor(pe(h,e.samplerate))}},ve=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},ye=function(e){var t,n,i=[];for(t=0;t<e.length;t++)n=e[t],i.push({size:n.data.byteLength,duration:1024});return i},_e=function(e){var t,n,i=0,r=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],r.set(n.data,i),i+=n.data.byteLength;return r},be=de,Ee=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},Te=function(e,t){var n,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/be,n=Math.floor(n)),n},we=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},xe=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},Ae=function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Se=function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[(r=3*n)+2],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},Me=4,Ce=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new De(0,0),new De(0,1),new De(1,0),new De(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};(Ce.prototype=new z).push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=xe(e.escapedRBSP)).payloadType===Me&&(n=Ae(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=Se(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},Ce.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},Ce.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},Ce.prototype.flush=function(){return this.flushStream("flush")},Ce.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ce.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},Ce.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},Ce.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},Ce.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},Ce.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Re={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ie=function(e){return null===e?"":(e=Re[e]||e,String.fromCharCode(e))},Pe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Le=function(){for(var e=[],t=15;t--;)e.push("");return e},De=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Le();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Le();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Le()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Ie((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=Pe.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=Ie(i),a+=Ie(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};De.prototype=new z,De.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},De.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Le(),this.nonDisplayed_=Le(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},De.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},De.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},De.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},De.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},De.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},De.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},De.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},De.prototype.isNormalChar=function(e){return e>=32&&e<=127},De.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Le(),this.displayed_=Le()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},De.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},De.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},De.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},De.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},De.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},De.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var Oe={CaptionStream:Ce,Cea608Stream:De},Ne={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},ke=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Fe=function e(t){var n,i;e.prototype.init.call(this),this.type_=t||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===i&&(i=e.dts),e.dts=ke(e.dts,i),e.pts=ke(e.pts,i),n=e.dts,this.trigger("data",e))},this.flush=function(){i=n,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){i=void 0,n=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Fe.prototype=new z;var Be,Ue=Fe,je=function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r},Ge=function(e,t,n){return decodeURIComponent(je(e,t,n))},ze=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},He={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ge(e.data,1,t),e.value=Ge(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ge(e.data,1,t),e.url=Ge(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(je(n,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Be=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},i=0,r=[],a=0;if(Be.prototype.init.call(this),this.dispatchType=Ne.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,l,u;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(e),a+=e.data.byteLength,1===r.length&&(i=ze(e.data.subarray(6,10)),i+=10),!(a<i)){for(t={data:new Uint8Array(i),frames:[],pts:r[0].pts,dts:r[0].dts},u=0;u<i;)t.data.set(r[0].data.subarray(0,i-u),u),u+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&t.data[5]&&(o+=4,o+=ze(t.data.subarray(10,14)),i-=ze(t.data.subarray(16,20)));do{if((s=ze(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((l={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=l.id,He[l.id]&&(He[l.id](l),"com.apple.streaming.transportStreamTimestamp"===l.owner)){var c=l.data,h=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;h*=4,h+=3&c[7],l.timeStamp=h,void 0===t.pts&&void 0===t.dts&&(t.pts=l.timeStamp,t.dts=l.timeStamp),this.trigger("timestamp",l)}t.frames.push(l),o+=10,o+=s}while(o<i);this.trigger("data",t)}}}).prototype=new z;var Ve,We,qe,Ye=Be,Xe=Ue;(Ve=function(){var e=new Uint8Array(188),t=0;Ve.prototype.init.call(this),this.push=function(n){var i,r=0,a=188;for(t?((i=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),i.set(n,t),t=0):i=n;a<i.byteLength;)71!==i[r]||71!==i[a]?(r++,a++):(this.trigger("data",i.subarray(r,a)),r+=188,a+=188);r<i.byteLength&&(e.set(i.subarray(r),0),t=i.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new z,(We=function(){var e,t,n,i;We.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,i){var r=0;i.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===i.type?t(e.subarray(r),i):n(e.subarray(r),i)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],i.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=i.pmtPid},n=function(e,t){var n,r;if(1&e[5]){for(i.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var a=e[r],o=(31&e[r+1])<<8|e[r+2];a===Ne.H264_STREAM_TYPE&&null===i.programMapTable.video?i.programMapTable.video=o:a===Ne.ADTS_STREAM_TYPE&&null===i.programMapTable.audio?i.programMapTable.audio=o:a===Ne.METADATA_STREAM_TYPE&&(i.programMapTable["timed-metadata"][o]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=i.programMapTable}},this.push=function(t){var n={},i=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(i+=t[i]+1),0===n.pid)n.type="pat",e(t.subarray(i),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(i),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,i,n]):this.processPes_(t,i,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Ne.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Ne.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new z,We.STREAM_TYPES={h264:27,adts:15},(qe=function(){var e,t=this,n={data:[],size:0},i={data:[],size:0},r={data:[],size:0},a=function(e,n,i){var r,a,o=new Uint8Array(e.size),s={type:n},l=0,u=0;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,l=0;l<e.data.length;l++)a=e.data[l],o.set(a.data,u),u+=a.data.byteLength;var c,h,d;c=o,(h=s).packetLength=6+(c[4]<<8|c[5]),h.dataAlignmentIndicator=0!=(4&c[6]),192&(d=c[7])&&(h.pts=(14&c[9])<<27|(255&c[10])<<20|(254&c[11])<<12|(255&c[12])<<5|(254&c[13])>>>3,h.pts*=4,h.pts+=(6&c[13])>>>1,h.dts=h.pts,64&d&&(h.dts=(14&c[14])<<27|(255&c[15])<<20|(254&c[16])<<12|(255&c[17])<<5|(254&c[18])>>>3,h.dts*=4,h.dts+=(6&c[18])>>>1)),h.data=c.subarray(9+c[8]),r="video"===n||s.packetLength<=e.size,(i||r)&&(e.size=0,e.data.length=0),r&&t.trigger("data",s)}};qe.prototype.init.call(this),this.push=function(o){({pat:function(){},pes:function(){var e,t;switch(o.streamType){case Ne.H264_STREAM_TYPE:case Ne.H264_STREAM_TYPE:e=n,t="video";break;case Ne.ADTS_STREAM_TYPE:e=i,t="audio";break;case Ne.METADATA_STREAM_TYPE:e=r,t="timed-metadata";break;default:return}o.payloadUnitStartIndicator&&a(e,t,!0),e.data.push(o),e.size+=o.data.byteLength},pmt:function(){var n={type:"metadata",tracks:[]};null!==(e=o.programMapTable).video&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",n)}})[o.type]()},this.reset=function(){n.size=0,n.data.length=0,i.size=0,i.data.length=0,this.trigger("reset")},this.flushStreams_=function(){a(n,"video"),a(i,"audio"),a(r,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new z;var Ke={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Ve,TransportParseStream:We,ElementaryStream:qe,TimestampRolloverStream:Xe,CaptionStream:Oe.CaptionStream,Cea608Stream:Oe.Cea608Stream,MetadataStream:Ye};for(var Qe in Ne)Ne.hasOwnProperty(Qe)&&(Ke[Qe]=Ne[Qe]);var Ze,Je=Ke,$e=de,et=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ze=function(e){var t,n=0;Ze.prototype.init.call(this),this.push=function(i){var r,a,o,s,l,u,c=0;if(e||(n=0),"audio"===i.type)for(t?(s=t,(t=new Uint8Array(s.byteLength+i.data.byteLength)).set(s),t.set(i.data,s.byteLength)):t=i.data;c+5<t.length;)if(255===t[c]&&240==(246&t[c+1])){if(a=2*(1&~t[c+1]),r=(3&t[c+3])<<11|t[c+4]<<3|(224&t[c+5])>>5,u=(l=1024*(1+(3&t[c+6])))*$e/et[(60&t[c+2])>>>2],o=c+r,t.byteLength<o)return;if(this.trigger("data",{pts:i.pts+n*u,dts:i.dts+n*u,sampleCount:l,audioobjecttype:1+(t[c+2]>>>6&3),channelcount:(1&t[c+2])<<2|(192&t[c+3])>>>6,samplerate:et[(60&t[c+2])>>>2],samplingfrequencyindex:(60&t[c+2])>>>2,samplesize:16,data:t.subarray(c+7+a,o)}),n++,t.byteLength===o)return void(t=void 0);t=t.subarray(o)}else c++},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new z;var tt,nt,it,rt=Ze,at=function(e){var t=e.byteLength,n=0,i=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+i},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(r,r+o)),n=new DataView(a.buffer).getUint32(0),i=8*o,t-=o},this.skipBits=function(e){var r;i>e?(n<<=e,i-=e):(e-=i,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord(),n<<=e,i-=e)},this.readBits=function(e){var r=Math.min(i,e),a=n>>>32-r;return(i-=r)>0?n<<=r:t>0&&this.loadWord(),(r=e-r)>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<i;++e)if(0!=(n&2147483648>>>e))return n<<=e,i-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(nt=function(){var e,t,n=0;nt.prototype.init.call(this),this.push=function(i){var r;t?((r=new Uint8Array(t.byteLength+i.data.byteLength)).set(t),r.set(i.data,t.byteLength),t=r):t=i.data;for(var a=t.byteLength;n<a-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<a;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<a);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.reset=function(){t=null,n=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new z,it={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(tt=function(){var e,t,n,i,r,a,o,s=new nt;tt.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,i=e.dts,s.push(e))},s.on("data",(function(o){var s={trackId:t,pts:n,dts:i,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)})),s.on("done",(function(){e.trigger("done")})),s.on("partialdone",(function(){e.trigger("partialdone")})),s.on("reset",(function(){e.trigger("reset")})),s.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){s.flush()},this.partialFlush=function(){s.partialFlush()},this.reset=function(){s.reset()},this.endTimeline=function(){s.endTimeline()},o=function(e,t){var n,i=8,r=8;for(n=0;n<e;n++)0!==r&&(r=(i+t.readExpGolomb()+256)%256),i=0===r?i:r},r=function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},a=function(e){var t,n,i,r,a,s,l,u,c,h,d,f,p,m=0,g=0,v=0,y=0,_=1;if(n=(t=new at(e)).readUnsignedByte(),r=t.readUnsignedByte(),i=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),it[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,p=0;p<d;p++)t.readBoolean()&&o(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),p=0;p<l;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(h=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}f&&(_=f[0]/f[1])}return{profileIdc:n,levelIdc:i,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*m-2*g)*_),height:(2-h)*(c+1)*16-2*v-2*y,sarRatio:f}}}).prototype=new z;var ot,st={H264Stream:tt,NalByteStream:nt},lt=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},ut=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},ct=function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n};(ot=function(){var e=new Uint8Array,t=0;ot.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var i,r,a,o,s=0,l=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(s=ct(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+s),pts:t,dts:t},this.trigger("data",a),l+=s}else{if(e.length-l<10)break;if(l+(s=ut(e,l))>e.length)break;r={type:"timed-metadata",data:e.subarray(l,l+s)},this.trigger("data",r),l+=s}i=e.length-l,e=i>0?e.subarray(l):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new z;var ht,dt,ft,pt,mt=ot,gt=st.H264Stream,vt=lt,yt=de,_t=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],bt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Et=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Tt=function(e,t,n,i,r,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(i-t),pts:e+(r-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(dt=function(e,t){var n=[],i=0,r=0,a=0,o=1/0;t=t||{},dt.prototype.init.call(this),this.push=function(t){we(e,t),e&&_t.forEach((function(n){e[n]=t[n]})),n.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,l,u,c,h;0!==n.length?(s=ve(n,e,r),e.baseMediaDecodeTime=Te(e,t.keepOriginalTimestamps),ge(e,s,a,o),e.samples=ye(s),u=J(_e(s)),n=[],l=$(i,[e]),c=new Uint8Array(l.byteLength+u.byteLength),i++,c.set(l),c.set(u,l.byteLength),Ee(e),h=Math.ceil(1024*yt/e.samplerate),s.length&&this.trigger("timingInfo",{start:s[0].pts,end:s[0].pts+s.length*h}),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){Ee(e),n=[],this.trigger("reset")}}).prototype=new z,(ht=function(e,t){var n,i,r=0,a=[],o=[];t=t||{},ht.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){we(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],bt.forEach((function(t){e[t]=n[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,i,s,l,u,c,h,d,f=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=ne(a),(s=ie(n))[0][0].keyFrame||((i=this.getGopForFusion_(a[0],e))?(f=i.duration,s.unshift(i),s.byteLength+=i.byteLength,s.nalCount+=i.nalCount,s.pts=i.pts,s.dts=i.dts,s.duration+=i.duration):s=re(s)),o.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Ee(e),s=p}we(e,s),e.samples=ae(s),u=J(oe(s)),e.baseMediaDecodeTime=Te(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),h=s[0],d=s[s.length-1],this.trigger("segmentTimingInfo",Tt(e.baseMediaDecodeTime,h.dts,h.pts,d.dts+d.duration,d.pts+d.duration,f)),this.trigger("timingInfo",{start:s[0].pts,end:s[s.length-1].pts+s[s.length-1].duration}),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=$(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,o.length=0,this.trigger("reset")},this.resetStream_=function(){Ee(e),n=void 0,i=void 0},this.getGopForFusion_=function(t){var n,i,r,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)r=(a=this.gopCache_[o]).gop,e.pps&&Et(e.pps[0],a.pps[0])&&e.sps&&Et(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||(n=t.dts-r.dts-r.duration)>=-1e4&&n<=45e3&&(!i||s>n)&&(i=a,s=n));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,n,i,r,a,s,l,u;for(a=e.byteLength,s=e.nalCount,l=e.duration,t=n=0;t<o.length&&n<e.length&&(i=o[t],r=e[n],i.pts!==r.pts);)r.pts>i.pts?t++:(n++,a-=r.byteLength,s-=r.nalCount,l-=r.duration);return 0===n?e:n===e.length?null:((u=e.slice(n)).byteLength=a,u.duration=l,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,n,i,r,a,s,l;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(i=o[t],r=e[n],i.pts===r.pts){s=!0;break}i.pts>r.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(l=s?n:a))return e;var u=e.slice(l),c=u.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){o=e}}).prototype=new z,(pt=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,pt.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new z,pt.prototype.flush=function(e){var t,n,i,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,bt.forEach((function(e){o.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,_t.forEach((function(e){o.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,i=ee(this.pendingTracks),o.initSegment=new Uint8Array(i.byteLength),o.initSegment.set(i),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=me(t.startPts,s,this.keepOriginalTimestamps),t.endTime=me(t.endPts,s,this.keepOriginalTimestamps),o.captionStreams[t.stream]=!0,o.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(n=this.pendingMetadata[r]).cueTime=me(n.pts,s,this.keepOriginalTimestamps),o.metadata.push(n);for(o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),r=0;r<o.captions.length;r++)t=o.captions[r],this.trigger("caption",t);for(r=0;r<o.metadata.length;r++)n=o.metadata[r],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},pt.prototype.setRemux=function(e){this.remuxTracks=e},(ft=function(e){var t,n,i=this,r=!0;ft.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="aac",r.metadataStream=new Je.MetadataStream,r.aacStream=new mt,r.audioTimestampRolloverStream=new Je.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new Je.TimestampRolloverStream("timed-metadata"),r.adtsStream=new rt,r.coalesceStream=new pt(e,r.metadataStream),r.headOfPipeline=r.aacStream,r.aacStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.aacStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.metadataStream.on("timestamp",(function(e){r.aacStream.setTimestamp(e.timeStamp)})),r.aacStream.on("data",(function(a){"timed-metadata"!==a.type||r.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new dt(n,e),r.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)),i.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})})),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new Je.MetadataStream,r.packetStream=new Je.TransportPacketStream,r.parseStream=new Je.TransportParseStream,r.elementaryStream=new Je.ElementaryStream,r.timestampRolloverStream=new Je.TimestampRolloverStream,r.adtsStream=new rt,r.h264Stream=new gt,r.captionStream=new Je.CaptionStream,r.coalesceStream=new pt(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream).pipe(r.timestampRolloverStream),r.timestampRolloverStream.pipe(r.h264Stream),r.timestampRolloverStream.pipe(r.adtsStream),r.timestampRolloverStream.pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",(function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new ht(t,e),r.videoSegmentStream.on("timelineStartInfo",(function(e){n&&(n.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))})),r.videoSegmentStream.on("processedGopsInfo",i.trigger.bind(i,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",i.trigger.bind(i,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",(function(e){n&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),r.videoSegmentStream.on("timingInfo",i.trigger.bind(i,"videoTimingInfo")),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),n&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new dt(n,e),r.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)),i.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})}})),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("id3Frame",(function(e){e.dispatchType=r.metadataStream.dispatchType,i.trigger("id3Frame",e)})),r.coalesceStream.on("caption",this.trigger.bind(this,"caption")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(i){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=i),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,Ee(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=i),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,Ee(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=i)),r.timestampRolloverStream&&r.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var n=this.transmuxPipeline_;e.remux=t,n&&n.coalesceStream&&n.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=vt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new z;var wt={Transmuxer:ft,VideoSegmentStream:ht,AudioSegmentStream:dt,AUDIO_PROPERTIES:_t,VIDEO_PROPERTIES:bt,generateVideoSegmentTimingInfo:Tt},xt=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),At=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n||{},this.self=t,this.init()}return xt(e,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new wt.Transmuxer(this.options),function(e,t){t.on("data",(function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var i=t.data;t.data=i.buffer,e.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])})),t.captionStream&&t.captionStream.on("data",(function(t){e.postMessage({action:"caption",data:t})})),t.on("done",(function(t){e.postMessage({action:"done"})})),t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})})),t.on("videoSegmentTimingInfo",(function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}))}(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),e}();new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new At(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new At(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(n)}()})),is={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},rs=function(e){return e.map((function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)}))}))},as=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={codecCount:0},n=void 0;return t.codecCount=e.split(",").length,t.codecCount=t.codecCount||2,(n=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e))&&(t.videoCodec=n[2],t.videoObjectTypeIndicator=n[3]),t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e),t.audioProfile=t.audioProfile&&t.audioProfile[2],t},os=function(e,t,n){return e+"/"+t+'; codecs="'+n.filter((function(e){return!!e})).join(", ")+'"'},ss=function(e,t){var n=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"}(t),i=function(e){var t=e.attributes||{};return t.CODECS?as(t.CODECS):is}(t),r=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&r.AUDIO){var s=e.mediaGroups.AUDIO[r.AUDIO];if(s)for(var l in o=!0,a=!1,s)if(!s[l].uri&&!s[l].playlists){a=!0;break}}o&&!i.audioProfile&&(a||(i.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var i in n){var r=n[i];if(r.default&&r.playlists)return as(r.playlists[0].attributes.CODECS).audioProfile}return null}(e,r.AUDIO)),i.audioProfile||(Ga.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),i.audioProfile=is.audioProfile));var u={};i.videoCodec&&(u.video=""+i.videoCodec+i.videoObjectTypeIndicator),i.audioProfile&&(u.audio="mp4a.40."+i.audioProfile);var c=os("audio",n,[u.audio]),h=os("video",n,[u.video]),d=os("video",n,[u.video,u.audio]);return o?!a&&u.video?[h,c]:a||u.video?[d,c]:[c,c]:u.video?[d]:[c]},ls=function(e){var t={type:"",parameters:{}},n=e.trim().split(";");return t.type=n.shift().trim(),n.forEach((function(e){var n=e.trim().split("=");if(n.length>1){var i=n[0].replace(/"/g,"").trim(),r=n[1].replace(/"/g,"").trim();t.parameters[i]=r}})),t},us=function(e){return/mp4a\.\d+.\d+/i.test(e)},cs=function(e){return/avc1\.[\da-f]+/i.test(e)},hs=function(e,t,n){if(null==t||!e.length)return[];var i=Math.ceil(9e4*(t-n+3)),r=void 0;for(r=0;r<e.length&&!(e[r].pts>i);r++);return e.slice(r)},ds=function(e){function t(e,n){qa(this,t);var i=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Ga.EventTarget));i.timestampOffset_=0,i.pendingBuffers_=[],i.bufferUpdating_=!1,i.mediaSource_=e,i.codecs_=n,i.audioCodec_=null,i.videoCodec_=null,i.audioDisabled_=!1,i.appendAudioInitSegment_=!0,i.gopBuffer_=[],i.timeMapping_=0,i.safeAppend_=Ga.browser.IE_VERSION>=11;var r={remux:!1,alignGopsAtEnd:i.safeAppend_};return i.codecs_.forEach((function(e){us(e)?i.audioCodec_=e:cs(e)&&(i.videoCodec_=e)})),i.transmuxer_=new ns,i.transmuxer_.postMessage({action:"init",options:r}),i.transmuxer_.onmessage=function(e){return"data"===e.data.action?i.data_(e):"done"===e.data.action?i.done_(e):"gopInfo"===e.data.action?i.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?i.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(i,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(i,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(i,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(i,"buffered",{get:function(){return function(e,t,n){var i=null,r=null,a=0,o=[],s=[];if(!e&&!t)return Ga.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return Ga.createTimeRange();for(var l=e.buffered,u=t.buffered,c=l.length;c--;)o.push({time:l.start(c),type:"start"}),o.push({time:l.end(c),type:"end"});for(c=u.length;c--;)o.push({time:u.start(c),type:"start"}),o.push({time:u.end(c),type:"end"});for(o.sort((function(e,t){return e.time-t.time})),c=0;c<o.length;c++)"start"===o[c].type?2===++a&&(i=o[c].time):"end"===o[c].type&&1===--a&&(r=o[c].time),null!==i&&null!==r&&(s.push([i,r]),i=null,r=null);return Ga.createTimeRanges(s)}(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),i}return Xa(t,e),Ya(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,n){var i=t.player_;if(n.captions&&n.captions.length)for(var r in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[r]){i.tech_.trigger({type:"usage",name:"hls-608"});var a=i.textTracks().getTrackById(r);e.inbandTextTracks_[r]=a||i.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/9e4,presentation:e.start.pts/9e4},end:{decode:e.end.dts/9e4,presentation:e.end.pts/9e4},baseMediaDecodeTime:e.baseMediaDecodeTime/9e4};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach((function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var i=null;if(e.mediaSource_[n+"Buffer_"])(i=e.mediaSource_[n+"Buffer_"]).updating=!1;else{var r=n+'/mp4;codecs="'+e[n+"Codec_"]+'"';i=function(e,t){var n=e.addSourceBuffer(t),i=Object.create(null);i.updating=!1,i.realBuffer_=n;var r=function(e){"function"==typeof n[e]?i[e]=function(){return n[e].apply(n,arguments)}:void 0===i[e]&&Object.defineProperty(i,e,{get:function(){return n[e]},set:function(t){return n[e]=t}})};for(var a in n)r(a);return i}(e.mediaSource_.nativeMediaSource_,r),e.mediaSource_[n+"Buffer_"]=i}e[n+"Buffer_"]=i,["update","updatestart","updateend"].forEach((function(r){i.addEventListener(r,(function(){if("audio"!==n||!e.audioDisabled_)return"updateend"===r&&(e[n+"Buffer_"].updating=!1),t.every((function(t){return!("audio"!==t||!e.audioDisabled_)||(n===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating)}))?e.trigger(r):void 0}))}))}}))}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:hs(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var i=t[0].pts,r=0;r<e.length&&!(e[r].pts>=i);r++);return e.slice(0,r).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,n,i){for(var r=Math.ceil(9e4*(t-i)),a=Math.ceil(9e4*(n-i)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var l=s+1;l--&&!(e[l].pts<=r););return l=Math.max(l,0),o.splice(l,s-l+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Ho(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Ho(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length)return this.trigger("updateend"),void(this.bufferUpdating_=!1);e=this.pendingBuffers_.reduce((function(e,t){var n=t.type,i=t.data,r=t.initSegment;return e[n].segments.push(i),e[n].bytes+=i.byteLength,e[n].initSegment=r,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e}),e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),Wo(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,i=void 0;if(e.bytes){i=new Uint8Array(e.bytes),e.segments.forEach((function(e){i.set(e,n),n+=e.byteLength}));try{t.updating=!0,t.appendBuffer(i)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"dispose",value:function(){this.transmuxer_&&this.transmuxer_.terminate(),this.trigger("dispose"),this.off()}}]),t}(Ga.EventTarget),fs=function(e){function t(){qa(this,t);var e=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=void 0;for(n in e.nativeMediaSource_=new r.a.MediaSource,e.nativeMediaSource_)n in t.prototype||"function"!=typeof e.nativeMediaSource_[n]||(e[n]=e.nativeMediaSource_[n].bind(e.nativeMediaSource_));return e.duration_=NaN,Object.defineProperty(e,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){this.duration_=e,e===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(e,"seekable",{get:function(){return this.duration_===1/0?Ga.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(e,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(e,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),e.sourceBuffers=[],e.activeSourceBuffers_=[],e.updateActiveSourceBuffers_=function(){if(e.activeSourceBuffers_.length=0,1===e.sourceBuffers.length){var t=e.sourceBuffers[0];return t.appendAudioInitSegment_=!0,t.audioDisabled_=!t.audioCodec_,void e.activeSourceBuffers_.push(t)}for(var n=!1,i=!0,r=0;r<e.player_.audioTracks().length;r++){var a=e.player_.audioTracks()[r];if(a.enabled&&"main"!==a.kind){n=!0,i=!1;break}}e.sourceBuffers.forEach((function(t,r){if(t.appendAudioInitSegment_=!0,t.videoCodec_&&t.audioCodec_)t.audioDisabled_=n;else if(t.videoCodec_&&!t.audioCodec_)t.audioDisabled_=!0,i=!1;else if(!t.videoCodec_&&t.audioCodec_&&(t.audioDisabled_=r?i:!i,t.audioDisabled_))return;e.activeSourceBuffers_.push(t)}))},e.onPlayerMediachange_=function(){e.sourceBuffers.forEach((function(e){e.appendAudioInitSegment_=!0}))},e.onHlsReset_=function(){e.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})}))},e.onHlsSegmentTimeMapping_=function(t){e.sourceBuffers.forEach((function(e){return e.timeMapping_=t.mapping}))},["sourceopen","sourceclose","sourceended"].forEach((function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))}),e),e.on("sourceopen",(function(t){var n=o.a.querySelector('[src="'+e.url_+'"]');n&&(e.player_=Ga(n.parentNode),e.player_&&(e.player_.tech_.on("hls-reset",e.onHlsReset_),e.player_.tech_.on("hls-segment-time-mapping",e.onHlsSegmentTimeMapping_),e.player_.audioTracks&&e.player_.audioTracks()&&(e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)),e.player_.on("mediachange",e.onPlayerMediachange_)))})),e.on("sourceended",(function(t){for(var n=Vo(e.duration),i=0;i<e.sourceBuffers.length;i++){var r=e.sourceBuffers[i],a=r.metadataTrack_&&r.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=n)}})),e.on("sourceclose",(function(e){this.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.terminate()})),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))})),e}return Xa(t,e),Ya(t,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=ls(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var i=[];n.parameters&&n.parameters.codecs&&(i=n.parameters.codecs.split(","),i=(i=rs(i)).filter((function(e){return us(e)||cs(e)}))),0===i.length&&(i=["avc1.4d400d","mp4a.40.2"]),t=new ds(this,i),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}},{key:"dispose",value:function(){this.trigger("dispose"),this.off(),this.sourceBuffers.forEach((function(e){e.dispose&&e.dispose()})),this.sourceBuffers.length=0}}]),t}(Ga.EventTarget),ps=0;Ga.mediaSources={};var ms=function(e,t){var n=Ga.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})},gs=function(){return!!r.a.MediaSource&&!!r.a.MediaSource.isTypeSupported&&r.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},vs=function(){if(this.MediaSource={open:ms,supportsNativeMediaSources:gs},gs())return new fs;throw new Error("Cannot use create a virtual MediaSource for this video")};vs.open=ms,vs.supportsNativeMediaSources=gs;var ys={createObjectURL:function(e){var t=void 0;return e instanceof fs?(t=r.a.URL.createObjectURL(e.nativeMediaSource_),e.url_=t,t):e instanceof fs?(t="blob:vjs-media-source/"+ps,ps++,Ga.mediaSources[t]=e,t):(t=r.a.URL.createObjectURL(e),e.url_=t,t)}};Ga.MediaSource=vs,Ga.URL=ys;var _s=Ga.EventTarget,bs=Ga.mergeOptions,Es=function(e,t){for(var n=void 0,i=bs(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0;r<t.playlists.length;r++){var a=to(i,t.playlists[r]);a?i=a:n=!0}return eo(t,(function(e,t,r,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].id,s=to(i,e.playlists[0]);s&&((i=s).mediaGroups[t][r][a].playlists[0]=i.playlists[o],n=!1)}})),n?null:i},Ts=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},ws=function(e,t){return(Boolean(!e.map&&!t.map)||Boolean(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length))&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length},xs=function(e,t){var n={};for(var i in e){var r=e[i].sidx;if(r){var a=Ts(r);if(!t[a])break;var o=t[a].sidxInfo;ws(o,r)&&(n[a]=t[a])}}return n},As=function(e,t,n,i,r){var a={uri:Wa(i.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return n(Ga.mergeOptions(a,{responseType:"arraybuffer",headers:Mo(a)}),r)},Ss=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];qa(this,t);var a=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=i.withCredentials,s=void 0!==o&&o,l=i.handleManifestRedirects,u=void 0!==l&&l;if(a.hls_=n,a.withCredentials=s,a.handleManifestRedirects=u,!e)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",(function(){a.refreshXml_()})),a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)})),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"==typeof e?(a.srcUrl=e,a.sidxMapping_={},Ka(a)):(a.setupChildLoader(r,e),a)}return Xa(t,e),Ya(t,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},r.a.clearTimeout(this.minimumUpdatePeriodTimeout_),r.a.clearTimeout(this.mediaRequest_),r.a.clearTimeout(this.mediaUpdateTimeout),this.off()}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,i){var r=this;return function(a,o){if(r.request){if(r.request=null,a)return r.error={status:o.status,message:"DASH playlist request error at URL: "+e.uri,response:o.response,code:2},n&&(r.state=n),r.trigger("error"),i(t,null);var s=new Uint8Array(o.response),l=Me.a.parseSidx(s.subarray(8));return i(t,l)}}}},{key:"media",value:function(e){var t=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"==typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}var i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(i&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(i)if(this.media_&&this.trigger("mediachanging"),e.sidx){var a=void 0,o=void 0;this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(a=this.master,o=this.sidxMapping_);var s=Ts(e.sidx);o[s]={sidxInfo:e.sidx},this.request=As(e.sidx,e,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(e,a,n,(function(i,r){if(!i||!r)throw new Error("failed to request sidx");o[s].sidx=r,t.haveMetadata({startingState:n,playlist:i.playlists[e.id]})})))}else this.mediaRequest_=r.a.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:e}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),r.a.clearTimeout(this.mediaUpdateTimeout),r.a.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(e){var t=this;r.a.clearTimeout(this.mediaUpdateTimeout),r.a.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var i=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=r.a.setTimeout((function(){return t.load()}),i)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=xe(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n}return eo(e,(function(t,n,i,r){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+n+"-"+i+"-"+r,o=no(0,a);t.playlists[0].uri=a,t.playlists[0].id=o,e.playlists[o]=t.playlists[0],e.playlists[a]=t.playlists[0]}})),io(e),ro(e),e}},{key:"start",value:function(){var e=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=r.a.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?e.masterLoaded_=Date.parse(n.responseHeaders.date):e.masterLoaded_=Date.now(),e.srcUrl=Wa(e.handleManifestRedirects,e.srcUrl,n),e.syncClientServerClock_(e.onClientServerClockSync_.bind(e))}}))}},{key:"syncClientServerClock_",value:function(e){var t=this,n=Ae(this.masterXml_);return null===n?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.clientOffset_=n.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:Va(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},(function(i,r){if(t.request){if(i)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a=void 0;a="HEAD"===n.method?r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):t.masterLoaded_:Date.parse(r.responseText),t.clientOffset_=a-Date.now(),e()}})))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=r.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var e=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,e.sidxMapping_=function(e,t,n,i){var r=xe(e,{manifestUri:t,clientOffset:n}),a=xs(r.playlists,i);return eo(r,(function(e,t,n,r){if(e.playlists&&e.playlists.length){var o=e.playlists;a=bs(a,xs(o,i))}})),a}(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var i=e.parseMasterXml(),a=Es(e.master,i),o=e.media().sidx;if(a)if(o){var s=Ts(o);if(!e.sidxMapping_[s]){var l=e.media();e.request=As(l.sidx,l,e.hls_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(l,i,e.state,(function(t,n){if(!t||!n)throw new Error("failed to request sidx on minimumUpdatePeriod");e.sidxMapping_[s].sidx=n,e.minimumUpdatePeriodTimeout_=r.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod),e.refreshMedia_(e.media().id)})))}}else e.master=a;e.minimumUpdatePeriodTimeout_=r.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod)}}))}},{key:"refreshMedia_",value:function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");var n=void 0,i=void 0;this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,i=this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,i=this.parseMasterXml());var a=Es(n,i);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[e]):(this.media_=i.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=r.a.setTimeout((function(){t.trigger("mediaupdatetimeout")}),ao(this.media(),!!a))),this.trigger("loadedplaylist")}}]),t}(_s),Ms=function(e){return Ga.log.debug?Ga.log.debug.bind(Ga,"VHS:",e+" >"):function(){}};function Cs(){}var Rs=function(){function e(t,n,i,r){qa(this,e),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,this.processedAppend_=!1,this.type_=i,this.mimeType_=n,this.logger_=Ms("SourceUpdater["+i+"]["+n+"]"),"closed"===t.readyState?t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,n,r)):this.createSourceBuffer_(n,r)}return Ya(e,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",(function(){n.start_()})):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+Go(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_((function(){t.sourceBuffer_.abort()}),e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_((function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)}),(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()}))}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:Ga.createTimeRanges()}},{key:"remove",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cs;this.processedAppend_&&this.queueCallback_((function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)}),i)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Cs}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_((function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()})),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){var e=this,t=function t(){e.sourceBuffer_&&"open"===e.mediaSource.readyState&&e.sourceBuffer_.abort(),e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",t):t()}}]),e}(),Is={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Ps=2,Ls=-101,Ds=-102,Os=function(e){e.forEach((function(e){e.abort()}))},Ns=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Ls,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Ds,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Ps,xhr:t}:null},ks=function(e,t,n){var i=0,r=!1;return function(a,o){if(!r)return a?(r=!0,Os(e),n(a,o)):(i+=1)===e.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?function(e,t,n){e.addEventListener("message",(function i(r){if(r.data.source===t.requestId){e.removeEventListener("message",i);var a=r.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),n(null,t)}}));var i=void 0;i=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(Po({source:t.requestId,encrypted:t.encryptedBytes,key:i,iv:t.key.iv}),[t.encryptedBytes.buffer,i.buffer])}(t,o,n):n(null,o)):void 0}},Fs=function(e,t){return function(n){var i,r,a;return e.stats=Ga.mergeOptions(e.stats,(r=(i=n).target,(a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-r.requestTime||0}).bytesReceived=i.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(n,e)}},Bs=function(e,t,n,i,r,a,o){var s=[],l=ks(s,n,o);if(r.key&&!r.key.bytes){var u=e(Ga.mergeOptions(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),function(e,t){return function(n,i){var r=i.response,a=Ns(n,i);if(a)return t(a,e);if(16!==r.byteLength)return t({status:i.status,message:"Invalid HLS key at URL: "+i.uri,code:Ps,xhr:i},e);var o=new DataView(r);return e.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),t(null,e)}}(r,l));s.push(u)}if(r.map&&!r.map.bytes){var c=e(Ga.mergeOptions(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Mo(r.map)}),function(e,t,n){return function(i,r){var a=r.response,o=Ns(i,r);return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Ps,xhr:r},e):(e.map.bytes=new Uint8Array(r.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=Re.a.timescale(e.map.bytes),e.map.videoTrackIds=Re.a.videoTrackIds(e.map.bytes),n(null,e))}}(r,i,l));s.push(c)}var h=e(Ga.mergeOptions(t,{uri:r.resolvedUri,responseType:"arraybuffer",headers:Mo(r)}),function(e,t,n){return function(i,r){var a=r.response,o=Ns(i,r),s=void 0;return o?n(o,e):0===a.byteLength?n({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Ps,xhr:r},e):(e.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(r),e.key?e.encryptedBytes=new Uint8Array(r.response):e.bytes=new Uint8Array(r.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),(s=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales))&&s.captions&&(e.captionStreams=s.captionStreams,e.fmp4Captions=s.captions)),n(null,e))}}(r,i,l));return h.addEventListener("progress",Fs(r,a)),s.push(h),function(){return Os(s)}},Us=function(e,t){var n;return e&&(n=r.a.getComputedStyle(e))?n[t]:""},js=function(e,t){var n=e.slice();e.sort((function(e,i){var r=t(e,i);return 0===r?n.indexOf(e)-n.indexOf(i):r}))},Gs=function(e,t){var n=void 0,i=void 0;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||r.a.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),n-(i=i||r.a.Number.MAX_VALUE)},zs=function(e,t,n){if(!e||!t)return!1;var i=n===e.segments.length;return e.endList&&"open"===t.readyState&&i},Hs=function(e){return"number"==typeof e&&isFinite(e)},Vs=function(e){function t(e){qa(this,t);var n=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return n.bandwidth=e.bandwidth,n.throughput={rate:0,count:0},n.roundTrip=NaN,n.resetStats_(),n.mediaIndex=null,n.hasPlayed_=e.hasPlayed,n.currentTime_=e.currentTime,n.seekable_=e.seekable,n.seeking_=e.seeking,n.duration_=e.duration,n.mediaSource_=e.mediaSource,n.hls_=e.hls,n.loaderType_=e.loaderType,n.startingMedia_=void 0,n.segmentMetadataTrack_=e.segmentMetadataTrack,n.goalBufferLength_=e.goalBufferLength,n.sourceType_=e.sourceType,n.inbandTextTracks_=e.inbandTextTracks,n.state_="INIT",n.checkBufferTimeout_=null,n.error_=void 0,n.currentTimeline_=-1,n.pendingSegment_=null,n.mimeType_=null,n.sourceUpdater_=null,n.xhrOptions_=null,n.activeInitSegmentId_=null,n.initSegments_={},n.cacheEncryptionKeys_=e.cacheEncryptionKeys,n.keyCache_={},"main"===n.loaderType_?n.captionParser_=new Pe.a:n.captionParser_=null,n.decrypter_=e.decrypter,n.syncController_=e.syncController,n.syncPoint_={segmentIndex:0,time:0},n.triggerSyncInfoUpdate_=function(){return n.trigger("syncinfoupdate")},n.syncController_.on("syncinfoupdate",n.triggerSyncInfoUpdate_),n.mediaSource_.addEventListener("sourceopen",(function(){return n.ended_=!1})),n.fetchAtBuffer_=!1,n.logger_=Ms("SegmentLoader["+n.loaderType_+"]"),Object.defineProperty(n,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),n}return Xa(t,e),Ya(t,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset(),this.checkBufferTimeout_&&r.a.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():Ga.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Lo(e),i=this.initSegments_[n];return t&&!i&&e.bytes&&(this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),i||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Do(e),i=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!i&&e.bytes&&(this.keyCache_[n]=i={resolvedUri:e.resolvedUri,bytes:e.bytes});var r={resolvedUri:(i||e).resolvedUri};return i&&(r.bytes=i.bytes),r}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new Rs(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=this.playlist_,i=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var r=null;if(n&&(n.id?r=n.id:n.uri&&(r=n.uri)),this.logger_("playlist update ["+r+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var a=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),i&&(i.mediaIndex-=a,i.mediaIndex>=0&&(i.segment=e.segments[i.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(r.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,1/0,e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),Ho(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)Ho(e,t,this.inbandTextTracks_[i])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&r.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=r.a.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&r.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=r.a.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_;return zs(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,i,r,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var l=Math.max(0,o-r);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!i&&l>=1)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n){t.segments[n];return s=o,this.generateSegmentInfo_(t,n+1,s,!1)}if(this.fetchAtBuffer_){var u=wo.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=u.mediaIndex,s=u.startTime}else{var c=wo.getMediaInfoForTime(t,r,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map((function(e,t){return{timeline:e.timeline,segmentIndex:t}})).filter((function(e){return e.timeline===t.currentTimeline_}));return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,i){if(t<0||t>=e.segments.length)return null;var r=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:t,isSyncRequest:i,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,i=this.pendingSegment_.duration,r=wo.estimateSegmentRequestTime(i,n,this.playlist_,e.bytesReceived),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.length?e.end(e.length-1):0;return(i-t)/n}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(r<=a)return!1;var o=function(e){var t=e.master,n=e.currentTime,i=e.bandwidth,r=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,l=e.syncController,u=t.playlists.filter((function(e){return!wo.isIncompatible(e)})),c=u.filter(wo.isEnabled);c.length||(c=u.filter((function(e){return!wo.isDisabled(e)})));var h=c.filter(wo.hasAttribute.bind(null,"BANDWIDTH")).map((function(e){var t=l.getSyncPoint(e,r,s,n)?1:2;return{playlist:e,rebufferingImpact:wo.estimateSegmentRequestTime(a,i,e)*t-o}})),d=h.filter((function(e){return e.rebufferingImpact<=0}));return js(d,(function(e,t){return Gs(t.playlist,e.playlist)})),d.length?d[0]:(js(h,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact})),h[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:i,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=r-a-o.rebufferingImpact,l=.5;return a<=1/30&&(l=1),!o.playlist||o.playlist.uri===this.playlist_.uri||s<l?!1:(this.bandwidth=o.playlist.attributes.BANDWIDTH*Is.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Bs(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=function(e,t,n){var i=t-30;e.length&&(i=Math.max(i,e.start(0)));var r=t-n;return Math.min(r,i)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=i}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===Ds?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===Ls?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(!function(e,t,n){for(var i in n)if(!e[i]){t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(i);e[i]=r||t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var t=e.inbandTextTracks,n=e.captionArray,i=e.timestampOffset;if(n){var r=window.WebKitDataCue||window.VTTCue;n.forEach((function(e){var n=e.stream,a=e.startTime,o=e.endTime;t[n]&&(a+=i,o+=i,t[n].addCue(new r(a,o,e.text)))}))}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,n=t.segment,i=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&i&&(i.containsAudio||i.containsVideo)&&(this.startingMedia_={containsAudio:i.containsAudio,containsVideo:i.containsVideo});var r,a,o,s=(r=this.loaderType_,a=this.startingMedia_,o=i,"main"===r&&a&&o?o.containsAudio||o.containsVideo?a.containsVideo&&!o.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!a.containsVideo&&o.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(s)return this.error({message:s,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(i&&i.segmentTimestampInfo){var l=i.segmentTimestampInfo[0].ptsTime,u=i.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=l-u}this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset")}var c=this.syncController_.mappingForTimeline(t.timeline);if(null!==c&&this.trigger({type:"segmenttimemapping",mapping:c}),this.state="APPENDING",n.map){var h=Lo(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==h){var d=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:d.bytes},(function(){e.activeInitSegmentId_=h}))}}t.byteLength=t.bytes.byteLength,"number"==typeof n.start&&"number"==typeof n.end?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(function(e){var t=e.segment,n=t.start,i=t.end,r=e.playlist,a=r.mediaSequence,o=r.id,s=r.segments,l=void 0===s?[]:s,u=e.mediaIndex,c=e.timeline;return["appending ["+u+"] of ["+a+", "+(a+l.length)+"] from playlist ["+o+"]","["+n+" => "+i+"] in timeline ["+c+"]"].join(" ")}(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,i=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(i-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,i=t.end;if(Hs(n)&&Hs(i)){Ho(n,i,this.segmentMetadataTrack_);var a=r.a.WebKitDataCue||r.a.VTTCue,o={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:i},s=new a(n,i,JSON.stringify(o));s.value=o,this.segmentMetadataTrack_.addCue(s)}}}}]),t}(Ga.EventTarget),Ws=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},qs=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)}))),Ys=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qa(this,t);var i=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.mediaSource_=null,i.subtitlesTrack_=null,i.featuresNativeTextTracks_=e.featuresNativeTextTracks,i}return Xa(t,e),Ya(t,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return Ga.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return Ga.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Lo(e),i=this.initSegments_[n];if(t&&!i&&e.bytes){var r=qs.byteLength+e.bytes.byteLength,a=new Uint8Array(r);a.set(e.bytes),a.set(qs,e.bytes.byteLength),this.initSegments_[n]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){Ho(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){return this.syncController_.one("timestampoffset",(function(){e.state="READY",e.paused()||e.monitorBuffer_()})),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var t=this.pendingSegment_,n=t.segment;if("function"!=typeof r.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var i=void 0,a=function(){e.subtitlesTrack_.tech_.off("vttjsloaded",i),e.error({message:"Error loading vtt.js"}),e.state="READY",e.pause(),e.trigger("error")};return i=function(){e.subtitlesTrack_.tech_.off("vttjserror",a),e.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",i),void this.subtitlesTrack_.tech_.one("vttjserror",a)}n.requested=!0;try{this.parseVTTCues_(t)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(t,this.syncController_.timelines[t.timeline],this.playlist_),t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,t.cues.length&&this.remove(t.cues[0].endTime,t.cues[t.cues.length-1].endTime),t.cues.forEach((function(t){e.subtitlesTrack_.addCue(e.featuresNativeTextTracks_?new r.a.VTTCue(t.startTime,t.endTime,t.text):t)})),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(e){var t=void 0,n=!1;"function"==typeof r.a.TextDecoder?t=new r.a.TextDecoder("utf8"):(t=r.a.WebVTT.StringDecoder(),n=!0);var i=new r.a.WebVTT.Parser(r.a,r.a.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},i.oncue=e.cues.push.bind(e.cues),i.ontimestampmap=function(t){return e.timestampmap=t},i.onparsingerror=function(e){Ga.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){var a=e.segment.map.bytes;n&&(a=Ws(a)),i.parse(a)}var o=e.bytes;n&&(o=Ws(o)),i.parse(o),i.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var i=e.segment;if(t)if(e.cues.length){var r=e.timestampmap,a=r.MPEGTS/9e4-r.LOCAL+t.mapping;if(e.cues.forEach((function(e){e.startTime+=a,e.endTime+=a})),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-i.duration)}}}else i.empty=!0}}]),t}(Vs),Xs=function(e,t){for(var n=e.cues,i=0;i<n.length;i++){var r=n[i];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null},Ks=De.a.inspect,Qs=[{name:"VOD",run:function(e,t,n,i,r){if(n!==1/0){return{time:0,segmentIndex:0}}return null}},{name:"ProgramDateTime",run:function(e,t,n,i,r){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,h=Math.abs(r-c);if(null!==s&&(0===h||s<h))break;s=h,o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,n,i,r){var a=t.segments||[],o=null,s=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===i&&void 0!==u.start){var c=Math.abs(r-u.start);if(null!==s&&s<c)break;(!o||null===s||s>=c)&&(s=c,o={time:u.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(e,t,n,i,r){var a=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var l=t.discontinuityStarts[s],u=t.discontinuitySequence+s+1,c=e.discontinuities[u];if(c){var h=Math.abs(r-c.time);if(null!==o&&o<h)break;(!a||null===o||o>=h)&&(o=h,a={time:c.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t,n,i,r){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],Zs=function(e){function t(){qa(this,t);var e=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Ms("SyncController"),e}return Xa(t,e),Ya(t,[{key:"getSyncPoint",value:function(e,t,n,i){var r=this.runStrategies_(e,t,n,i);return r.length?this.selectSyncPoint_(r,{key:"time",value:i}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var i=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return i.segmentIndex>0&&(i.time*=-1),Math.abs(i.time+co(e,i.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,i){for(var r=[],a=0;a<Qs.length;a++){var o=Qs[a],s=o.run(this,e,t,n,i);s&&(s.strategy=o.name,r.push({strategy:o.name,syncPoint:s}))}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,i=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<i&&(i=o,n=e[a].syncPoint,r=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+r+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;n>=0;n--){var i=e.segments[n];if(i&&void 0!==i.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:i.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,n=e.playlist,i=void 0;return(i=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,i)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:t.start})),i}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Re.a.timescale(t.map.bytes),i=Re.a.compositionStartTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=i),{start:i,end:i+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Ks(e.bytes,this.inspectCache_),n=void 0,i=void 0,r=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,i=t.video[1].dtsTime,r=t.video):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,i=t.audio[1].dtsTime,r=t.audio),{segmentTimestampInfo:r,start:n,end:i,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,i=this.timelines[e.timeline];if(null!==e.timestampOffset)i={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=i,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+i.time+"] [mapping: "+i.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+i.mapping;else{if(!i)return!1;n.start=t.start+i.mapping,n.end=t.end+i.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var i=0;i<t.discontinuityStarts.length;i++){var r=t.discontinuityStarts[i],a=t.discontinuitySequence+i+1,o=r-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var l=void 0;l=o<0?n.start-co(t,e.mediaIndex,r):n.end+co(t,e.mediaIndex+1,r),this.discontinuities[a]={time:l,accuracy:s}}}}},{key:"dispose",value:function(){this.trigger("dispose"),this.off()}}]),t}(Ga.EventTarget),Js=new Zo("./decrypter-worker.worker.js",(function(e,t){var n=this;!function(){var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=null,r=function(){function t(n){e(this,t),i||(i=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],i=t[4],r=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,h=void 0,d=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!i[o];o^=c||1,s=u[s]||1)for(d=(d=s^s<<1^s<<2^s<<3^s<<4)>>8^255&d^99,i[o]=d,r[d]=o,p=16843009*l[h=l[c=l[o]]]^65537*h^257*c^16843008*o,f=257*l[d]^16843008*d,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][d]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];var r=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=this._tables[0][4],c=this._tables[1],h=n.length,d=1;if(4!==h&&6!==h&&8!==h)throw new Error("Invalid aes key size");for(s=n.slice(0),l=[],this._key=[s,l],r=h;r<4*h+28;r++)o=s[r-1],(r%h==0||8===h&&r%h==4)&&(o=u[o>>>24]<<24^u[o>>16&255]<<16^u[o>>8&255]<<8^u[255&o],r%h==0&&(o=o<<8^o>>>24^d<<24,d=d<<1^283*(d>>7))),s[r]=s[r-h]^o;for(a=0;r;a++,r--)o=s[3&a?r:r-4],l[a]=r<=4||a<4?o:c[0][u[o>>>24]]^c[1][u[o>>16&255]]^c[2][u[o>>8&255]]^c[3][u[255&o]]}return t.prototype.decrypt=function(e,t,n,i,r,a){var o=this._key[1],s=e^o[0],l=i^o[1],u=n^o[2],c=t^o[3],h=void 0,d=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)h=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^E[255&c]^o[g],d=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&l]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^E[255&u]^o[g+3],g+=4,s=h,l=d,u=f;for(m=0;m<4;m++)r[(3&-m)+a]=T[s>>>24]<<24^T[l>>16&255]<<16^T[u>>8&255]<<8^T[255&c]^o[g++],h=s,s=l,l=u,u=c,c=h},t}(),a=function(){function t(){e(this,t),this.listeners={}}return t.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,r)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},t}(),o=function(t){function n(){e(this,n);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,a));return i.jobs=[],i.delay=1,i.timeout_=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),n.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},n.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},n}(a),s=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},l=function(){function n(t,i,r,a){e(this,n);var l=n.STEP,u=new Int32Array(t.buffer),c=new Uint8Array(t.byteLength),h=0;for(this.asyncStream_=new o,this.asyncStream_.push(this.decryptChunk_(u.subarray(h,h+l),i,r,c)),h=l;h<u.length;h+=l)r=new Uint32Array([s(u[h-4]),s(u[h-3]),s(u[h-2]),s(u[h-1])]),this.asyncStream_.push(this.decryptChunk_(u.subarray(h,h+l),i,r,c));this.asyncStream_.push((function(){var e;a(null,(e=c).subarray(0,e.byteLength-e[e.byteLength-1]))}))}return n.prototype.decryptChunk_=function(e,t,n,i){return function(){var a=function(e,t,n){var i=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),a=new r(Array.prototype.slice.call(t)),o=new Uint8Array(e.byteLength),l=new Int32Array(o.buffer),u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;for(u=n[0],c=n[1],h=n[2],d=n[3],v=0;v<i.length;v+=4)f=s(i[v]),p=s(i[v+1]),m=s(i[v+2]),g=s(i[v+3]),a.decrypt(f,p,m,g,l,v),l[v]=s(l[v]^u),l[v+1]=s(l[v+1]^c),l[v+2]=s(l[v+2]^h),l[v+3]=s(l[v+3]^d),u=f,c=p,h=m,d=g;return o}(e,t,n);i.set(a,e.byteOffset)}},t(n,null,[{key:"STEP",get:function(){return 32e3}}]),n}();new function(e){e.onmessage=function(t){var n=t.data,i=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),r=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),a=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new l(i,r,a,(function(t,i){var r,a;e.postMessage((r={source:n.source,decrypted:i},a={},Object.keys(r).forEach((function(e){var t=r[e];ArrayBuffer.isView(t)?a[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:a[e]=t})),a),[i.buffer])}))}}(n)}()})),$s=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},el=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},tl=function(e,t){t.activePlaylistLoader=e,e.load()},nl={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e],r=t.blacklistCurrentPlaylist;el(n,i);var a=i.activeTrack(),o=i.activeGroup(),s=(o.filter((function(e){return e.default}))[0]||o[0]).id,l=i.tracks[s];if(a!==l){for(var u in Ga.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[u].enabled=i.tracks[u]===l;i.onTrackChanged()}else r({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],i=t.mediaTypes[e];Ga.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),el(n,i);var r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}}},il={AUDIO:function(e,t,n){if(t){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,r),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),r),i.paused()||a.load()})),t.on("error",nl[e](e,n))}},SUBTITLES:function(e,t,n){var i=n.tech,r=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,r),a.track(o.activeTrack()),(!i.paused()||e.endList&&"none"!==i.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),r),i.paused()||a.load()})),t.on("error",nl[e](e,n))}},rl={AUDIO:function(e,t){var n=t.hls,i=t.sourceType,r=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],l=s.groups,u=s.tracks,c=t.masterPlaylistLoader;for(var h in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var d in l[h]||(l[h]=[]),o[e][h]){var f=o[e][h][d],p=void 0;if(p=f.resolvedUri?new oo(f.resolvedUri,n,a):f.playlists&&"dash"===i?new Ss(f.playlists[0],n,a,c):null,f=Ga.mergeOptions({id:d,playlistLoader:p},f),il[e](e,f.playlistLoader,t),l[h].push(f),void 0===u[d]){var m=new Ga.AudioTrack({id:d,kind:$s(f),enabled:!1,language:f.language,default:f.default,label:d});u[d]=m}}r.on("error",nl[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,i=t.hls,r=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,h=t.masterPlaylistLoader;for(var d in s[e])for(var f in u[d]||(u[d]=[]),s[e][d])if(!s[e][d][f].forced){var p=s[e][d][f],m=void 0;if("hls"===r?m=new oo(p.resolvedUri,i,o):"dash"===r&&(m=new Ss(p.playlists[0],i,o,h)),p=Ga.mergeOptions({id:f,playlistLoader:m},p),il[e](e,p.playlistLoader,t),u[d].push(p),void 0===c[f]){var g=n.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;c[f]=g}}a.on("error",nl[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,i=t.master.mediaGroups,r=t.mediaTypes[e],a=r.groups,o=r.tracks;for(var s in i[e])for(var l in a[s]||(a[s]=[]),i[e][s]){var u=i[e][s][l];if(u.instreamId.match(/CC\d/)&&(a[s].push(Ga.mergeOptions({id:l},u)),void 0===o[l])){var c=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;o[l]=c}}}},al={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if(n[i].enabled)return n[i];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var i in n)if("showing"===n[i].mode||"hidden"===n[i].mode)return n[i];return null}}},ol=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){rl[t](t,e)}));var t=e.mediaTypes,n=e.masterPlaylistLoader,i=e.tech,r=e.hls;["AUDIO","SUBTITLES"].forEach((function(n){t[n].activeGroup=function(e,t){return function(n){var i=t.masterPlaylistLoader,r=t.mediaTypes[e].groups,a=i.media();if(!a)return null;var o=null;return a.attributes[e]&&(o=r[a.attributes[e]]),o=o||r.main,void 0===n?o:null===n?null:o.filter((function(e){return e.id===n.id}))[0]||null}}(n,e),t[n].activeTrack=al[n](n,e),t[n].onGroupChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;el(i,a),s&&(s.playlistLoader?(i.resyncLoader(),tl(s.playlistLoader,a)):l&&r.resetEverything())}}(n,e),t[n].onTrackChanged=function(e,t){return function(){var n=t.segmentLoaders,i=n[e],r=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),l=a.activePlaylistLoader;el(i,a),s&&(s.playlistLoader?l!==s.playlistLoader?(i.track&&i.track(o),i.resetEverything(),tl(s.playlistLoader,a)):tl(s.playlistLoader,a):r.resetEverything())}}(n,e)}));var a=t.AUDIO.activeGroup(),o=(a.filter((function(e){return e.default}))[0]||a[0]).id;t.AUDIO.tracks[o].enabled=!0,t.AUDIO.onTrackChanged(),n.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanged()}))}));var s=function(){t.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"hls-audio-change"})};for(var l in i.audioTracks().addEventListener("change",s),i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),r.on("dispose",(function(){i.audioTracks().removeEventListener("change",s),i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)})),i.clearTracks("audio"),t.AUDIO.tracks)i.audioTracks().addTrack(t.AUDIO.tracks[l])},sl=void 0,ll=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],ul=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},cl=function(e){function t(e){qa(this,t);var n,i=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=e.url,a=e.handleManifestRedirects,o=e.withCredentials,s=e.tech,l=e.bandwidth,u=e.externHls,c=e.useCueTags,h=e.blacklistDuration,d=e.enableLowInitialPlaylist,f=e.cacheEncryptionKeys,p=e.sourceType;if(!r)throw new Error("A non-empty playlist URL is required");sl=u,i.withCredentials=o,i.tech_=s,i.hls_=s.hls,i.sourceType_=p,i.useCueTags_=c,i.blacklistDuration=h,i.enableLowInitialPlaylist=d,i.useCueTags_&&(i.cueTagsTrack_=i.tech_.addTextTrack("metadata","ad-cues"),i.cueTagsTrack_.inBandMetadataTrackDispatchType=""),i.requestOptions_={withCredentials:o,handleManifestRedirects:a,timeout:null},i.mediaTypes_=(n={},["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){n[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Cs,activeTrack:Cs,onGroupChanged:Cs,onTrackChanged:Cs}})),n),i.mediaSource=new Ga.MediaSource,i.mediaSource.addEventListener("sourceopen",i.handleSourceOpen_.bind(i)),i.seekable_=Ga.createTimeRanges(),i.hasPlayed_=!1,i.syncController_=new Zs(e),i.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,i.decrypter_=new Js,i.inbandTextTracks_={};var m={hls:i.hls_,mediaSource:i.mediaSource,currentTime:i.tech_.currentTime.bind(i.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},duration:function(){return i.mediaSource.duration},hasPlayed:function(){return i.hasPlayed_},goalBufferLength:function(){return i.goalBufferLength()},bandwidth:l,syncController:i.syncController_,decrypter:i.decrypter_,sourceType:i.sourceType_,inbandTextTracks:i.inbandTextTracks_,cacheEncryptionKeys:f};return i.masterPlaylistLoader_="dash"===i.sourceType_?new Ss(r,i.hls_,i.requestOptions_):new oo(r,i.hls_,i.requestOptions_),i.setupMasterPlaylistLoaderListeners_(),i.mainSegmentLoader_=new Vs(Ga.mergeOptions(m,{segmentMetadataTrack:i.segmentMetadataTrack_,loaderType:"main"}),e),i.audioSegmentLoader_=new Vs(Ga.mergeOptions(m,{loaderType:"audio"}),e),i.subtitleSegmentLoader_=new Ys(Ga.mergeOptions(m,{loaderType:"vtt",featuresNativeTextTracks:i.tech_.featuresNativeTextTracks}),e),i.setupSegmentLoaderListeners_(),ll.forEach((function(e){i[e+"_"]=ul.bind(i,e)})),i.logger_=Ms("MPC"),i.masterPlaylistLoader_.load(),i}return Xa(t,e),Ya(t,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;To(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),ol({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(t){return Ga.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))})),this.masterPlaylistLoader_.on("loadedplaylist",(function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;return e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var i=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};if(e.duration()!==1/0){e.tech_.one("durationchange",(function t(){e.duration()===1/0?i():e.tech_.one("durationchange",t)}))}else i()}})),this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)})),this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()})),this.masterPlaylistLoader_.on("mediachange",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;To(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})})),this.masterPlaylistLoader_.on("playlistunchanged",(function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))})),this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})})),this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},i=!0,r=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){n.AUDIO[a][o].uri||(i=!1)}i&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),sl.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),sl.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.length&&Object.keys(n.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",(function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),i=e.tech_.buffered();(function(e){var t=e.currentPlaylist,n=e.nextPlaylist,i=e.forwardBuffer,r=e.bufferLowWaterLine,a=e.duration;e.log;return n?!t.endList||(a<Is.MAX_BUFFER_LOW_WATER_LINE||(n.attributes.BANDWIDTH<t.attributes.BANDWIDTH||i>=r)):(Ga.log.warn("We received no playlist to switch to. Please check your stream."),!1)})({currentPlaylist:n,nextPlaylist:t,forwardBuffer:i.length?i.end(i.length-1)-e.tech_.currentTime():0,bufferLowWaterLine:e.bufferLowWaterLine(),duration:e.duration(),log:e.logger_})&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")})),this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("ended",(function(){e.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)})),this.mainSegmentLoader_.on("reseteverything",(function(){e.tech_.trigger("hls-reset")})),this.mainSegmentLoader_.on("segmenttimemapping",(function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})})),this.audioSegmentLoader_.on("ended",(function(){e.onEndOfStream()}))}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything((function(){Ga.browser.IE_VERSION||Ga.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())})))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(Ga.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0})),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return Ga.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,(function(e){}))}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){Ga.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var n=sl.Playlist.playlistEnd(e,t),i=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return n-i<=.1;var a=r.end(r.length-1);return a-i<=.1&&n-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,i=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(bo).length,a=this.masterPlaylistLoader_.master.playlists;return 1===a.length?(Ga.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(r)):(r&&(Ga.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),a.forEach((function(e){e.excludeUntil!==1/0&&delete e.excludeUntil})),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),i=this.selectPlaylist(),Ga.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(i,r))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Uo(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:sl.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var n=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(null!==n){var i=this.masterPlaylistLoader_.master.suggestedPresentationDelay,r=sl.Playlist.seekable(t,n,i);if(0!==r.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(t,this.mediaSource.duration)))return;if(0===(e=sl.Playlist.seekable(t,n,i)).length)return}var a=void 0,o=void 0;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>r.end(0)||r.start(0)>e.end(0)?this.seekable_=r:this.seekable_=Ga.createTimeRanges([[e.start(0)>r.start(0)?e.start(0):r.start(0),e.end(0)<r.end(0)?e.end(0):r.end(0)]]):this.seekable_=r,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===o||(this.logger_("seekable updated ["+Go(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=sl.Playlist.duration(this.masterPlaylistLoader_.media()),i=this.tech_.buffered(),r=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(e){Ga.log.warn("Failed to set media source duration",e)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};i.length>0&&(n=Math.max(n,i.end(i.length-1))),t!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",r):r())}},{key:"dispose",value:function(){var e=this;this.trigger("dispose"),this.decrypter_&&this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach((function(t){var n=e.mediaTypes_[t].groups;for(var i in n)n[i].forEach((function(e){e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.off(),this.mediaSource.dispose&&this.mediaSource.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=ss(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new Ga.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach((function(e){var t;e.attributes.CODECS&&r.a.MediaSource&&r.a.MediaSource.isTypeSupported&&!r.a.MediaSource.isTypeSupported('video/mp4; codecs="'+(t=e.attributes.CODECS,t.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return rs([e])[0]}))+'"'))&&(e.excludeUntil=1/0)}))}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,i=void 0;e.attributes.CODECS&&(i=as(e.attributes.CODECS),n=i.videoCodec,t=i.codecCount),this.master().playlists.forEach((function(e){var i={codecCount:2,videoCodec:null};e.attributes.CODECS&&(i=as(e.attributes.CODECS)),i.codecCount!==t&&(e.excludeUntil=1/0),i.videoCodec!==n&&(e.excludeUntil=1/0)}))}},{key:"updateAdCues_",value:function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.segments)for(var i=n,a=void 0,o=0;o<e.segments.length;o++){var s=e.segments[o];if(a||(a=Xs(t,i+s.duration/2)),a){if("cueIn"in s){a.endTime=i,a.adEndTime=i,i+=s.duration,a=null;continue}if(i<a.endTime){i+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&((a=new r.a.VTTCue(i,i+s.duration,s.cueOut)).adStartTime=i,a.adEndTime=i+parseFloat(s.cueOut),t.addCue(a)),"cueOutCont"in s){var l=void 0,u=void 0,c=s.cueOutCont.split("/").map(parseFloat),h=Qa(c,2);l=h[0],u=h[1],(a=new r.a.VTTCue(i,i+s.duration,"")).adStartTime=i-l,a.adEndTime=a.adStartTime+u,t.addCue(a)}i+=s.duration}}(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Is.GOAL_BUFFER_LENGTH,n=Is.GOAL_BUFFER_LENGTH_RATE,i=Math.max(t,Is.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,i)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Is.BUFFER_LOW_WATER_LINE,n=Is.BUFFER_LOW_WATER_LINE_RATE,i=Math.max(t,Is.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,i)}}]),t}(Ga.EventTarget),hl=function e(t,n,i){qa(this,e);var r,a,o,s=t.masterPlaylistController_,l=s[(t.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(s);if(n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION;this.width=u.width,this.height=u.height}this.bandwidth=n.attributes.BANDWIDTH,this.id=i,this.enabled=(r=t.playlists,a=n.id,o=l,function(e){var t=r.master.playlists[a],n=_o(t),i=bo(t);return void 0===e?i:(e?delete t.disabled:t.disabled=!0,e===i||n||(o(),e?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),e)})},dl=["seeking","seeked","pause","playing","error"],fl=function(){function e(t){var n=this;qa(this,e),this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Ms("PlaybackWatcher"),this.logger_("initialize");var i=function(){return n.monitorCurrentTime_()},a=function(){return n.techWaiting_()},o=function(){return n.cancelTimer_()},s=function(){return n.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",a),this.tech_.on(dl,o),this.tech_.on("canplay",i),this.dispose=function(){n.logger_("dispose"),n.tech_.off("seekablechanged",s),n.tech_.off("waiting",a),n.tech_.off(dl,o),n.tech_.off("canplay",i),n.checkCurrentTimeTimeout_&&r.a.clearTimeout(n.checkCurrentTimeTimeout_),n.cancelTimer_()}}return Ya(e,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&r.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=r.a.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=void 0;this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(n=e.end(e.length-1));this.beforeSeekableWindow_(e,t)&&(n=e.start(0)+.1);return void 0!==n&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Go(e)+". Seeking to "+n+"."),this.tech_.setCurrentTime(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Uo(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var i=this.tech_.buffered(),r=jo(i,t);if(this.videoUnderflow_(r,i,t))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(r.length>0){var a=r.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+r.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;var r=e.end(e.length-1)+.1,a=!n.endList;return a&&i&&(r=e.end(e.length-1)+3*n.targetDuration),t>r}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var i=this.gapFromVideoUnderflow_(t,n);if(i)return this.logger_("Encountered a gap in video from "+i.start+" to "+i.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),i=jo(t,n);this.cancelTimer_(),0!==i.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",i.start(0)),this.tech_.setCurrentTime(i.start(0)+1/30),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=function(e){if(e.length<2)return Ga.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var i=e.end(n-1),r=e.start(n);t.push([i,r])}return Ga.createTimeRanges(t)}(e),i=0;i<n.length;i++){var r=n.start(i),a=n.end(i);if(t-r<4&&t-r>2)return{start:r,end:a}}return null}}]),e}(),pl={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},ml=function(e){!function e(t,n){var i=0,r=0,a=Ga.mergeOptions(pl,n);t.ready((function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var o=function(){r&&t.currentTime(r)},s=function(e){null!=e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},l=function(){if(Date.now()-i<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return i=Date.now(),a.getSource.call(t,s);Ga.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},u=function e(){t.off("loadedmetadata",o),t.off("error",l),t.off("dispose",e)};t.on("error",l),t.on("dispose",u),t.reloadSourceOnError=function(n){u(),e(t,n)}}(this,e)},gl={PlaylistLoader:oo,Playlist:wo,Decrypter:ze,AsyncStream:Ue,decrypt:Ge,utils:No,STANDARD_PLAYLIST_SELECTOR:function(){var e=this.useDevicePixelRatio&&r.a.devicePixelRatio||1;return function(e,t,n,i,a){var o=e.playlists.map((function(e){var t,n;return t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,{bandwidth:e.attributes.BANDWIDTH||r.a.Number.MAX_VALUE,width:t,height:n,playlist:e}}));js(o,(function(e,t){return e.bandwidth-t.bandwidth}));var s=(o=o.filter((function(e){return!wo.isIncompatible(e.playlist)}))).filter((function(e){return wo.isEnabled(e.playlist)}));s.length||(s=o.filter((function(e){return!wo.isDisabled(e.playlist)})));var l=s.filter((function(e){return e.bandwidth*Is.BANDWIDTH_VARIANCE<t})),u=l[l.length-1],c=l.filter((function(e){return e.bandwidth===u.bandwidth}))[0];if(!1===a){var h=c||s[0]||o[0];return h?h.playlist:null}var d=l.filter((function(e){return e.width&&e.height}));js(d,(function(e,t){return e.width-t.width}));var f=d.filter((function(e){return e.width===n&&e.height===i}));u=f[f.length-1];var p=f.filter((function(e){return e.bandwidth===u.bandwidth}))[0],m=void 0,g=void 0,v=void 0;p||(g=(m=d.filter((function(e){return e.width>n||e.height>i}))).filter((function(e){return e.width===m[0].width&&e.height===m[0].height})),u=g[g.length-1],v=g.filter((function(e){return e.bandwidth===u.bandwidth}))[0]);var y=v||p||c||s[0]||o[0];return y?y.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(Us(this.tech_.el(),"width"),10)*e,parseInt(Us(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(wo.isEnabled);return js(e,(function(e,t){return Gs(e,t)})),e.filter((function(e){return as(e.attributes.CODECS).videoCodec}))[0]||null},comparePlaylistBandwidth:Gs,comparePlaylistResolution:function(e,t){var n=void 0,i=void 0;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||r.a.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),n===(i=i||r.a.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-i},xhr:So()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach((function(e){Object.defineProperty(gl,e,{get:function(){return Ga.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Is[e]},set:function(t){Ga.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?Ga.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Is[e]=t}})}));var vl=function(e){if(/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e))return"hls";return/^application\/dash\+xml/i.test(e)?"dash":null},yl=function(e,t){for(var n=t.media(),i=-1,r=0;r<e.length;r++)if(e[r].id===n.id){i=r;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})};gl.canPlaySource=function(){return Ga.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var _l=function(e){var t=e.masterPlaylistController_.mainSegmentLoader_,n=e.masterPlaylistController_.audioSegmentLoader_,i=Ga.players[e.tech_.options_.playerId];if(i.eme){var r=function(e,t,n){if(!e)return e;var i=void 0,r=void 0;if(n.mimeType_)i=t.mimeType_,r=n.mimeType_;else{var a=ls(t.mimeType_),o=a.parameters.codecs.split(","),s=void 0,l=void 0;o.forEach((function(e){e=e.trim(),us(e)?s=e:cs(e)&&(l=e)})),i=a.type+'; codecs="'+l+'"',r=a.type.replace("video","audio")+'; codecs="'+s+'"'}var u={},c=t.playlist_;for(var h in e)u[h]={audioContentType:r,videoContentType:i},c.contentProtection&&c.contentProtection[h]&&c.contentProtection[h].pssh&&(u[h].pssh=c.contentProtection[h].pssh),"string"==typeof e[h]&&(u[h].url=e[h]);return Ga.mergeOptions(e,u)}(e.source_.keySystems,t,n);r&&(i.currentSource().keySystems=r,11!==Ga.browser.IE_VERSION&&i.eme.initializeMediaKeys&&i.eme.initializeMediaKeys())}},bl=function(){if(!window.localStorage)return null;var e=window.localStorage.getItem("videojs-vhs");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};gl.supportsNativeHls=function(){var e=o.a.createElement("video");if(!Ga.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}(),gl.supportsNativeDash=!!Ga.getTech("Html5").isSupported()&&/maybe|probably/i.test(o.a.createElement("video").canPlayType("application/dash+xml")),gl.supportsTypeNatively=function(e){return"hls"===e?gl.supportsNativeHls:"dash"===e&&gl.supportsNativeDash},gl.isSupported=function(){return Ga.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var El=function(e){function t(e,n,i){qa(this,t);var r=Ka(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,i.hls));if(n.options_&&n.options_.playerId){var a=Ga(n.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return Ga.log.warn("player.hls is deprecated. Use player.tech().hls instead."),n.trigger({type:"usage",name:"hls-player-access"}),r},configurable:!0}),a.vhs=r,a.dash=r,r.player_=a}if(r.tech_=n,r.source_=e,r.stats={},r.ignoreNextSeekingEvent_=!1,r.setOptions_(),r.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(r.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return r.on(o.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=o.a.fullscreenElement||o.a.webkitFullscreenElement||o.a.mozFullScreenElement||o.a.msFullscreenElement;t&&t.contains(r.tech_.el())&&r.masterPlaylistController_.smoothQualityChange_()})),r.on(r.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),r.on(r.tech_,"error",(function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()})),r.on(r.tech_,"play",r.play),r}return Xa(t,e),Ya(t,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=bl();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Is.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Is.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach((function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=gl,this.options_.sourceType=vl(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e)},this.masterPlaylistController_=new cl(this.options_),this.playbackWatcher_=new fl(Ga.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",(function(){Ga.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)})),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):gl.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=gl.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;return t=this.throughput>0?1/this.throughput:0,Math.floor(1/(e+t))},set:function(){Ga.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return zo(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return zo(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",(function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(!window.localStorage)return!1;var t=bl();t=t?Ga.mergeOptions(t,e):e;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(t))}catch(e){return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})})),this.masterPlaylistController_.on("selectedinitialmedia",(function(){var e,t;t=(e=n).playlists,e.representations=function(){return t&&t.master&&t.master.playlists?t.master.playlists.filter((function(e){return!_o(e)})).map((function(t,n){return new hl(e,t,t.id)})):[]},_l(n)})),this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&this.tech_.src(Ga.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=Ga.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",(function(){var t,n;t=e.qualityLevels_,(n=e).representations().forEach((function(e){t.addQualityLevel(e)})),yl(t,n.playlists)})),this.playlists.on("mediachange",(function(){yl(e.qualityLevels_,e.playlists)})))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return ko({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return Fo({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:i,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),t}(Ga.getComponent("Component")),Tl={name:"videojs-http-streaming",VERSION:"1.13.2",canHandleSource:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ga.mergeOptions(Ga.options,t);return Tl.canPlayType(e.type,n)},handleSource:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Ga.mergeOptions(Ga.options,n);return t.hls=new El(e,t,i),t.hls.xhr=So(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ga.mergeOptions(Ga.options,t),i=n.hls.overrideNative,r=vl(e),a=r&&(!gl.supportsTypeNatively(r)||i);return a?"maybe":""}};void 0!==Ga.MediaSource&&void 0!==Ga.URL||(Ga.MediaSource=vs,Ga.URL=ys),vs.supportsNativeMediaSources()&&Ga.getTech("Html5").registerSourceHandler(Tl,0),Ga.HlsHandler=El,Ga.HlsSourceHandler=Tl,Ga.Hls=gl,Ga.use||Ga.registerComponent("Hls",gl),Ga.options.hls=Ga.options.hls||{},Ga.registerPlugin?Ga.registerPlugin("reloadSourceOnError",ml):Ga.plugin("reloadSourceOnError",ml);t.a=Ga},function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return o[e];var n,a=String(e);return(n=i[a.toLowerCase()])?n:(n=r[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var a;if(a=i[t.toLowerCase()])return a===n;if(a=r[t.toLowerCase()])return a===n}else if("number"==typeof t)return t===n;return!1}};var i=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};
/*!
 * Programatically add the following
 */
for(a=97;a<123;a++)i[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)i[a-48]=a;for(a=1;a<13;a++)i["f"+a]=a+111;for(a=0;a<10;a++)i["numpad "+a]=a+96;var o=t.names=t.title={};for(a in i)o[i[a]]=a;for(var s in r)i[s]=r[s]},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return i(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer"}}]),e}());t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e={};function t(t,n,i){var r=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===n&&(!i||i===e.scope))return r=t,!0})),r):r}return{on:function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!n)throw new Error("event type cannot be null or undefined");if(!i||"function"!=typeof i)throw new Error("listener must be a function: "+i);if(!(t(n,i,r)>=0)){e[n]=e[n]||[];var o={callback:i,scope:r,priority:a},s=e[n].some((function(t,i){if(t&&a>t.priority)return e[n].splice(i,0,o),!0}));s||e[n].push(o)}},off:function(n,i,r){if(n&&i&&e[n]){var a=t(n,i,r);a<0||(e[n][a]=null)}},trigger:function(t,n){if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,e[t]=e[t].filter((function(e){return e})),e[t].forEach((function(e){return e&&e.callback.call(e.scope,n)}))}},reset:function(){e={}}}}o.__dashjs_factory_name="EventBus";var s=a.default.getSingletonFactory(o);s.EVENT_PRIORITY_LOW=0,s.EVENT_PRIORITY_HIGH=5e3,a.default.updateSingletonFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(8)),r=o(n(10)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var s=1,l=2,u=3,c=4,h=5;function d(e){e=e||{};var t,n=this.context,a=(0,i.default)(n).getInstance(),o=e.settings,d=[],f=void 0,p=void 0,m=void 0;function g(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[s,this].concat(t))}function y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[l,this].concat(t))}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[u,this].concat(t))}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[c,this].concat(t))}function E(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[h,this].concat(t))}function T(e,t){var n="",i=null;f&&(i=(new Date).getTime(),n+="["+(i-m)+"]"),p&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var s=arguments.length,l=Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];Array.apply(null,l).forEach((function(e){n+=e+" "})),d[e]&&o.get().debug.logLevel>=e&&d[e](n),a.trigger(r.default.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:_.bind(e),info:b.bind(e),debug:E.bind(e)}},setLogTimestampVisible:function(e){f=e},setCalleeNameVisible:function(e){p=e}},f=!0,p=!0,m=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(d[s]=g(window.console.error),d[l]=g(window.console.error),d[u]=g(window.console.warn),d[c]=g(window.console.info),d[h]=g(window.console.debug)),t}d.__dashjs_factory_name="Debug";var f=a.default.getSingletonFactory(d);f.LOG_LEVEL_NONE=0,f.LOG_LEVEL_FATAL=s,f.LOG_LEVEL_ERROR=l,f.LOG_LEVEL_WARNING=u,f.LOG_LEVEL_INFO=c,f.LOG_LEVEL_DEBUG=h,a.default.updateSingletonFactory(d.__dashjs_factory_name,f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(125);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var s=new(function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.MediaPlayerFactory=t.MetricsReporting=t.Protection=t.MediaPlayer=void 0;var i=n(123),r=l(n(245)),a=l(n(264)),o=l(n(279)),s=l(n(9));function l(e){return e&&e.__esModule?e:{default:e}}dashjs.Protection=a.default,dashjs.MetricsReporting=r.default,dashjs.MediaPlayerFactory=o.default,dashjs.Debug=s.default,t.default=dashjs,t.MediaPlayer=i.MediaPlayer,t.Protection=a.default,t.MetricsReporting=r.default,t.MediaPlayerFactory=o.default,t.Debug=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=i||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return i(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate"}}]),e}());t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){i(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null};r.GET="GET",r.HEAD="HEAD",r.MPD_TYPE="MPD",r.XLINK_EXPANSION_TYPE="XLinkExpansion",r.INIT_SEGMENT_TYPE="InitializationSegment",r.INDEX_SEGMENT_TYPE="IndexSegment",r.MEDIA_SEGMENT_TYPE="MediaSegment",r.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",r.OTHER_TYPE="other",t.HTTPRequest=r,t.HTTPRequestTrace=function e(){i(this,e),this.s=null,this.d=null,this.b=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(89);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,e.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_CODEC_CODE=30,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="buffer is not defined",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return i(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=r},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(177));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=[],n=this.context;function i(n,i,r){var a=function(n){var i=void 0;for(i=0;i<t.length;i++){if(t[i].regex.test(n))return t[i].utils}return e}(r||i);return a&&"function"==typeof a[n]?a[n](i,r):e[n](i,r)}return e=(0,r.default)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return i("parseBaseUrl",e)},parseOrigin:function(e){return i("parseOrigin",e)},parseScheme:function(e){return i("parseScheme",e)},isRelative:function(e){return i("isRelative",e)},isPathAbsolute:function(e){return i("isPathAbsolute",e)},isSchemeRelative:function(e){return i("isSchemeRelative",e)},isHTTPURL:function(e){return i("isHTTPURL",e)},isHTTPS:function(e){return i("isHTTPS",e)},removeHostname:function(e){return i("removeHostname",e)},resolve:function(e,t){return i("resolve",e,t)}}}o.__dashjs_factory_name="URLUtils";var s=i.default.getSingletonFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};var o={DEFAULT:.5,STRONG:1,WEAK:0};function s(e,t,n){return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:function(e){var t=o.DEFAULT;return e!==o.DEFAULT&&e!==o.STRONG&&e!==o.WEAK||(t=e),t}(n)}}s.__dashjs_factory_name="SwitchRequest";var l=a.default.getClassFactory(s);l.NO_CHANGE=-1,l.PRIORITY=o,a.default.updateClassFactory(s.__dashjs_factory_name,l),t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.checkParameterType=function(e,t){if((void 0===e?"undefined":i(e))!==t)throw o.default.BAD_ARGUMENT_ERROR},t.checkInteger=function(e){if(null===e||isNaN(e)||e%1!=0)throw o.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},t.checkRange=function(e,t,n){if(e<t||e>n)throw o.default.BAD_ARGUMENT_ERROR+" : argument out of range"},t.checkIsVideoOrAudioType=function(e){if("string"!=typeof e||e!==o.default.AUDIO&&e!==o.default.VIDEO)throw o.default.BAD_ARGUMENT_ERROR};var r,a=n(7),o=(r=a)&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(14);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return i(e,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===r.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?r.HTTPRequest.INIT_SEGMENT_TYPE:r.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}]),e}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete",t.default=a},function(e,t,n){"use strict";var i=n(41),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=h;var a=Object.create(n(31));a.inherits=n(24);var o=n(85),s=n(56);a.inherits(h,o);for(var l=r(s.prototype),u=0;u<l.length;u++){var c=l[u];h.prototype[c]||(h.prototype[c]=s.prototype[c])}function h(e){if(!(this instanceof h))return new h(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return i(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}());t.default=r},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},t.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.replaceTokenForTemplate=s,t.getIndexBasedSegment=function(e,t,n,i){var r,a,o=void 0;o=n.segmentDuration,isNaN(o)&&(o=n.adaptation.period.duration);r=parseFloat((n.adaptation.period.start+i*o).toFixed(5)),a=parseFloat((r+o).toFixed(5));var s=l(n,o,r,e.calcMediaTimeFromPresentationTime(r,n),e.calcAvailabilityStartTimeFromPresentationTime(r,n.adaptation.period.mpd,t),e,a,t,i);if(!u(e,n,s,t))return null;return s},t.getTimeBasedSegment=function(e,t,n,i,r,a,o,c,h,d){var f,p,m=i/a,g=Math.min(r/a,n.adaptation.period.mpd.maxSegmentDuration),v=void 0;if(f=e.calcPresentationTimeFromMediaTime(m,n),p=f+g,v=l(n,g,f,m,n.adaptation.period.mpd.manifest.loadedTime,e,p,t,h),!u(e,n,v,t))return null;return v.replacementTime=d||i,o=s(o,"Number",v.replacementNumber),o=s(o,"Time",v.replacementTime),v.media=o,v.mediaRange=c,v};var i,r=n(60),a=(i=r)&&i.__esModule?i:{default:i};function o(e,t){for(;e.length<t;)e="0"+e;return e}function s(e,t,n){var i=void 0,r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=t.length,h="%0".length;if(!e)return e;for(;;){if((i=e.indexOf("$"+t))<0)return e;if((r=e.indexOf("$",i+c))<0)return e;if((a=e.indexOf("%0",i+c))>i&&a<r)switch(s=e.charAt(r-1),l=parseInt(e.substring(a+h,r-1),10),s){case"d":case"i":case"u":u=o(n.toString(),l);break;case"x":u=o(n.toString(16),l);break;case"X":u=o(n.toString(16),l).toUpperCase();break;case"o":u=o(n.toString(8),l);break;default:return e}else u=n;e=e.substring(0,i)+u+e.substring(r+1)}}function l(e,t,n,i,r,o,s,l,u){var c,h=new a.default;return h.representation=e,h.duration=t,h.presentationStartTime=n,h.mediaStartTime=i,h.availabilityStartTime=r,h.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(s,e.adaptation.period.mpd,l),h.wallStartTime=o.calcWallTimeForSegment(h,l),h.replacementNumber=(c=u,h.representation.startNumber+c),h.availabilityIdx=u,h}function u(e,t,n,i){var r=e.getPeriodEnd(t,i),a=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,r);if(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n.presentationStartTime)>=a){if(!i)return!1;if(t.segmentAvailabilityRange&&n.presentationStartTime>=t.segmentAvailabilityRange.end)return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var i=e[n];"urn:mpeg:dash:mp4protection:2011"===i.schemeIdUri.toLowerCase()&&"cenc"===i.value.toLowerCase()&&(t=i)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),i=n.getUint8(t);return t+=20,i>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var i=e.parsePSSHList(n);return t&&i.hasOwnProperty(t.uuid.toLowerCase())?i[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},i=0;;){var r,a,o=void 0,s=i;if(i>=t.buffer.byteLength)break;if(r=i+t.getUint32(i),i+=4,1886614376===t.getUint32(i))if(i+=4,0===(a=t.getUint8(i))||1===a){i++,i+=3,o="";var l=void 0,u=void 0;for(l=0;l<4;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=4,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;for(i+=2,o+="-",l=0;l<6;l++)o+=1===(u=t.getUint8(i+l).toString(16)).length?"0"+u:u;i+=6,o=o.toLowerCase(),t.getUint32(i),i+=4,n[o]=t.buffer.slice(s,r),i=r}else i=r;else i=r}return n}}]),e}();t.default=r},function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,i,r;for(void 0===t&&(t=15),i=.5,n=new Date;;){for(r=i*=2;r>3;r-=4)e(),e(),e(),e();for(;r>0;)e(),r--;if(new Date-n>t)break}for(r=i;r>3;r-=4)e(),e(),e(),e();for(;r>0;)e(),r--;return 1e3*(3*i-1)/(new Date-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;t<n;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){var t=[];return function e(n){var i;if(void 0===n)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return t.push('"'+n+'"'),!1;if("boolean"==typeof n)return t.push(n.toString()),!1;if("number"==typeof n){var r=function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),i=t/Math.pow(10,n),r=i.toPrecision(numeric.precision);return 10===parseFloat(r)&&(n++,r=(i=1).toPrecision(numeric.precision)),parseFloat(r).toString()+"e"+n.toString()}return"Infinity"}(n),a=n.toPrecision(numeric.precision),o=parseFloat(n.toString()).toString(),s=[r,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(i=1;i<s.length;i++)s[i].length<r.length&&(r=s[i]);return t.push(Array(numeric.precision+8-r.length).join(" ")+r),!1}if(null===n)return t.push("null"),!1;if("function"==typeof n){t.push(n.toString());var l=!1;for(i in n)n.hasOwnProperty(i)&&(l?t.push(",\n"):t.push("\n{"),l=!0,t.push(i),t.push(": \n"),e(n[i]));return l&&t.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return t.push("...Large Array..."),!0;l=!1;for(t.push("["),i=0;i<n.length;i++)i>0&&(t.push(","),l&&t.push("\n ")),l=e(n[i]);return t.push("]"),!0}for(i in t.push("{"),l=!1,n)n.hasOwnProperty(i)&&(l&&t.push(",\n"),l=!0,t.push(i),t.push(": \n"),e(n[i]));return t.push("}"),!0}(e),t.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,i=[];for(n=0;n<t.length;n++)i[n]=e(t[n]);return i}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,i=[];for(n=0;n<t.length;n++)i[n]=e(t[n]);return i}(e)},numeric.parseCSV=function(e){var t,n,i,r=e.split("\n"),a=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(n=0;n<r.length;n++){var u,c=(r[n]+",").match(o);if(c.length>0){for(a[l]=[],t=0;t<c.length;t++)u=(i=c[t]).substr(0,i.length-1),s.test(u)?a[l][t]=parseFloat(u):a[l][t]=u;l++}}return a},numeric.toCSV=function(e){var t,n,i,r,a,o=numeric.dim(e);for(i=o[0],o[1],a=[],t=0;t<i;t++){for(r=[],n=0;n<i;n++)r[n]=e[t][n].toString();a[t]=r.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var i,r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],a=-1;e.length;for(i=t;i<n;i++)a=a>>>8^r[255&(a^e[i])];return-1^a}var n,i,r,a,o,s,l,u,c,h,d=e[0].length,f=e[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=t(p,12,29),p[29]=h>>24&255,p[30]=h>>16&255,p[31]=h>>8&255,p[32]=255&h,n=1,i=0,l=0;l<d;l++){for(l<d-1?p.push(0):p.push(1),o=3*f+1+(0===l)&255,s=3*f+1+(0===l)>>8&255,p.push(o),p.push(s),p.push(255&~o),p.push(255&~s),0===l&&p.push(0),u=0;u<f;u++)for(r=0;r<3;r++)i=(i+(n=(n+(o=(o=e[r][l][u])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return c=(i<<16)+n,p.push(c>>24&255),p.push(c>>16&255),p.push(c>>8&255),p.push(255&c),a=p.length-41,p[33]=a>>24&255,p[34]=a>>16&255,p[35]=a>>8&255,p[36]=255&a,h=t(p,37),p.push(h>>24&255),p.push(h>>16&255),p.push(h>>8&255),p.push(255&h),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(e){var t,n,i,r,a,o,s,l=e.length,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;t<l;t+=3)a=((3&(n=e[t]))<<4)+((i=e[t+1])>>4),o=((15&i)<<2)+((r=e[t+2])>>6),s=63&r,t+1>=l?o=s=64:t+2>=l&&(s=64),c+=u.charAt(n>>2)+u.charAt(a)+u.charAt(o)+u.charAt(s);return c}(p)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var i,r;if(!(t instanceof Array&&n instanceof Array))return!1;if((r=t.length)!==n.length)return!1;for(i=0;i<r;i++)if(t[i]!==n[i]){if("object"!=typeof t[i])return!1;if(!e(t[i],n[i]))return!1}return!0},numeric.rep=function(e,t,n){void 0===n&&(n=0);var i,r=e[n],a=Array(r);if(n===e.length-1){for(i=r-2;i>=0;i-=2)a[i+1]=t,a[i]=t;return-1===i&&(a[0]=t),a}for(i=r-1;i>=0;i--)a[i]=numeric.rep(e,t,n+1);return a},numeric.dotMMsmall=function(e,t){var n,i,r,a,o,s,l,u,c,h,d;for(a=e.length,o=t.length,s=t[0].length,l=Array(a),n=a-1;n>=0;n--){for(u=Array(s),c=e[n],r=s-1;r>=0;r--){for(h=c[o-1]*t[o-1][r],i=o-2;i>=1;i-=2)d=i-1,h+=c[i]*t[i][r]+c[d]*t[d][r];0===i&&(h+=c[0]*t[0][r]),u[r]=h}l[n]=u}return l},numeric._getCol=function(e,t,n){var i;for(i=e.length-1;i>0;--i)n[i]=e[i][t],n[--i]=e[i][t];0===i&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,i,r,a=numeric._getCol,o=t.length,s=Array(o),l=e.length,u=t[0].length,c=new Array(l),h=numeric.dotVV;for(--o,i=--l;-1!==i;--i)c[i]=Array(u);for(i=--u;-1!==i;--i)for(a(t,i,s),r=l;-1!==r;--r)0,n=e[r],c[r][i]=h(n,s);return c},numeric.dotMV=function(e,t){var n,i=e.length,r=(t.length,Array(i)),a=numeric.dotVV;for(n=i-1;n>=0;n--)r[n]=a(e[n],t);return r},numeric.dotVM=function(e,t){var n,i,r,a,o,s,l;for(r=e.length,a=t[0].length,o=Array(a),i=a-1;i>=0;i--){for(s=e[r-1]*t[r-1][i],n=r-2;n>=1;n-=2)l=n-1,s+=e[n]*t[n][i]+e[l]*t[l][i];0===n&&(s+=e[0]*t[0][i]),o[i]=s}return o},numeric.dotVV=function(e,t){var n,i,r=e.length,a=e[r-1]*t[r-1];for(n=r-2;n>=1;n-=2)i=n-1,a+=e[n]*t[n]+e[i]*t[i];return 0===n&&(a+=e[0]*t[0]),a},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,i,r,a=e.length,o=Array(a);for(t=a-1;t>=0;t--){for(r=Array(a),n=t+2,i=a-1;i>=n;i-=2)r[i]=0,r[i-1]=0;for(i>t&&(r[i]=0),r[t]=e[t],i=t-1;i>=1;i-=2)r[i]=0,r[i-1]=0;0===i&&(r[0]=0),o[t]=r}return o},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),i=Array(n);for(t=n-1;t>=1;--t)i[t]=e[t][t],i[--t]=e[t][t];return 0===t&&(i[0]=e[0][0]),i},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){void 0===n&&(n="");var i,r,a=[],o=/\[i\]$/,s="",l=!1;for(i=0;i<e.length;i++)o.test(e[i])?s=r=e[i].substring(0,e[i].length-3):r=e[i],"ret"===r&&(l=!0),a.push(r);return a[e.length]="_s",a[e.length+1]="_k",a[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric.pointwise2=function(e,t,n){void 0===n&&(n="");var i,r,a=[],o=/\[i\]$/,s="",l=!1;for(i=0;i<e.length;i++)o.test(e[i])?s=r=e[i].substring(0,e[i].length-3):r=e[i],"ret"===r&&(l=!0),a.push(r);return a[e.length]="var _n = "+s+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric._biforeach=function e(t,n,i,r,a){var o;if(r!==i.length-1)for(o=i[r]-1;o>=0;o--)e("object"==typeof t?t[o]:t,"object"==typeof n?n[o]:n,i,r+1,a);else a(t,n)},numeric._biforeach2=function e(t,n,i,r,a){if(r===i.length-1)return a(t,n);var o,s=i[r],l=Array(s);for(o=s-1;o>=0;--o)l[o]=e("object"==typeof t?t[o]:t,"object"==typeof n?n[o]:n,i,r+1,a);return l},numeric._foreach=function e(t,n,i,r){var a;if(i!==n.length-1)for(a=n[i]-1;a>=0;a--)e(t[a],n,i+1,r);else r(t)},numeric._foreach2=function e(t,n,i,r){if(i===n.length-1)return r(t);var a,o=n[i],s=Array(o);for(a=o-1;a>=0;a--)s[a]=e(t[a],n,i+1,r);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,i,r="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(r="var "+t+" = Math."+t+";\n",n=function(e,n,i){return e+" = "+t+"("+n+","+i+")"},i=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,i){return e+" = "+n+" "+t+" "+i},i=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),r),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),r),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),r),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),r),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),r),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(r="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(r="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",r),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",r),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,i,r,a,o,s,l=numeric.dim(e),u=Math.abs,c=l[0],h=l[1],d=numeric.clone(e),f=numeric.identity(c);for(o=0;o<h;++o){var p=-1,m=-1;for(a=o;a!==c;++a)(s=u(d[a][o]))>m&&(p=a,m=s);for(n=d[p],d[p]=d[o],d[o]=n,r=f[p],f[p]=f[o],f[o]=r,e=n[o],s=o;s!==h;++s)n[s]/=e;for(s=h-1;-1!==s;--s)r[s]/=e;for(a=c-1;-1!==a;--a)if(a!==o){for(t=d[a],i=f[a],e=t[o],s=o+1;s!==h;++s)t[s]-=n[s]*e;for(s=h-1;s>0;--s)i[s]-=r[s]*e,i[--s]-=r[s]*e;0===s&&(i[0]-=r[0]*e)}}return f},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,i,r,a,o,s,l,u,c=t[0],h=1,d=numeric.clone(e);for(i=0;i<c-1;i++){for(r=i,n=i+1;n<c;n++)Math.abs(d[n][i])>Math.abs(d[r][i])&&(r=n);for(r!==i&&(l=d[r],d[r]=d[i],d[i]=l,h*=-1),a=d[i],n=i+1;n<c;n++){for(s=(o=d[n])[i]/a[i],r=i+1;r<c-1;r+=2)u=r+1,o[r]-=a[r]*s,o[u]-=a[u]*s;r!==c&&(o[r]-=a[r]*s)}if(0===a[i])return 0;h*=a[i]}return h*d[i][i]},numeric.transpose=function(e){var t,n,i,r,a,o=e.length,s=e[0].length,l=Array(s);for(n=0;n<s;n++)l[n]=Array(o);for(t=o-1;t>=1;t-=2){for(r=e[t],i=e[t-1],n=s-1;n>=1;--n)(a=l[n])[t]=r[n],a[t-1]=i[n],(a=l[--n])[t]=r[n],a[t-1]=i[n];0===n&&((a=l[0])[t]=r[0],a[t-1]=i[0])}if(0===t){for(i=e[0],n=s-1;n>=1;--n)l[n][0]=i[n],l[--n][0]=i[n];0===n&&(l[0][0]=i[0])}return l},numeric.negtranspose=function(e){var t,n,i,r,a,o=e.length,s=e[0].length,l=Array(s);for(n=0;n<s;n++)l[n]=Array(o);for(t=o-1;t>=1;t-=2){for(r=e[t],i=e[t-1],n=s-1;n>=1;--n)(a=l[n])[t]=-r[n],a[t-1]=-i[n],(a=l[--n])[t]=-r[n],a[t-1]=-i[n];0===n&&((a=l[0])[t]=-r[0],a[t-1]=-i[0])}if(0===t){for(i=e[0],n=s-1;n>=1;--n)l[n][0]=-i[n],l[--n][0]=-i[n];0===n&&(l[0][0]=-i[0])}return l},numeric._random=function e(t,n){var i,r,a=t[n],o=Array(a);if(n===t.length-1){for(r=Math.random,i=a-1;i>=1;i-=2)o[i]=r(),o[i-1]=r();return 0===i&&(o[0]=r()),o}for(i=a-1;i>=0;i--)o[i]=e(t,n+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if(void 0===n&&(n=Math.max(Math.round(t-e)+1,1)),n<2)return 1===n?[e]:[];var i,r=Array(n);for(i=--n;i>=0;i--)r[i]=(i*t+(n-i)*e)/n;return r},numeric.getBlock=function(e,t,n){var i=numeric.dim(e);return function e(r,a){var o,s=t[a],l=n[a]-s,u=Array(l);if(a===i.length-1){for(o=l;o>=0;o--)u[o]=r[o+s];return u}for(o=l;o>=0;o--)u[o]=e(r[o+s],a+1);return u}(e,0)},numeric.setBlock=function(e,t,n,i){var r=numeric.dim(e);return function e(i,a,o){var s,l=t[o],u=n[o]-l;if(o===r.length-1)for(s=u;s>=0;s--)i[s+l]=a[s];for(s=u;s>=0;s--)e(i[s+l],a[s],o+1)}(e,i,0),e},numeric.getRange=function(e,t,n){var i,r,a,o,s=t.length,l=n.length,u=Array(s);for(i=s-1;-1!==i;--i)for(u[i]=Array(l),a=u[i],o=e[t[i]],r=l-1;-1!==r;--r)a[r]=o[n[r]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,i,r,a,o,s=t[0],l=t[1];for(n=0,i=0,r=0;r<s;++r)n+=e[r][0].length;for(a=0;a<l;++a)i+=e[0][a][0].length;var u=Array(n);for(r=0;r<n;++r)u[r]=Array(i);var c,h,d,f,p,m=0;for(r=0;r<s;++r){for(c=i,a=l-1;-1!==a;--a)for(c-=(o=e[r][a])[0].length,d=o.length-1;-1!==d;--d)for(p=o[d],h=u[m+d],f=p.length-1;-1!==f;--f)h[c+f]=p[f];m+=e[r][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),i=numeric.dim(t);if(1!==n.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var r,a,o,s,l=n[0],u=i[0],c=Array(l);for(a=l-1;a>=0;a--){for(r=Array(u),s=e[a],o=u-1;o>=3;--o)r[o]=s*t[o],r[--o]=s*t[o],r[--o]=s*t[o],r[--o]=s*t[o];for(;o>=0;)r[o]=s*t[o],--o;c[a]=r}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,i,r){var a;numeric.indexOf;if("string"!=typeof r)for(a in r="",numeric)numeric.hasOwnProperty(a)&&(e.indexOf(a)>=0||t.indexOf(a)>=0||n.indexOf(a)>=0||i.indexOf(a)>=0)&&a.length>1&&(r+="var "+a+" = numeric."+a+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+r+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,n,i,r,a,o,s,l,u,c,h,d,f,p,m,g,v,y,_=e.x.length,b=numeric.identity(_),E=numeric.rep([_,_],0),T=numeric.clone(e.x),w=numeric.clone(e.y);for(u=0;u<_;u++){for(d=(p=T[u][u])*p+(m=w[u][u])*m,h=u,c=u+1;c<_;c++)(f=(p=T[c][u])*p+(m=w[c][u])*m)>d&&(h=c,d=f);for(h!==u&&(y=T[u],T[u]=T[h],T[h]=y,y=w[u],w[u]=w[h],w[h]=y,y=b[u],b[u]=b[h],b[h]=y,y=E[u],E[u]=E[h],E[h]=y),t=T[u],n=w[u],a=b[u],o=E[u],p=t[u],m=n[u],c=u+1;c<_;c++)g=t[c],v=n[c],t[c]=(g*p+v*m)/d,n[c]=(v*p-g*m)/d;for(c=0;c<_;c++)g=a[c],v=o[c],a[c]=(g*p+v*m)/d,o[c]=(v*p-g*m)/d;for(c=u+1;c<_;c++){for(i=T[c],r=w[c],s=b[c],l=E[c],p=i[u],m=r[u],h=u+1;h<_;h++)g=t[h],v=n[h],i[h]-=g*p-v*m,r[h]-=v*p+g*m;for(h=0;h<_;h++)g=a[h],v=o[h],s[h]-=g*p-v*m,l[h]-=v*p+g*m}}for(u=_-1;u>0;u--)for(a=b[u],o=E[u],c=u-1;c>=0;c--)for(s=b[c],l=E[c],p=T[c][u],m=w[c][u],h=_-1;h>=0;h--)g=a[h],v=o[h],s[h]-=p*g-m*v,l[h]-=p*v+m*g;return new numeric.T(b,E)},numeric.T.prototype.get=function(e){var t,n=this.x,i=this.y,r=0,a=e.length;if(i){for(;r<a;)n=n[t=e[r]],i=i[t],r++;return new numeric.T(n,i)}for(;r<a;)n=n[t=e[r]],r++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,i=this.x,r=this.y,a=0,o=e.length,s=t.x,l=t.y;if(0===o)return l?this.y=l:r&&(this.y=void 0),this.x=i,this;if(l){for(r||(r=numeric.rep(numeric.dim(i),0),this.y=r);a<o-1;)i=i[n=e[a]],r=r[n],a++;return i[n=e[a]]=s,r[n]=l,this}if(r){for(;a<o-1;)i=i[n=e[a]],r=r[n],a++;return i[n=e[a]]=s,r[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;a<o-1;)i=i[n=e[a]],a++;return i[n=e[a]]=s,this},numeric.T.prototype.getRows=function(e,t){var n,i,r=t-e+1,a=Array(r),o=this.x,s=this.y;for(n=e;n<=t;n++)a[n-e]=o[n];if(s){for(i=Array(r),n=e;n<=t;n++)i[n-e]=s[n];return new numeric.T(a,i)}return new numeric.T(a)},numeric.T.prototype.setRows=function(e,t,n){var i,r=this.x,a=this.y,o=n.x,s=n.y;for(i=e;i<=t;i++)r[i]=o[i-e];if(s)for(a||(a=numeric.rep(numeric.dim(r),0),this.y=a),i=e;i<=t;i++)a[i]=s[i-e];else if(a)for(i=e;i<=t;i++)a[i]=numeric.rep([o[i-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,i=this.y,r=t.x,a=t.y;return n[e]=r,a?(i||(i=numeric.rep(numeric.dim(n),0),this.y=i),i[e]=a):i&&(i=numeric.rep([r.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,i=this.y,r=numeric.getBlock;return i?new numeric.T(r(n,e,t),r(i,e,t)):new numeric.T(r(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var i=this.x,r=this.y,a=numeric.setBlock,o=n.x,s=n.y;if(s)return r||(this.y=numeric.rep(numeric.dim(this),0),r=this.y),a(i,e,t,o),a(r,e,t,s),this;a(i,e,t,o),r&&a(r,e,t,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var i=t.x,r=t.y,a=numeric.rep;return r?new n(a(e,i),a(e,r)):new n(a(e,i))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,i=numeric.diag;return n?new numeric.T(i(t),i(n)):new numeric.T(i(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=(e[0]>=0?1:-1)*numeric.norm2(e);t[0]+=n;var i=numeric.norm2(t);if(0===i)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,i,r,a,o,s,l,u,c,h,d=t[0],f=numeric.clone(e),p=numeric.identity(d);for(i=0;i<d-2;i++){for(a=Array(d-i-1),n=i+1;n<d;n++)a[n-i-1]=f[n][i];if(numeric.norm2(a)>0){for(o=numeric.house(a),s=numeric.getBlock(f,[i+1,i],[d-1,d-1]),l=numeric.tensor(o,numeric.dot(o,s)),n=i+1;n<d;n++)for(u=f[n],c=l[n-i-1],r=i;r<d;r++)u[r]-=2*c[r-i];for(s=numeric.getBlock(f,[0,i+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(s,o),o),n=0;n<d;n++)for(u=f[n],c=l[n],r=i+1;r<d;r++)u[r]-=2*c[r-i-1];for(s=Array(d-i-1),n=i+1;n<d;n++)s[n-i-1]=p[n];for(l=numeric.tensor(o,numeric.dot(o,s)),n=i+1;n<d;n++)for(h=p[n],c=l[n-i-1],r=0;r<d;r++)h[r]-=2*c[r]}}return{H:f,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var n,i,r,a,o,s,l,u,c,h,d,f,p,m,g,v,y,_,b=numeric.dim(e)[0],E=numeric.identity(b);if(b<3)return{Q:E,B:[[0,b-1]]};var T=numeric.epsilon;for(_=0;_<t;_++){for(v=0;v<b-1;v++)if(Math.abs(e[v+1][v])<T*(Math.abs(e[v][v])+Math.abs(e[v+1][v+1]))){var w=numeric.QRFrancis(numeric.getBlock(e,[0,0],[v,v]),t),x=numeric.QRFrancis(numeric.getBlock(e,[v+1,v+1],[b-1,b-1]),t);for(f=Array(v+1),g=0;g<=v;g++)f[g]=E[g];for(p=numeric.dot(w.Q,f),g=0;g<=v;g++)E[g]=p[g];for(f=Array(b-v-1),g=v+1;g<b;g++)f[g-v-1]=E[g];for(p=numeric.dot(x.Q,f),g=v+1;g<b;g++)E[g]=p[g-v-1];return{Q:E,B:w.B.concat(numeric.add(x.B,v+1))}}var A,S,M;if(r=e[b-2][b-2],a=e[b-2][b-1],o=e[b-1][b-2],u=r+(s=e[b-1][b-1]),l=r*s-a*o,c=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*l)A=.5*(u+Math.sqrt(u*u-4*l)),S=.5*(u-Math.sqrt(u*u-4*l)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,A+S)),numeric.diag(numeric.rep([3],A*S)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],l)));for(n=[c[0][0],c[1][0],c[2][0]],i=numeric.house(n),f=[e[0],e[1],e[2]],p=numeric.tensor(i,numeric.dot(i,f)),g=0;g<3;g++)for(d=e[g],m=p[g],y=0;y<b;y++)d[y]-=2*m[y];for(f=numeric.getBlock(e,[0,0],[b-1,2]),p=numeric.tensor(numeric.dot(f,i),i),g=0;g<b;g++)for(d=e[g],m=p[g],y=0;y<3;y++)d[y]-=2*m[y];for(f=[E[0],E[1],E[2]],p=numeric.tensor(i,numeric.dot(i,f)),g=0;g<3;g++)for(h=E[g],m=p[g],y=0;y<b;y++)h[y]-=2*m[y];for(v=0;v<b-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(e[y+1][y])<T*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){w=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),x=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[b-1,b-1]),t);for(f=Array(y+1),g=0;g<=y;g++)f[g]=E[g];for(p=numeric.dot(w.Q,f),g=0;g<=y;g++)E[g]=p[g];for(f=Array(b-y-1),g=y+1;g<b;g++)f[g-y-1]=E[g];for(p=numeric.dot(x.Q,f),g=y+1;g<b;g++)E[g]=p[g-y-1];return{Q:E,B:w.B.concat(numeric.add(x.B,y+1))}}for(M=Math.min(b-1,v+3),n=Array(M-v),g=v+1;g<=M;g++)n[g-v-1]=e[g][v];for(i=numeric.house(n),f=numeric.getBlock(e,[v+1,v],[M,b-1]),p=numeric.tensor(i,numeric.dot(i,f)),g=v+1;g<=M;g++)for(d=e[g],m=p[g-v-1],y=v;y<b;y++)d[y]-=2*m[y-v];for(f=numeric.getBlock(e,[0,v+1],[b-1,M]),p=numeric.tensor(numeric.dot(f,i),i),g=0;g<b;g++)for(d=e[g],m=p[g],y=v+1;y<=M;y++)d[y]-=2*m[y-v-1];for(f=Array(M-v),g=v+1;g<=M;g++)f[g-v-1]=E[g];for(p=numeric.tensor(i,numeric.dot(i,f)),g=v+1;g<=M;g++)for(h=E[g],m=p[g-v-1],y=0;y<b;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,i,r,a,o,s,l,u,c,h,d,f,p,m,g,v,y=numeric.toUpperHessenberg(e),_=numeric.QRFrancis(y.H,t),b=numeric.T,E=e.length,T=_.B,w=numeric.dot(_.Q,numeric.dot(y.H,numeric.transpose(_.Q))),x=new b(numeric.dot(_.Q,y.Q)),A=T.length,S=Math.sqrt;for(i=0;i<A;i++)if((n=T[i][0])===T[i][1]);else{if(a=n+1,o=w[n][n],s=w[n][a],l=w[a][n],u=w[a][a],0===s&&0===l)continue;(h=(c=-o-u)*c-4*(o*u-s*l))>=0?((g=(o-(d=c<0?-.5*(c-S(h)):-.5*(c+S(h))))*(o-d)+s*s)>(v=l*l+(u-d)*(u-d))?(p=(o-d)/(g=S(g)),m=s/g):(p=l/(v=S(v)),m=(u-d)/v),r=new b([[m,-p],[p,m]]),x.setRows(n,a,r.dot(x.getRows(n,a)))):(d=-.5*c,f=.5*S(-h),(g=(o-d)*(o-d)+s*s)>(v=l*l+(u-d)*(u-d))?(p=(o-d)/(g=S(g+f*f)),m=s/g,d=0,f/=g):(p=l/(v=S(v+f*f)),m=(u-d)/v,d=f/v,f=0),r=new b([[m,-p],[p,m]],[[d,f],[f,-d]]),x.setRows(n,a,r.dot(x.getRows(n,a))))}var M=x.dot(e).dot(x.transjugate()),C=(E=e.length,numeric.T.identity(E));for(a=0;a<E;a++)if(a>0)for(i=a-1;i>=0;i--){var R=M.get([i,i]),I=M.get([a,a]);numeric.neq(R.x,I.x)||numeric.neq(R.y,I.y)?(d=M.getRow(i).getBlock([i],[a-1]),f=C.getRow(a).getBlock([i],[a-1]),C.set([a,i],M.get([i,a]).neg().sub(d.dot(f)).div(R.sub(I)))):C.setRow(a,C.getRow(i))}for(a=0;a<E;a++)d=C.getRow(a),C.setRow(a,d.div(d.norm2()));return C=C.transpose(),C=x.transjugate().dot(C),{lambda:M.getDiag(),E:C}},numeric.ccsSparse=function(e){var t,n,i,r=e.length,a=[];for(n=r-1;-1!==n;--n)for(i in t=e[n]){for(i=parseInt(i);i>=a.length;)a[a.length]=0;0!==t[i]&&a[i]++}var o=a.length,s=Array(o+1);for(s[0]=0,n=0;n<o;++n)s[n+1]=s[n]+a[n];var l=Array(s[o]),u=Array(s[o]);for(n=r-1;-1!==n;--n)for(i in t=e[n])0!==t[i]&&(a[i]--,l[s[i]+a[i]]=n,u[s[i]+a[i]]=t[i]);return[s,l,u]},numeric.ccsFull=function(e){var t,n,i,r,a=e[0],o=e[1],s=e[2],l=numeric.ccsDim(e),u=l[0],c=l[1],h=numeric.rep([u,c],0);for(t=0;t<c;t++)for(i=a[t],r=a[t+1],n=i;n<r;++n)h[o[n]][t]=s[n];return h},numeric.ccsTSolve=function(e,t,n,i,r){var a,o,s,l,u,c,h,d=e[0],f=e[1],p=e[2],m=d.length-1,g=Math.max,v=0;function y(e){var t;if(0===n[e]){for(n[e]=1,t=d[e];t<d[e+1];++t)y(f[t]);r[v]=e,++v}}for(void 0===i&&(n=numeric.rep([m],0)),void 0===i&&(i=numeric.linspace(0,n.length-1)),void 0===r&&(r=[]),a=i.length-1;-1!==a;--a)y(i[a]);for(r.length=v,a=r.length-1;-1!==a;--a)n[r[a]]=0;for(a=i.length-1;-1!==a;--a)o=i[a],n[o]=t[o];for(a=r.length-1;-1!==a;--a){for(o=r[a],s=d[o],l=g(d[o+1],s),u=s;u!==l;++u)if(f[u]===o){n[o]/=p[u];break}for(h=n[o],u=s;u!==l;++u)(c=f[u])!==o&&(n[c]-=h*p[u])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,i,r,a){var o,s,l,u=0,c=r.length,h=this.k,d=this.k1,f=this.j;if(0===i[e])for(i[e]=1,f[0]=e,h[0]=s=t[e],d[0]=l=t[e+1];;)if(s>=l){if(r[c]=f[u],0===u)return;++c,s=h[--u],l=d[u]}else 0===i[o=a[n[s]]]?(i[o]=1,h[u]=s,f[++u]=o,s=t[o],d[u]=l=t[o+1]):++s},numeric.ccsLPSolve=function(e,t,n,i,r,a,o){var s,l,u,c,h,d,f,p,m,g=e[0],v=e[1],y=e[2],_=(g.length,t[0]),b=t[1],E=t[2];for(l=_[r],u=_[r+1],i.length=0,s=l;s<u;++s)o.dfs(a[b[s]],g,v,n,i,a);for(s=i.length-1;-1!==s;--s)n[i[s]]=0;for(s=l;s!==u;++s)n[c=a[b[s]]]=E[s];for(s=i.length-1;-1!==s;--s){for(h=g[c=i[s]],d=g[c+1],f=h;f<d;++f)if(a[v[f]]===c){n[c]/=y[f];break}for(m=n[c],f=h;f<d;++f)(p=a[v[f]])!==c&&(n[p]-=m*y[f])}return n},numeric.ccsLUP1=function(e,t){var n,i,r,a,o,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],h=[numeric.rep([u+1],0),[],[]],d=c[0],f=c[1],p=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([u],0),_=numeric.rep([u],0),b=numeric.ccsLPSolve,E=(Math.max,Math.abs),T=numeric.linspace(0,u-1),w=numeric.linspace(0,u-1),x=new numeric.ccsDFS(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,_,n,w,x),a=-1,o=-1,i=_.length-1;-1!==i;--i)(r=_[i])<=n||(s=E(y[r]))>a&&(o=r,a=s);for(E(y[n])<t*a&&(i=T[n],a=T[o],T[n]=a,w[a]=n,T[o]=i,w[i]=o,a=y[n],y[n]=y[o],y[o]=a),a=d[n],o=m[n],l=y[n],f[a]=T[n],p[a]=1,++a,i=_.length-1;-1!==i;--i)s=y[r=_[i]],_[i]=0,y[r]=0,r<=n?(g[o]=r,v[o]=s,++o):(f[a]=T[r],p[a]=s/l,++a);d[n+1]=a,m[n+1]=o}for(i=f.length-1;-1!==i;--i)f[i]=w[f[i]];return{L:c,U:h,P:T,Pinv:w}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,i,r,a,o){var s,l,u,c=0,h=r.length,d=this.k,f=this.k1,p=this.j;if(0===i[e])for(i[e]=1,p[0]=e,d[0]=l=t[a[e]],f[0]=u=t[a[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=u){if(r[h]=a[p[c]],0===c)return;++h,l=d[--c],u=f[c]}else 0===i[s=n[l]]?(i[s]=1,d[c]=l,p[++c]=s,l=t[s=a[s]],f[c]=u=t[s+1]):++l}},numeric.ccsLPSolve0=function(e,t,n,i,r,a,o,s){var l,u,c,h,d,f,p,m,g,v=e[0],y=e[1],_=e[2],b=(v.length,t[0]),E=t[1],T=t[2];for(u=b[r],c=b[r+1],i.length=0,l=u;l<c;++l)s.dfs(E[l],v,y,n,i,a,o);for(l=i.length-1;-1!==l;--l)n[o[h=i[l]]]=0;for(l=u;l!==c;++l)n[h=E[l]]=T[l];for(l=i.length-1;-1!==l;--l){for(m=o[h=i[l]],d=v[h],f=v[h+1],p=d;p<f;++p)if(y[p]===m){n[m]/=_[p];break}for(g=n[m],p=d;p<f;++p)n[y[p]]-=g*_[p];n[m]=g}},numeric.ccsLUP0=function(e,t){var n,i,r,a,o,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],h=[numeric.rep([u+1],0),[],[]],d=c[0],f=c[1],p=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([u],0),_=numeric.rep([u],0),b=numeric.ccsLPSolve0,E=(Math.max,Math.abs),T=numeric.linspace(0,u-1),w=numeric.linspace(0,u-1),x=new numeric.ccsDFS0(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,_,n,w,T,x),a=-1,o=-1,i=_.length-1;-1!==i;--i)(r=_[i])<=n||(s=E(y[T[r]]))>a&&(o=r,a=s);for(E(y[T[n]])<t*a&&(i=T[n],a=T[o],T[n]=a,w[a]=n,T[o]=i,w[i]=o),a=d[n],o=m[n],l=y[T[n]],f[a]=T[n],p[a]=1,++a,i=_.length-1;-1!==i;--i)s=y[T[r=_[i]]],_[i]=0,y[T[r]]=0,r<=n?(g[o]=r,v[o]=s,++o):(f[a]=T[r],p[a]=s/l,++a);d[n+1]=a,m[n+1]=o}for(i=f.length-1;-1!==i;--i)f[i]=w[f[i]];return{L:c,U:h,P:T,Pinv:w}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var i=numeric.ccsDim(e),r=i[0],a=i[1];void 0===t?t=numeric.linspace(0,r-1):"number"==typeof t&&(t=[t]),void 0===n?n=numeric.linspace(0,a-1):"number"==typeof n&&(n=[n]);var o,s,l,u,c=t.length,h=n.length,d=numeric.rep([a],0),f=[],p=[],m=[d,f,p],g=e[0],v=e[1],y=e[2],_=numeric.rep([r],0),b=0,E=numeric.rep([r],0);for(s=0;s<h;++s){var T=g[u=n[s]],w=g[u+1];for(o=T;o<w;++o)E[l=v[o]]=1,_[l]=y[o];for(o=0;o<c;++o)E[t[o]]&&(f[b]=o,p[b]=_[t[o]],++b);for(o=T;o<w;++o)E[l=v[o]]=0;d[s+1]=b}return m},numeric.ccsDot=function(e,t){var n,i,r,a,o,s,l,u,c,h,d,f=e[0],p=e[1],m=e[2],g=t[0],v=t[1],y=t[2],_=numeric.ccsDim(e),b=numeric.ccsDim(t),E=_[0],T=(_[1],b[1]),w=numeric.rep([E],0),x=numeric.rep([E],0),A=Array(E),S=numeric.rep([T],0),M=[],C=[],R=[S,M,C];for(r=0;r!==T;++r){for(a=g[r],o=g[r+1],c=0,i=a;i<o;++i)for(h=v[i],d=y[i],s=f[h],l=f[h+1],n=s;n<l;++n)0===x[u=p[n]]&&(A[c]=u,x[u]=1,c+=1),w[u]=w[u]+m[n]*d;for(o=(a=S[r])+c,S[r+1]=o,i=c-1;-1!==i;--i)d=a+i,n=A[i],M[d]=n,C[d]=w[n],x[n]=0,w[n]=0;S[r+1]=S[r]+c}return R},numeric.ccsLUPSolve=function(e,t){var n=e.L,i=e.U,r=(e.P,t[0]),a=!1;"object"!=typeof r&&(r=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],a=!0);var o,s,l,u,c,h,d=t[1],f=t[2],p=n[0].length-1,m=r.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),_=Array(p),b=numeric.rep([m+1],0),E=[],T=[],w=numeric.ccsTSolve,x=0;for(o=0;o<m;++o){for(c=0,l=r[o],u=r[o+1],s=l;s<u;++s)h=e.Pinv[d[s]],_[c]=h,y[h]=f[s],++c;for(_.length=c,w(n,y,g,_,v),s=_.length-1;-1!==s;--s)y[_[s]]=0;if(w(i,g,y,v,_),a)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=_.length-1;-1!==s;--s)h=_[s],E[x]=h,T[x]=y[h],y[h]=0,++x;b[o+1]=x}return[b,E,T]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],i=e[1],r=e[2],a=numeric.sup(i)+1,o=n.length,s=numeric.rep([a],0),l=Array(o),u=Array(o),c=numeric.rep([a],0);for(t=0;t<o;++t)c[i[t]]++;for(t=0;t<a;++t)s[t+1]=s[t]+c[t];var h,d,f=s.slice(0);for(t=0;t<o;++t)l[h=f[d=i[t]]]=n[t],u[h]=r[t],f[d]=f[d]+1;return[s,l,u]},numeric.ccsGather=function(e){var t,n,i,r,a,o=e[0],s=e[1],l=e[2],u=o.length-1,c=s.length,h=Array(c),d=Array(c),f=Array(c);for(a=0,t=0;t<u;++t)for(i=o[t],r=o[t+1],n=i;n!==r;++n)d[a]=t,h[a]=s[n],f[a]=l[n],++a;return[h,d,f]},numeric.sdim=function e(t,n,i){if(void 0===n&&(n=[]),"object"!=typeof t)return n;var r;for(r in void 0===i&&(i=0),i in n||(n[i]=0),t.length>n[i]&&(n[i]=t.length),t)t.hasOwnProperty(r)&&e(t[r],n,i+1);return n},numeric.sclone=function e(t,n,i){void 0===n&&(n=0),void 0===i&&(i=numeric.sdim(t).length);var r,a=Array(t.length);if(n===i-1){for(r in t)t.hasOwnProperty(r)&&(a[r]=t[r]);return a}for(r in t)t.hasOwnProperty(r)&&(a[r]=e(t[r],n+1,i));return a},numeric.sdiag=function(e){var t,n,i=e.length,r=Array(i);for(t=i-1;t>=1;t-=2)n=t-1,r[t]=[],r[t][t]=e[t],r[n]=[],r[n][n]=e[n];return 0===t&&(r[0]=[],r[0][0]=e[t]),r},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,n,i,r=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(n in i=e[t])i.hasOwnProperty(n)&&("object"!=typeof r[n]&&(r[n]=[]),r[n][t]=i[n]);return r},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,i,r,a,o,s,l,u=e.length,c=(t.length,numeric.stranspose(t)),h=c.length,d=Array(u);for(r=u-1;r>=0;r--){for(l=[],n=e[r],o=h-1;o>=0;o--){for(a in s=0,i=c[o],n)n.hasOwnProperty(a)&&a in i&&(s+=n[a]*i[a]);s&&(l[o]=s)}d[r]=l}return d},numeric.sdotMV=function(e,t){var n,i,r,a,o=e.length,s=Array(o);for(i=o-1;i>=0;i--){for(r in a=0,n=e[i])n.hasOwnProperty(r)&&t[r]&&(a+=n[r]*t[r]);a&&(s[i]=a)}return s},numeric.sdotVM=function(e,t){var n,i,r,a,o=[];for(n in e)if(e.hasOwnProperty(n))for(i in r=t[n],a=e[n],r)r.hasOwnProperty(i)&&(o[i]||(o[i]=0),o[i]+=a*r[i]);return o},numeric.sdotVV=function(e,t){var n,i=0;for(n in e)e[n]&&t[n]&&(i+=e[n]*t[n]);return i},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,i=numeric.sdim(t).length;switch(1e3*n+i){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+i)}},numeric.sscatter=function(e){var t,n,i,r,a=e[0].length,o=e.length,s=[];for(n=a-1;n>=0;--n)if(e[o-1][n]){for(r=s,i=0;i<o-2;i++)r[t=e[i][n]]||(r[t]=[]),r=r[t];r[e[i][n]]=e[i+1][n]}return s},numeric.sgather=function e(t,n,i){var r,a,o;for(a in void 0===n&&(n=[]),void 0===i&&(i=[]),r=i.length,t)if(t.hasOwnProperty(a))if(i[r]=parseInt(a),"number"==typeof(o=t[a])){if(o){if(0===n.length)for(a=r+1;a>=0;--a)n[a]=[];for(a=r;a>=0;--a)n[a].push(i[a]);n[r+1].push(o)}}else e(o,n,i);return i.length>r&&i.pop(),n},numeric.cLU=function(e){var t,n,i,r,a,o,s=e[0],l=e[1],u=e[2],c=s.length,h=0;for(t=0;t<c;t++)s[t]>h&&(h=s[t]);h++;var d,f=Array(h),p=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(i=0;i<c;i++)t=s[i],(n=l[i])<m[t]&&(m[t]=n),n>g[t]&&(g[t]=n);for(t=0;t<h-1;t++)g[t]>g[t+1]&&(g[t+1]=g[t]);for(t=h-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);for(t=0;t<h;t++)p[t]=numeric.rep([g[t]-m[t]+1],0),f[t]=numeric.rep([t-m[t]],0),t-m[t]+1,g[t]-t+1;for(i=0;i<c;i++)p[t=s[i]][l[i]-m[t]]=u[i];for(t=0;t<h-1;t++)for(r=t-m[t],_=p[t],n=t+1;m[n]<=t&&n<h;n++)if(a=t-m[n],o=g[t]-t,d=(b=p[n])[a]/_[r]){for(i=1;i<=o;i++)b[i+a]-=d*_[i+r];f[n][t-m[n]]=d}var v,y,_=[],b=[],E=[],T=[],w=[],x=[];for(c=0,v=0,t=0;t<h;t++){for(r=m[t],a=g[t],y=p[t],n=t;n<=a;n++)y[n-r]&&(_[c]=t,b[c]=n,E[c]=y[n-r],c++);for(y=f[t],n=r;n<t;n++)y[n-r]&&(T[v]=t,w[v]=n,x[v]=y[n-r],v++);T[v]=t,w[v]=t,x[v]=1,v++}return{U:[_,b,E],L:[T,w,x]}},numeric.cLUsolve=function(e,t){var n,i,r=e.L,a=e.U,o=numeric.clone(t),s=r[0],l=r[1],u=r[2],c=a[0],h=a[1],d=a[2],f=c.length,p=(s.length,o.length);for(i=0,n=0;n<p;n++){for(;l[i]<n;)o[n]-=u[i]*o[l[i]],i++;i++}for(i=f-1,n=p-1;n>=0;n--){for(;h[i]>n;)o[n]-=d[i]*o[h[i]],i--;o[n]/=d[i],i--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,i,r,a=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(e,t){return!0}}for(r=0,n=1;n<e[0]-1;n++)for(i=1;i<e[1]-1;i++)t(n,i)&&(a[n][i]=r,r++);return a},numeric.cdelsq=function(e){var t,n,i,r,a,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),l=s[0],u=s[1],c=[],h=[],d=[];for(t=1;t<l-1;t++)for(n=1;n<u-1;n++)if(!(e[t][n]<0)){for(i=0;i<4;i++)r=t+o[i][0],a=n+o[i][1],e[r][a]<0||(c.push(e[t][n]),h.push(e[r][a]),d.push(-1));c.push(e[t][n]),h.push(e[t][n]),d.push(4)}return[c,h,d]},numeric.cdotMV=function(e,t){var n,i,r,a=e[0],o=e[1],s=e[2],l=a.length;for(r=0,i=0;i<l;i++)a[i]>r&&(r=a[i]);for(r++,n=numeric.rep([r],0),i=0;i<l;i++)n[a[i]]+=s[i]*t[o[i]];return n},numeric.Spline=function(e,t,n,i,r){this.x=e,this.yl=t,this.yr=n,this.kl=i,this.kr=r},numeric.Spline.prototype._at=function(e,t){var n,i,r,a=this.x,o=this.yl,s=this.yr,l=this.kl,u=this.kr,c=numeric.add,h=numeric.sub,d=numeric.mul;n=h(d(l[t],a[t+1]-a[t]),h(s[t+1],o[t])),i=c(d(u[t+1],a[t]-a[t+1]),h(s[t+1],o[t]));var f=(r=(e-a[t])/(a[t+1]-a[t]))*(1-r);return c(c(c(d(1-r,o[t]),d(r,s[t+1])),d(n,f*(1-r))),d(i,f*r))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,i,r=this.x,a=r.length,o=Math.floor;for(t=0,n=a-1;n-t>1;)r[i=o((t+n)/2)]<=e?t=i:n=i;return this._at(e,t)}a=e.length;var s,l=Array(a);for(s=a-1;-1!==s;--s)l[s]=this.at(e[s]);return l},numeric.Spline.prototype.diff=function(){var e,t,n,i=this.x,r=this.yl,a=this.yr,o=this.kl,s=this.kr,l=r.length,u=o,c=s,h=Array(l),d=Array(l),f=numeric.add,p=numeric.mul,m=numeric.div,g=numeric.sub;for(e=l-1;-1!==e;--e)t=i[e+1]-i[e],n=g(a[e+1],r[e]),h[e]=m(f(p(n,6),p(o[e],-4*t),p(s[e+1],-2*t)),t*t),d[e+1]=m(f(p(n,-6),p(o[e],2*t),p(s[e+1],4*t)),t*t);return new numeric.Spline(i,u,c,h,d)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,i=this.yl,r=this.yr,a=this.kl,o=this.kr;"number"==typeof i[0]&&(i=[i],r=[r],a=[a],o=[o]);var s,l,u,c,h,d,f,p,m,g,v,y,_,b,E,T,w,x,A,S,M,C,R,I=i.length,P=n.length-1,L=(t=Array(I),Math.sqrt);for(s=0;s!==I;++s){for(c=i[s],h=r[s],d=a[s],f=o[s],p=[],l=0;l!==P;l++){for(l>0&&h[l]*c[l]<0&&p.push(n[l]),T=n[l+1]-n[l],n[l],v=c[l],y=h[l+1],m=d[l]/T,_=(g=f[l+1]/T)+3*v+2*m-3*y,b=3*(g+m+2*(v-y)),(E=e(m-g+3*(v-y))+12*g*v)<=0?w=(x=_/b)>n[l]&&x<n[l+1]?[n[l],x,n[l+1]]:[n[l],n[l+1]]:(x=(_-L(E))/b,A=(_+L(E))/b,w=[n[l]],x>n[l]&&x<n[l+1]&&w.push(x),A>n[l]&&A<n[l+1]&&w.push(A),w.push(n[l+1])),M=w[0],x=this._at(M,l),u=0;u<w.length-1;u++)if(C=w[u+1],A=this._at(C,l),0!==x)if(0===A||x*A>0)M=C,x=A;else{for(var D=0;!((R=(x*C-A*M)/(x-A))<=M||R>=C);)if((S=this._at(R,l))*A>0)C=R,A=S,-1===D&&(x*=.5),D=-1;else{if(!(S*x>0))break;M=R,x=S,1===D&&(A*=.5),D=1}p.push(R),M=w[u+1],x=this._at(M,l)}else p.push(M),M=C,x=A;0===A&&p.push(C)}t[s]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,i){var r,a=e.length,o=[],s=[],l=[],u=numeric.sub,c=numeric.mul,h=numeric.add;for(r=a-2;r>=0;r--)s[r]=e[r+1]-e[r],l[r]=u(t[r+1],t[r]);"string"!=typeof n&&"string"!=typeof i||(n=i="periodic");var d=[[],[],[]];switch(typeof n){case"undefined":o[0]=c(3/(s[0]*s[0]),l[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/s[0],1/s[0]);break;case"string":o[0]=h(c(3/(s[a-2]*s[a-2]),l[a-2]),c(3/(s[0]*s[0]),l[0])),d[0].push(0,0,0),d[1].push(a-2,0,1),d[2].push(1/s[a-2],2/s[a-2]+2/s[0],1/s[0]);break;default:o[0]=n,d[0].push(0),d[1].push(0),d[2].push(1)}for(r=1;r<a-1;r++)o[r]=h(c(3/(s[r-1]*s[r-1]),l[r-1]),c(3/(s[r]*s[r]),l[r])),d[0].push(r,r,r),d[1].push(r-1,r,r+1),d[2].push(1/s[r-1],2/s[r-1]+2/s[r],1/s[r]);switch(typeof i){case"undefined":o[a-1]=c(3/(s[a-2]*s[a-2]),l[a-2]),d[0].push(a-1,a-1),d[1].push(a-2,a-1),d[2].push(1/s[a-2],2/s[a-2]);break;case"string":d[1][d[1].length-1]=0;break;default:o[a-1]=i,d[0].push(a-1),d[1].push(a-1),d[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var f=Array(o.length);if("string"==typeof n)for(r=f.length-1;-1!==r;--r)f[r]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),o[r]),f[r][a-1]=f[r][0];else for(r=f.length-1;-1!==r;--r)f[r]=numeric.cLUsolve(numeric.cLU(d),o[r]);return f="number"==typeof t[0]?f[0]:numeric.transpose(f),new numeric.Spline(e,t,t,f,f)},numeric.fftpow2=function e(t,n){var i=t.length;if(1!==i){var r,a,o=Math.cos,s=Math.sin,l=Array(i/2),u=Array(i/2),c=Array(i/2),h=Array(i/2);for(a=i/2,r=i-1;-1!==r;--r)c[--a]=t[r],h[a]=n[r],--r,l[a]=t[r],u[a]=n[r];e(l,u),e(c,h),a=i/2;var d,f,p,m=-6.283185307179586/i;for(r=i-1;-1!==r;--r)-1===--a&&(a=i/2-1),f=o(d=m*r),p=s(d),t[r]=l[a]+f*c[a]-p*h[a],n[r]=u[a]+f*h[a]+p*c[a]}},numeric._ifftpow2=function e(t,n){var i=t.length;if(1!==i){var r,a,o=Math.cos,s=Math.sin,l=Array(i/2),u=Array(i/2),c=Array(i/2),h=Array(i/2);for(a=i/2,r=i-1;-1!==r;--r)c[--a]=t[r],h[a]=n[r],--r,l[a]=t[r],u[a]=n[r];e(l,u),e(c,h),a=i/2;var d,f,p,m=6.283185307179586/i;for(r=i-1;-1!==r;--r)-1===--a&&(a=i/2-1),f=o(d=m*r),p=s(d),t[r]=l[a]+f*c[a]-p*h[a],n[r]=u[a]+f*h[a]+p*c[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,i){var r,a,o,s,l;for(numeric.fftpow2(e,t),numeric.fftpow2(n,i),r=e.length-1;-1!==r;--r)a=e[r],s=t[r],o=n[r],l=i[r],e[r]=a*o-s*l,t[r]=a*l+s*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,n=this.x,i=this.y,r=n.length,a=Math.log,o=a(2),s=Math.ceil(a(2*r-1)/o),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),h=Math.cos,d=Math.sin,f=-3.141592653589793/r,p=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(r/2);for(e=0;e<r;e++)p[e]=n[e];if(void 0!==i)for(e=0;e<r;e++)m[e]=i[e];for(u[0]=1,e=1;e<=l/2;e++)t=f*e*e,u[e]=h(t),c[e]=d(t),u[l-e]=h(t),c[l-e]=d(t);var g=new numeric.T(p,m),v=new numeric.T(u,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=r,g.y.length=r,g},numeric.T.prototype.ifft=function(){var e,t,n=this.x,i=this.y,r=n.length,a=Math.log,o=a(2),s=Math.ceil(a(2*r-1)/o),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),h=Math.cos,d=Math.sin,f=3.141592653589793/r,p=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(r/2);for(e=0;e<r;e++)p[e]=n[e];if(void 0!==i)for(e=0;e<r;e++)m[e]=i[e];for(u[0]=1,e=1;e<=l/2;e++)t=f*e*e,u[e]=h(t),c[e]=d(t),u[l-e]=h(t),c[l-e]=d(t);var g=new numeric.T(p,m),v=new numeric.T(u,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=r,g.y.length=r,g.div(r)},numeric.gradient=function(e,t){var n=t.length,i=e(t);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var r,a,o,s,l,u,c,h,d,f=Math.max,p=numeric.clone(t),m=Array(n),g=(numeric.div,numeric.sub,f=Math.max,Math.abs),v=Math.min,y=0;for(r=0;r<n;r++)for(var _=f(1e-6*i,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(p[r]=t[r]+_,a=e(p),p[r]=t[r]-_,o=e(p),p[r]=t[r],isNaN(a)||isNaN(o))_/=16;else{if(m[r]=(a-o)/(2*_),s=t[r]-_,l=t[r],u=t[r]+_,c=(a-i)/_,h=(i-o)/_,d=f(g(m[r]),g(i),g(a),g(o),g(s),g(l),g(u),1e-8),!(v(f(g(c-m[r]),g(h-m[r]),g(c-h))/d,_/d)>.001))break;_/=16}}return m},numeric.uncmin=function(e,t,n,i,r,a,o){var s=numeric.gradient;void 0===o&&(o={}),void 0===n&&(n=1e-8),void 0===i&&(i=function(t){return s(e,t)}),void 0===r&&(r=1e3);var l,u,c=(t=numeric.clone(t)).length,h=e(t);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,f=numeric.norm2;n=d(n,numeric.epsilon);var p,m,g,v,y,_,b,E,T,w,x=o.Hinv||numeric.identity(c),A=numeric.dot,S=(numeric.inv,numeric.sub),M=numeric.add,C=numeric.tensor,R=numeric.div,I=numeric.mul,P=numeric.all,L=numeric.isFinite,D=numeric.neg,O=0,N="";for(m=i(t);O<r;){if("function"==typeof a&&a(O,t,h,m,x)){N="Callback returned true";break}if(!P(L(m))){N="Gradient has Infinity or NaN";break}if(!P(L(p=D(A(x,m))))){N="Search direction has Infinity or NaN";break}if((w=f(p))<n){N="Newton step smaller than tol";break}for(T=1,u=A(m,p),y=t;O<r&&!(T*w<n)&&(y=M(t,v=I(p,T)),(l=e(y))-h>=.1*T*u||isNaN(l));)T*=.5,++O;if(T*w<n){N="Line search step size smaller than tol";break}if(O===r){N="maxit reached during line search";break}E=A(_=S(g=i(y),m),v),b=A(x,_),x=S(M(x,I((E+A(_,b))/(E*E),C(v,v))),R(M(C(b,v),C(v,b)),E)),t=y,h=l,m=g,++O}return{solution:t,f:h,gradient:m,invHessian:x,iterations:O,message:N}},numeric.Dopri=function(e,t,n,i,r,a,o){this.x=e,this.y=t,this.f=n,this.ymid=i,this.iterations=r,this.events=o,this.message=a},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var i,r,a,o,s,l,u,c,h,d=this.x,f=this.y,p=this.f,m=this.ymid,g=(d.length,Math.floor,numeric.add),v=numeric.mul,y=numeric.sub;return i=d[t],r=d[t+1],o=f[t],s=f[t+1],a=i+.5*(r-i),l=m[t],u=y(p[t],v(o,1/(i-a)+2/(i-r))),c=y(p[t+1],v(s,1/(r-a)+2/(r-i))),g(g(g(g(v(o,(h=[n(e-r)*(e-a)/n(i-r)/(i-a),n(e-i)*n(e-r)/n(i-a)/n(r-a),n(e-i)*(e-a)/n(r-i)/(r-a),(e-i)*n(e-r)*(e-a)/n(i-r)/(i-a),(e-r)*n(e-i)*(e-a)/n(i-r)/(r-a)])[0]),v(l,h[1])),v(s,h[2])),v(u,h[3])),v(c,h[4]))},numeric.Dopri.prototype.at=function(e){var t,n,i,r=Math.floor;if("number"!=typeof e){var a=e.length,o=Array(a);for(t=a-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var s=this.x;for(t=0,n=s.length-1;n-t>1;)s[i=r(.5*(t+n))]<=e?t=i:n=i;return this._at(e,t)},numeric.dopri=function(e,t,n,i,r,a,o){void 0===r&&(r=1e-6),void 0===a&&(a=1e3);var s,l,u,c,h,d,f,p,m,g,v,y,_,b=[e],E=[n],T=[i(e,n)],w=[],x=[3/40,9/40],A=[44/45,-56/15,32/9],S=[19372/6561,-25360/2187,64448/6561,-212/729],M=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],C=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],I=[.2,.3,.8,8/9,1,1],P=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],L=0,D=(t-e)/10,O=0,N=numeric.add,k=numeric.mul,F=(Math.max,Math.min),B=Math.abs,U=numeric.norminf,j=Math.pow,G=numeric.any,z=numeric.lt,H=numeric.and,V=(numeric.sub,new numeric.Dopri(b,E,T,w,-1,""));for("function"==typeof o&&(v=o(e,n));e<t&&O<a;)if(++O,e+D>t&&(D=t-e),s=i(e+I[0]*D,N(n,k(.2*D,T[L]))),l=i(e+I[1]*D,N(N(n,k(x[0]*D,T[L])),k(x[1]*D,s))),u=i(e+I[2]*D,N(N(N(n,k(A[0]*D,T[L])),k(A[1]*D,s)),k(A[2]*D,l))),c=i(e+I[3]*D,N(N(N(N(n,k(S[0]*D,T[L])),k(S[1]*D,s)),k(S[2]*D,l)),k(S[3]*D,u))),h=i(e+I[4]*D,N(N(N(N(N(n,k(M[0]*D,T[L])),k(M[1]*D,s)),k(M[2]*D,l)),k(M[3]*D,u)),k(M[4]*D,c))),d=i(e+D,m=N(N(N(N(N(n,k(T[L],D*C[0])),k(l,D*C[2])),k(u,D*C[3])),k(c,D*C[4])),k(h,D*C[5]))),(g="number"==typeof(f=N(N(N(N(N(k(T[L],D*P[0]),k(l,D*P[2])),k(u,D*P[3])),k(c,D*P[4])),k(h,D*P[5])),k(d,D*P[6])))?B(f):U(f))>r){if(e+(D=.2*D*j(r/g,.25))===e){V.msg="Step size became too small";break}}else{if(w[L]=N(N(N(N(N(N(n,k(T[L],D*R[0])),k(l,D*R[2])),k(u,D*R[3])),k(c,D*R[4])),k(h,D*R[5])),k(d,D*R[6])),b[++L]=e+D,E[L]=m,T[L]=d,"function"==typeof o){var W,q,Y=e,X=e+.5*D;if(y=o(X,w[L-1]),G(_=H(z(v,0),z(0,y)))||(Y=X,v=y,y=o(X=e+D,m),_=H(z(v,0),z(0,y))),G(_)){for(var K,Q,Z=0,J=1,$=1;;){if("number"==typeof v)q=($*y*Y-J*v*X)/($*y-J*v);else for(q=X,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(q=F(q,($*y[p]*Y-J*v[p]*X)/($*y[p]-J*v[p])));if(q<=Y||q>=X)break;Q=o(q,W=V._at(q,L-1)),G(K=H(z(v,0),z(0,Q)))?(X=q,y=Q,_=K,$=1,-1===Z?J*=.5:J=1,Z=-1):(Y=q,v=Q,J=1,1===Z?$*=.5:$=1,Z=1)}return m=V._at(.5*(e+q),L-1),V.f[L]=i(q,W),V.x[L]=q,V.y[L]=W,V.ymid[L-1]=m,V.events=_,V.iterations=O,V}}e+=D,n=m,v=y,D=F(.8*D*j(r/g,.25),4*D)}return V.iterations=O,V},numeric.LU=function(e,t){t=t||!1;var n,i,r,a,o,s,l,u,c,h=Math.abs,d=e.length,f=d-1,p=new Array(d);for(t||(e=numeric.clone(e)),r=0;r<d;++r){for(l=r,c=h((s=e[r])[r]),i=r+1;i<d;++i)c<(a=h(e[i][r]))&&(c=a,l=i);for(p[r]=l,l!=r&&(e[r]=e[l],e[l]=s,s=e[r]),o=s[r],n=r+1;n<d;++n)e[n][r]/=o;for(n=r+1;n<d;++n){for(u=e[n],i=r+1;i<f;++i)u[i]-=u[r]*s[i],u[++i]-=u[r]*s[i];i===f&&(u[i]-=u[r]*s[i])}}return{LU:e,P:p}},numeric.LUsolve=function(e,t){var n,i,r,a,o,s=e.LU,l=s.length,u=numeric.clone(t),c=e.P;for(n=l-1;-1!==n;--n)u[n]=t[n];for(n=0;n<l;++n)for(r=c[n],c[n]!==n&&(o=u[n],u[n]=u[r],u[r]=o),a=s[n],i=0;i<n;++i)u[n]-=u[i]*a[i];for(n=l-1;n>=0;--n){for(a=s[n],i=n+1;i<l;++i)u[n]-=u[i]*a[i];u[n]/=a[n]}return u},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,i,r,a,o,s,l,u=numeric.dim(e),c=u[0],h=u[1],d=numeric.identity(c),f=Array(c),p=Math.abs,m=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(i=0,a=e[t],o=d[t],n=1;n<h;++n)p(a[i])<p(a[n])&&(i=n);for(f[t]=i,m(o,a[i]),m(a,a[i]),n=0;n<c;++n)if(n!==t){for(l=(s=e[n])[i],r=h-1;-1!==r;--r)s[r]-=a[r]*l;for(s=d[n],r=c-1;-1!==r;--r)s[r]-=o[r]*l}}return{I:d,A:e,P:f}},numeric.__solveLP=function(e,t,n,i,r,a,o){var s,l,u,c,h=numeric.sum,d=(numeric.log,numeric.mul),f=numeric.sub,p=numeric.dot,m=numeric.div,g=numeric.add,v=e.length,y=n.length,_=!1,b=1,E=(numeric.transpose(t),numeric.svd,numeric.transpose),T=(numeric.leq,Math.sqrt),w=Math.abs,x=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,S=numeric.gt,M=Array(v),C=Array(y),R=(numeric.rep([y],1),numeric.solve),I=f(n,p(t,a)),P=p(e,e);for(u=0;u<r;++u){var L,D;for(L=y-1;-1!==L;--L)C[L]=m(t[L],I[L]);var O=E(C);for(L=v-1;-1!==L;--L)M[L]=h(O[L]);b=.25*w(P/p(e,M));var N=100*T(P/p(M,M));for((!isFinite(b)||b>N)&&(b=N),c=g(e,d(b,M)),l=p(O,C),L=v-1;-1!==L;--L)l[L][L]+=1;D=R(l,m(c,b),!0);var k=m(I,p(t,D)),F=1;for(L=y-1;-1!==L;--L)k[L]<0&&(F=x(F,-.999*k[L]));if(s=f(a,d(D,F)),!A(S(I=f(n,p(t,s)),0)))return{solution:a,message:"",iterations:u};if(a=s,b<i)return{solution:s,message:"",iterations:u};if(o){var B=p(e,c),U=p(t,c);for(_=!0,L=y-1;-1!==L;--L)if(B*U[L]<0){_=!1;break}}else _=!(a[v-1]>=0);if(_)return{solution:s,message:"Unbounded",iterations:u}}return{solution:a,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,n,i,r){var a=e.length,o=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),c=numeric.rep([o,1],-1),h=numeric.blockMatrix([[t,c]]),d=n,f=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(u,h,d,i,r,f,!1),m=numeric.clone(p.solution);if(m.length=a,numeric.inf(s(n,l(t,m)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(e,t,n,i,r-p.iterations,m,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(e,t,n,i,r,a,o){if(void 0===o&&(o=1e3),void 0===a&&(a=numeric.epsilon),void 0===i)return numeric._solveLP(e,t,n,a,o);var s,l=i.length,u=i[0].length,c=t.length,h=numeric.echelonize(i),d=numeric.rep([u],0),f=h.P,p=[];for(s=f.length-1;-1!==s;--s)d[f[s]]=1;for(s=u-1;-1!==s;--s)0===d[s]&&p.push(s);var m=numeric.getRange,g=numeric.linspace(0,l-1),v=numeric.linspace(0,c-1),y=m(i,g,p),_=m(t,v,f),b=m(t,v,p),E=numeric.dot,T=numeric.sub,w=E(_,h.I),x=T(b,E(w,y)),A=T(n,E(w,r)),S=Array(f.length),M=Array(p.length);for(s=f.length-1;-1!==s;--s)S[s]=e[f[s]];for(s=p.length-1;-1!==s;--s)M[s]=e[p[s]];var C=T(M,E(S,E(h.I,y))),R=numeric._solveLP(C,x,A,a,o),I=R.solution;if(I!=I)return R;var P=E(h.I,T(r,E(y,I))),L=Array(e.length);for(s=f.length-1;-1!==s;--s)L[f[s]]=P[s];for(s=p.length-1;-1!==s;--s)L[p[s]]=I[s];return{solution:L,message:R.message,iterations:R.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,n,i,r,a=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,l=0,u={},c=[],h=0,d={},f=0,p=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+t+": "+e[t]+"\nCurrent state: "+o[a]+"\n")}for(t=0;t<s;++t){var y=(i=e[t]).match(/\S*/g),_=[];for(n=0;n<y.length;++n)""!==y[n]&&_.push(y[n]);if(0!==_.length){for(n=0;n<o.length&&i.substr(0,o[n].length)!==o[n];++n);if(n<o.length){if(a=n,1===n&&(r=_[1]),6===n)return{name:r,c:p,A:numeric.transpose(m),b:g,rows:u,vars:d}}else switch(a){case 0:case 1:v("Unexpected line");case 2:switch(_[0]){case"N":0===l?l=_[1]:v("Two or more N rows");break;case"L":u[_[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":u[_[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":u[_[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(_))}break;case 3:d.hasOwnProperty(_[0])||(d[_[0]]=f,p[f]=0,m[f]=numeric.rep([h],0),++f);var b=d[_[0]];for(n=1;n<_.length;n+=2)if(_[n]!==l){var E=u[_[n]];m[b][E]=(c[E]<0?-1:1)*parseFloat(_[n+1])}else p[b]=parseFloat(_[n+1]);break;case 4:for(n=1;n<_.length;n+=2)g[u[_[n]]]=(c[u[_[n]]]<0?-1:1)*parseFloat(_[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,i,r,a,o){function s(e){var t,n,i=this,r=e.length,a=0,o=i.i=i.j=i.m=0;for(i.S=[],i.c=[],r||(e=[r++]);a<256;)i.S[a]=a++;for(a=0;a<256;a++)o=c(o+(t=i.S[a])+e[a%r]),n=i.S[o],i.S[a]=n,i.S[o]=t;i.g=function(e){var t=i.S,n=c(i.i+1),r=t[n],a=c(i.j+r),o=t[a];t[n]=o,t[a]=r;for(var s=t[c(r+o)];--e;)n=c(n+1),o=t[a=c(a+(r=t[n]))],t[n]=o,t[a]=r,s=256*s+t[c(r+o)];return i.i=n,i.j=a,s},i.g(256)}function l(e,t,n,i,r){if(n=[],r=typeof e,t&&"object"==r)for(i in e)if(i.indexOf("S")<5)try{n.push(l(e[i],t-1))}catch(e){}return n.length?n:e+("string"!=r?"\0":"")}function u(e,t,n,i){for(e+="",n=0,i=0;i<e.length;i++)t[c(i)]=c((n^=19*t[c(i)])+e.charCodeAt(i));for(i in e="",t)e+=String.fromCharCode(t[i]);return e}function c(e){return 255&e}t.seedrandom=function(n,i){var c,h=[];return n=u(l(i?[n,e]:arguments.length?n:[(new Date).getTime(),e,window],3),h),u((c=new s(h)).S,e),t.random=function(){for(var e=c.g(6),t=o,n=0;e<r;)e=256*(e+n),t*=256,n=c.g(1);for(;e>=a;)e/=2,t/=2,n>>>=1;return(e+n)/t},n},o=t.pow(256,6),r=t.pow(2,r),a=2*r,u(t.random(),e)}([],numeric.seedrandom,0,0,52),function(e){function t(e){if("object"!=typeof e)return e;var n,i=[],r=e.length;for(n=0;n<r;n++)i[n+1]=t(e[n]);return i}function n(e){if("object"!=typeof e)return e;var t,i=[],r=e.length;for(t=1;t<r;t++)i[t-1]=n(e[t]);return i}function i(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){var g,v,y,_,b,E,T,w,x,A,S,M,C,R,I,P,L,D,O,N,k,F,B,U,j,G,z;C=Math.min(i,u),y=2*i+C*(C+5)/2+2*u+1,U=1e-60;do{j=1+.1*(U+=U),G=1+.2*U}while(j<=1||G<=1);for(g=1;g<=i;g+=1)p[g]=t[g];for(g=i+1;g<=y;g+=1)p[g]=0;for(g=1;g<=u;g+=1)h[g]=0;if(b=[],0===m[1]){if(function(e,t,n,i){var r,a,o,s,l,u;for(a=1;a<=n;a+=1){if(i[1]=a,u=0,(o=a-1)<1){if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}else{for(s=1;s<=o;s+=1){for(l=e[s][a],r=1;r<s;r+=1)l-=e[r][a]*e[r][s];l/=e[s][s],e[s][a]=l,u+=l*l}if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}i[1]=0}}(e,0,i,b),0!==b[1])return void(m[1]=2);!function(e,t,n,i){var r,a,o,s;for(a=1;a<=n;a+=1){for(s=0,r=1;r<a;r+=1)s+=e[r][a]*i[r];i[a]=(i[a]-s)/e[a][a]}for(o=1;o<=n;o+=1)for(i[a=n+1-o]=i[a]/e[a][a],s=-i[a],r=1;r<a;r+=1)i[r]=i[r]+s*e[r][a]}(e,0,i,t),function(e,t,n){var i,r,a,o,s;for(a=1;a<=n;a+=1){for(e[a][a]=1/e[a][a],s=-e[a][a],i=1;i<a;i+=1)e[i][a]=s*e[i][a];if(n<(o=a+1))break;for(r=o;r<=n;r+=1)for(s=e[a][r],e[a][r]=0,i=1;i<=a;i+=1)e[i][r]=e[i][r]+s*e[i][a]}}(e,0,i)}else{for(v=1;v<=i;v+=1)for(r[v]=0,g=1;g<=v;g+=1)r[v]=r[v]+e[g][v]*t[g];for(v=1;v<=i;v+=1)for(t[v]=0,g=v;g<=i;g+=1)t[v]=t[v]+e[v][g]*r[g]}for(a[1]=0,v=1;v<=i;v+=1)for(r[v]=t[v],a[1]=a[1]+p[v]*r[v],p[v]=0,g=v+1;g<=i;g+=1)e[g][v]=0;for(a[1]=-a[1]/2,m[1]=0,R=(A=(x=(S=(w=(T=i)+i)+C)+C+1)+C*(C+1)/2)+u,g=1;g<=u;g+=1){for(P=0,v=1;v<=i;v+=1)P+=o[v][g]*o[v][g];p[R+g]=Math.sqrt(P)}function H(){for(f[1]=f[1]+1,y=A,g=1;g<=u;g+=1){for(y+=1,P=-s[g],v=1;v<=i;v+=1)P+=o[v][g]*r[v];if(Math.abs(P)<U&&(P=0),g>c)p[y]=P;else if(p[y]=-Math.abs(P),P>0){for(v=1;v<=i;v+=1)o[v][g]=-o[v][g];s[g]=-s[g]}}for(g=1;g<=d;g+=1)p[A+h[g]]=0;for(M=0,I=0,g=1;g<=u;g+=1)p[A+g]<I*p[R+g]&&(M=g,I=p[A+g]/p[R+g]);return 0===M?999:0}function V(){for(g=1;g<=i;g+=1){for(P=0,v=1;v<=i;v+=1)P+=e[v][g]*o[v][M];p[g]=P}for(_=T,g=1;g<=i;g+=1)p[_+g]=0;for(v=d+1;v<=i;v+=1)for(g=1;g<=i;g+=1)p[_+g]=p[_+g]+e[g][v]*p[v];for(F=!0,g=d;g>=1;g-=1){for(P=p[g],_=(y=x+g*(g+3)/2)-g,v=g+1;v<=d;v+=1)P-=p[y]*p[w+v],y+=v;if(P/=p[_],p[w+g]=P,h[g]<c)break;if(P<0)break;F=!1,E=g}if(!F)for(L=p[S+E]/p[w+E],g=1;g<=d&&!(h[g]<c)&&!(p[w+g]<0);g+=1)(I=p[S+g]/p[w+g])<L&&(L=I,E=g);for(P=0,g=T+1;g<=T+i;g+=1)P+=p[g]*p[g];if(Math.abs(P)<=U){if(F)return m[1]=1,999;for(g=1;g<=d;g+=1)p[S+g]=p[S+g]-L*p[w+g];return p[S+d+1]=p[S+d+1]+L,700}for(P=0,g=1;g<=i;g+=1)P+=p[T+g]*o[g][M];for(D=-p[A+M]/P,B=!0,F||L<D&&(D=L,B=!1),g=1;g<=i;g+=1)r[g]=r[g]+D*p[T+g],Math.abs(r[g])<U&&(r[g]=0);for(a[1]=a[1]+D*P*(D/2+p[S+d+1]),g=1;g<=d;g+=1)p[S+g]=p[S+g]-D*p[w+g];if(p[S+d+1]=p[S+d+1]+D,!B){for(P=-s[M],v=1;v<=i;v+=1)P+=r[v]*o[v][M];if(M>c)p[A+M]=P;else if(p[A+M]=-Math.abs(P),P>0){for(v=1;v<=i;v+=1)o[v][M]=-o[v][M];s[M]=-s[M]}return 700}for(h[d+=1]=M,y=x+(d-1)*d/2+1,g=1;g<=d-1;g+=1)p[y]=p[g],y+=1;if(d===i)p[y]=p[i];else{for(g=i;g>=d+1&&0!==p[g]&&(O=Math.max(Math.abs(p[g-1]),Math.abs(p[g])),N=Math.min(Math.abs(p[g-1]),Math.abs(p[g])),I=p[g-1]>=0?Math.abs(O*Math.sqrt(1+N*N/(O*O))):-Math.abs(O*Math.sqrt(1+N*N/(O*O))),O=p[g-1]/I,N=p[g]/I,1!==O);g-=1)if(0===O)for(p[g-1]=N*I,v=1;v<=i;v+=1)I=e[v][g-1],e[v][g-1]=e[v][g],e[v][g]=I;else for(p[g-1]=I,k=N/(1+O),v=1;v<=i;v+=1)I=O*e[v][g-1]+N*e[v][g],e[v][g]=k*(e[v][g-1]+I)-e[v][g],e[v][g-1]=I;p[y]=p[d]}return 0}function W(){if(0===p[_=(y=x+E*(E+1)/2+1)+E])return 798;if(O=Math.max(Math.abs(p[_-1]),Math.abs(p[_])),N=Math.min(Math.abs(p[_-1]),Math.abs(p[_])),I=p[_-1]>=0?Math.abs(O*Math.sqrt(1+N*N/(O*O))):-Math.abs(O*Math.sqrt(1+N*N/(O*O))),O=p[_-1]/I,N=p[_]/I,1===O)return 798;if(0===O){for(g=E+1;g<=d;g+=1)I=p[_-1],p[_-1]=p[_],p[_]=I,_+=g;for(g=1;g<=i;g+=1)I=e[g][E],e[g][E]=e[g][E+1],e[g][E+1]=I}else{for(k=N/(1+O),g=E+1;g<=d;g+=1)I=O*p[_-1]+N*p[_],p[_]=k*(p[_-1]+I)-p[_],p[_-1]=I,_+=g;for(g=1;g<=i;g+=1)I=O*e[g][E]+N*e[g][E+1],e[g][E+1]=k*(e[g][E]+I)-e[g][E+1],e[g][E]=I}return 0}function q(){for(_=y-E,g=1;g<=E;g+=1)p[_]=p[y],y+=1,_+=1;return p[S+E]=p[S+E+1],h[E]=h[E+1],(E+=1)<d?797:0}function Y(){return p[S+d]=p[S+d+1],p[S+d+1]=0,h[d]=0,d-=1,f[2]=f[2]+1,0}for(d=0,f[1]=0,f[2]=0,z=0;;){if(999===(z=H()))return;for(;0!==(z=V());){if(999===z)return;if(700===z)if(E===d)Y();else{for(;W(),797===(z=q()););Y()}}}}e.solveQP=function(e,r,a,o,s,l){e=t(e),r=t(r),a=t(a);var u,c,h,d,f,p=[],m=[],g=[],v=[],y=[];if(s=s||0,l=l?t(l):[void 0,0],o=o?t(o):[],c=e.length-1,h=a[1].length-1,!o)for(u=1;u<=h;u+=1)o[u]=0;for(u=1;u<=h;u+=1)m[u]=0;for(0,d=Math.min(c,h),u=1;u<=c;u+=1)g[u]=0;for(p[1]=0,u=1;u<=2*c+d*(d+5)/2+2*h+1;u+=1)v[u]=0;for(u=1;u<=2;u+=1)y[u]=0;return i(e,r,0,c,g,p,a,o,0,h,s,m,0,y,v,l),f="",1===l[1]&&(f="constraints are inconsistent, no solution!"),2===l[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(p),unconstrained_solution:n(r),iterations:n(y),iact:n(m),message:f}}}(numeric),numeric.svd=function(e){var t,n=numeric.epsilon,i=1e-64/n,r=0,a=0,o=0,s=0,l=0,u=numeric.clone(e),c=u.length,h=u[0].length;if(c<h)throw"Need more rows than columns";var d=new Array(h),f=new Array(h);for(a=0;a<h;a++)d[a]=f[a]=0;var p=numeric.rep([h,h],0);function m(e,t){return(e=Math.abs(e))>(t=Math.abs(t))?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var g=0,v=0,y=0,_=0,b=0,E=0,T=0;for(a=0;a<h;a++){for(d[a]=v,T=0,l=a+1,o=a;o<c;o++)T+=u[o][a]*u[o][a];if(T<=i)v=0;else for(g=u[a][a],v=Math.sqrt(T),g>=0&&(v=-v),y=g*v-T,u[a][a]=g-v,o=l;o<h;o++){for(T=0,s=a;s<c;s++)T+=u[s][a]*u[s][o];for(g=T/y,s=a;s<c;s++)u[s][o]+=g*u[s][a]}for(f[a]=v,T=0,o=l;o<h;o++)T+=u[a][o]*u[a][o];if(T<=i)v=0;else{for(g=u[a][a+1],v=Math.sqrt(T),g>=0&&(v=-v),y=g*v-T,u[a][a+1]=g-v,o=l;o<h;o++)d[o]=u[a][o]/y;for(o=l;o<c;o++){for(T=0,s=l;s<h;s++)T+=u[o][s]*u[a][s];for(s=l;s<h;s++)u[o][s]+=T*d[s]}}(b=Math.abs(f[a])+Math.abs(d[a]))>_&&(_=b)}for(a=h-1;-1!=a;a+=-1){if(0!=v){for(y=v*u[a][a+1],o=l;o<h;o++)p[o][a]=u[a][o]/y;for(o=l;o<h;o++){for(T=0,s=l;s<h;s++)T+=u[a][s]*p[s][o];for(s=l;s<h;s++)p[s][o]+=T*p[s][a]}}for(o=l;o<h;o++)p[a][o]=0,p[o][a]=0;p[a][a]=1,v=d[a],l=a}for(a=h-1;-1!=a;a+=-1){for(l=a+1,v=f[a],o=l;o<h;o++)u[a][o]=0;if(0!=v){for(y=u[a][a]*v,o=l;o<h;o++){for(T=0,s=l;s<c;s++)T+=u[s][a]*u[s][o];for(g=T/y,s=a;s<c;s++)u[s][o]+=g*u[s][a]}for(o=a;o<c;o++)u[o][a]=u[o][a]/v}else for(o=a;o<c;o++)u[o][a]=0;u[a][a]+=1}for(n*=_,s=h-1;-1!=s;s+=-1)for(var w=0;w<50;w++){var x=!1;for(l=s;-1!=l;l+=-1){if(Math.abs(d[l])<=n){x=!0;break}if(Math.abs(f[l-1])<=n)break}if(!x){r=0,T=1;var A=l-1;for(a=l;a<s+1&&(g=T*d[a],d[a]=r*d[a],!(Math.abs(g)<=n));a++)for(y=m(g,v=f[a]),f[a]=y,r=v/y,T=-g/y,o=0;o<c;o++)b=u[o][A],E=u[o][a],u[o][A]=b*r+E*T,u[o][a]=-b*T+E*r}if(E=f[s],l==s){if(E<0)for(f[s]=-E,o=0;o<h;o++)p[o][s]=-p[o][s];break}if(w>=49)throw"Error: no convergence.";for(_=f[l],v=m(g=(((b=f[s-1])-E)*(b+E)+((v=d[s-1])-(y=d[s]))*(v+y))/(2*y*b),1),g=g<0?((_-E)*(_+E)+y*(b/(g-v)-y))/_:((_-E)*(_+E)+y*(b/(g+v)-y))/_,r=1,T=1,a=l+1;a<s+1;a++){for(v=d[a],b=f[a],y=T*v,v*=r,E=m(g,y),d[a-1]=E,g=_*(r=g/E)+v*(T=y/E),v=-_*T+v*r,y=b*T,b*=r,o=0;o<h;o++)_=p[o][a-1],E=p[o][a],p[o][a-1]=_*r+E*T,p[o][a]=-_*T+E*r;for(E=m(g,y),f[a-1]=E,g=(r=g/E)*v+(T=y/E)*b,_=-T*v+r*b,o=0;o<c;o++)b=u[o][a-1],E=u[o][a],u[o][a-1]=b*r+E*T,u[o][a]=-b*T+E*r}d[l]=0,d[s]=g,f[s]=_}for(a=0;a<f.length;a++)f[a]<n&&(f[a]=0);for(a=0;a<h;a++)for(o=a-1;o>=0;o--)if(f[o]<f[a]){for(r=f[o],f[o]=f[a],f[a]=r,s=0;s<u.length;s++)t=u[s][a],u[s][a]=u[s][o],u[s][o]=t;for(s=0;s<p.length;s++)t=p[s][a],p[s][a]=p[s][o],p[s][o]=t;a=o}return{U:u,S:f,V:p}}}).call(this,__webpack_require__(17))},function(e,t,n){"use strict";var i,r,a,o,s,l=n(75).toUnsigned,u=n(75).toHexString,c=n(46);i=function(e){return c.findBox(e,["moov","trak"]).reduce((function(e,t){var n,i,r,a,o;return(n=c.findBox(t,["tkhd"])[0])?(i=n[0],a=l(n[r=0===i?12:20]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]),(o=c.findBox(t,["mdia","mdhd"])[0])?(r=0===(i=o[0])?12:20,e[a]=l(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),e):null):null}),{})},r=function(e,t){var n,i,r;return n=c.findBox(t,["moof","traf"]),i=[].concat.apply([],n.map((function(t){return c.findBox(t,["tfhd"]).map((function(n){var i,r;return i=l(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),r=e[i]||9e4,(c.findBox(t,["tfdt"]).map((function(e){var t,n;return t=e[0],n=l(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=l(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n}))[0]||1/0)/r}))}))),r=Math.min.apply(null,i),isFinite(r)?r:0},a=function(e,t){var n,i=c.findBox(t,["moof","traf"]),r=0,a=0;if(i&&i.length)for(var o=c.parseTraf(i[0]),s=0;s<o.boxes.length;s++)"tfhd"===o.boxes[s].type?n=o.boxes[s].trackId:"tfdt"===o.boxes[s].type?r=o.boxes[s].baseMediaDecodeTime:"trun"===o.boxes[s].type&&o.boxes[s].samples.length&&(a=o.boxes[s].samples[0].compositionTimeOffset||0);return(r+a)/(e[n]||9e4)},o=function(e){var t=c.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t=c.findBox(e,["mdia","hdlr"]),i=c.findBox(e,["tkhd"]);t.forEach((function(e,t){var r,a,o=c.parseType(e.subarray(8,12)),s=i[t];"vide"===o&&(a=0===(r=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),n.push(a))}))})),n},s=function(e){var t=c.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t,i,r={},a=c.findBox(e,["tkhd"])[0];a&&(i=(t=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),r.id=0===i?t.getUint32(12):t.getUint32(20));var o=c.findBox(e,["mdia","hdlr"])[0];if(o){var s=c.parseType(o.subarray(8,12));r.type="vide"===s?"video":"soun"===s?"audio":s}var h=c.findBox(e,["mdia","minf","stbl","stsd"])[0];if(h){var d=h.subarray(8);r.codec=c.parseType(d.subarray(4,8));var f,p=c.findBox(d,[r.codec])[0];p&&(/^[a-z]vc[1-9]$/i.test(r.codec)?(f=p.subarray(78),"avcC"===c.parseType(f.subarray(4,8))&&f.length>11?(r.codec+=".",r.codec+=u(f[9]),r.codec+=u(f[10]),r.codec+=u(f[11])):r.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(r.codec)&&(f=p.subarray(28),"esds"===c.parseType(f.subarray(4,8))&&f.length>20&&0!==f[19]?(r.codec+="."+u(f[19]),r.codec+="."+u(f[20]>>>2&63).replace(/^0/,"")):r.codec="mp4a.40.2"))}var m=c.findBox(e,["mdia","mdhd"])[0];if(m&&a){var g=0===i?12:20;r.timescale=l(m[g]<<24|m[g+1]<<16|m[g+2]<<8|m[g+3])}n.push(r)})),n},e.exports={findBox:c.findBox,parseType:c.parseType,timescale:i,startTime:r,compositionStartTime:a,videoTrackIds:o,tracks:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(21));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).eventBus,n=e.events,i=e.dashMetrics,a=e.fragmentLoader,o=e.debug,s=e.streamId,l=void 0,u=void 0,c=void 0,h=void 0;function d(e){var t;return!!e&&(t=!1,c.some((function(n){if(i=e,a=n,!isNaN(i.index)&&i.startTime===a.startTime&&i.adaptationIndex===a.adaptationIndex&&i.type===a.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===r.default.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var i,a})),t)}function f(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function p(e){c=c.filter((function(t){var n=f(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n}))}function m(e,t){t<=e+.5||(c=c.filter((function(n){var i=f(n);return isNaN(n.startTime)||n.startTime>=t-i||isNaN(n.duration)||n.startTime+n.duration<=e+i})))}function g(e,t,n){for(var i=e.length-1;i>=0;i--){var r=e[i],a=r.startTime,o=a+r.duration;if(n=isNaN(n)?f(r):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return r}return null}function v(e,t){i.addSchedulingInfo(e,t),i.addRequestsQueue(e.mediaType,h,c)}function y(e){e.sender===a&&(h.splice(h.indexOf(e.request),1),e.response&&!e.error&&c.push(e.request),v(e.request,e.error?"failed":"executed"),t.trigger(n.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function _(e){e.sender===a&&t.trigger(n.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function b(e){e.sender===a&&t.trigger(n.FRAGMENT_LOADING_ABANDONED,{streamId:s,request:e.request,mediaType:e.mediaType})}function E(){c=[],h=[]}return l={getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach((function(t){var i=function(e){var t=void 0;switch(e){case"loading":t=h;break;case"executed":t=c;break;default:t=[]}return t}(t);n=n.concat(function(e,t){if(t.hasOwnProperty("time"))return[g(e,t.time,t.threshold)];return e.filter((function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0}))}(i,e))})),n},isFragmentLoaded:d,isFragmentLoadedOrPending:function(e){var t=!1,n=0,i=void 0;if(!(t=d(e)))for(n=0;n<h.length;n++)i=h[n],e.url===i.url&&e.startTime===i.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:p,removeExecutedRequestsAfterTime:function(e){c=c.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,i=0,r=e.length;i<r;i++)m(n,e.start(i)),n=e.end(i);t>0&&m(n,t)}else p()},abortRequests:function(){a.abort(),h=[]},executeRequest:function(e){switch(e.action){case r.default.ACTION_COMPLETE:c.push(e),v(e,"executed"),u.debug("STREAM_COMPLETED"),t.trigger(n.STREAM_COMPLETED,{request:e});break;case r.default.ACTION_DOWNLOAD:v(e,"loading"),h.push(e),function(e){t.trigger(n.FRAGMENT_LOADING_STARTED,{streamId:s,request:e}),a.load(e)}(e);break;default:u.warn("Unknown request action.")}},reset:function(){t.off(n.LOADING_COMPLETED,y,this),t.off(n.LOADING_DATA_PROGRESS,_,this),t.off(n.LOADING_ABANDONED,b,this),a&&a.reset(),E()},addExecutedRequest:function(e){c.push(e)}},u=o.getLogger(l),E(),t.on(n.LOADING_COMPLETED,y,l),t.on(n.LOADING_DATA_PROGRESS,_,l),t.on(n.LOADING_ABANDONED,b,l),l}o.__dashjs_factory_name="FragmentModel";var s=i.default.getClassFactory(o);s.FRAGMENT_MODEL_LOADING="loading",s.FRAGMENT_MODEL_EXECUTED="executed",s.FRAGMENT_MODEL_CANCELED="canceled",s.FRAGMENT_MODEL_FAILED="failed",i.default.updateClassFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(9)),r=l(n(131)),a=l(n(2)),o=l(n(51)),s=l(n(133));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=void 0,t=void 0,n=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.default.parseBuffer(e),i=(0,r.default)(n).create();return i.setData(t),i}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:a,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.default(0,!1);for(var i=t instanceof ArrayBuffer?new Uint8Array(t):t,r=void 0,a=0;n<i.byteLength;){var o=l(i,n),c=u(i,n+4);if(0===o)break;n+o<=i.byteLength&&(e.indexOf(c)>=0?r=new s.default(n,!0,o):a=n+o),n+=o}return r||new s.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,i=a(e),r=i.getBoxes("moof"),o=i.getBoxes("mfhd"),s=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0;n=i.getBoxes("moof").length,t=o[o.length-1].sequence_number,l=0,h=[];var E=-1,T=-1;for(g=0;g<r.length;g++){var w=r[g],x=w.getChildBoxes("traf");for(p=0;p<x.length;p++){var A=x[p],S=A.getChildBox("tfhd"),M=A.getChildBox("tfdt");c=M.baseMediaDecodeTime;var C=A.getChildBoxes("trun"),R=A.getChildBoxes("subs");for(m=0;m<C.length;m++){var I=C[m];for(l=I.sample_count,_=(S.base_data_offset||0)+(I.data_offset||0),f=0;f<l;f++){s=void 0!==(d=I.samples[f]).sample_duration?d.sample_duration:S.default_sample_duration,u=void 0!==d.sample_size?d.sample_size:S.default_sample_size;var P={dts:c,cts:c+(void 0!==d.sample_composition_time_offset?d.sample_composition_time_offset:0),duration:s,offset:w.offset+_,size:u,subSizes:[u]};if(R)for(v=0;v<R.length;v++){var L=R[v];if(E<L.entry_count-1&&f>T&&(E++,T+=L.entries[E].sample_delta),f==T){P.subSizes=[];var D=L.entries[E];for(y=0;y<D.subsample_count;y++)P.subSizes.push(D.subsamples[y].subsample_size)}}h.push(P),_+=u,c+=s}}b=c-M.baseMediaDecodeTime}}return{sampleList:h,lastSequenceNumber:t,totalDuration:b,numSequences:n}},findInitRange:function(t){var n=null,i=a(t);if(!i)return n;var r=i.getBox("ftyp"),o=i.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(n=(r?r.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+n)),n}},e=(0,i.default)(n).getInstance().getLogger(t),t}u.__dashjs_factory_name="BoxParser",t.default=a.default.getSingletonFactory(u)},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(39).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(94));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,n=void 0,i=void 0;return n=(0,r.default)(t).getInstance(),{load:function(r){var a=n.getLoader(r&&r.request?r.request.url:null);(i=a(t).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.useFetch||null,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,errors:e.errors})).load(r)},abort:function(){i&&i.abort()}}}o.__dashjs_factory_name="URLLoader";var s=i.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(89);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=a},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(17))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,i=!!t&&t.publicOnly;for(var r in e)!e.hasOwnProperty(r)||this[r]&&!n||i&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}]),e}();t.default=r},function(e,t,n){!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},function(e,t,n){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=r[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=i.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){var n=t.split(","),i=[];for(var r in n){var a=n[r].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){i.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){i.push(o);continue}var l=e.parseColor(a[0]);if(null===l)return null;o[3]=l,i.push(o)}}return i},e.parsePosition=function(t){var n=t.split(" "),i=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var r in n)if(!i(n[r])){var a=e.parseLength(n[r]);if(null===a)return null;n[r]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var l=n[s++];if(i(l)){var u={value:0,unit:"%"};2!==n.length&&s<n.length&&!i(n[s])&&(u=n[s++]),"right"===l?(o.h.edge=l,o.h.offset=u):"bottom"===l?(o.v.edge=l,o.v.offset=u):"left"===l?o.h.offset=u:"top"===l&&(o.v.offset=u)}else{if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=l:o.v.offset=l}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,i,r,a,o){return"%"===n&&r?new e.ComputedLength(r.rw*t/100,r.rh*t/100):"em"===n&&i?new e.ComputedLength(i.rw*t,i.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(137),r=n(138),a=n(84);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=s(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):d(e,t);if("Buffer"===t.type&&a(t.data))return d(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(c(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function v(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,i,r){var a,o=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var c=-1;for(a=n;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+l>s&&(n=s-l),a=n;a>=0;a--){for(var h=!0,d=0;d<l;d++)if(u(e,a+d)!==u(t,d)){h=!1;break}if(h)return a}return-1}function _(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function b(e,t,n,i){return z(j(t,e.length-n),e,n,i)}function E(e,t,n,i){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function T(e,t,n,i){return E(e,t,n,i)}function w(e,t,n,i){return z(G(t),e,n,i)}function x(e,t,n,i){return z(function(e,t){for(var n,i,r,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,r=n%256,a.push(r),a.push(i);return a}(t,e.length-n),e,n,i)}function A(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var a,o,s,l,u=e[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(r+h<=n)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[r+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[r+1],o=e[r+2],128==(192&a)&&128==(192&o)&&(l=(15&u)<<12|(63&a)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[r+1],o=e[r+2],s=e[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return c(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,a=Math.min(n,i);r<a;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(i,r),c=e.slice(t,n),h=0;h<s;++h)if(u[h]!==c[h]){a=u[h],o=c[h];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function M(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function C(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function R(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",a=t;a<n;++a)r+=U(e[a]);return r}function I(e,t,n){for(var i=e.slice(t,n),r="",a=0;a<i.length;a+=2)r+=String.fromCharCode(i[a]+256*i[a+1]);return r}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,i,r,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function D(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-n,2);r<a;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function O(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-n,4);r<a;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function N(e,t,n,i,r,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(e,t,n,i,a){return a||N(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function F(e,t,n,i,a){return a||N(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var a=0;a<r;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],r=1,a=0;++a<t&&(r*=256);)i+=this[e+a]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=t,r=1,a=this[e+--i];i>0&&(r*=256);)a+=this[e+--i]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,a=0;for(this[t]=255&e;++a<n&&(r*=256);)this[t+a]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return k(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return k(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,a=i-n;if(this===e&&n<t&&t<i)for(r=a-1;r>=0;--r)e[r+t]=this[r+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=l.isBuffer(e)?e:j(new l(e,i).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var i=e.length,r=null,a=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&a.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function G(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(17))},function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&f())}function f(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,i,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,i)}));case 4:return t.nextTick((function(){e.call(null,n,i,r)}));default:for(a=new Array(s-1),o=0;o<a.length;)a[o++]=arguments[o];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,n(40))},function(e,t,n){var i=n(39),r=i.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=o),a(r,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}return i(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(36);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(26)),r=f(n(267)),a=f(n(268)),o=f(n(269)),s=f(n(270)),l=f(n(271)),u=f(n(272)),c=f(n(273)),h=f(n(274)),d=f(n(23));function f(e){return e&&e.__esModule?e:{default:e}}function p(){var e=this.context,t=void 0,n=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;return t={initialize:function(){p=[];var t=void 0;t=(0,s.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,o.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,r.default)(e).getInstance({BASE64:m}),p.push(t),g=t,t=(0,a.default)(e).getInstance({BASE64:m,debug:n}),p.push(t),v=t},setProtectionData:function(e){for(var t,n,i=0;i<p.length;i++){var r=p[i];r.hasOwnProperty("init")&&r.init((t=r.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===g||e===v},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),i=new Uint8Array(t),r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}return!1},getKeySystems:function(){return p},setKeySystems:function(e){p=e},getKeySystemBySystemString:function(e){for(var t=0;t<p.length;t++)if(p[t].systemString===e)return p[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,n=void 0,i=void 0,r=void 0,a=[];if(e)for(i=0;i<p.length;++i)for(n=p[i],r=0;r<e.length;++r)if((t=e[r]).schemeIdUri.toLowerCase()===n.schemeIdURI){var o=n.getInitData(t);a.push({ks:p[i],initData:o,cdmData:n.getCDMData(),sessionId:n.getSessionId(t)})}return a},getSupportedKeySystems:function(e,t){for(var n=[],r=i.default.parsePSSHList(e),a=void 0,o=void 0,s=void 0,l=0;l<p.length;++l)o=(a=p[l]).systemString,s=!t||o in t,a.uuid in r&&s&&n.push({ks:a,initData:r[a.uuid],cdmData:a.getCDMData(),sessionId:a.getSessionId()});return n},getLicenseServer:function(t,n,i){if("license-release"===i||"individualization-request"===i)return null;var r=null;return n&&n.hasOwnProperty("drmtoday")?r=(0,l.default)(e).getInstance({BASE64:m}):t.systemString===d.default.WIDEVINE_KEYSTEM_STRING?r=(0,c.default)(e).getInstance():t.systemString===d.default.PLAYREADY_KEYSTEM_STRING?r=(0,u.default)(e).getInstance():t.systemString===d.default.CLEARKEY_KEYSTEM_STRING&&(r=(0,h.default)(e).getInstance()),r},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return f.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,f=n.getLogger(t)),e.BASE64&&(m=e.BASE64))}}}p.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(p)},function(e,t,n){"use strict";var i,r,a=n(75).toUnsigned,o=function(e){return new Date(1e3*e-20828448e5)},s=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},l=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},u=function(e,t){var n,i,r,o,s,c=[];if(!t.length)return null;for(n=0;n<e.byteLength;)i=a(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),r=l(e.subarray(n+4,n+8)),o=i>1?n+i:e.byteLength,r===t[0]&&(1===t.length?c.push(e.subarray(n+8,o)):(s=u(e.subarray(n+8,o),t.slice(1))).length&&(c=c.concat(s))),n=o;return c},c=function(e){var t,n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=n)if(n=i.getUint32(t),t+=4,n<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r},h={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:i(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,i,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(i=6,r=0;r<s;r++)n=a.getUint16(i),i+=2,o.sps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;for(t=e[i],i++,r=0;r<t;r++)n=a.getUint16(i),i+=2,o.pps.push(new Uint8Array(e.subarray(i,i+n))),i+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:l(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},i=8;i<e.byteLength;)n.compatibleBrands.push(l(e.subarray(i,i+4))),i+=4;return n},dinf:function(e){return{boxes:i(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:i(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:l(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:c(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=o(n.getUint32(i)),i+=8,r.modificationTime=o(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=o(n.getUint32(i)),i+=4,r.modificationTime=o(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,t=n.getUint16(i),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:i(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:i(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=i(e.subarray(28))[0]),n},moof:function(e){return{boxes:i(e)}},moov:function(e){return{boxes:i(e)}},mvex:function(e){return{boxes:i(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=o(t.getUint32(n)),n+=8,i.modificationTime=o(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=8,i.duration=t.getUint32(n)):(i.creationTime=o(t.getUint32(n)),n+=4,i.modificationTime=o(t.getUint32(n)),n+=4,i.timescale=t.getUint32(n),n+=4,i.duration=t.getUint32(n)),n+=4,i.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=t.getUint32(n),i},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(t=24;r;t+=12,r--)i.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return i},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:i(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(t=8;r;t+=4,r--)i.chunkOffsets.push(n.getUint32(t));return i},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;i;t+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:i(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)i.entries.push(n.getUint32(t));return i},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(t=8;r;t+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return i},styp:function(e){return h.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:a(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=a(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],a=2&i.flags[2],o=8&i.flags[2],s=16&i.flags[2],l=32&i.flags[2],u=65536&i.flags[0],c=131072&i.flags[0];return t=8,r&&(t+=4,i.baseDataOffset=n.getUint32(12),t+=4),a&&(i.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(i.defaultSampleDuration=n.getUint32(t),t+=4),s&&(i.defaultSampleSize=n.getUint32(t),t+=4),l&&(i.defaultSampleFlags=n.getUint32(t)),u&&(i.durationIsEmpty=!0),!r&&c&&(i.baseDataOffsetIsMoof=!0),i},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,i={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=o(t.getUint32(n)),n+=8,i.modificationTime=o(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=8,i.duration=t.getUint32(n)):(i.creationTime=o(t.getUint32(n)),n+=4,i.modificationTime=o(t.getUint32(n)),n+=4,i.trackId=t.getUint32(n),n+=4,n+=4,i.duration=t.getUint32(n)),n+=4,n+=8,i.layer=t.getUint16(n),n+=2,i.alternateGroup=t.getUint16(n),n+=2,i.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,i.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,i.height=t.getUint16(n)+t.getUint16(n+2)/16,i},traf:function(e){return{boxes:i(e)}},trak:function(e){return{boxes:i(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],l=2&n.flags[1],u=4&n.flags[1],c=8&n.flags[1],h=i.getUint32(4),d=8;for(r&&(n.dataOffset=i.getInt32(d),d+=4),a&&h&&(t={flags:s(e.subarray(d,d+4))},d+=4,o&&(t.duration=i.getUint32(d),d+=4),l&&(t.size=i.getUint32(d),d+=4),c&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t),h--);h--;)t={},o&&(t.duration=i.getUint32(d),d+=4),l&&(t.size=i.getUint32(d),d+=4),u&&(t.flags=s(e.subarray(d,d+4)),d+=4),c&&(t.compositionTimeOffset=i.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};i=function(e){for(var t,n,i,r,a,o=0,s=[],u=new ArrayBuffer(e.length),c=new Uint8Array(u),d=0;d<e.length;++d)c[d]=e[d];for(t=new DataView(u);o<e.byteLength;)n=t.getUint32(o),i=l(e.subarray(o+4,o+8)),r=n>1?o+n:e.byteLength,(a=(h[i]||function(e){return{data:e}})(e.subarray(o+8,r))).size=n,a.type=i,s.push(a),o=r;return s},r=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map((function(e,i){return n+e.type+"\n"+Object.keys(e).filter((function(e){return"type"!==e&&"boxes"!==e})).map((function(t){var i=n+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return a?1===a.length?i+"<"+a.join("").slice(1)+">":i+"<\n"+a.map((function(e){return n+"  "+e})).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map((function(e,t){return 0===t?e:n+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+r(e.boxes,t+1):"")})).join("\n")},e.exports={inspect:i,textify:r,parseType:l,findBox:u,parseTraf:h.traf,parseTfdt:h.tfdt,parseHdlr:h.hdlr,parseTfhd:h.tfhd,parseTrun:h.trun,parseSidx:h.sidx}},function(e,t,n){var i,r,a,o,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,r=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var i=s.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=s.normalizePath(i.path),s.buildURLFromParts(i)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=r.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(h)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=n.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},function(e,t,n){"use strict";
/*! @name @videojs/vhs-utils @version 1.3.0 @license MIT */function i(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=i(n(47)),a=i(n(0));e.exports=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=r.buildAbsoluteURL(a.location&&a.location.href||"",e)),r.buildAbsoluteURL(e,t))}},function(e,t,n){var i=n(27),r=function(e,t){for(var n,i,r,a=new Array(e.length),o=0;o<e.length;o++)n=Math.atan2(e[o][1],e[o][0]),i=Math.atan2(e[o][2],Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1])),1==t?a[o]=[n,i]:(r=Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1]+e[o][2]*e[o][2]),a[o]=[n,i,r]);return a},a=function(e,t){for(var n=new Array(t.length),r=new Array(t.length),a=0;a<t.length;a++)n[a]=t[a][0],r[a]=t[a][1];var l,u,c,h,d,f=new Array(2*e+1),p=(n.length,(e+1)*(e+1)),m=0,g=0,v=i.sin(r),y=0,_=new Array(p);for(a=0;a<2*e+1;a++)f[a]=o(a);for(var b=0;b<e+1;b++){if(0==b){var E=new Array(n.length);E.fill(1),_[b]=E,y=1}else{l=s(b,v,m,g),u=Math.sqrt(2*b+1);for(var T=0;T<b+1;T++)0==T?_[y+b]=i.mul(u,l[T]):(c=u*Math.sqrt(2*f[b-T]/f[b+T]),h=i.cos(i.mul(T,n)),d=i.sin(i.mul(T,n)),_[y+b-T]=i.mul(c,i.mul(l[T],d)),_[y+b+T]=i.mul(c,i.mul(l[T],h)));y=y+2*b+1}g=m,m=l}return _},o=function(e){return 0===e?1:e*o(e-1)},s=function(e,t,n,r){var a=new Array(e+1);switch(e){case 1:var o=i.mul(t,t),s=t,l=i.sqrt(i.sub(1,o));a[0]=s,a[1]=l;break;case 2:o=i.mul(t,t);var u=i.mul(3,o);u=i.sub(u,1),u=i.div(u,2);var c=i.sub(1,o);c=i.sqrt(c),c=i.mul(3,c),c=i.mul(c,t);var h=i.sub(1,o);h=i.mul(3,h),a[0]=u,a[1]=c,a[2]=h;break;default:o=i.mul(t,t);var d=i.sub(1,o),f=2*e-1,p=1;if(f%2==0)for(var m=1;m<f/2+1;m++)p=2*p*m;else for(m=1;m<(f+1)/2+1;m++)p*=2*m-1;a[e]=i.mul(p,i.pow(d,e/2)),a[e-1]=i.mul(2*e-1,i.mul(t,n[e-1]));for(var g=0;g<e-1;g++){var v=i.mul(2*e-1,i.mul(t,n[g])),y=i.mul(e+g-1,r[g]);a[g]=i.div(i.sub(v,y),e-g)}}return a},l=function(e){var t=i.transpose(e);return i.dot(i.inv(i.dot(t,e)),t)};function u(e,t,n,i,r){return d(0,e,t,n,i,r)}function c(e,t,n,i,r){var a,o,s,l;return 0==t?s=(a=d(1,e,1,n,i,r))+(o=d(-1,e,-1,n,i,r)):t>0?(l=1==t?1:0,a=d(1,e,t-1,n,i,r),o=d(-1,e,1-t,n,i,r),s=a*Math.sqrt(1+l)-o*(1-l)):(l=-1==t?1:0,s=(a=d(1,e,t+1,n,i,r))*(1-l)+(o=d(-1,e,-t-1,n,i,r))*Math.sqrt(1+l)),s}function h(e,t,n,i,r){var a;return 0==t?console.error("should not be called"):a=t>0?d(1,e,t+1,n,i,r)+d(-1,e,-t-1,n,i,r):d(1,e,t-1,n,i,r)-d(-1,e,1-t,n,i,r),a}function d(e,t,n,i,r,a){var o,s,l;return o=r[e+1][2],s=r[e+1][0],l=r[e+1][1],i==-t?o*a[n+t-1][0]+s*a[n+t-1][2*t-2]:i==t?o*a[n+t-1][2*t-2]-s*a[n+t-1][0]:l*a[n+t-1][i+t-1]}e.exports.forwardSHT=function(e,t,n,o){var s,u=t.length,c=[,];(e+1)*(e+1)>u&&console.log("The SHT degree is too high for the number of data points"),0==n&&(t=r(t));for(var h=0;h<t.length;h++)c[h]=t[h][2];return Y_N=a(e,t),s=0==o?i.mul(1/u,Y_N):l(i.transpose(Y_N)),i.dotMV(s,c)},e.exports.inverseSHT=function(e,t){for(var n=t,r=Math.sqrt(e.length)-1,o=a(r,t),s=i.dotVM(e,o),l=0;l<t.length;l++)n[l][2]=s[l];return n},e.exports.print2Darray=function(e){for(var t=0;t<e.length;t++)console.log(e[t])},e.exports.convertCart2Sph=r,e.exports.convertSph2Cart=function(e){for(var t,n,i,r=new Array(e.length),a=0;a<e.length;a++)t=Math.cos(e[a][0])*Math.cos(e[a][1]),n=Math.sin(e[a][0])*Math.cos(e[a][1]),i=Math.sin(e[a][1]),2==e[0].length?r[a]=[t,n,i]:3==e[0].length&&(r[a]=[e[a][2]*t,e[a][2]*n,e[a][2]*i]);return r},e.exports.computeRealSH=a,e.exports.factorial=o,e.exports.recurseLegendrePoly=s,e.exports.pinv_svd=function(e){for(var t=i.svd(e),n=t.S[0],r=t.U,a=t.S,o=t.V,s=e.length,l=e[0].length,u=Math.max(s,l)*i.epsilon*n,c=a.length,h=new Array(c),d=c-1;-1!==d;d--)a[d]>u?h[d]=1/a[d]:h[d]=0;return i.dot(i.dot(o,i.diag(h)),i.transpose(r))},e.exports.pinv_direct=l,e.exports.getSHrotMtx=function(e,t){var n=(t+1)*(t+1),r=i.rep([n,n],0);r[0][0]=1;var a=i.rep([3,3],0);a[0][0]=e[1][1],a[0][1]=e[1][2],a[0][2]=e[1][0],a[1][0]=e[2][1],a[1][1]=e[2][2],a[1][2]=e[2][0],a[2][0]=e[0][1],a[2][1]=e[0][2],a[2][2]=e[0][0],r=i.setBlock(r,[1,1],[3,3],a);for(var o=a,s=3,l=2;l<t+1;l++){for(var d=i.rep([2*l+1,2*l+1],0),f=-l;f<l+1;f++)for(var p=-l;p<l+1;p++){var m,g,v,y,_;m=0==f?1:0,g=Math.abs(p)==l?2*l*(2*l-1):l*l-p*p,v=Math.sqrt((l*l-f*f)/g),y=Math.sqrt((1+m)*(l+Math.abs(f)-1)*(l+Math.abs(f))/g)*(1-2*m)*.5,_=Math.sqrt((l-Math.abs(f)-1)*(l-Math.abs(f))/g)*(1-m)*-.5,0!=v&&(v*=u(l,f,p,a,o)),0!=y&&(y*=c(l,f,p,a,o)),0!=_&&(_*=h(l,f,p,a,o)),d[f+l][p+l]=v+y+_}r=i.setBlock(r,[s+1,s+1],[s+2*l+1,s+2*l+1],d),o=d,s=s+2*l+1}return r},e.exports.yawPitchRoll2Rzyx=function(e,t,n){var r,a,o;r=0==n?[[1,0,0],[0,1,0],[0,0,1]]:[[1,0,0],[0,Math.cos(n),Math.sin(n)],[0,-Math.sin(n),Math.cos(n)]],a=0==t?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(t),0,-Math.sin(t)],[0,1,0],[Math.sin(t),0,Math.cos(t)]],o=0==e?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(e),Math.sin(e),0],[-Math.sin(e),Math.cos(e),0],[0,0,1]];var s=i.dotMMsmall(a,o);return s=i.dotMMsmall(r,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(7)),r=d(n(2)),a=d(n(129)),o=d(n(52)),s=d(n(153)),l=d(n(154)),u=d(n(8)),c=d(n(10)),h=n(20);function d(e){return e&&e.__esModule?e:{default:e}}function f(){var e=this.context,t=void 0,n=void 0,r=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0;function I(e){void 0===R&&null!==e.fromStreamInfo&&(R=this.getCurrentTrackIdx())}function P(){void 0===R&&(R=this.getCurrentTrackIdx())}function L(){void 0!==R&&(this.setTextTrack(R),R=void 0)}function D(e){var t=this,n=e.tracks,i=e.index;E&&n.some((function(e,n){if(p.matchSettings(E,e))return t.setTextTrack(n),i=n,!0})),(!1===x||void 0===x&&!E||C)&&this.setTextTrack(-1),w=i,b.trigger(c.default.TEXT_TRACKS_ADDED,{enabled:N(),index:i,tracks:n}),M=!0}function O(e){if(!T&&e&&e.newMediaInfo){var t=e.newMediaInfo;t.type===i.default.FRAGMENTED_TEXT&&(E={lang:t.lang,role:t.roles[0],accessibility:t.accessibility[0]})}}function N(){var e=!0;return A&&!S&&(e=!1),e}function k(){A=!0,M=!1,C=!1}return t={setConfig:function(e){e&&(e.errHandler&&(r=e.errHandler),e.adapter&&(d=e.adapter),e.manifestModel&&(f=e.manifestModel),e.mediaController&&(p=e.mediaController),e.videoModel&&(m=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(v=e.textTracks),e.vttParser&&(y=e.vttParser),e.ttmlParser&&(_=e.ttmlParser),n.setConfig({errHandler:r,adapter:d,manifestModel:f,mediaController:p,videoModel:m,streamController:g,textTracks:v,vttParser:y,ttmlParser:_}))},getTextSourceBuffer:function(){return n},getAllTracksAreDisabled:function(){return A},addEmbeddedTrack:function(e){n.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return E&&E.lang||""},setTextDefaultLanguage:function(e){(0,h.checkParameterType)(e,"string"),E||(E={}),E.lang=e,T=!0},setTextDefaultEnabled:function(e){(0,h.checkParameterType)(e,"boolean"),(x=e)?A=!1:this.setTextTrack(-1)},getTextDefaultEnabled:function(){return void 0!==x&&x},setInitialSettings:function(e){E=e,T=!0},enableText:function(e){(0,h.checkParameterType)(e,"boolean"),!x&&e&&(x=!0),N()!==e&&(e&&this.setTextTrack(w),e||(w=this.getCurrentTrackIdx(),M?this.setTextTrack(-1):C=!0))},isTextEnabled:N,setTextTrack:function(e){var t=n.getConfig(),r=t.fragmentModel,a=t.fragmentedTracks,o=t.videoModel,s=void 0,l=void 0;A=-1===e;var u=v.getCurrentTrackIdx();if(u!==e){A&&p&&p.saveTextSettingsDisabled(),v.setModeForTrackIdx(u,i.default.TEXT_HIDDEN),v.setCurrentTrackIdx(e),v.setModeForTrackIdx(e,i.default.TEXT_SHOWING);var c=v.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var h=0;h<a.length;h++){var d=a[h];if(c.lang===d.lang&&c.index===d.index&&(d.id?c.id===d.id:c.id===d.index))if(d!==p.getCurrentTrackFor(i.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))r.abortRequests(),r.removeExecutedRequestsBeforeTime(),n.remove(),v.deleteCuesFromTrackIdx(u),p.setTrack(d),n.setCurrentFragmentedTrackIdx(h);else if(-1===u){for(var f=g.getActiveStreamProcessors(),m=0;m<f.length;m++)if(f[m].getType()===i.default.FRAGMENTED_TEXT){l=f[m];break}l.setIndexHandlerTime(o.getTime()),l.getScheduleController().start()}}else if(c&&!c.isFragmented){for(var y=g.getActiveStreamProcessors(),_=0;_<y.length;_++)if(y[_].getType()===i.default.TEXT){s=(l=y[_]).getMediaInfoArr();break}if(l&&s)for(var b=0;b<s.length;b++)if(s[b].index===c.index&&s[b].lang===c.lang){l.selectMediaInfo(s[b]);break}}}},getCurrentTrackIdx:function(){return v.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,h.checkParameterType)(e,"boolean"),S=e},reset:function(){k(),n.resetEmbedded(),n.reset()}},E=null,w=-1,S=!1,M=!1,T=!1,C=!1,v=(0,o.default)(e).getInstance(),y=(0,s.default)(e).getInstance(),_=(0,l.default)(e).getInstance(),n=(0,a.default)(e).getInstance(),b=(0,u.default)(e).getInstance(),v.initialize(),b.on(c.default.TEXT_TRACKS_QUEUE_INITIALIZED,D,t),b.on(c.default.CURRENT_TRACK_CHANGED,O,t),b.on(c.default.PERIOD_SWITCH_STARTED,I,t),b.on(c.default.STREAM_COMPLETED,P,t),b.on(c.default.PERIOD_SWITCH_COMPLETED,L,t),k(),t}f.__dashjs_factory_name="TextController",t.default=r.default.getSingletonFactory(f)},function(e,t,n){
/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
var i={parseBuffer:function(e){return new r(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(a.prototype._boxProcessors[e]=t)},createFile:function(){return new r},createBox:function(e,t,n){var i=a.create(e);return t&&t.append(i,n),i},createFullBox:function(e,t,n){var r=i.createBox(e,t,n);return r.version=0,r.flags=0,r},Utils:{}};i.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var i=[],r=0;if("utf-8"===n)for(;r<e.byteLength;){var a=e.getUint8(r++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(r++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(r++))<<6,a|=63&e.getUint8(r++)):(a=(7&a)<<18,a|=(63&e.getUint8(r++))<<12,a|=(63&e.getUint8(r++))<<6,a|=63&e.getUint8(r++))),i.push(String.fromCharCode(a))}else for(;r<e.byteLength;)i.push(String.fromCharCode(e.getUint8(r++)));return i.join("")},i.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},i.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var i,r=-1;if("number"==typeof n)r=n;else{if("string"==typeof n)i=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);i=n.type}for(var a=0;a<e.boxes.length;a++)if(i===e.boxes[a].type){r=a+1;break}}e.boxes.splice(r,0,t)}else e.boxes.push(t)},t.parseBuffer=i.parseBuffer,t.addBoxProcessor=i.addBoxProcessor,t.createFile=i.createFile,t.createBox=i.createBox,t.createFullBox=i.createFullBox,t.Utils=i.Utils,i.Cursor=function(e){this.offset=void 0===e?0:e};var r=function(e){this._cursor=new i.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};r.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},r.prototype.fetchAll=function(e,t){var n=[];return r._sweep.call(this,e,n,t),n},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},r._sweep=function(e,t,n){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;r._sweep.call(this.boxes[i],e,t,n)}},r.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},r.prototype.append=function(e,t){i.Utils.appendBox(this,e,t)};var a=function(){this._cursor=new i.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.create=function(e){var t=new a;return t.type=e,t.boxes=[],t},a.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],a.prototype._boxProcessors={},a.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},a.prototype._procFieldArray=function(e,t,n,i){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e][r]=this._readField(n,i);else for(r=0;r<this[e].length;r++)this._writeField(n,i,this[e][r])},a.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},a.prototype._procEntries=function(e,t,n){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e].push({}),n.call(this,this[e][i]);else for(i=0;i<t;i++)n.call(this,this[e][i])},a.prototype._procSubEntries=function(e,t,n,i){var r;if(this._parsing)for(e[t]=[],r=0;r<n;r++)e[t].push({}),i.call(this,e[t][r]);else for(r=0;r<n;r++)i.call(this,e[t][r])},a.prototype._procEntryField=function(e,t,n,i){this._parsing?e[t]=this._readField(n,i):this._writeField(n,i,e[t])},a.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(a.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},a.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},a.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var i=this._raw.getInt32(n),r=this._raw.getInt32(n+4);t=i*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t,n,i=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:i=this._raw.getUint8(r);break;case 16:i=this._raw.getUint16(r);break;case 24:i=((t=this._raw.getUint16(r))<<8)+(n=this._raw.getUint8(r+2));break;case 32:i=this._raw.getUint32(r);break;case 64:t=this._raw.getUint32(r),n=this._raw.getUint32(r+4),i=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,i},a.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var i=this._readUint(8);t+=String.fromCharCode(i)}return t},a.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},a.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},a.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},a.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?i.Utils.dataViewToString(t):t},a.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))},a.prototype.append=function(e,t){i.Utils.appendBox(this,e,t)},a.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},a.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},a.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var i=Math.floor(t/Math.pow(2,32)),r=t-i*Math.pow(2,32);this._rawo.setUint32(n,i),this._rawo.setUint32(n+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeUint=function(e,t){if(this._rawo){var n,i,r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(r,t);break;case 16:this._rawo.setUint16(r,t);break;case 24:n=(16776960&t)>>8,i=255&t,this._rawo.setUint16(r,n),this._rawo.setUint8(r+2,i);break;case 32:this._rawo.setUint32(r,t);break;case 64:i=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},a.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},a.prototype._writeTemplate=function(e,t){var n=Math.floor(t),i=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,i)},a.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},a.prototype._writeUTF8String=function(e){var t=i.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),r=0;r<t.length;r++)n.setUint8(r,t[r]);else this.size+=t.length},a.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},a.prototype._boxProcessors.avc1=a.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},a.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},a.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},a.prototype._boxProcessors.free=a.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},a.prototype._boxProcessors.ftyp=a.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},a.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},a.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},a.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},a.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},a.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},a.prototype._boxProcessors.mp4a=a.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},a.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},a.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},a.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},a.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},a.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},a.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},a.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},a.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},a.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},a.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},a.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},a.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},a.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},a.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},a.prototype._boxProcessors["url "]=a.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},a.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},a.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},a.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},a.prototype._boxProcessors.vtte=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(7)),r=c(n(8)),a=c(n(10)),o=c(n(2)),s=c(n(9)),l=n(83),u=n(20);function c(e){return e&&e.__esModule?e:{default:e}}function h(){var e=this.context,t=(0,r.default)(e).getInstance(),n=void 0,o=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0;function A(e){var t=d[e].kind,n=void 0!==d[e].id?d[e].id:d[e].lang,i=d[e].lang,r=d[e].isTTML,a=d[e].isEmbedded;return h.addTextTrack(t,n,i,r,a)}function S(e,t,n,i,r,a){var o=0,s=0;e/t>n/i?o=(s=t)/i*n:s=(o=e)/n*i;var l,u,c=0,h=0;return o/s>r?(h=s,c=s*r):(c=o,h=o/r),l=(e-c)/2,u=(t-h)/2,a?{x:l+.1*c,y:u+.1*h,w:.8*c,h:.8*h}:{x:l,y:u,w:c,h:h}}function M(e,n){var i=h.getClientWidth(),r=h.getClientHeight(),o=h.getVideoWidth(),s=h.getVideoHeight(),l=h.getVideoRelativeOffsetTop(),u=h.getVideoRelativeOffsetLeft();if(0!==o&&0!==s){var c=o/s,d=!1;e.isFromCEA608&&(c=3.5/3,d=!0);var f=S.call(this,i,r,o,s,c,d),p=f.w,b=f.h,w=f.x,A=f.y;if(p!=v||b!=y||w!=m||A!=g||n){if(m=w+u,g=A+l,v=p,y=b,_){var M=_.style;M&&(M.left=m+"px",M.top=g+"px",M.width=v+"px",M.height=y+"px",M.zIndex=E&&document[E]||T?x:null,t.trigger(a.default.CAPTION_CONTAINER_RESIZE,{}))}var C=e.activeCues;if(C)for(var R=C.length,I=0;I<R;++I){var P=C[I];P.scaleCue(P)}}}}function C(e){var t=v,n=y,i=void 0,r=void 0,a=void 0,o=void 0,s=void 0;if(e.cellResolution){var l=[t/e.cellResolution[0],n/e.cellResolution[1]];if(e.linePadding)for(i in e.linePadding)if(e.linePadding.hasOwnProperty(i)){r=(e.linePadding[i]*l[0]).toString();for(var u=document.getElementsByClassName("spanPadding"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r),u[c].style.cssText=u[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.fontSize){for(i in e.fontSize)if(e.fontSize.hasOwnProperty(i)){"%"===e.fontSize[i][0]?a=e.fontSize[i][1]/100:"c"===e.fontSize[i][0]&&(a=e.fontSize[i][1]),r=(a*l[1]).toString(),s="defaultFontSize"!==i?document.getElementsByClassName(i):document.getElementsByClassName("paragraph");for(var h=0;h<s.length;h++)s[h].style.cssText=s[h].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.lineHeight)for(i in e.lineHeight)if(e.lineHeight.hasOwnProperty(i)){"%"===e.lineHeight[i][0]?o=e.lineHeight[i][1]/100:"c"===e.fontSize[i][0]&&(o=e.lineHeight[i][1]),r=(o*l[1]).toString(),s=document.getElementsByClassName(i);for(var d=0;d<s.length;d++)s[d].style.cssText=s[d].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}}}if(e.isd){var f=document.getElementById(e.cueID);f&&_.removeChild(f),R(e)}}function R(e){if(_){var n=document.createElement("div");_.appendChild(n),w=(0,l.renderHTML)(e.isd,n,(function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,i=/^#(.*)$/;if(n.test(t)){var r=n.exec(t),a=parseInt(r[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(i.test(t)){var o=i.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return null}),_.clientHeight,_.clientWidth,!1,(function(e){o.info("renderCaption :",e)}),w,!0),n.id=e.cueID,t.trigger(a.default.CAPTION_RENDERED,{captionDiv:n,currentTrackIdx:p})}}function I(e){return e>=0&&d[e]?h.getTextTrack(d[e].kind,d[e].id,d[e].lang,d[e].isTTML,d[e].isEmbedded):null}function P(e){if(e!==p){var t=I(p=e);L.call(this,t),b&&(clearInterval(b),b=null),t&&"html"===t.renderingType&&(M.call(this,t,!0),b=setInterval(M.bind(this,t),500))}}function L(e){F.call(this),e&&"html"===e.renderingType?N.call(this):k.call(this)}function D(e,t,n){return(isNaN(t)||e.startTime>=t)&&(isNaN(n)||e.endTime<=n)}function O(e,t,n){if(e.cues)for(var i=e.cues,r=i.length-1;r>=0;r--)D(i[r],t,n)&&e.removeCue(i[r])}function N(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=h.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){o.info(""+e.message)}}}function k(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function F(){if(_)for(;_.firstChild;)_.removeChild(_.firstChild)}return n={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(c=window.VTTCue||window.TextTrackCue,d=[],f=[],p=-1,m=0,g=0,v=0,y=0,_=null,b=null,T=!1,x=2147483647,w=null,void 0!==document.fullscreenElement?E="fullscreenElement":void 0!==document.webkitIsFullScreen?E="webkitIsFullScreen":document.msFullscreenElement?E="msFullscreenElement":document.mozFullScreen&&(E="mozFullScreen"))},setDisplayCConTop:function(e){(0,u.checkParameterType)(e,"boolean"),T=e,_&&!document[E]&&(_.style.zIndex=e?x:null)},addTextTrack:function(e,n){if(d.length!==n){if(d.push(e),d.length===n){d.sort((function(e,t){return e.index-t.index})),_=h.getTTMLRenderingDiv();for(var r=-1,s=0;s<d.length;s++){var l=A.call(this,s);f.push(l),d[s].defaultTrack&&(l.default=!0,r=s);var u=I(s);u&&(u.mode=i.default.TEXT_SHOWING,_&&(d[s].isTTML||d[s].isEmbedded)?u.renderingType="html":u.renderingType="default"),this.addCaptions(s,0,d[s].captionData),t.trigger(a.default.TEXT_TRACK_ADDED)}if(P.call(this,r),r>=0){t.on(a.default.PLAYBACK_METADATA_LOADED,(function e(){var n=I(r);n&&M.call(this,n,!0),t.off(a.default.PLAYBACK_METADATA_LOADED,e,this)}),this);for(var c=0;c<d.length;c++){var m=I(c);m&&(m.mode=c===r?i.default.TEXT_SHOWING:i.default.TEXT_HIDDEN)}}t.trigger(a.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:p,tracks:d})}}else o.error("Trying to add too many tracks.")},addCaptions:function(e,n,r){var s=I(e),l=this;if(s&&Array.isArray(r)&&0!==r.length)for(var u=0;u<r.length;u++){var h=void 0,d=r[u];s.cellResolution=d.cellResolution,s.isFromCEA608=d.isFromCEA608,"html"===d.type&&_?((h=new c(d.start-n,d.end-n,"")).cueHTMLElement=d.cueHTMLElement,h.isd=d.isd,h.images=d.images,h.embeddedImages=d.embeddedImages,h.cueID=d.cueID,h.scaleCue=C.bind(l),h.cellResolution=d.cellResolution,h.lineHeight=d.lineHeight,h.linePadding=d.linePadding,h.fontSize=d.fontSize,_.style.left=m+"px",_.style.top=g+"px",_.style.width=v+"px",_.style.height=y+"px",h.onenter=function(){s.mode===i.default.TEXT_SHOWING&&(this.isd?(R(this),o.debug("Cue enter id:"+this.cueID)):(_.appendChild(this.cueHTMLElement),C.call(l,this),t.trigger(a.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:p})))},h.onexit=function(){if(_)for(var e=_.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(o.debug("Cue exit id:"+e[t].id),_.removeChild(e[t]),--t)}):d.data&&(h=new c(d.start-n,d.end-n,d.data),d.styles&&(void 0!==d.styles.align&&"align"in h&&(h.align=d.styles.align),void 0!==d.styles.line&&"line"in h&&(h.line=d.styles.line),void 0!==d.styles.position&&"position"in h&&(h.position=d.styles.position),void 0!==d.styles.size&&"size"in h&&(h.size=d.styles.size)),h.onenter=function(){s.mode===i.default.TEXT_SHOWING&&t.trigger(a.default.CAPTION_RENDERED,{currentTrackIdx:p})});try{h?s.addCue(h):o.error("impossible to display subtitles.")}catch(e){throw O(s),s.addCue(h),e}}},getCurrentTrackIdx:function(){return p},setCurrentTrackIdx:P,getTrackIdxForId:function(e){for(var t=-1,n=0;n<d.length;n++)if(d[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return d[p]},setModeForTrackIdx:function(e,t){var n=I(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e,t,n){var i=I(e);i&&O(i,t,n)},deleteAllTextTracks:function(){for(var e=f?f.length:0,t=0;t<e;t++){var n=I(t);n&&(O.call(this,n),n.mode="disabled")}f=[],d=[],b&&(clearInterval(b),b=null),p=-1,F.call(this)},deleteTextTrack:function(e){h.removeChild(f[e]),f.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(h=e.videoModel)}},o=(0,s.default)(e).getInstance().getLogger(n),n}h.__dashjs_factory_name="TextTracks",t.default=o.default.getSingletonFactory(h)},function(e,t,n){!function(e,t,n){function i(e,t,n,i,r,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=r,this.animatable=a,this.initial=n,this.applies=i,this.parse=o,this.compute=s}for(var r in e.all=[new i(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new i(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new i(t.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"displayAlign","before",["region"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var i=n.parseLength(t[0]),r=n.parseLength(t[1]);return r&&i?{h:r,w:i}:null}),(function(e,t,i,r,a){var o,s;if("auto"===r)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(r.h.value,r.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===r)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(r.w.value,r.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new i(t.ns_tts,"fontFamily","default",["span"],!0,!0,(function(e){var t=e.split(","),n=[];for(var i in t)"'"!==t[i].charAt(0)&&'"'!==t[i].charAt(0)&&"default"===t[i]?n.push("monospaceSerif"):n.push(t[i]);return n}),null),new i(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,(function(e,t,n,i){return"%"!==i.unit?null:Math.abs(i.value)>100?100*Math.sign(i.value):i.value})),new i(t.ns_tts,"fontSize","1c",["span"],!0,!0,n.parseLength,(function(t,i,r,a,o){return n.toComputedLength(a.value,a.unit,null!==i?i.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==i?i.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)})),new i(t.ns_tts,"fontStyle","normal",["span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"fontWeight","normal",["span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(e){return"normal"===e?e:n.parseLength(e)}),(function(t,i,r,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s})),new i(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new i(t.ns_tts,"origin","auto",["region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var i=n.parseLength(t[0]),r=n.parseLength(t[1]);return r&&i?{h:r,w:i}:null}),(function(e,t,i,r,a){var o,s;if("auto"===r)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(r.h.value,r.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===r)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(r.w.value,r.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new i(t.ns_tts,"overflow","hidden",["region"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"padding","0px",["region"],!1,!0,(function(e){var t=e.split(" ");if(t.length>4)return null;var i=[];for(var r in t){var a=n.parseLength(t[r]);if(!a)return null;i.push(a)}return i}),(function(t,i,r,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var l=r.styleAttrs[e.byName.writingMode.qname];if("lrtb"===l||"lr"===l)s=[s[0],s[3],s[2],s[1]];else if("rltb"===l||"rl"===l)s=[s[0],s[1],s[2],s[3]];else if("tblr"===l)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==l&&"tb"!==l)return null;s=[s[3],s[2],s[1],s[0]]}var u=[];for(var c in s)if(0===s[c].value)u[c]=new n.ComputedLength(0,0);else if(u[c]=n.toComputedLength(s[c].value,s[c].unit,r.styleAttrs[e.byName.fontSize.qname],"0"===c||"2"===c?r.styleAttrs[e.byName.extent.qname].h:r.styleAttrs[e.byName.extent.qname].w,"0"===c||"2"===c?t.cellLength.h:t.cellLength.w,"0"===c||"2"===c?t.pxLength.h:t.pxLength.w),null===u[c])return null;return u})),new i(t.ns_tts,"position","top left",["region"],!1,!0,(function(e){return n.parsePosition(e)}),(function(t,i,r,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-r.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-r.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-r.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-r.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-r.styleAttrs[e.byName.extent.qname].w.rw,-r.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-r.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-r.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))})),new i(t.ns_tts,"ruby","none",["span"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(e){return"center"!==e&&"spaceAround"!==e?null:e}),null),new i(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(e){var t=e.split(" "),i=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(i[0]=t[0],2===t.length&&"none"!==t[0]){var r=n.parseLength(t[1]);if(!r)return null;i[1]=r}return i}),(function(t,i,r,a,o){if("none"===a[0])return a;var s=null;return null===(s=null===a[1]?new n.ComputedLength(.5*r.styleAttrs[e.byName.fontSize.qname].rw,.5*r.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s]})),new i(t.ns_tts,"showBackground","always",["region"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"textAlign","start",["p"],!0,!0,(function(e){return e}),(function(e,t,n,i,r){return"left"===i?"start":"right"===i?"end":i})),new i(t.ns_tts,"textCombine","none",["span"],!0,!0,(function(e){var t=e.split(" ");return 1!==t.length||"none"!==t[0]&&"all"!==t[0]?null:[t[0]]}),null),new i(t.ns_tts,"textDecoration","none",["span"],!0,!0,(function(e){return e.split(" ")}),null),new i(t.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(e){var t=e.split(" "),i={style:null,symbol:null,color:null,position:null};for(var r in t)if("none"===t[r]||"auto"===t[r])i.style=t[r];else if("filled"===t[r]||"open"===t[r])i.style=t[r];else if("circle"===t[r]||"dot"===t[r]||"sesame"===t[r])i.symbol=t[r];else if("current"===t[r])i.color=t[r];else if("outside"===t[r]||"before"===t[r]||"after"===t[r])i.position=t[r];else if(i.color=n.parseColor(t[r]),null===i.color)return null;return null==i.style&&null==i.symbol?i.style="auto":(i.symbol=i.symbol||"circle",i.style=i.style||"filled"),i.position=i.position||"outside",i.color=i.color||"current",i}),null),new i(t.ns_tts,"textOutline","none",["span"],!0,!0,(function(e){if("none"===e)return e;var t={},i=e.split(" ");if(0===i.length||i.length>2)return null;var r=n.parseColor(i[0]);if(t.color=r,null!==r&&i.shift(),1!==i.length)return null;var a=n.parseLength(i[0]);return a?(t.thickness=a,t):null}),(function(t,i,r,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=r.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,r.styleAttrs[e.byName.fontSize.qname],r.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s})),new i(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,(function(t,i,r,a){if("none"===a)return a;var o=[];for(var s in a){var l={};if(l.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===l.x_off)return null;if(l.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.y_off)return null;if(null===a[s][2])l.b_radius=0;else if(l.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,r.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.b_radius)return null;null===a[s][3]?l.color=r.styleAttrs[e.byName.color.qname]:l.color=a[s][3],o.push(l)}return o})),new i(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(e){return e}),null),new i(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(e){return e}),null),new i(t.ns_tts,"zIndex","auto",["region"],!1,!0,(function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t}),null),new i(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,(function(e,t,i,r,a){return n.toComputedLength(r.value,r.unit,null,null,e.cellLength.w,null)})),new i(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(e){return e}),null),new i(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(e){return e}),null),new i(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(e){return"true"===e}),null),new i(t.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(e){return"true"===e}),null)],e.byQName={},e.all)e.byQName[e.all[r].qname]=e.all[r];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?n(37):imscNames,"undefined"==typeof imscUtils?n(38):imscUtils)},function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,i){function r(){void 0!==a&&e.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==t&&(a=function(n){e.removeListener(t,r),i(n)},e.once("error",a)),e.once(t,r)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var r,a,o,s;if(u(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=c(e))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,s=l,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function p(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):g(r,r.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var u=l.length,c=g(l,u);for(n=0;n<u;++n)a(c[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,i,r,a,o;if(u(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){(t=e.exports=n(85)).Stream=t,t.Readable=t,t.Writable=n(56),t.Duplex=n(22),t.Transform=n(88),t.PassThrough=n(146)},function(e,t,n){"use strict";(function(t,i,r){var a=n(41);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;e.entry=null;for(;i;){var r=i.callback;t.pendingcb--,r(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=y;var s,l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:a.nextTick;y.WritableState=v;var u=Object.create(n(31));u.inherits=n(24);var c={deprecate:n(145)},h=n(86),d=n(42).Buffer,f=r.Uint8Array||function(){};var p,m=n(87);function g(){}function v(e,t){s=s||n(22),e=e||{};var i=t instanceof s;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,u=e.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(u||0===u)?u:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,r=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,r){--t.pendingcb,n?(a.nextTick(r,i),a.nextTick(x,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(r(i),e._writableState.errorEmitted=!0,e.emit("error",i),x(e,t))}(e,n,i,t,r);else{var o=T(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||E(e,n),i?l(b,e,n,o,r):b(e,n,o,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function y(e){if(s=s||n(22),!(p.call(y,this)||this instanceof s))return new y(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function _(e,t,n,i,r,a,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(r,t.onwrite):e._write(r,a,t.onwrite),t.sync=!1}function b(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),x(e,t)}function E(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,r=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)r[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;r.allBuffers=l,_(e,t,!0,t.length,r,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,c=n.encoding,h=n.callback;if(_(e,t,!1,t.objectMode?1:u.length,u,c,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(e,t){var n=T(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(y,h),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===y&&(e&&e._writableState instanceof v)}})):p=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,n){var i,r=this._writableState,o=!1,s=!r.objectMode&&(i=e,d.isBuffer(i)||i instanceof f);return s&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=g),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),a.nextTick(t,n)}(this,n):(s||function(e,t,n,i){var r=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(i,o),r=!1),r}(this,r,e,n))&&(r.pendingcb++,o=function(e,t,n,i,r,a){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,n));return t}(t,i,r);i!==o&&(n=!0,r="buffer",i=o)}var s=t.objectMode?1:i.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else _(e,t,!1,s,i,r,a);return l}(this,r,s,e,t,n)),o},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,x(e,t),n&&(t.finished?a.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(40),n(143).setImmediate,n(17))},function(e,t,n){"use strict";var i=n(42).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=o(t[i]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if((r=o(t[i]))>=0)return r>0&&(e.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if((r=o(t[i]))>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(7)),r=l(n(10)),a=l(n(8)),o=l(n(2)),s=l(n(9));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,o=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=["alwaysReplace","neverReplace"],p=["highestBitrate","widestRange"];function m(e,t){if(!e||!t)return[];var n=t.id;return l[n]&&l[n][e]?l[n][e].list:[]}function g(e,t){return!e||!t||t&&!l[t.id]?null:l[t.id][e].current}function v(e,n){if(e&&e.streamInfo){var a=e.type,o=e.streamInfo,s=o.id,u=g(a,o);if(l[s]&&l[s][a]&&!T(e,u)&&(l[s][a].current=e,!l[s][a].current||n&&a===i.default.FRAGMENTED_TEXT||t.trigger(r.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:u,newMediaInfo:e,switchMode:h[a]}),!n)){var c=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!c||!l[s][a].storeLastSettings)return;c.roles&&(c.role=c.roles[0],delete c.roles),c.accessibility&&(c.accessibility=c.accessibility[0]),c.audioChannelConfiguration&&(c.audioChannelConfiguration=c.audioChannelConfiguration[0]),d.setSavedMediaSettings(a,c)}}}function y(e,t){e&&t&&(u[e]=t)}function _(e){return e?u[e]:null}function b(){return c||"highestBitrate"}function E(e){return e===i.default.AUDIO||e===i.default.VIDEO||e===i.default.TEXT||e===i.default.FRAGMENTED_TEXT||e===i.default.IMAGE}function T(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,i=e.viewpoint===t.viewpoint,r=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&i&&r&&a&&o&&s}function w(){l={},u={audio:null,video:null,fragmentedText:null},h={audio:"alwaysReplace",video:"neverReplace"}}function x(e,t){var n=!e.lang||t.lang.match(e.lang),i=!e.viewpoint||e.viewpoint===t.viewpoint,r=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],a=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return n&&i&&r&&a&&o}function A(e,t){if(e===i.default.FRAGMENTED_TEXT)return t[0];var n=b(),r=[],a=function(e){var t=0,n=[],i=void 0;return e.forEach((function(e){(i=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>t?(t=i,n=[e]):i===t&&n.push(e)})),n},s=function(e){var t=0,n=[],i=void 0;return e.forEach((function(e){(i=e.representationCount)>t?(t=i,n=[e]):i===t&&n.push(e)})),n};switch(n){case"highestBitrate":(r=a(t)).length>1&&(r=s(r));break;case"widestRange":(r=s(t)).length>1&&(r=a(t));break;default:o.warn("Track selection mode is not supported: "+n)}return r[0]}return n={checkInitialMediaSettingsForType:function(e,t){var n=_(e),i=m(e,t),r=[];n||y(e,n=d.getSavedMediaSettings(e)),i&&0!==i.length&&(n&&i.forEach((function(e){x(n,e)&&r.push(e)})),0===r.length?v(A(e,i),!0):r.length>1?v(A(e,r)):v(r[0]))},addTrack:function(e){if(e){var t=e.type;if(E(t)){var n=e.streamInfo.id;l[n]||(l[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var i=l[n][t].list,r=0,a=i.length;r<a;++r)if(T(i[r],e))return;i.push(e);var o=_(t);o&&x(o,e)&&!g(t,e.streamInfo)&&v(e)}}},getTracksFor:m,getCurrentTrackFor:g,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return l[n]&&l[n][t]&&T(l[n][t].current,e)},setTrack:v,setInitialSettings:y,getInitialSettings:_,setSwitchMode:function(e,t){-1!==f.indexOf(t)?h[e]=t:o.warn("Track switch mode is not supported: "+t)},getSwitchMode:function(e){return h[e]},setSelectionModeForInitialTrack:function(e){-1!==p.indexOf(e)?c=e:o.warn("Track selection mode is not supported: "+e)},getSelectionModeForInitialTrack:b,isMultiTrackSupportedByType:E,isTracksEqual:T,matchSettings:x,saveTextSettingsDisabled:function(){d.setSavedMediaSettings(i.default.FRAGMENTED_TEXT,null)},setConfig:function(e){e&&e.domStorage&&(d=e.domStorage)},reset:w},o=(0,s.default)(e).getInstance().getLogger(n),w(),n}u.__dashjs_factory_name="MediaController";var c=o.default.getSingletonFactory(u);c.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",c.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",c.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",c.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",c.DEFAULT_INIT_TRACK_SELECTION_MODE="highestBitrate",o.default.updateSingletonFactory(u.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e={};return{save:function(t){var n=t.streamId,i=t.representationId;e[n]=e[n]||{},e[n][i]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}o.__dashjs_factory_name="InitCache",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}o.__dashjs_factory_name="RequestModifier",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){i(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};r.INITIAL_PLAYOUT_START_REASON="initial_playout",r.SEEK_START_REASON="seek",r.RESUME_FROM_PAUSE_START_REASON="resume",r.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){i(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",t.PlayList=r,t.PlayListTrace=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).requestModifier;return{load:function(e){var n=new Date,i=e.request,r=new XMLHttpRequest;r.open(e.method,e.url,!0),i.responseType&&(r.responseType=i.responseType),i.range&&r.setRequestHeader("Range","bytes="+i.range),i.requestStartDate||(i.requestStartDate=n),t&&(r=t.modifyRequestHeader(r)),r.withCredentials=e.withCredentials,r.onload=e.onload,r.onloadend=e.onend,r.onerror=e.onerror,r.onprogress=e.progress,r.onabort=e.onabort,r.send(),e.response=r},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}o.__dashjs_factory_name="XHRLoader";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(36);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=u(n(2)),a=u(n(66)),o=u(n(9)),s=u(n(7)),l=n(14);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){var e,t,n={debug:{logLevel:o.default.LOG_LEVEL_WARNING},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,bufferPruningInterval:10,bufferToKeep:20,bufferAheadToKeep:80,jumpGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindowEnd:!0,manifestUpdateRetryInterval:100,liveCatchUpMinDrift:.02,liveCatchUpMaxDrift:0,liveCatchUpPlaybackRate:.5,liveCatchupLatencyThreshold:NaN,lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},retryIntervals:(e={},c(e,l.HTTPRequest.MPD_TYPE,500),c(e,l.HTTPRequest.XLINK_EXPANSION_TYPE,500),c(e,l.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),c(e,l.HTTPRequest.INIT_SEGMENT_TYPE,1e3),c(e,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),c(e,l.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),c(e,l.HTTPRequest.OTHER_TYPE,1e3),c(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},c(t,l.HTTPRequest.MPD_TYPE,3),c(t,l.HTTPRequest.XLINK_EXPANSION_TYPE,1),c(t,l.HTTPRequest.MEDIA_SEGMENT_TYPE,3),c(t,l.HTTPRequest.INIT_SEGMENT_TYPE,3),c(t,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),c(t,l.HTTPRequest.INDEX_SEGMENT_TYPE,3),c(t,l.HTTPRequest.OTHER_TYPE,3),c(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:s.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:s.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useBufferOccupancyABR:!1,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0}},cmcd:{enabled:!1,sid:null,cid:null,did:null}}},r=a.default.clone(n);return{get:function(){return r},update:function(e){"object"===(void 0===e?"undefined":i(e))&&function e(t,n,r){for(var o in t)t.hasOwnProperty(o)&&n.hasOwnProperty(o)&&("object"===i(t[o])&&null!==t[o]?e(t[o],n[o],r.slice()+o+"."):n[o]=a.default.clone(t[o]))}(e,r,"")},reset:function(){r=a.default.clone(n)}}}h.__dashjs_factory_name="Settings";var d=r.default.getSingletonFactory(h);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"mixin",value:function(t,n,r){var a=void 0,o={};if(t)for(var s in n)n.hasOwnProperty(s)&&(a=n[s],s in t&&(t[s]===a||s in o&&o[s]===a)||("object"===i(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],a,r):t[s]=r(a)));return t}},{key:"clone",value:function(t){if(!t||"object"!==(void 0===t?"undefined":i(t)))return t;var n=void 0;if(t instanceof Array){n=[];for(var r=0,a=t.length;r<a;++r)r in t&&n.push(e.clone(t[r]))}else n={};return e.mixin(n,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach((function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)})),n.href}catch(t){return e}}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=b(n(7)),r=b(n(13)),a=b(n(183)),o=b(n(184)),s=b(n(185)),l=b(n(186)),u=b(n(96)),c=b(n(97)),h=b(n(98)),d=b(n(187)),f=b(n(99)),p=b(n(18)),m=b(n(2)),g=b(n(9)),v=b(n(12)),y=b(n(15)),_=n(100);function b(e){return e&&e.__esModule?e:{default:e}}function E(){var e=void 0,t=void 0,n=void 0,m=void 0,b=this.context,E=(0,p.default)(b).getInstance(),T=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function w(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=!1,h=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),l=t!==i.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var d=D(e.Representation_asArray[0]);if(d&&d.length>0&&_.THUMBNAILS_SCHEME_ID_URIS.indexOf(d[0].schemeIdUri)>=0)return t===i.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(r.default.CODECS)&&(0===(u=e.Representation_asArray[0].codecs).search(i.default.STPP)||0===u.search(i.default.WVTT)))return t===i.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return t===i.default.MUXED;s[0]&&s[0].contentType===t&&(c=!0,h=!0)}if(e.hasOwnProperty(r.default.MIME_TYPE)&&(c=l.test(e.mimeType),h=!0),!h)for(n=0,a=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!h&&n<a;)(o=e.Representation_asArray[n]).hasOwnProperty(r.default.MIME_TYPE)&&(c=l.test(o.mimeType),h=!0),n++;return c}function x(e){return w(e,i.default.AUDIO)}function A(e){return w(e,i.default.VIDEO)}function S(e){return w(e,i.default.FRAGMENTED_TEXT)}function M(e){return w(e,i.default.IMAGE)}function C(e){return"text/vtt"===e||"application/ttml+xml"===e}function R(){return function(e,t){return e.bandwidth-t.bandwidth}}function I(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function P(e,t){return e&&e.Period_asArray&&T(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function L(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===r.default.DYNAMIC),t}function D(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function O(e){if(e&&e.period&&T(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&T(e.index))return I(t.AdaptationSet_asArray[e.index])}}function N(e){var t=e.S_asArray[e.S_asArray.length-1];return!t.hasOwnProperty("r")||t.r>=0}function k(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=s.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(r.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function F(e,t){var n=[],a=void 0;if(!e)return n;for(a=0;a<e.length;a++){var o=new d.default;if(o.timescale=1,o.representation=t,!e[a].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[a].schemeIdUri,e[a].hasOwnProperty(r.default.TIMESCALE)&&(o.timescale=e[a].timescale),e[a].hasOwnProperty(r.default.VALUE)&&(o.value=e[a].value),n.push(o)}return n}function B(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],i=!1;return n.some((function(n){if(n){var a=new h.default,o=n.__text||n;return E.isRelative(o)&&(i=!0,e.baseUri&&(o=E.resolve(o,e.baseUri))),a.url=o,n.hasOwnProperty(r.default.SERVICE_LOCATION)&&n.serviceLocation.length?a.serviceLocation=n.serviceLocation:a.serviceLocation=o,n.hasOwnProperty(r.default.DVB_PRIORITY)&&(a.dvb_priority=n[r.default.DVB_PRIORITY]),n.hasOwnProperty(r.default.DVB_WEIGHT)&&(a.dvb_weight=n[r.default.DVB_WEIGHT]),n.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)&&(a.availabilityTimeOffset=n[r.default.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)&&(a.availabilityTimeComplete="false"!==n[r.default.AVAILABILITY_TIME_COMPLETE]),t.push(a),i}})),t}return e={getIsTypeOf:w,getIsTextTrack:C,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(r.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(r.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(r.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var i=P(t,n);return i.length>0&&T(e)?i[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var i=P(t,n),r=0;r<i.length;r++){if((0,f.default)(b).getInstance().areEqual(i[r],e))return r}return-1},getAdaptationForId:function(e,t,n){var i,a=P(t,n),o=void 0;for(o=0,i=a.length;o<i;o++)if(a[o].hasOwnProperty(r.default.ID)&&a[o].id===e)return a[o];return null},getAdaptationsForType:function(e,t,n){var i,r=P(e,t),a=void 0,o=[];for(a=0,i=r.length;a<i;a++)w(r[a],n)&&o.push(I(r[a]));return o},getCodec:function(e,t,n){var i=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var r=T(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];r&&(i=r.mimeType+';codecs="'+r.codecs+'"',n&&void 0!==r.width&&(i+=';width="'+r.width+'";height="'+r.height+'"'))}return i&&(i=i.replace(/\sprofiles=[^;]*/g,"")),i},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(r.default.CENC_DEFAULT_KID)?e[r.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(r.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:L,hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=I(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}}))},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&T(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,i,o,s,l=[],u=O(e),c=void 0,h=void 0;if(u&&u.Representation_asArray){if(e&&e.period&&T(e.period.index)){var d=B(e.period.mpd.manifest);d&&(h=d[0])}for(var f=0,p=u.Representation_asArray.length;f<p;++f){var m=u.Representation_asArray[f],g=new a.default;if(g.index=f,g.adaptation=e,m.hasOwnProperty(r.default.ID)&&(g.id=m.id),m.hasOwnProperty(r.default.CODECS)&&(g.codecs=m.codecs),m.hasOwnProperty(r.default.CODEC_PRIVATE_DATA)&&(g.codecPrivateData=m.codecPrivateData),m.hasOwnProperty(r.default.BANDWITH)&&(g.bandwidth=m.bandwidth),m.hasOwnProperty(r.default.WIDTH)&&(g.width=m.width),m.hasOwnProperty(r.default.HEIGHT)&&(g.height=m.height),m.hasOwnProperty(r.default.SCAN_TYPE)&&(g.scanType=m.scanType),m.hasOwnProperty(r.default.MAX_PLAYOUT_RATE)&&(g.maxPlayoutRate=m.maxPlayoutRate),m.hasOwnProperty(r.default.SEGMENT_BASE)?(c=m.SegmentBase,g.segmentInfoType=r.default.SEGMENT_BASE):m.hasOwnProperty(r.default.SEGMENT_LIST)?(c=m.SegmentList).hasOwnProperty(r.default.SEGMENT_TIMELINE)?(g.segmentInfoType=r.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=N(c.SegmentTimeline)):(g.segmentInfoType=r.default.SEGMENT_LIST,g.useCalculatedLiveEdgeTime=!0):m.hasOwnProperty(r.default.SEGMENT_TEMPLATE)?((c=m.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE)?(g.segmentInfoType=r.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=N(c.SegmentTimeline)):g.segmentInfoType=r.default.SEGMENT_TEMPLATE,c.hasOwnProperty(r.default.INITIALIZATION_MINUS)&&(g.initialization=c.initialization.split("$Bandwidth$").join(m.bandwidth).split("$RepresentationID$").join(m.id))):g.segmentInfoType=r.default.BASE_URL,g.essentialProperties=D(m),c){if(c.hasOwnProperty(r.default.INITIALIZATION)){var v=c.Initialization;v.hasOwnProperty(r.default.SOURCE_URL)&&(g.initialization=v.sourceURL),v.hasOwnProperty(r.default.RANGE)&&(g.range=v.range)}else m.hasOwnProperty(r.default.MIME_TYPE)&&C(m.mimeType)&&(g.range=0);c.hasOwnProperty(r.default.TIMESCALE)&&(g.timescale=c.timescale),c.hasOwnProperty(r.default.DURATION)?g.segmentDuration=c.duration/g.timescale:m.hasOwnProperty(r.default.SEGMENT_TEMPLATE)&&(c=m.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE)&&(g.segmentDuration=(i=c.SegmentTimeline,o=void 0,s=void 0,o=i.S_asArray[0],s=i.S_asArray[1],(o.hasOwnProperty("d")?o.d:s.t-o.t)/g.timescale)),c.hasOwnProperty(r.default.MEDIA)&&(g.media=c.media),c.hasOwnProperty(r.default.START_NUMBER)&&(g.startNumber=c.startNumber),c.hasOwnProperty(r.default.INDEX_RANGE)&&(g.indexRange=c.indexRange),c.hasOwnProperty(r.default.PRESENTATION_TIME_OFFSET)&&(g.presentationTimeOffset=c.presentationTimeOffset/g.timescale),c.hasOwnProperty(r.default.AVAILABILITY_TIME_OFFSET)?g.availabilityTimeOffset=c.availabilityTimeOffset:h&&void 0!==h.availabilityTimeOffset&&(g.availabilityTimeOffset=h.availabilityTimeOffset),c.hasOwnProperty(r.default.AVAILABILITY_TIME_COMPLETE)?g.availabilityTimeComplete="false"!==c.availabilityTimeComplete:h&&void 0!==h.availabilityTimeComplete&&(g.availabilityTimeComplete=h.availabilityTimeComplete)}g.MSETimeOffset=(n=void 0,void 0,n=(t=g).presentationTimeOffset,t.adaptation.period.start-n),g.path=[e.period.index,e.index,f],l.push(g)}}return l},getAdaptationsForPeriod:function(e){var t=e&&T(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],a=void 0,s=void 0,l=void 0;if(t&&t.AdaptationSet_asArray)for(l=0;l<t.AdaptationSet_asArray.length;l++)s=t.AdaptationSet_asArray[l],a=new o.default,s.hasOwnProperty(r.default.ID)&&(a.id=s.id),a.index=l,a.period=e,w(s,i.default.MUXED)?a.type=i.default.MUXED:x(s)?a.type=i.default.AUDIO:A(s)?a.type=i.default.VIDEO:S(s)?a.type=i.default.FRAGMENTED_TEXT:M(s)?a.type=i.default.IMAGE:a.type=i.default.TEXT,n.push(a);return n},getRegularPeriods:function(e){var a,o=!!e&&L(e.manifest),l=[],u=null,c=null,h=null,d=null,f=void 0;for(f=0,a=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;f<a;f++)(c=e.manifest.Period_asArray[f]).hasOwnProperty(r.default.START)?(d=new s.default).start=c.start:null!==u&&u.hasOwnProperty(r.default.DURATION)&&null!==h?(d=new s.default).start=parseFloat((h.start+h.duration).toFixed(5)):0!==f||o||((d=new s.default).start=0),null!==h&&isNaN(h.duration)&&(null!==d?h.duration=parseFloat((d.start-h.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==d&&(d.id=k(c,f),d.index=f,d.mpd=e,c.hasOwnProperty(r.default.DURATION)&&(d.duration=c.duration),l.push(d),u=c,h=d),c=null,d=null;return 0===l.length||null!==h&&isNaN(h.duration)&&(h.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(i.default.MISSING_CONFIG_ERROR)}();var t=L(e.mpd.manifest),r=void 0;e.mpd.manifest.mediaPresentationDuration?r=e.mpd.manifest.mediaPresentationDuration:e.duration?r=e.duration:t?r=Number.POSITIVE_INFINITY:n.error(new v.default(y.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return r}(h)-h.start).toFixed(5))),l},getMpd:function(e){var t=new l.default;return e&&(t.manifest=e,e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(r.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(r.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(r.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(r.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(r.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(r.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,a=n&&e&&T(e.index)?n[e.index].EventStream_asArray:null,o=[],s=void 0,l=void 0;if(a)for(s=0;s<a.length;s++){var u=new d.default;if(u.period=e,u.timescale=1,!a[s].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(u.schemeIdUri=a[s].schemeIdUri,a[s].hasOwnProperty(r.default.TIMESCALE)&&(u.timescale=a[s].timescale),a[s].hasOwnProperty(r.default.VALUE)&&(u.value=a[s].value),l=0;a[s].Event_asArray&&l<a[s].Event_asArray.length;l++){var h=new c.default;if(h.presentationTime=0,h.eventStream=u,a[s].Event_asArray[l].hasOwnProperty(r.default.PRESENTATION_TIME)){h.presentationTime=a[s].Event_asArray[l].presentationTime;var f=u.presentationTimeOffset?u.presentationTimeOffset*u.timescale:0;h.calculatedPresentationTime=h.presentationTime+e.start*u.timescale+f}a[s].Event_asArray[l].hasOwnProperty(r.default.DURATION)&&(h.duration=a[s].Event_asArray[l].duration),a[s].Event_asArray[l].hasOwnProperty(r.default.ID)&&(h.id=a[s].Event_asArray[l].id),a[s].Event_asArray[l].Signal&&a[s].Event_asArray[l].Signal.Binary?h.messageData=m.decodeArray(a[s].Event_asArray[l].Signal.Binary.toString()):h.messageData=a[s].Event_asArray[l].messageData||a[s].Event_asArray[l].__text,o.push(h)}}return o},getEventStreamForAdaptationSet:function(e,t){var n=void 0,i=void 0,r=void 0;return e&&e.Period_asArray&&t&&t.period&&T(t.period.index)&&(i=e.Period_asArray[t.period.index])&&i.AdaptationSet_asArray&&T(t.index)&&(r=i.AdaptationSet_asArray[t.index])&&(n=r.InbandEventStream_asArray),F(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,i=void 0,r=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&T(t.adaptation.period.index)&&(i=e.Period_asArray[t.adaptation.period.index])&&i.AdaptationSet_asArray&&T(t.adaptation.index)&&(r=i.AdaptationSet_asArray[t.adaptation.index])&&r.Representation_asArray&&T(t.index)&&(a=r.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),F(n,t)},getUTCTimingSources:function(e){var t=L(e),n=!!e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME),a=e?e.UTCTiming_asArray:null,o=[];return(t||n)&&a&&a.forEach((function(e){var t=new u.default;e.hasOwnProperty(i.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(r.default.VALUE)&&(t.value=e.value.toString(),o.push(t)))})),o},getBaseURLsFromElement:B,getRepresentationSortFunction:R,getLocation:function(e){if(e&&e.hasOwnProperty(i.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getUseCalculatedLiveEdgeTimeForAdaptation:function(e){var t=O(e),n=t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray[0]:null,i=void 0;if(n){if(n.hasOwnProperty(r.default.SEGMENT_LIST))return!(i=n.SegmentList).hasOwnProperty(r.default.SEGMENT_TIMELINE)||N(i.SegmentTimeline);if(n.hasOwnProperty(r.default.SEGMENT_TEMPLATE)&&(i=n.SegmentTemplate).hasOwnProperty(r.default.SEGMENT_TIMELINE))return N(i.SegmentTimeline)}return!1},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(r.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(r.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(r.default.SERVICE_DESCRIPTION)){var n=!0,a=!1,o=void 0;try{for(var s,l=e.ServiceDescription_asArray[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value,c=void 0,h=void 0,d=void 0,f=void 0;for(var p in u)u.hasOwnProperty(p)&&(p===r.default.ID?c=u[p]:p===r.default.SERVICE_DESCRIPTION_SCOPE?h=u[p].schemeIdUri:p===r.default.SERVICE_DESCRIPTION_LATENCY?d={target:u[p].target,max:u[p].max,min:u[p].min}:p===r.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(f={max:u[p].max,min:u[p].min}));h===i.default.SERVICE_DESCRIPTION_LL_SCHEME&&(d||f)&&t.push({id:c,schemeIdUri:h,latency:d,playbackRate:f})}}catch(e){a=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}}return t},getSupplementalPropperties:function(e){var t={};if(e&&e.hasOwnProperty(r.default.SUPPLEMENTAL_PROPERTY)){var n=!0,a=!1,o=void 0;try{for(var s,l=e.SupplementalProperty_asArray[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;u.hasOwnProperty(i.default.SCHEME_ID_URI)&&u.hasOwnProperty(r.default.VALUE)&&(t[u[i.default.SCHEME_ID_URI]]=u[r.default.VALUE])}}catch(e){a=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}}return t},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(m=e.BASE64))}},t=(0,g.default)(b).getInstance().getLogger(e),e}E.__dashjs_factory_name="DashManifestModel",t.default=m.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=function(){return"3.1.2"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,i,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=i,this.persistentState=r,this.sessionTypes=a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return i(e,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var i={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(i)}this.type&&(n.type=this.type);var r=JSON.stringify(n),a=r.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=r.charCodeAt(e);return o}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=i,this.messageType=r||"license-request"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n}},function(e,t){e.exports={toUnsigned:function(e){return e>>>0},toHexString:function(e){return("00"+e.toString(16)).slice(-2)}}},function(e,t,n){"use strict";var i=n(284),r=n(34),a=n(285);function o(e,t,n){var i=e;return a(t)?(n=t,"string"==typeof e&&(i={uri:e})):i=r({},t,{uri:e}),i.callback=n,i}function s(e,t,n){return l(t=o(e,t,n))}function l(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,i,r){t||(t=!0,e.callback(n,i,r))};function i(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(u),g)try{e=JSON.parse(e)}catch(e){}return e}function r(e){return clearTimeout(c),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,v)}function a(){if(!l){var t;clearTimeout(c),t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var r=v,a=null;return 0!==t?(r={body:i(),statusCode:t,method:d,headers:{},url:h,rawRequest:u},u.getAllResponseHeaders&&(r.headers=function(e){var t={};return e?(e.trim().split("\n").forEach((function(e){var n=e.indexOf(":"),i=e.slice(0,n).trim().toLowerCase(),r=e.slice(n+1).trim();void 0===t[i]?t[i]=r:Array.isArray(t[i])?t[i].push(r):t[i]=[t[i],r]})),t):t}(u.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,r,r.body)}}var o,l,u=e.xhr||null;u||(u=e.cors||e.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var c,h=u.url=e.uri||e.url,d=u.method=e.method||"GET",f=e.body||e.data,p=u.headers=e.headers||{},m=!!e.sync,g=!1,v={body:void 0,headers:{},statusCode:0,method:d,url:h,rawRequest:u};if("json"in e&&!1!==e.json&&(g=!0,p.accept||p.Accept||(p.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(p["content-type"]||p["Content-Type"]||(p["Content-Type"]="application/json"),f=JSON.stringify(!0===e.json?f:e.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(a,0)},u.onload=a,u.onerror=r,u.onprogress=function(){},u.onabort=function(){l=!0},u.ontimeout=r,u.open(d,h,!m,e.username,e.password),m||(u.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(c=setTimeout((function(){if(!l){l=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}}),e.timeout)),u.setRequestHeader)for(o in p)p.hasOwnProperty(o)&&u.setRequestHeader(o,p[o]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(f||null),u}e.exports=s,e.exports.default=s,s.XMLHttpRequest=i.XMLHttpRequest||function(){},s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:i.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],(function(e){s["delete"===e?"del":e]=function(t,n,i){return(n=o(t,n,i)).method=e.toUpperCase(),l(n)}}))},function(e,t,n){var i=n(0),r=e.exports={WebVTT:n(286),VTTCue:n(287),VTTRegion:n(288)};i.vttjs=r,i.WebVTT=r.WebVTT;var a=r.VTTCue,o=r.VTTRegion,s=i.VTTCue,l=i.VTTRegion;r.shim=function(){i.VTTCue=a,i.VTTRegion=o},r.restore=function(){i.VTTCue=s,i.VTTRegion=l},i.VTTCue||r.shim()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=W(n(79)),r=W(n(7)),a=W(n(13)),o=W(n(16)),s=W(n(124)),l=W(n(126)),u=W(n(58)),c=W(n(196)),h=W(n(202)),d=W(n(214)),f=W(n(215)),p=W(n(52)),m=W(n(61)),g=W(n(50)),v=W(n(216)),y=W(n(218)),_=W(n(219)),b=W(n(90)),E=W(n(94)),T=W(n(220)),w=W(n(95)),x=W(n(221)),A=W(n(9)),S=W(n(15)),M=W(n(8)),C=W(n(10)),R=W(n(64)),I=W(n(2)),P=W(n(65)),L=n(68),D=W(n(222)),O=W(n(226)),N=W(n(231)),k=W(n(243)),F=n(14),B=W(n(244)),U=W(n(51)),j=W(n(12)),G=n(20),z=W(n(101)),H=W(n(18)),V=W(n(30));function W(e){return e&&e.__esModule?e:{default:e}}function q(){var e="You must first call initialize() and set a source before calling this method",t="You must first call initialize() and set a valid source and view before calling this method",n="You must first call attachView() to set the video element before calling this method",W="You must first call attachSource() with a valid source before calling this method",q=this.context,Y=(0,M.default)(q).getInstance(),X=(0,P.default)(q).getInstance(),K=(0,A.default)(q).getInstance({settings:X}),Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,ie=void 0,re=void 0,ae=void 0,oe=void 0,se=void 0,le=void 0,ue=void 0,ce=void 0,he=void 0,de=void 0,fe=void 0,pe=void 0,me=void 0,ge=void 0,ve=void 0,ye=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,we=void 0,xe=void 0,Ae=void 0,Se=void 0;function Me(){return!!J&&!!Te.getElement()}function Ce(){return(0,L.getVersionString)()}function Re(){if(!ne)throw t;return ye.isPaused()}function Ie(e){var t=_e.getCurrentDVRInfo();if(!t)return 0;var n=ye.getLiveDelay(),i=t.range.start+e;return i>t.range.end-n&&(i=t.range.end-n),i}function Pe(e){if(!ne)throw t;var n=ke().currentTime;if(void 0!==e)n=ve.getTimeRelativeToStreamId(n,e);else if(ye.getIsDynamic()){var i=_e.getCurrentDVRInfo();n=null===i?0:Le()-(i.range.end-i.time)}return n}function Le(){if(!ne)throw t;var e=ke().duration;if(ye.getIsDynamic()){var n,i=_e.getCurrentDVRInfo();if(!i)return 0;e=(n=i.range.end-i.range.start)<i.manifestInfo.DVRWindowSize?n:i.manifestInfo.DVRWindowSize}return e}function De(e){(0,G.checkParameterType)(e,"boolean"),ie=e}function Oe(){fe.restoreDefaultUTCTimingSources()}function Ne(){return _e}function ke(){if(!Te.getElement())throw n;return Te.getElement()}function Fe(e){if(!ee)throw"MediaPlayer not initialized!";Te.setElement(e),e&&(He(),function(){if(ue)return;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(q).create();ue=t.createMetricsReporting({debug:K,eventBus:Y,mediaElement:ke(),adapter:de,dashMetrics:_e,events:C.default,constants:r.default,metricsConstants:o.default})}}(),function(){if(ce)return;var e=dashjs.MssHandler;"function"==typeof e&&(S.default.extend(e.errors),ce=e(q).create({eventBus:Y,mediaPlayerModel:fe,dashMetrics:_e,manifestModel:be,playbackController:ye,streamController:ve,protectionController:le,baseURLController:me,errHandler:pe,events:C.default,constants:r.default,debug:K,initSegmentType:F.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:B.default,ISOBoxer:U.default,settings:X}))}(),ve&&ve.switchToVideoElement()),ne&&Ge(),qe()}function Be(t){if(!te)throw e;var n=ve.getActiveStreamInfo();return se.getTracksFor(t,n)}function Ue(e){if(!ee)throw"MediaPlayer not initialized!";"string"==typeof e&&xe.initialize(e),J=e,(te||ne)&&Ge(),Me()&&qe()}function je(){if(!te)throw e;var t=ve.getActiveStreamInfo();return t?ve.getStreamById(t.id):null}function Ge(){ne=!1,te=!1,de.reset(),ve.reset(),ye.reset(),re.reset(),se.reset(),we.reset(),le&&(X.get().streaming.keepProtectionMediaKeys?le.stop():(le.reset(),le=null,He())),Ee.reset()}function ze(){return(0,h.default)(q).create({debug:K,errHandler:pe,dashMetrics:_e,mediaPlayerModel:fe,requestModifier:(0,m.default)(q).getInstance(),mssHandler:ce,settings:X})}function He(){if(le)return le;var e=dashjs.Protection;if("function"==typeof e){var t=e(q).create();return C.default.extend(e.events),R.default.extend(e.events,{publicOnly:!0}),S.default.extend(e.errors),ge||(ge=(0,f.default)(q).getInstance()),le=t.createProtectionSystem({debug:K,errHandler:pe,videoModel:Te,capabilities:ge,eventBus:Y,events:C.default,BASE64:B.default,constants:r.default})}return null}function Ve(){if(!ee)throw"MediaPlayer not initialized!";if(he)return he;var e=dashjs.OfflineController;if("function"==typeof e){C.default.extend(e.events),R.default.extend(e.events,{publicOnly:!0}),S.default.extend(e.errors);var t=ze(),n=(0,z.default)(q).create();return n.setConfig({manifestModel:be,adapter:de,manifestLoader:t,errHandler:pe}),he=e(q).create({debug:K,manifestUpdater:n,baseURLController:me,manifestLoader:t,manifestModel:be,mediaPlayerModel:fe,abrController:re,playbackController:ye,adapter:de,errHandler:pe,dashMetrics:_e,timelineConverter:oe,schemeLoaderFactory:ae,eventBus:Y,events:C.default,errors:S.default,constants:r.default,settings:X,dashConstants:a.default,urlUtils:(0,H.default)(q).getInstance()})}return null}function We(e){var t=_e.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function qe(){var e;he&&he.resetRecords(),!te&&J&&(te=!0,Z.info("Streaming Initialized"),e=ze(),ve||(ve=(0,l.default)(q).getInstance()),se.setConfig({domStorage:Ae}),ve.setConfig({capabilities:ge,manifestLoader:e,manifestModel:be,mediaPlayerModel:fe,protectionController:le,adapter:de,dashMetrics:_e,errHandler:pe,timelineConverter:oe,videoModel:Te,playbackController:ye,abrController:re,mediaController:se,textController:we,settings:X,baseURLController:me}),ye.setConfig({streamController:ve,dashMetrics:_e,mediaPlayerModel:fe,adapter:de,videoModel:Te,timelineConverter:oe,uriFragmentModel:xe,settings:X}),re.setConfig({streamController:ve,domStorage:Ae,mediaPlayerModel:fe,dashMetrics:_e,adapter:de,videoModel:Te,settings:X}),re.createAbrRulesCollection(),we.setConfig({errHandler:pe,manifestModel:be,adapter:de,mediaController:se,streamController:ve,videoModel:Te}),Ee.setConfig({abrController:re,dashMetrics:_e,playbackController:ye}),ve.initialize(ie,$),Ee.initialize(),"string"==typeof J?ve.load(J):ve.loadWithManifest(J)),!ne&&Me()&&(ne=!0,Z.info("Playback Initialized"))}return Q={initialize:function(e,t,n){ge||(ge=(0,f.default)(q).getInstance()),pe=(0,d.default)(q).getInstance(),ge.supportsMediaSource()?ee||(ee=!0,oe=(0,k.default)(q).getInstance(),re||(re=(0,b.default)(q).getInstance()).setConfig({settings:X}),ae||(ae=(0,E.default)(q).getInstance()),ye||(ye=(0,s.default)(q).getInstance()),se||(se=(0,u.default)(q).getInstance()),ve||(ve=(0,l.default)(q).getInstance()),de=(0,O.default)(q).getInstance(),be=(0,y.default)(q).getInstance(),Ee=(0,w.default)(q).getInstance(),_e=(0,N.default)(q).getInstance({settings:X}),we=(0,g.default)(q).getInstance(),Ae=(0,x.default)(q).getInstance({settings:X}),de.setConfig({constants:r.default,cea608parser:i.default,errHandler:pe,BASE64:B.default}),me||(me=(0,c.default)(q).create()),me.setConfig({adapter:de}),(Se=(0,D.default)(q).getInstance({dashMetrics:_e,mediaPlayerModel:fe,errHandler:pe,baseURLController:me,events:C.default,eventBus:Y,debug:K,boxParser:(0,V.default)(q).getInstance(),requestModifier:(0,m.default)(q).getInstance(),errors:S.default})).initialize(),Oe(),De(void 0===n||n),Ve(),e&&Fe(e),t&&Ue(t),Z.info("[dash.js "+Ce()+"] MediaPlayer has been initialized")):pe.error(new j.default(S.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,S.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(ge=e.capabilities),e.streamController&&(ve=e.streamController),e.playbackController&&(ye=e.playbackController),e.mediaPlayerModel&&(fe=e.mediaPlayerModel),e.abrController&&(re=e.abrController),e.schemeLoaderFactory&&(ae=e.schemeLoaderFactory),e.mediaController&&(se=e.mediaController),e.settings&&(X=e.settings))},on:function(e,t,n){Y.on(e,t,n)},off:function(e,t,n){Y.off(e,t,n)},extend:function(e,t,n){I.default.extend(e,t,n,q)},attachView:Fe,attachSource:Ue,isReady:Me,preload:function(){if(Te.getElement()||te)return!1;if(!J)throw W;qe()},play:function(){if(!ne)throw t;(!ie||Re()&&ne)&&ye.play()},isPaused:Re,pause:function(){if(!ne)throw t;ye.pause()},isSeeking:function(){if(!ne)throw t;return ye.isSeeking()},isDynamic:function(){if(!ne)throw t;return ye.getIsDynamic()},seek:function(e){if(!ne)throw t;if((0,G.checkParameterType)(e,"number"),isNaN(e))throw r.default.BAD_ARGUMENT_ERROR;var n=ye.getIsDynamic()?Ie(e):e;ye.seek(n)},setPlaybackRate:function(e){ke().playbackRate=e},getPlaybackRate:function(){return ke().playbackRate},setMute:function(e){(0,G.checkParameterType)(e,"boolean"),ke().muted=e},isMuted:function(){return ke().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw r.default.BAD_ARGUMENT_ERROR;ke().volume=e},getVolume:function(){return ke().volume},time:Pe,duration:Le,timeAsUTC:function(){if(!ne)throw t;return Pe()<0?NaN:We(Pe())},durationAsUTC:function(){if(!ne)throw t;return We(Le())},getActiveStream:je,getDVRWindowSize:function(){var e=_e.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Ie,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),i=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(i<10?"0"+i.toString():i.toString())},formatUTC:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=new Date(1e3*e),a=r.toLocaleDateString(t),o=r.toLocaleTimeString(t,{hour12:n});return i?o+" "+a:o},getVersion:Ce,getDebug:function(){return K},getBufferLength:function(e){var t=[r.default.VIDEO,r.default.AUDIO,r.default.FRAGMENTED_TEXT];if(e){if(-1!==t.indexOf(e)){var n=Ne().getCurrentBufferLevel(e);return n||NaN}return Z.warn("getBufferLength requested for invalid type"),NaN}var i=t.map((function(e){return Be(e).length>0?Ne().getCurrentBufferLevel(e):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)}));return i===Number.MAX_VALUE?NaN:i},getTTMLRenderingDiv:function(){return Te?Te.getTTMLRenderingDiv():null},getVideoElement:ke,getSource:function(){if(!J)throw W;return J},getCurrentLiveLatency:function(){if(!ee)throw"MediaPlayer not initialized!";return ne?ye.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(t){if(!te)throw e;return re.getTopBitrateInfoFor(t)},setAutoPlay:De,getAutoPlay:function(){return ie},getDashMetrics:Ne,getQualityFor:function(t){if(!te)throw e;if(t===r.default.IMAGE){var n=je();if(!n)return-1;var i=n.getThumbnailController();return i?i.getCurrentTrackIndex():-1}return re.getQualityFor(t)},setQualityFor:function(t,n){if(!te)throw e;if(t===r.default.IMAGE){var i=je();if(!i)return;var a=i.getThumbnailController();a&&a.setTrackByIndex(n)}re.setPlaybackQuality(t,ve.getActiveStreamInfo(),n)},updatePortalSize:function(){re.setElementSize(),re.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(e){Z.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===we&&(we=(0,g.default)(q).getInstance()),we.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return Z.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===we&&(we=(0,g.default)(q).getInstance()),we.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===we&&(we=(0,g.default)(q).getInstance()),we.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===we&&(we=(0,g.default)(q).getInstance()),we.getTextDefaultEnabled()},enableText:function(e){void 0===we&&(we=(0,g.default)(q).getInstance()),we.enableText(e)},enableForcedTextStreaming:function(e){void 0===we&&(we=(0,g.default)(q).getInstance()),we.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===we&&(we=(0,g.default)(q).getInstance()),we.isTextEnabled()},setTextTrack:function(e){if(!ne)throw t;void 0===we&&(we=(0,g.default)(q).getInstance()),we.setTextTrack(e)},getBitrateInfoListFor:function(t){if(!te)throw e;var n=je();return n?n.getBitrateListFor(t):[]},getStreamsFromManifest:function(t){if(!te)throw e;return de.getStreamsInfo(t)},getTracksFor:Be,getTracksForTypeFromManifest:function(t,n,i){if(!te)throw e;return(i=i||de.getStreamsInfo(n,1)[0])?de.getAllMediaInfoForType(i,t,n):[]},getCurrentTrackFor:function(t){if(!te)throw e;var n=ve.getActiveStreamInfo();return se.getCurrentTrackFor(t,n)},setInitialMediaSettingsFor:function(e,t){if(!ee)throw"MediaPlayer not initialized!";se.setInitialSettings(e,t),e===r.default.FRAGMENTED_TEXT&&we.setInitialSettings(t)},getInitialMediaSettingsFor:function(e){if(!ee)throw"MediaPlayer not initialized!";return se.getInitialSettings(e)},setCurrentTrack:function(t){if(!te)throw e;se.setTrack(t)},getTrackSwitchModeFor:function(e){if(!ee)throw"MediaPlayer not initialized!";return se.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!ee)throw"MediaPlayer not initialized!";se.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!ee)throw"MediaPlayer not initialized!";se.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!ee)throw"MediaPlayer not initialized!";return se.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,n){fe.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){fe.removeABRCustomRule(e)},removeAllABRCustomRule:function(){fe.removeABRCustomRule()},getAverageThroughput:function(e){var t=re.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,t){var n=ze(),i=this;Y.on(C.default.INTERNAL_MANIFEST_LOADED,(function e(r){r.error?t(null,r.error):t(r.manifest),Y.off(C.default.INTERNAL_MANIFEST_LOADED,e,i),n.reset()}),i),xe.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){fe.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){fe.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){fe.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:Oe,setXHRWithCredentialsForType:function(e,t){fe.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return fe.getXHRWithCredentialsForType(e)},getProtectionController:function(){return He()},attachProtectionController:function(e){le=e},setProtectionData:function(e){$=e,ve&&ve.setProtectionData($)},displayCaptionsOnTop:function(e){var t=(0,p.default)(q).getInstance();t.setConfig({videoModel:Te}),t.initialize(),t.setDisplayCConTop(e)},attachTTMLRenderingDiv:function(e){if(!Te.getElement())throw n;Te.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return we&&(e=we.getCurrentTrackIdx()),e},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=ye.getIsDynamic()?Ie(e):e,i=ve.getStreamForTime(n);if(null!==i){var r=i.getThumbnailController();if(r){var a=ve.getTimeRelativeToStreamId(n,i.getId());return r.provide(a,t)}t(null)}else t(null)}},getDashAdapter:function(){return de},getOfflineController:function(){return Ve()},getSettings:function(){return X.get()},updateSettings:function(e){X.update(e)},resetSettings:function(){X.reset()},reset:function(){Ue(null),Fe(null),$=null,le&&(le.reset(),le=null),ue&&(ue.reset(),ue=null),Se.reset(),X.reset(),he&&(he.reset(),he=null)}},Z=K.getLogger(Q),ee=!1,ne=!1,te=!1,ie=!0,le=null,he=null,$=null,de=null,Se=null,C.default.extend(R.default),fe=(0,_.default)(q).getInstance(),Te=(0,T.default)(q).getInstance(),xe=(0,v.default)(q).getInstance(),Q}q.__dashjs_factory_name="MediaPlayer";var Y=I.default.getClassFactory(q);Y.events=R.default,Y.errors=S.default,I.default.updateClassFactory(q.__dashjs_factory_name,Y),t.default=Y},function(e,t,n){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},i={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},r={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},o={25:2,26:4,29:6,30:8,31:10,27:13,28:15},s=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],l={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},u=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},c=function(e,t,n,i,r){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=i||"black",this.flash=r||!1};c.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var h=function(e,t,n,i,r,a){this.uchar=e||" ",this.penState=new c(t,n,i,r,a)};h.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var d=function(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new h);this.pos=0,this.currPenState=new c};d.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(l.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(l.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=32?l.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var f=function(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new d);this.currRow=14,this.nrRollUpRows=null,this.reset()};f.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){l.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){l.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var i=e.indent,r=Math.max(i-1,0);n.setCursor(e.indent),e.color=n.chars[r].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){l.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){l.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),l.log("INFO","Rolling up")}else l.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,r=0;r<15;r++){var a=this.rows[r].getTextString();a&&(i=r+1,e?t.push("Row "+i+': "'+a+'"'):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var p=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new f,this.nonDisplayedMemory=new f,this.lastOutputScreen=new f,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,l.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";l.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(l.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){l.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){l.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){l.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){l.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){l.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){l.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){l.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){l.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){l.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){l.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){l.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(l.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,l.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){l.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}l.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=l.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var m=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};m.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,i,r,a=!1;this.lastTime=e,l.setTime(e);for(var o=0;o<t.length;o+=2)if(i=127&t[o],r=127&t[o+1],i>=16&&i<=31&&i===this.lastCmdA&&r===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,l.log("DEBUG","Repeated command ("+u([i,r])+") is dropped");else if(0!==i||0!==r){if(l.log("DATA","["+u([t[o],t[o+1]])+"] -> ("+u([i,r])+")"),(n=this.parseCmd(i,r))||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),!n)if(a=this.parseChars(i,r))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else l.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,l.log("WARNING","Couldn't parse cleaned data "+u([i,r])+" orig: "+u([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var i=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?i.cc_RCL():33===t?i.cc_BS():34===t?i.cc_AOF():35===t?i.cc_AON():36===t?i.cc_DER():37===t?i.cc_RU(2):38===t?i.cc_RU(3):39===t?i.cc_RU(4):40===t?i.cc_FON():41===t?i.cc_RDC():42===t?i.cc_TR():43===t?i.cc_RTD():44===t?i.cc_EDM():45===t?i.cc_CR():46===t?i.cc_ENM():47===t&&i.cc_EOC():i.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return l.log("ERROR","Mismatch channel in midrow parsing"),!1;var i=this.channels[n-1];return i.insertChars([32]),i.cc_MIDROW(t),l.log("DEBUG","MIDROW ("+u([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,s=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,s=64<=t&&t<=95?1===n?i[e]:a[e]:1===n?r[e]:o[e];var l=this.interpretPAC(s,t);return this.channels[n-1].setPAC(l),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i},parseChars:function(e,t){var i=null,r=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,l.log("INFO","Special char '"+n(o)+"' in channel "+i),r=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(r=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(r){var s=u(r);l.log("DEBUG","Char codes =  "+s.join(","))}return r},parseBackgroundAttributes:function(e,t){var n,i,r;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(i=Math.floor((t-32)/2),n.background=s[i],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),r=e<24?1:2,this.channels[r-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=l,e.PenState=c,e.CaptionScreen=f,e.Cea608Parser=m,e.findCea608Nalus=function(e,t,n){for(var i=0,r=t,a=[],o=function(e,t,n,i){if(4!==e||t<8)return null;var r=n.getUint8(i),a=n.getUint16(i+1),o=n.getUint32(i+3),s=n.getUint8(i+7);return 181==r&&49==a&&1195456820==o&&3==s};r<t+n;){if(i=e.getUint32(r),6===(31&e.getUint8(r+4)))for(var s=r+5,l=-1;s<r+4+i-1;){l=0;for(var u=255;255===u;)l+=u=e.getUint8(s),s++;var c=0;for(u=255;255===u;)c+=u=e.getUint8(s),s++;o(l,c,e,s)&&a.push([s,c]),s+=c}r+=i+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],i=[[],[]];n+=8;var r=31&e.getUint8(n);n+=2;for(var a=0;a<r;a++){var o=e.getUint8(n),s=4&o,l=3&o;n++;var u=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&u)+(127&c)!=0&&(0===l?(i[0].push(u),i[0].push(c)):1===l&&(i[1].push(u),i[1].push(c)))}return i}}(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(7)),r=y(n(16)),a=y(n(29)),o=y(n(81)),s=y(n(155)),l=y(n(90)),u=y(n(58)),c=y(n(8)),h=y(n(10)),d=y(n(2)),f=y(n(9)),p=y(n(59)),m=y(n(12)),g=y(n(15)),v=n(14);function y(e){return e&&e.__esModule?e:{default:e}}function _(e){e=e||{};var t=this.context,n=(0,c.default)(t).getInstance(),d=e.errHandler,y=e.fragmentModel,_=e.representationController,b=e.mediaController,E=e.adapter,T=e.textController,w=e.abrController,x=e.playbackController,A=e.streamInfo,S=e.type,M=e.settings,C=void 0,R=void 0,I=void 0,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,z=void 0,H=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,X=void 0,K=void 0;function Q(e,n){if(!V||!e)return null;var i=e[0];if(O)try{"function"==typeof(F=n&&n[S]?(0,o.default)(t).create(O,i,te.bind(this),M.get().streaming.useAppendWindowEnd,n[S]):(0,o.default)(t).create(O,i,te.bind(this),M.get().streaming.useAppendWindowEnd)).getBuffer().initialize&&F.getBuffer().initialize(S,A,e,y)}catch(e){R.fatal("Caught error on create SourceBuffer: "+e),d.error(new m.default(g.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,g.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+S))}else F=(0,s.default)(t).create(te.bind(this));return ye(this.getRepresentationInfo(I)),F}function Z(e){e.chunk.streamId===A.id&&e.chunk.mediaInfo.type===S&&(R.info("Init fragment finished loading saving to",S+"'s init cache"),V.save(e.chunk),R.debug("Append Init fragment",S," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),$(e.chunk))}function J(e){var t=e.chunk;if(t.streamId===A.id&&t.mediaInfo.type==S)if(X){K=t;var n=F&&F.getAllBufferRanges();n&&n.length>0&&x.getTimeToStreamEnd()>.5&&(R.debug("Clearing buffer because track changed - "+(n.end(n.length-1)+.5)),me([{start:0,end:n.end(n.length-1)+.5,force:!0}]))}else $(t)}function $(e){F.append(e),e.mediaInfo.type===i.default.VIDEO&&Me(h.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ee(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)R.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",x.getTime())}function te(e){if(e.error){if(22===e.error.code&&(H=!0,D=.8*Ae(),R.warn("Quota exceeded, Critical Buffer: "+D),D>0)){var t=Math.max(.2*D,1),n=D-t,r={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferAheadToKeep:parseFloat(n.toFixed(5))}};M.update(r)}22!==e.error.code&&Se()||(R.warn("Clearing playback buffer to overcome quota exceed situation"),Me(h.default.QUOTA_EXCEEDED,{criticalBufferLevel:D}),ae())}else{H=!1,(j=e.chunk)&&!isNaN(j.index)&&(N=Math.max(j.index,N),he());var a=F.getAllBufferRanges();if(j.segmentType===v.HTTPRequest.MEDIA_SEGMENT_TYPE)ee(a),oe(),function(){if(S!==i.default.AUDIO&&S!==i.default.VIDEO)return;if(isNaN(W))return;var e=x.getTime(),t=ue(W,0);if(e===W&&t)return;var n=_.getCurrentRepresentation().segmentDuration;if(!(t=ue(W,n)))return;Math.abs(e-W)>n?W<=t.end&&(x.seek(Math.max(W,t.start),!1,!0),W=NaN):e<t.start&&(x.seek(t.start,!1,!0),W=NaN)}();else if(X){var o=x.getTime();R.debug("AppendToBuffer seek target should be "+o),Me(h.default.SEEK_TARGET,{time:o})}j&&Me(j.endFragment?h.default.BYTES_APPENDED_END_FRAGMENT:h.default.BYTES_APPENDED,{quality:j.quality,startTime:j.start,index:j.index,bufferedRanges:a,mediaType:S})}}function ne(e){e.streamInfo.id==A.id&&e.mediaType===S&&I!==e.newQuality&&(ye(this.getRepresentationInfo(e.newQuality)),I=e.newQuality)}function ie(e){W=e.seekTime,P&&(q=!0,P=!1,k=Number.POSITIVE_INFINITY),S!==i.default.FRAGMENTED_TEXT?ae():oe()}function re(){W=NaN}function ae(){F.waitForUpdateEnd((function(){var e=function(){var e=[],t=F.getAllBufferRanges();if(!t||0===t.length)return e;var n=x.getTime(),i=t.end(t.length-1)+.5,r=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(r){var o={start:0,end:r.startTime-.5},s=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:r.startTime-r.duration/2,threshold:.01})[0];s&&s.startTime!=r.startTime&&(o.end=s.startTime),o.start<o.end&&o.end>t.start(0)&&e.push(o);var l={start:r.startTime+r.duration+.5,end:i},u=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:r.startTime+r.duration+.5,threshold:.01})[0];u&&u.startTime!==r.startTime&&(l.start=u.startTime+u.duration+.5),l.start<l.end&&l.start<i&&e.push(l)}else R.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",i),e.push({start:0,end:i});return e}();e&&0!==e.length||oe(),me(e)}))}function oe(){(!X||S===i.default.FRAGMENTED_TEXT&&T.isTextEnabled())&&ce()}function se(){de()}function le(){W=NaN,de()}function ue(e,t){var n=F.getAllBufferRanges(),i=0,r=0,a=null,o=null,s=0,l=void 0,u=void 0,c=isNaN(t)?.15:t;if(null!=n){for(u=0,l=n.length;u<l;u++)if(i=n.start(u),r=n.end(u),null===a)s=Math.abs(i-e),(e>=i&&e<r||s<=c)&&(a=i,o=r);else{if(!((s=i-o)<=c))break;o=r}if(null!==a)return{start:a,end:o}}return null}function ce(){var e,t,n;x&&(e=(isNaN(W)?x.getTime():W)||0,L=null===(n=ue(e,t))?0:n.end-e,Me(h.default.BUFFER_LEVEL_UPDATED,{bufferLevel:L}),de())}function he(){N>=k-1&&!P&&void 0===F.discharge&&(P=!0,R.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),Me(h.default.BUFFERING_COMPLETED))}function de(){S!==i.default.AUDIO&&S!==i.default.VIDEO||(q&&!P&&L>0&&x&&x.getTimeToStreamEnd()-L<.5&&(q=!1,P=!0,R.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),Me(h.default.BUFFERING_COMPLETED)),(!M.get().streaming.lowLatencyEnabled&&L<.5||0===L)&&!P?fe(r.default.BUFFER_EMPTY):(P||L>=A.manifestInfo.minBufferTime)&&fe(r.default.BUFFER_LOADED))}function fe(e){U===e||e===r.default.BUFFER_EMPTY&&0===x.getTime()||S===i.default.FRAGMENTED_TEXT&&!T.isTextEnabled()||(U=e,Me(h.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Me(e===r.default.BUFFER_LOADED?h.default.BUFFER_LOADED:h.default.BUFFER_EMPTY),R.debug(e===r.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function pe(){F&&S!==i.default.FRAGMENTED_TEXT&&(P||me(function(){var e=[],t=F.getAllBufferRanges();if(!t||0===t.length)return e;var n=x.getTime(),i={start:Math.max(0,n-M.get().streaming.bufferToKeep),end:n+M.get().streaming.bufferAheadToKeep},r=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(r)i.start=Math.min(r.startTime,i.start),i.end=Math.max(r.startTime+r.duration,i.end);else if(0===n&&x.getIsDynamic())return[];if(t.start(0)<=i.start){for(var o={start:0,end:i.start},s=0;s<t.length&&t.end(s)<=i.start;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}if(t.end(t.length-1)>=i.end){var l={start:i.end,end:t.end(t.length-1)+.01};l.start<l.end&&e.push(l)}return e}()))}function me(e){e&&F&&0!==e.length&&(Y.push.apply(Y,e),z||ge())}function ge(){if(0===Y.length||!F)return R.debug("Nothing to prune, halt pruning"),Y=[],void(z=!1);var e=F.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return R.debug("SourceBuffer is empty (or does not exist), halt pruning"),Y=[],void(z=!1);var t=Y.shift();R.debug("Removing buffer from:",t.start,"to",t.end),z=!0,x.getTime()<t.end&&(P=!1,N=0),F.remove(t.start,t.end,t.force)}function ve(e){F===e.buffer&&(R.debug("onRemoved buffer from:",e.from,"to",e.to),ee(F.getAllBufferRanges()),0===Y.length&&(z=!1),e.unintended&&(R.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),Me(h.default.SEEK_TARGET,{time:e.from})),z?ge():(X?(X=!1,K&&$(K)):ce(),Me(h.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Se(),quotaExceeded:H})))}function ye(e){e&&void 0!==e.MSETimeOffset&&F&&F.updateTimestampOffset&&F.updateTimestampOffset(e.MSETimeOffset)}function _e(e){e.sender.getStreamId()===A.id&&e.sender.getType()===S&&(e.error||ye(e.currentRepresentation))}function be(e){e.request.mediaInfo.streamInfo.id===A.id&&e.request.mediaType===S&&(k=e.request.index,he())}function Ee(e){if(e.newMediaInfo.streamInfo.id===A.id&&e.newMediaInfo.type===S){var t=F&&F.getAllBufferRanges();t&&(R.info("Track change asked"),b.getSwitchMode(S)===u.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&x.getTimeToStreamEnd()>.5&&(P=!1,k=Number.POSITIVE_INFINITY))}}function Te(){++G*(M.get().streaming.wallclockTimeUpdateInterval/1e3)>=M.get().streaming.bufferPruningInterval&&(G=0,pe())}function we(){de()}function xe(e,t){O=e,F&&t&&"function"==typeof F.discharge&&(B=F,Q(t))}function Ae(){var e,t=F.getAllBufferRanges(),n=0,i=void 0;if(!t)return n;for(i=0,e=t.length;i<e;i++)n+=t.end(i)-t.start(i);return n}function Se(){return Ae()<D}function Me(e,t){var i=t||{};i.sender=C,i.mediaType=S,i.streamId=A.id,n.trigger(e,i)}function Ce(e,t){D=Number.POSITIVE_INFINITY,U=void 0,I=l.default.QUALITY_DEFAULT,k=Number.POSITIVE_INFINITY,N=0,j=null,P=!1,z=!1,H=!1,q=!1,L=0,G=0,Y=[],W=NaN,F&&(e||F.abort(),F.reset(t),F=null),X=!1}return C={getBufferControllerType:function(){return"BufferController"},getRepresentationInfo:function(e){return E.convertDataToRepresentationInfo(_.getRepresentationForQuality(e))},initialize:function(e){xe(e),I=w.getQualityFor(S),n.on(h.default.DATA_UPDATE_COMPLETED,_e,this),n.on(h.default.INIT_FRAGMENT_LOADED,Z,this),n.on(h.default.MEDIA_FRAGMENT_LOADED,J,this),n.on(h.default.QUALITY_CHANGE_REQUESTED,ne,this),n.on(h.default.STREAM_COMPLETED,be,this),n.on(h.default.PLAYBACK_PLAYING,le,this),n.on(h.default.PLAYBACK_PROGRESS,oe,this),n.on(h.default.PLAYBACK_TIME_UPDATED,oe,this),n.on(h.default.PLAYBACK_RATE_CHANGED,we,this),n.on(h.default.PLAYBACK_SEEKING,ie,this),n.on(h.default.PLAYBACK_SEEKED,re,this),n.on(h.default.PLAYBACK_STALLED,se,this),n.on(h.default.WALLCLOCK_TIME_UPDATED,Te,this),n.on(h.default.CURRENT_TRACK_CHANGED,Ee,this,c.default.EVENT_PRIORITY_HIGH),n.on(h.default.SOURCEBUFFER_REMOVE_COMPLETED,ve,this)},createBuffer:Q,dischargePreBuffer:function(){if(F&&B&&"function"==typeof B.discharge){var e=B.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+S+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";R.debug(t)}else R.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var i=B.discharge(),r=null,a=0;a<i.length;a++){var o=i[a],s=V.extract(o.streamId,o.representationId);s&&(r!==s&&(F.append(s),r=s),F.append(o))}B.reset(),B=null}},getType:function(){return S},getBuffer:function(){return F},setBuffer:function(e){F=e},getBufferLevel:function(){return L},getRangeAt:ue,setMediaSource:xe,getMediaSource:function(){return O},appendInitSegment:function(e){var t=V.extract(A.id,e);return!!t&&(R.info("Append Init fragment",S," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),$(t),!0)},replaceBuffer:function(){X=!0},getIsBufferingCompleted:function(){return P},getIsPruningInProgress:function(){return z},reset:function(e,t){n.off(h.default.DATA_UPDATE_COMPLETED,_e,this),n.off(h.default.INIT_FRAGMENT_LOADED,Z,this),n.off(h.default.MEDIA_FRAGMENT_LOADED,J,this),n.off(h.default.QUALITY_CHANGE_REQUESTED,ne,this),n.off(h.default.STREAM_COMPLETED,be,this),n.off(h.default.PLAYBACK_PLAYING,le,this),n.off(h.default.PLAYBACK_PROGRESS,oe,this),n.off(h.default.PLAYBACK_TIME_UPDATED,oe,this),n.off(h.default.PLAYBACK_RATE_CHANGED,we,this),n.off(h.default.PLAYBACK_SEEKING,ie,this),n.off(h.default.PLAYBACK_SEEKED,re,this),n.off(h.default.PLAYBACK_STALLED,se,this),n.off(h.default.WALLCLOCK_TIME_UPDATED,Te,this),n.off(h.default.CURRENT_TRACK_CHANGED,Ee,this),n.off(h.default.SOURCEBUFFER_REMOVE_COMPLETED,ve,this),Ce(e,t)}},R=(0,f.default)(t).getInstance().getLogger(C),V=(0,p.default)(t).getInstance(),Ce(),C}_.__dashjs_factory_name="BufferController",t.default=d.default.getClassFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(9)),r=c(n(12)),a=c(n(8)),o=c(n(10)),s=c(n(2)),l=c(n(50)),u=c(n(15));function c(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,s,c){var h=this.context,d=(0,a.default)(h).getInstance(),f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=[],_=[],b=n,E=!1!==s;function T(){try{return m.buffered}catch(e){return p.error("getAllBufferRanges exception: "+e.message),null}}function w(){var e=this;if(_.length>0){g=!0;var t=_[0];_.splice(0,1);var n=[],i=function(){var i=T();!function(e,t,n,i){t&&t.length>0&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var i=Math.round(e.start(n)),r=Math.round(e.end(n));if(r===t.start||i===t.end||t.start>=i&&t.end<=r)return!0}return!1}(t,i)&&d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}(e,n,i,t),_.length>0?w.call(this):(g=!1,b&&b({chunk:t}))};try{0===t.bytes.length?i.call(this):(n=T(),m.appendBuffer?m.appendBuffer(t.bytes):m.append(t.bytes,t),C(i.bind(this)))}catch(e){p.fatal('SourceBuffer append failed "'+e+'"'),_.length>0?w():g=!1,b&&b({chunk:t,error:new r.default(e.code,e.message)})}}}function x(){if(y.length>0){var e=y.shift();m.updating?C(e):(e(),x())}}function A(){m.updating||x()}function S(){m.updating||x()}function M(){p.error("SourceBufferSink error",t.type)}function C(e){y.push(e),m.updating||x()}return f={getAllBufferRanges:T,getBuffer:function(){return m},append:function(e){e?(_.push(e),g||C(w.bind(this))):b({chunk:e,error:new r.default(u.default.APPEND_ERROR_CODE,u.default.APPEND_ERROR_MESSAGE)})},remove:function(t,n,i){var a=this;C((function(){try{t>=0&&n>t&&(i||"ended"!==e.readyState)&&m.remove(t,n),C((function(){d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1})}))}catch(e){d.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1,error:new r.default(e.code,e.message)})}}))},abort:function(){try{("open"===e.readyState||m.setTextTrack&&"ended"===e.readyState)&&m.abort()}catch(e){p.error('SourceBuffer append abort failed: "'+e+'"')}_=[]},reset:function(t){if(m){if("function"==typeof m.removeEventListener&&(m.removeEventListener("updateend",S,!1),m.removeEventListener("error",M,!1),m.removeEventListener("abort",M,!1)),clearInterval(v),m.appendWindowEnd=1/0,!t){try{m.getClassName&&"TextSourceBuffer"===m.getClassName()||e.removeSourceBuffer(m)}catch(e){p.error("Failed to remove source buffer from media source.")}m=null}g=!1}_=[],b=null},updateTimestampOffset:function(e){m.timestampOffset===e||isNaN(e)||C((function(){m.timestampOffset=e}))},hasDiscontinuitiesAfter:function(e){try{var t=T();if(t&&t.length>1)for(var n=0,i=t.length;n<i;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+.1)return!0}catch(e){p.error("hasDiscontinuities exception: "+e.message)}return!1},waitForUpdateEnd:C},function(){p=(0,i.default)(h).getInstance().getLogger(f),g=!1;var n=t.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");(m=c||e.addSourceBuffer(n)).changeType&&c&&(p.debug("Doing period transition with changeType"),m.changeType(n)),E&&m&&(m.appendWindowEnd=e.duration);if("function"==typeof m.addEventListener)try{m.addEventListener("updateend",S,!1),m.addEventListener("error",M,!1),m.addEventListener("abort",M,!1)}catch(e){v=setInterval(A,50)}else v=setInterval(A,50)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;var r=(0,l.default)(h).getInstance();m=r.getTextSourceBuffer()}}(),f}h.__dashjs_factory_name="SourceBufferSink";var d=s.default.getClassFactory(h);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i},o=n(20);function s(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],i=this.customTimeRangeArray[t];return n.start<=i.start&&i.start<=n.end&&n.end<=i.end?(n.end=i.end,this.customTimeRangeArray.splice(t,1),!0):i.start<=n.start&&n.start<=i.end&&i.end<=n.end?(n.start=i.start,this.customTimeRangeArray.splice(t,1),!0):i.start<=n.start&&n.start<=i.end&&n.end<=i.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=i.start&&i.start<=n.end&&i.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}s.__dashjs_factory_name="CustomTimeRanges",t.default=a.default.getClassFactory(s)},function(e,t,n){t.generateISD=n(134).generateISD,t.fromXML=n(135).fromXML,t.renderHTML=n(151).render},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(t,i){var r=n(41);e.exports=_;var a,o=n(84);_.ReadableState=y;n(54).EventEmitter;var s=function(e,t){return e.listeners(t).length},l=n(86),u=n(42).Buffer,c=t.Uint8Array||function(){};var h=Object.create(n(31));h.inherits=n(24);var d=n(140),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=n(141),g=n(87);h.inherits(_,l);var v=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var i=t instanceof(a=a||n(22));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(57).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function _(e){if(a=a||n(22),!(this instanceof _))return new _(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function b(e,t,n,i,r){var a,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,w(e)}(e,o)):(r||(a=function(e,t){var n;i=t,u.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var i;return n}(o,t)),a?e.emit("error",a):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),i?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):E(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?E(e,o,t,!1):A(e,o)):E(e,o,t,!1))):i||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function E(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&w(e)),A(e,t)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=g.destroy,_.prototype._undestroy=g.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=u.from(e,t),t=""),n=!0),b(this,e,t,!1,n)},_.prototype.unshift=function(e){return b(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return p||(p=n(57).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(x,e):x(e))}function x(e){f("emit readable"),e.emit("readable"),R(e)}function A(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(S,e,t))}function S(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function M(e){f("readable nexttick read 0"),e.read(0)}function C(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,i=1,r=n.data;e-=r.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?r+=a:r+=a.slice(0,e),0===(e-=o)){o===a.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++i}return t.length-=i,r}(e,t):function(e,t){var n=u.allocUnsafe(e),i=t.head,r=1;i.data.copy(n),e-=i.data.length;for(;i=i.next;){var a=i.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(o));break}++r}return t.length-=r,n}(e,t);return i}(e,t.buffer,t.decoder),n);var n}function P(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(L,t,e))}function L(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function D(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?P(this):w(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&P(this),null;var i,r=t.needReadable;return f("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",r=!0),t.ended||t.reading?f("reading or ended",r=!1):r&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(i=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&P(this)),null!==i&&this.emit("data",i),i},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var l=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?c:_;function u(t,i){f("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",v),e.removeListener("finish",y),e.removeListener("drain",h),e.removeListener("error",g),e.removeListener("unpipe",u),n.removeListener("end",c),n.removeListener("end",_),n.removeListener("data",m),d=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function c(){f("onend"),e.end()}a.endEmitted?r.nextTick(l):n.once("end",l),e.on("unpipe",u);var h=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,R(e))}}(n);e.on("drain",h);var d=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==D(a.pipes,e))&&!d&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){f("onerror",t),_(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",y),_()}function y(){f("onfinish"),e.removeListener("close",v),_()}function _(){f("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",v),e.once("finish",y),e.emit("pipe",n),a.flowing||(f("pipe resume"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<r;a++)i[a].emit("unpipe",this,n);return this}var o=D(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},_.prototype.on=function(e,t){var n=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):r.nextTick(M,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(C,e,t))}(this,e)),this},_.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var r in e.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(f("wrapped data"),n.decoder&&(r=n.decoder.write(r)),n.objectMode&&null==r)||(n.objectMode||r&&r.length)&&(t.push(r)||(i=!0,e.pause()))})),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){f("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=I}).call(this,n(17),n(40))},function(e,t,n){e.exports=n(54).EventEmitter},function(e,t,n){"use strict";var i=n(41);function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(r,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";e.exports=o;var i=n(22),r=Object.create(n(31));function a(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){l(e,t,n)})):l(this,null,null)}function l(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=n(24),r.inherits(o,i),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,i=!!t&&t.publicOnly;for(var r in e)!e.hasOwnProperty(r)||this[r]&&!n||i&&-1===e[r].indexOf("public_")||(this[r]=e[r])}}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=_(n(91)),r=_(n(7)),a=_(n(16)),o=_(n(92)),s=_(n(29)),l=_(n(8)),u=_(n(10)),c=_(n(2)),h=_(n(162)),d=_(n(19)),f=_(n(163)),p=_(n(164)),m=_(n(165)),g=_(n(9)),v=n(14),y=n(20);function _(e){return e&&e.__esModule?e:{default:e}}function b(){var e=this.context,t=(0,g.default)(e).getInstance(),n=(0,l.default)(e).getInstance(),c=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0,I=void 0,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0;function G(){(b=(0,i.default)(e).create({dashMetrics:U,mediaPlayerModel:L,settings:j})).initialize()}function z(){T={},w={},A={},x={},N={},B={},void 0===M&&(M=!1),O=void 0,k=void 0,F=void 0,clearTimeout(S),S=null}function H(e){e.mediaType===r.default.VIDEO&&(O=e.oldQuality,k.push(O,P.getPlaybackQuality()))}function V(e){e.metric!==a.default.HTTP_REQUEST||!e.value||e.value.type!==v.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==r.default.AUDIO&&e.mediaType!==r.default.VIDEO||F.push(e.mediaType,e.value,j.get().streaming.abr.useDeadTimeLatency),e.metric!==a.default.BUFFER_LEVEL||e.mediaType!==r.default.AUDIO&&e.mediaType!==r.default.VIDEO||function(e,t){var n=j.get().streaming.abr.ABRStrategy;if(n===r.default.ABR_STRATEGY_BOLA)return void(B[e]=!0);if(n===r.default.ABR_STRATEGY_THROUGHPUT)return void(B[e]=!1);var i=L.getStableBufferTime(),a=i,o=.5*i,s=B[e],l=t>(s?o:a);B[e]=l,l!==s&&(l?_.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):_.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e.mediaType,.001*e.value.level)}function W(e,t){return T[t]=T[t]||{},T[t].hasOwnProperty(e)||(T[t][e]=0),function(e,t){if(t!==r.default.VIDEO||!j.get().streaming.abr.limitBitrateByPortal||!x[t])return e;M||te();var n=I.getAdaptationForType(0,t).Representation,i=e;if(C>0&&R>0){for(;i>0&&n[i]&&C<n[i].width&&C-n[i-1].width<n[i].width-C;)i-=1;for(;i<n.length-1&&n[i].width===n[i+1].width;)i+=1}return i}(function(e,t,n){var i=j.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(i)||i>=1||i<0)return e;return Math.min(e,Math.round(n*i))}(function(e,t){var n=e;if(!x[t])return n;var i=Y(t);void 0!==i&&(n=Math.max(e,i));var r=q(t);void 0!==r&&(n=Math.min(n,r));return n}(T[t][e],e),e,T[t][e]),e)}function q(e){var t=function(e){return j.get().streaming.abr.maxBitrate[e]}(e);return t>-1?Z(x[e].getMediaInfo(),t):void 0}function Y(e){var t=function(e){return j.get().streaming.abr.minBitrate[e]}(e);if(t>-1){var n=x[e].getMediaInfo(),i=J(n),r=Z(n,t);return i[r]&&r<i.length-1&&i[r].bitrate<1e3*t&&r++,r}}function X(e,t,n,i){var r=t.id,a=ee(e);(0,y.checkInteger)(n);var o=W(e,r);n!==a&&n>=0&&n<=o&&K(e,a,n,o,i)}function K(e,t,i,r,a){if(e&&x[e]){var o=x[e].getStreamInfo(),s=o?o.id:null;if(j.get().debug.logLevel===g.default.LOG_LEVEL_DEBUG){var l=U.getCurrentBufferLevel(e);_.info("["+e+"] switch from "+t+" to "+i+"/"+r+" (buffer: "+l+") "+(a?JSON.stringify(a):"."))}!function(e,t,n){w[t]=w[t]||{},w[t][e]=n}(e,s,i),n.trigger(u.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:o,oldQuality:t,newQuality:i,reason:a});var c=F.getAverageThroughput(e);isNaN(c)||D.setSavedBitrateSettings(e,c)}}function Q(e,t){A[e].state=t}function Z(e,t,n){var i=e&&e.type?x[e.type].getRepresentationInfo():null;if(j.get().streaming.abr.useDeadTimeLatency&&n&&i&&i.fragmentDuration){n/=1e3;var r=i.fragmentDuration;if(n>r)return 0;t*=1-n/r}for(var a=J(e),o=a.length-1;o>=0;o--){if(1e3*t>=a[o].bitrate)return o}return 0}function J(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,i=e.type,r=void 0,a=0,s=n.length;a<s;a++)(r=new o.default).mediaType=i,r.qualityIndex=a,r.bitrate=n[a].bandwidth,r.width=n[a].width,r.height=n[a].height,r.scanType=n[a].scanType,t.push(r);return t}function $(e){return B[e]}function ee(e){if(e&&x[e]){var t=x[e].getStreamInfo(),n=t?t.id:null;if(n)return w[n]=w[n]||{},w[n].hasOwnProperty(e)||(w[n][e]=0),w[n][e]}return 0}function te(){if(P){var e=j.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;C=P.getClientWidth()*e,R=P.getClientHeight()*e}}function ne(t){var n=t.request.mediaType;if(j.get().streaming.abr.autoSwitchBitrate[n]){var i=x[n];if(!i)return;var r=(0,h.default)(e).create({abrController:c,streamProcessor:i,currentRequest:t.request,useBufferOccupancyABR:$(n)}),o=b.shouldAbandonFragment(r);if(o.quality>d.default.NO_CHANGE){var l=i.getFragmentModel();l.getRequests({state:s.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(l.abortRequests(),Q(n,a.default.ABANDON_LOAD),N[n].reset(),N[n].push({oldValue:ee(n),newValue:o.quality,confidence:1,reason:o.reason}),X(n,E.getActiveStreamInfo(),o.quality,o.reason),clearTimeout(S),S=setTimeout((function(){Q(n,a.default.ALLOW_LOAD),S=null}),j.get().streaming.abandonLoadTimeout))}}}return c={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=ee(r.default.AUDIO),i=ee(r.default.VIDEO);return n===W(r.default.AUDIO,t)&&i===W(r.default.VIDEO,t)},updateTopQualityIndex:function(e){if(e){var t=e.type,n=e.streamInfo.id,i=e.representationCount-1;return function(e,t,n){T[t]=T[t]||{},T[t][e]=n}(t,n,i),i}},getThroughputHistory:function(){return F},getBitrateList:J,getQualityForBitrate:Z,getTopBitrateInfoFor:function(e){if(e&&x&&x[e]){var t=x[e].getStreamInfo();if(t&&t.id){var n=W(e,t.id),i=J(x[e].getMediaInfo());return i[n]?i[n]:null}}return null},getMaxAllowedIndexFor:q,getMinAllowedIndexFor:Y,getInitialBitrateFor:function(e){if(function(){if(!D||!D.hasOwnProperty("getSavedBitrateSettings"))throw new Error(r.default.MISSING_CONFIG_ERROR)}(),e===r.default.TEXT||e===r.default.FRAGMENTED_TEXT)return NaN;var t=D.getSavedBitrateSettings(e),n=j.get().streaming.abr.initialBitrate[e],i=j.get().streaming.abr.initialRepresentationRatio[e];if(-1===n)if(i>-1){var a=I.getAdaptationForType(0,e).Representation;if(Array.isArray(a))n=a[Math.max(Math.round(a.length*i)-1,0)].bandwidth;else n=0}else n=isNaN(t)?e===r.default.VIDEO?1e3:100:t;return n},getQualityFor:ee,getAbandonmentStateFor:function(e){return A[e]?A[e].state:null},setPlaybackQuality:X,checkPlaybackQuality:function(t){if(t&&x&&x[t]){var n=x[t].getStreamInfo(),i=n?n.id:null,r=ee(t),o=(0,h.default)(e).create({abrController:c,streamProcessor:x[t],currentValue:r,switchHistory:N[t],droppedFramesHistory:k,useBufferOccupancyABR:$(t)});if(k){var s=P.getPlaybackQuality();s&&k.push(O,s)}if(j.get().streaming.abr.autoSwitchBitrate[t]){var l=Y(t),u=W(t,i),f=b.getMaxQuality(o),p=f.quality;if(void 0!==l&&(p>d.default.NO_CHANGE?p:r)<l&&(p=l),p>u&&(p=u),N[t].push({oldValue:r,newValue:p}),p>d.default.NO_CHANGE&&p!=r)(A[t].state===a.default.ALLOW_LOAD||p>r)&&K(t,r,p,u,f.reason);else if(j.get().debug.logLevel===g.default.LOG_LEVEL_DEBUG){var m=U.getCurrentBufferLevel(t);_.debug("["+t+"] stay on "+r+"/"+u+" (buffer: "+m+")")}}}},getTopQualityIndexFor:W,setElementSize:te,setWindowResizeEventCalled:function(e){M=e},createAbrRulesCollection:G,registerStreamType:function(t,i){N[t]=N[t]||(0,f.default)(e).create(),x[t]=i,A[t]=A[t]||{},A[t].state=a.default.ALLOW_LOAD,B[t]=!1,n.on(u.default.LOADING_PROGRESS,ne,this),t==r.default.VIDEO&&(n.on(u.default.QUALITY_CHANGE_RENDERED,H,this),k=k||(0,p.default)(e).create(),te()),n.on(u.default.METRIC_ADDED,V,this),n.on(u.default.PERIOD_SWITCH_COMPLETED,G,this),F=F||(0,m.default)(e).create({settings:j})},unRegisterStreamType:function(e){delete x[e]},setConfig:function(e){e&&(e.streamController&&(E=e.streamController),e.domStorage&&(D=e.domStorage),e.mediaPlayerModel&&(L=e.mediaPlayerModel),e.dashMetrics&&(U=e.dashMetrics),e.adapter&&(I=e.adapter),e.videoModel&&(P=e.videoModel),e.settings&&(j=e.settings))},reset:function(){z(),n.off(u.default.LOADING_PROGRESS,ne,this),n.off(u.default.QUALITY_CHANGE_RENDERED,H,this),n.off(u.default.METRIC_ADDED,V,this),n.off(u.default.PERIOD_SWITCH_COMPLETED,G,this),b&&b.reset()}},_=t.getLogger(c),z(),c}b.__dashjs_factory_name="AbrController";var E=c.default.getSingletonFactory(b);E.QUALITY_DEFAULT=0,c.default.updateSingletonFactory(b.__dashjs_factory_name,E),t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(156)),r=h(n(157)),a=h(n(158)),o=h(n(159)),s=h(n(160)),l=h(n(161)),u=h(n(2)),c=h(n(19));function h(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,u=e.dashMetrics,h=e.settings,d=void 0,f=void 0;function p(e){return e.filter((function(e){return e.quality>c.default.NO_CHANGE}))}function m(e){var n,i={},r=void 0,a=void 0,o=void 0,s=void 0;if(0!==e.length){for(i[c.default.PRIORITY.STRONG]=c.default.NO_CHANGE,i[c.default.PRIORITY.WEAK]=c.default.NO_CHANGE,i[c.default.PRIORITY.DEFAULT]=c.default.NO_CHANGE,r=0,n=e.length;r<n;r+=1)(a=e[r]).quality!==c.default.NO_CHANGE&&(i[a.priority]=i[a.priority]>c.default.NO_CHANGE?Math.min(i[a.priority],a.quality):a.quality);return i[c.default.PRIORITY.WEAK]!==c.default.NO_CHANGE&&(o=i[c.default.PRIORITY.WEAK]),i[c.default.PRIORITY.DEFAULT]!==c.default.NO_CHANGE&&(o=i[c.default.PRIORITY.DEFAULT]),i[c.default.PRIORITY.STRONG]!==c.default.NO_CHANGE&&(o=i[c.default.PRIORITY.STRONG]),o!==c.default.NO_CHANGE&&(s=o),(0,c.default)(t).create(s)}}return{initialize:function(){d=[],f=[],h.get().streaming.abr.useDefaultABRRules&&(d.push((0,l.default)(t).create({dashMetrics:u,mediaPlayerModel:n,settings:h})),d.push((0,i.default)(t).create({dashMetrics:u})),d.push((0,r.default)(t).create({dashMetrics:u})),d.push((0,s.default)(t).create()),d.push((0,o.default)(t).create()),f.push((0,a.default)(t).create({dashMetrics:u,mediaPlayerModel:n,settings:h}))),n.getABRCustomRules().forEach((function(e){"qualitySwitchRules"===e.type&&d.push(e.rule(t).create()),"abandonFragmentRules"===e.type&&f.push(e.rule(t).create())}))},reset:function(){[d,f].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),d=[],f=[]},getMaxQuality:function(e){return m(p(d.map((function(t){return t.getMaxIndex(e)}))))||(0,c.default)(t).create()},shouldAbandonFragment:function(e){return m(p(f.map((function(t){return t.shouldAbandon(e)}))))||(0,c.default)(t).create()}}}d.__dashjs_factory_name="ABRRulesCollection";var f=u.default.getClassFactory(d);f.QUALITY_SWITCH_RULES="qualitySwitchRules",f.ABANDON_FRAGMENT_RULES="abandonFragmentRules",u.default.updateSingletonFactory(d.__dashjs_factory_name,f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(21)),r=n(14),a=l(n(2)),o=n(25),s=l(n(172));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=this.context,n=e.eventBus,a=e.events,l=e.debug,u=e.dashConstants,c=e.urlUtils,h=e.type,d=e.streamInfo,f=e.timelineConverter,p=e.dashMetrics,m=e.baseURLController,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0;function S(){return h}function M(){y=-1,_=null}function C(){M(),E=0,b=null,A=null,x=null}function R(e,t,n){var i=m.resolve(n.path),r=void 0,a=void 0;return i&&t!==i.url&&c.isRelative(t)?(r=i.url,a=i.serviceLocation,t&&(r=c.resolve(t,r))):r=t,!c.isRelative(r)&&(e.url=r,e.serviceLocation=a,!0)}function I(e){var t,i,r;e.sender.getType()===S()&&(t=e.representation,i=t.hasInitialization(),r=t.hasSegments(),i&&r?n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:g,representation:t}):A.update(t,S(),x,i,r))}function P(e,t){if(null==t)return null;var n=new i.default,a=t.representation,s=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,l=t.media;return l=(0,o.replaceTokenForTemplate)(l,"Number",t.replacementNumber),l=(0,o.replaceTokenForTemplate)(l,"Time",t.replacementTime),l=(0,o.replaceTokenForTemplate)(l,"Bandwidth",s),l=(0,o.replaceIDForTemplate)(l,a.id),l=(0,o.unescapeDollarsInTemplate)(l),n.mediaType=S(),n.type=r.HTTPRequest.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.duration=t.duration,n.timescale=a.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.wallStartTime=t.wallStartTime,n.quality=a.index,n.index=t.availabilityIdx,n.mediaInfo=e,n.adaptationIndex=a.adaptation.index,n.representationId=a.id,R(n,l,a)?n:void 0}function L(e){var t=!1;if(!e)return t;if(T){if(w)t=!0;else if(_){var n=parseFloat((_.presentationStartTime-e.adaptation.period.start).toFixed(5));t=(_.duration>0?n+1.5*_.duration:n)>=e.adaptation.period.duration}}else y>=e.availableSegmentsNumber&&(t=!0);return t}function D(e){var t=e.representation;t.segments&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:t})}function O(e){if(!e.error&&S()===e.mediaType){var t,i=e.segments,r=e.representation,s=[],l=0,u=void 0,c=void 0,h=void 0;for(u=0,t=i?i.length:0;u<t;u++)c=i[u],(h=(0,o.getTimeBasedSegment)(f,T,r,c.startTime,c.duration,c.timescale,c.media,c.mediaRange,l))&&(s.push(h),h=null,l++);if(s.length>0)if(r.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[s.length-1].presentationStartTime},r.availableSegmentsNumber=s.length,r.segments=s,T)!function(e){f.setExpectedLiveEdge(e),p.updateManifestUpdateInfo({presentationStartTime:e})}(s[s.length-1].presentationStartTime-8);r.hasInitialization()&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:r})}}function N(){v.debug("Dynamic stream complete"),w=!0}return g={initialize:function(e){T=e,w=!1,A.initialize(e)},getType:S,getStreamInfo:function(){return d},getInitRequest:function(e,t){return t?function(e,t,n){var a=new i.default,s=t.adaptation.period,l=s.start;if(a.mediaType=n,a.type=r.HTTPRequest.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=f.calcAvailabilityStartTimeFromPresentationTime(l,s.mpd,T),a.availabilityEndTime=f.calcAvailabilityEndTimeFromPresentationTime(l+s.duration,s.mpd,T),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,R(a,t.initialization,t))return a.url=(0,o.replaceTokenForTemplate)(a.url,"Bandwidth",t.bandwidth),a}(e,t,S()):null},getRequestForSegment:P,getSegmentRequestForTime:function(e,t,n,r){var a=null;if(!t||!t.segmentInfoType)return a;var o=y,s=!!r&&r.keepIdx,l=!(!r||!r.ignoreIsFinished);b!==n&&(b=n,v.debug("Getting the request for time : "+n));var c=A.getSegmentByTime(t,n);return c?(y=c.availabilityIdx,_=c,v.debug("Index for time "+n+" is "+y),a=P(e,c)):!l&&L(t)&&((a=new i.default).action=i.default.ACTION_COMPLETE,a.index=y-1,a.mediaType=h,a.mediaInfo=e,v.debug("Signal complete in getSegmentRequestForTime")),s&&o>=0&&(y=t.segmentInfoType===u.SEGMENT_TIMELINE&&T?y:o),a},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;b=null;var r=y+1;v.debug("Getting the next request at index: "+r);var a=A.getSegmentByIndex(t,r,_?_.mediaStartTime:-1);return a||!function(e){return!isFinite(e.adaptation.period.duration)}(t)||w?(a?(n=P(e,a),y=a.availabilityIdx):y=T?r-1:r,a?_=a:L(t)&&((n=new i.default).action=i.default.ACTION_COMPLETE,n.index=y-1,n.mediaType=S(),n.mediaInfo=e,v.debug("Signal complete")),n):(v.debug("No segment found at index: "+r+". Wait for next loop"),null)},setCurrentTime:function(e){E=e},getCurrentTime:function(){return E},setCurrentIndex:function(e){y=e},getCurrentIndex:function(){return y},isMediaFinished:L,reset:function(){C(),n.off(a.INITIALIZATION_LOADED,D,g),n.off(a.SEGMENTS_LOADED,O,g),n.off(a.REPRESENTATION_UPDATE_STARTED,I,g),n.off(a.DYNAMIC_STREAM_COMPLETED,N,g)},resetIndex:M,setMimeType:function(e){x=e}},v=l.getLogger(g),C(),A=(0,s.default)(t).create(e),n.on(a.INITIALIZATION_LOADED,D,g),n.on(a.SEGMENTS_LOADED,O,g),n.on(a.REPRESENTATION_UPDATE_STARTED,I,g),n.on(a.DYNAMIC_STREAM_COMPLETED,N,g),g}u.__dashjs_factory_name="DashHandler",t.default=a.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(181));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return r.default},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}o.__dashjs_factory_name="SchemeLoaderFactory";var s=i.default.getSingletonFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(8)),r=d(n(64)),a=d(n(2)),o=d(n(9)),s=d(n(65)),l=n(14),u=d(n(67)),c=d(n(66)),h=n(68);function d(e){return e&&e.__esModule?e:{default:e}}var f="dash.js-v"+(0,h.getVersionString)(),p=null,m=1,g=2,v=3,y=4,_="m",b="a",E="v",T="i",w="c",x="d",A="s",S="v",M="l";function C(){var e=void 0,t=void 0,n=void 0,a=void 0,h=void 0,d=void 0,C=this.context,R=(0,i.default)(C).getInstance(),I=(0,s.default)(C).getInstance();function P(){n={pr:1,nor:null,st:null,sf:null,sid:""+c.default.generateUuid(),bs:{audio:m,video:m},cid:null,did:""+f}}function L(){var e={v:1};return e.sid=I.get().streaming.cmcd.sid?I.get().streaming.cmcd.sid:n.sid,e.cid=I.get().streaming.cmcd.cid?I.get().streaming.cmcd.cid:n.cid,e.did=I.get().streaming.cmcd.did?I.get().streaming.cmcd.did:n.did,e.sid='"'+e.sid+'"',e.cid='"'+e.cid+'"',e.did='"'+e.did+'"',isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e}function D(e){try{n.pr=e.playbackRate}catch(e){}}function O(t){try{var i=e.getIsDynamic(t.data)?""+M:""+S,r=t.protocol&&"MSS"===t.protocol?""+A:""+x;n.st=""+i,n.sf=""+r}catch(e){}}function N(e){try{if(e.state&&e.mediaType){var t=null;switch(e.state){case r.default.BUFFER_LOADED:t=p;break;case r.default.BUFFER_EMPTY:d.isSeeking()&&(t=g),t=y}n.bs[e.mediaType]=t}}catch(e){}}return t={getQueryParameter:function(e){try{return I.get().streaming.cmcd&&I.get().streaming.cmcd.enabled?{key:"Common-Media-Client-Data",value:function(e){try{if(!e)return null;var t=Object.keys(e),n=t.length;return t.reduce((function(t,i,r){return t+=i+"="+e[i],r<n-1&&(t+=","),t}),"")}catch(e){return null}}(function(e){try{return e.type===l.HTTPRequest.MPD_TYPE?(function(e){try{n.cid=""+c.default.generateHashCode(e.url)}catch(e){}}(e),(t=L()).ot=""+_,t):e.type===l.HTTPRequest.MEDIA_SEGMENT_TYPE?function(e){var t=L(),i=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),r=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),o="video"===e.mediaType?""+E:"audio"===e.mediaType?""+b:"fragmentedText"===e.mediaType?""+w:null,s=function(e){try{return Math.round(a.getThroughputHistory().getSafeAverageThroughput(e))}catch(e){return null}}(e.mediaType),l=function(e){try{var t=n.pr,i=h.getCurrentBufferLevel(e);return isNaN(t)||isNaN(i)?null:parseInt(i/t*1e3)}catch(e){return null}}(e.mediaType),u=function(e){try{var t=e.mediaType;if(null!==n.bs[t])return n.bs[t];var i=h.getCurrentBufferLevel(t),r=e.duration;return i<r?v:p}catch(e){}}(e);i&&(t.br=i);o&&(t.ot=o);isNaN(r)||(t.d=r);isNaN(s)||(t.mtp=s);isNaN(l)||(t.dl=l);isNaN(u)||null===u||(t.bs=u);return t}(e):e.type===l.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=L();return e.ot=""+T,e}():null}catch(e){return null}var t}(e))}:null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(a=e.abrController),e.dashMetrics&&(h=e.dashMetrics),e.playbackController&&(d=e.playbackController))},reset:function(){R.off(r.default.PLAYBACK_RATE_CHANGED,D,this),R.off(r.default.MANIFEST_LOADED,O,this),R.off(r.default.BUFFER_LEVEL_STATE_CHANGED,N,t),P()},initialize:function(){R.on(r.default.PLAYBACK_RATE_CHANGED,D,t),R.on(r.default.MANIFEST_LOADED,O,t),R.on(r.default.BUFFER_LEVEL_STATE_CHANGED,N,t)}},(0,o.default)(C).getInstance().getLogger(t),e=(0,u.default)(C).getInstance(),P(),t}C.__dashjs_factory_name="CmcdModel",t.default=a.default.getSingletonFactory(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=i||1,this.dvb_weight=r||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};i.DEFAULT_DVB_PRIORITY=1,i.DEFAULT_DVB_WEIGHT=1,t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(188));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{areEqual:function(e,t){return(0,r.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=i.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THUMBNAILS_SCHEME_ID_URIS=void 0;var i=f(n(7)),r=f(n(13)),a=f(n(2)),o=f(n(189)),s=f(n(18)),l=n(25),u=f(n(10)),c=f(n(30)),h=f(n(63)),d=f(n(93));function f(e){return e&&e.__esModule?e:{default:e}}var p=t.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function m(e){var t,n=this.context,a=e.adapter,f=e.baseURLController,m=e.streamInfo,g=e.timelineConverter,v=e.debug,y=e.eventBus,_=e.events,b=e.dashConstants,E=(0,s.default)(n).getInstance(),T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0;function C(){I(),S=(0,h.default)(n).create({}),M=(0,c.default)(n).getInstance(),(w=(0,d.default)(n).create({timelineConverter:g,baseURLController:f,debug:v,eventBus:y,events:_,dashConstants:b,urlUtils:E})).initialize(!!a&&a.getIsDynamic()),function(){if(!m||!a)return;if(!(A=a.getMediaInfoForType(m,i.default.IMAGE)))return;var e=a.getVoRepresentations(A);e&&e.length>0&&e.forEach((function(e){(e.segmentInfoType===r.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===r.default.SEGMENT_TIMELINE)&&R(e),e.segmentInfoType===r.default.SEGMENT_BASE&&R(e,!0)}));T.length>0&&(T.sort((function(e,t){return e.bitrate-t.bitrate})),x=T.length-1)}()}function R(e,t){var n=new o.default;n.id=e.id,n.bitrate=e.bandwidth,n.width=e.width,n.height=e.height,n.tilesHor=1,n.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(p.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}})),t?y.trigger(u.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:A.mimeType,mediaType:i.default.IMAGE,representation:e,callback:function(e,t){var i=[];e=function(e,t){var n,i=[],r=0,o=void 0,s=void 0,u=void 0;for(o=0,n=e.length;o<n;o++)s=e[o],(u=(0,l.getTimeBasedSegment)(g,a.getIsDynamic(),t,s.startTime,s.duration,s.timescale,s.media,s.mediaRange,r))&&(i.push(u),u=null,r++);return i}(e,t),n.segmentDuration=e[0].duration,n.readThumbnail=function(n,r){var a=null;i.some((function(e){if(e.start<=n&&e.end>n)return a=e.url,!0})),a?r(a):e.some((function(e){if(e.mediaStartTime<=n&&e.mediaStartTime+e.duration>n){var a=f.resolve(t.path);return S.load({method:"get",url:a.url,request:{range:e.mediaRange,responseType:"arraybuffer"},onload:function(t){var n=M.getSamplesInfo(t.target.response),a=new Blob([t.target.response.slice(n.sampleList[0].offset,n.sampleList[0].offset+n.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);i.push({start:e.mediaStartTime,end:e.mediaStartTime+e.duration,url:o}),r&&r(o)}}),!0}}))}}}):(n.startNumber=e.startNumber,n.segmentDuration=e.segmentDuration,n.timescale=e.timescale,n.templateUrl=function(e){var t=E.isRelative(e.media)?E.resolve(e.media,f.resolve(e.path).url):e.media;if(!t)return"";return(0,l.replaceIDForTemplate)(t,e.id)}(e)),n.tilesHor>0&&n.tilesVert>0&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,T.push(n))}function I(){T=[],x=-1,A=null}return t={initialize:C,getTracks:function(){return T},reset:I,setTrackByIndex:function(e){T&&0!==T.length&&(e>=T.length&&(e=T.length-1),x=e)},getCurrentTrack:function(){return x<0?null:T[x]},getCurrentTrackIndex:function(){return x},getThumbnailRequestForTime:function(e){for(var t=void 0,n=a.getVoRepresentations(A),i=0;i<n.length;i++)if(T[x].id===n[i].id){t=n[i];break}return w.getSegmentRequestForTime(A,t,e)}},C(),t}m.__dashjs_factory_name="ThumbnailTracks",t.default=a.default.getClassFactory(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(8)),r=u(n(10)),a=u(n(2)),o=u(n(9)),s=u(n(15)),l=u(n(13));function u(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0,a=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){u=NaN,d=!1,h=!0,_()}function _(){null!==c&&(clearTimeout(c),c=null)}function b(e){_(),isNaN(e)&&!isNaN(u)&&(e=1e3*u),isNaN(e)||(a.debug("Refresh manifest in "+e+" milliseconds."),c=setTimeout(w,e))}function E(){d=!0;var e=p.getValue(),t=e.url,n=m.getLocation(e);n&&(t=n),f.load(t)}function T(e){if(p.getValue()&&p.getValue().type===l.default.DYNAMIC&&e.type===l.default.STATIC)t.trigger(r.default.DYNAMIC_STREAM_COMPLETED);else{p.setValue(e);var n=new Date,i=(n.getTime()-e.loadedTime.getTime())/1e3;1e3*(u=m.getManifestUpdatePeriod(e,i))>2147483647&&(u=2147483.647),t.trigger(r.default.MANIFEST_UPDATED,{manifest:e}),a.info("Manifest has been refreshed at "+n+"["+n.getTime()/1e3+"] "),h||b()}}function w(){h&&!v.get().streaming.scheduleWhilePaused||(d?b(v.get().streaming.manifestUpdateRetryInterval):E())}function x(e){e.error?e.error.code===s.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&g.error(e.error):T(e.manifest)}function A(){h=!1,b()}function S(){h=!0,_()}function M(){d=!1}return n={initialize:function(){y(),t.on(r.default.STREAMS_COMPOSED,M,this),t.on(r.default.PLAYBACK_STARTED,A,this),t.on(r.default.PLAYBACK_PAUSED,S,this),t.on(r.default.INTERNAL_MANIFEST_LOADED,x,this)},setManifest:function(e){T(e)},refreshManifest:E,setConfig:function(e){e&&(e.manifestModel&&(p=e.manifestModel),e.adapter&&(m=e.adapter),e.manifestLoader&&(f=e.manifestLoader),e.errHandler&&(g=e.errHandler),e.settings&&(v=e.settings))},reset:function(){t.off(r.default.PLAYBACK_STARTED,A,this),t.off(r.default.PLAYBACK_PAUSED,S,this),t.off(r.default.STREAMS_COMPOSED,M,this),t.off(r.default.INTERNAL_MANIFEST_LOADED,x,this),y()}},a=(0,o.default)(e).getInstance().getLogger(n),n}c.__dashjs_factory_name="ManifestUpdater",t.default=a.default.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(7));function r(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.url=e||null,r.type=n||null,r.mediaType=i.default.STREAM,r.responseType="",r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r(n(21)).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0);void 0===e.attributePrefix&&(e.attributePrefix="_");e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0);e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0);void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0);e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1);e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1);void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var t=1,n=3,i=4,r=8,a=9;function o(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function s(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function l(e,t,n,i){for(var r=0;r<e.length;r++){var a=e[r];if("string"==typeof a){if(a==i)break}else if(a instanceof RegExp){if(a.test(i))break}else if("function"==typeof a&&a(t,n,i))break}return r!=e.length}function u(t,n,i){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&l(e.arrayAccessFormPaths,t,n,i)&&(t[n]=[t[n]])}function c(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),i=t[5].split(".");if(n.setHours(t[3],t[4],i[0]),i.length>1&&n.setMilliseconds(i[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]);r=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*r:r),n.setMinutes(n.getMinutes()-r-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function h(n,i,r,a){return!(i==t&&e.xmlElementsFilter.length>0)||l(e.xmlElementsFilter,n,r,a)}function d(s,f){if(s.nodeType==a){for(var p=new Object,m=s.childNodes,g=0;g<m.length;g++){if((y=m[g]).nodeType==t)if(e.ignoreRoot)p=d(y);else(p={})[_=o(y)]=d(y)}return p}if(s.nodeType==t){(p=new Object).__cnt=0;var v=[];for(m=s.childNodes,g=0;g<m.length;g++){var y,_=o(y=m[g]);if(y.nodeType!=r){var b=f+"."+_;if(h(p,y.nodeType,_,b))if(p.__cnt++,null==p[_]){var E=d(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_]=E,u(p,_,b)}else{null!=p[_]&&(p[_]instanceof Array||(p[_]=[p[_]],u(p,_,b)));var T;E=d(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_][p[_].length]=E}}}p.__children=v;for(var w=o(s),x=0;x<s.attributes.length;x++){var A=s.attributes[x];p.__cnt++;for(var S=A.value,M=0,C=e.matchers.length;M<C;M++){var R=e.matchers[M];R.test(A,w)&&(S=R.converter(A.value))}p[e.attributePrefix+A.name]=S}var I=function(e){return e.prefix}(s);return null!=I&&""!=I&&(p.__cnt++,p.__prefix=I),null!=p["#text"]&&(p.__text=p["#text"],p.__text instanceof Array&&(p.__text=p.__text.join("\n")),e.stripWhitespaces&&(p.__text=p.__text.trim()),delete p["#text"],"property"==e.arrayAccessForm&&delete p["#text_asArray"],p.__text=function(t,n,i){if(e.datetimeAccessFormPaths.length>0){var r=i.split(".#")[0];return l(e.datetimeAccessFormPaths,t,n,r)?c(t):t}return t}(p.__text,_,f+"."+_)),null!=p["#cdata-section"]&&(p.__cdata=p["#cdata-section"],delete p["#cdata-section"],"property"==e.arrayAccessForm&&delete p["#cdata-section_asArray"]),0==p.__cnt&&"text"==e.emptyNodeForm?p="":1==p.__cnt&&null!=p.__text?p=p.__text:1!=p.__cnt||null==p.__cdata||e.keepCData?p.__cnt>1&&null!=p.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==p.__text||""==p.__text.trim())&&delete p.__text:p=p.__cdata,delete p.__cnt,!e.enableToStringFunc||null==p.__text&&null==p.__cdata||(p.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),p}if(s.nodeType==n||s.nodeType==i)return s.nodeValue}function f(t,n,i,r){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var o=0;o<i.length;o++){var l=i[o],u=t[l];e.escapeMode&&(u=s(u)),a+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+u+'"':a+="'"+u+"'"}return a+=r?"/>":">"}function p(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function m(t,n){return"property"==e.arrayAccessForm&&(i=n.toString(),r="_asArray",-1!==i.indexOf(r,i.length-r.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var i,r}function g(e){var t=0;if(e instanceof Object)for(var n in e)m(e,n)||t++;return t}function v(t,n,i){return 0==e.jsonPropertiesFilter.length||""==i||l(e.jsonPropertiesFilter,t,n,i)}function y(t){var n=[];if(t instanceof Object)for(var i in t)-1==i.toString().indexOf("__")&&0==i.toString().indexOf(e.attributePrefix)&&n.push(i);return n}function _(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=s(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=s(t):n+=t),n}function b(e,t){return""===e?t:e+"."+t}function E(e,t,n,i){var r="";if(0==e.length)r+=f(e,t,n,!0);else for(var a=0;a<e.length;a++)r+=f(e[a],t,y(e[a]),!1),r+=T(e[a],b(i,t)),r+=p(e[a],t);return r}function T(e,t){var n="";if(g(e)>0)for(var i in e)if(!m(e,i)&&(""==t||v(e,i,b(t,i)))){var r=e[i],a=y(r);if(null==r||null==r)n+=f(r,i,a,!0);else if(r instanceof Object)if(r instanceof Array)n+=E(r,i,a,t);else if(r instanceof Date)n+=f(r,i,a,!1),n+=r.toISOString(),n+=p(r,i);else{g(r)>0||null!=r.__text||null!=r.__cdata?(n+=f(r,i,a,!1),n+=T(r,b(t,i)),n+=p(r,i)):n+=f(r,i,a,!0)}else n+=f(r,i,a,!1),n+=_(r),n+=p(r,i)}return n+=_(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||window;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?c(e):e},this.xml2json=function(e){return d(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return T(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(212),o=(i=a)&&i.__esModule?i:{default:i};var s=function(){function e(t,n,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=i||[],Array.isArray(n)&&n.forEach((function(e){r._properties.push(new o.default(e))}))}return r(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(252),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":a.default},n=this.context,i=void 0,r=e.debug?e.debug.getLogger(i):{},o=e.metricsConstants;return i={create:function(e,i){var a=void 0;try{(a=t[e.schemeIdUri](n).create({metricsConstants:o})).initialize(e,i)}catch(t){a=null,r.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return a},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}o.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(256)),r=s(n(257)),a=s(n(258)),o=s(n(259));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=void 0,n=(e=e||{}).debug?e.debug.getLogger(t):{},s=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,l=this.context,u={BufferLevel:i.default,DVBErrors:r.default,HttpList:a.default,PlayList:o.default,RepSwitchList:o.default,TcpList:o.default};return t={create:function(t,i){var r,a=t.match(s);if(a){try{(r=u[a[1]](l).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(a[1],i,a[3],a[5])}catch(e){r=null,n.error("MetricsHandlerFactory: Could not create handler for type "+a[1]+" with args "+a[3]+", "+a[5]+" ("+e.message+")")}return r}},register:function(e,t){u[e]=t},unregister:function(e){delete u[e]}}}l.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(l)},function(e,t,n){"use strict";function i(){return{reconstructFullMetricName:function(e,t,n){var i=e;return t&&(i+="("+t,n&&n.length&&(i+=","+n),i+=")"),i},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},function(e,t){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,i)}e.exports=n},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function i(e,t){var i=e.prototype;if(Object.create){var r=Object.create(t.prototype);i.__proto__=r}if(!(i instanceof t)){function a(){}a.prototype=t.prototype,n(i,a=new a),e.prototype=i=a}i.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),i.constructor=e)}var r={},a=r.ELEMENT_NODE=1,o=r.ATTRIBUTE_NODE=2,s=r.TEXT_NODE=3,l=r.CDATA_SECTION_NODE=4,u=r.ENTITY_REFERENCE_NODE=5,c=r.ENTITY_NODE=6,h=r.PROCESSING_INSTRUCTION_NODE=7,d=r.COMMENT_NODE=8,f=r.DOCUMENT_NODE=9,p=r.DOCUMENT_TYPE_NODE=10,m=r.DOCUMENT_FRAGMENT_NODE=11,g=r.NOTATION_NODE=12,v={},y={},_=(v.INDEX_SIZE_ERR=(y[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(y[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(y[3]="Hierarchy request error",3)),b=(v.WRONG_DOCUMENT_ERR=(y[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(y[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(y[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(y[7]="No modification allowed",7),v.NOT_FOUND_ERR=(y[8]="Not found",8)),E=(v.NOT_SUPPORTED_ERR=(y[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(y[10]="Attribute in use",10));v.INVALID_STATE_ERR=(y[11]="Invalid state",11),v.SYNTAX_ERR=(y[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(y[13]="Invalid modification",13),v.NAMESPACE_ERR=(y[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(y[15]="Invalid access",15);function T(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,y[e]),this.message=y[e],Error.captureStackTrace&&Error.captureStackTrace(this,T);return n.code=e,t&&(this.message=this.message+": "+t),n}function w(){}function x(e,t){this._node=e,this._refresh=t,A(this)}function A(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var i=e._refresh(e._node);te(e,"length",i.length),n(i,e),e._inc=t}}function S(){}function M(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function C(e,t,n,i){if(i?t[M(t,i)]=n:t[t.length++]=n,e){n.ownerElement=e;var r=e.ownerDocument;r&&(i&&N(r,e,i),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(r,e,n))}}function R(e,t,n){var i=M(t,n);if(!(i>=0))throw T(b,new Error(e.tagName+"@"+n));for(var r=t.length-1;i<r;)t[i]=t[++i];if(t.length=r,e){var a=e.ownerDocument;a&&(N(a,e,n),n.ownerElement=null)}}function I(e){if(this._features={},e)for(var t in e)this._features=e[t]}function P(){}function L(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function D(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(D(e,t))return!0}while(e=e.nextSibling)}function O(){}function N(e,t,n,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function k(e,t,n){if(e&&e._inc){e._inc++;var i=t.childNodes;if(n)i[i.length++]=n;else{for(var r=t.firstChild,a=0;r;)i[a++]=r,r=r.nextSibling;i.length=a}}}function F(e,t){var n=t.previousSibling,i=t.nextSibling;return n?n.nextSibling=i:e.firstChild=i,i?i.previousSibling=n:e.lastChild=n,k(e.ownerDocument,e),t}function B(e,t,n){var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===m){var r=t.firstChild;if(null==r)return t;var a=t.lastChild}else r=a=t;var o=n?n.previousSibling:e.lastChild;r.previousSibling=o,a.nextSibling=n,o?o.nextSibling=r:e.firstChild=r,null==n?e.lastChild=a:n.previousSibling=a;do{r.parentNode=e}while(r!==a&&(r=r.nextSibling));return k(e.ownerDocument||e,e),t.nodeType==m&&(t.firstChild=t.lastChild=null),t}function U(){this._nsMap={}}function j(){}function G(){}function z(){}function H(){}function V(){}function W(){}function q(){}function Y(){}function X(){}function K(){}function Q(){}function Z(){}function J(e,t){var n=[],i=9==this.nodeType?this.documentElement:this,r=i.prefix,a=i.namespaceURI;if(a&&null==r&&null==(r=i.lookupPrefix(a)))var o=[{namespace:a,prefix:null}];return ee(this,n,e,t,o),n.join("")}function $(e,t,n){var i=e.prefix||"",r=e.namespaceURI;if(!i&&!r)return!1;if("xml"===i&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix==i)return o.namespace!=r}return!0}function ee(e,t,n,i,r){if(i){if(!(e=i(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case a:r||(r=[]);r.length;var c=e.attributes,g=c.length,v=e.firstChild,y=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,t.push("<",y);for(var _=0;_<g;_++){"xmlns"==(b=c.item(_)).prefix?r.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&r.push({prefix:"",namespace:b.value})}for(_=0;_<g;_++){var b;if($(b=c.item(_),0,r)){var E=b.prefix||"",T=b.namespaceURI,w=E?" xmlns:"+E:" xmlns";t.push(w,'="',T,'"'),r.push({prefix:E,namespace:T})}ee(b,t,n,i,r)}if($(e,0,r)){E=e.prefix||"",T=e.namespaceURI,w=E?" xmlns:"+E:" xmlns";t.push(w,'="',T,'"'),r.push({prefix:E,namespace:T})}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(y)){if(t.push(">"),n&&/^script$/i.test(y))for(;v;)v.data?t.push(v.data):ee(v,t,n,i,r),v=v.nextSibling;else for(;v;)ee(v,t,n,i,r),v=v.nextSibling;t.push("</",y,">")}else t.push("/>");return;case f:case m:for(v=e.firstChild;v;)ee(v,t,n,i,r),v=v.nextSibling;return;case o:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,L),'"');case s:return t.push(e.data.replace(/[<&]/g,L));case l:return t.push("<![CDATA[",e.data,"]]>");case d:return t.push("\x3c!--",e.data,"--\x3e");case p:var x=e.publicId,A=e.systemId;if(t.push("<!DOCTYPE ",e.name),x)t.push(' PUBLIC "',x),A&&"."!=A&&t.push('" "',A),t.push('">');else if(A&&"."!=A)t.push(' SYSTEM "',A,'">');else{var S=e.internalSubset;S&&t.push(" [",S,"]"),t.push(">")}return;case h:return t.push("<?",e.target," ",e.data,"?>");case u:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,n){e[t]=n}T.prototype=Error.prototype,n(v,T),w.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],i=0;i<this.length;i++)ee(this[i],n,e,t);return n.join("")}},x.prototype.item=function(e){return A(this),this[e]},i(x,w),S.prototype={length:0,item:w.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new T(E);var n=this.getNamedItem(e.nodeName);return C(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new T(E);return t=this.getNamedItemNS(e.namespaceURI,e.localName),C(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return R(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return R(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var i=this[n];if(i.localName==t&&i.namespaceURI==e)return i}return null}},I.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var i=new O;if(i.implementation=this,i.childNodes=new w,i.doctype=n,n&&i.appendChild(n),t){var r=i.createElementNS(e,t);i.appendChild(r)}return i},createDocumentType:function(e,t,n){var i=new W;return i.name=e,i.nodeName=e,i.publicId=t,i.systemId=n,i}},P.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return F(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,i){var r=new n.constructor;for(var s in n){var l=n[s];"object"!=typeof l&&l!=r[s]&&(r[s]=l)}n.childNodes&&(r.childNodes=new w);switch(r.ownerDocument=t,r.nodeType){case a:var u=n.attributes,c=r.attributes=new S,h=u.length;c._ownerElement=r;for(var d=0;d<h;d++)r.setAttributeNode(e(t,u.item(d),!0));break;case o:i=!0}if(i)for(var f=n.firstChild;f;)r.appendChild(e(t,f,i)),f=f.nextSibling;return r}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==s&&e.nodeType==s?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var i in n)if(n[i]==e)return i;t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(r,P),n(r,P.prototype),O.prototype={nodeName:"#document",nodeType:f,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==m){for(var n=e.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,t),n=i}return e}return null==this.documentElement&&e.nodeType==a&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),F(this,e)},importNode:function(e,t){return function e(t,n,i){var r;switch(n.nodeType){case a:(r=n.cloneNode(!1)).ownerDocument=t;case m:break;case o:i=!0}r||(r=n.cloneNode(!1));if(r.ownerDocument=t,r.parentNode=null,i)for(var s=n.firstChild;s;)r.appendChild(e(t,s,i)),s=s.nextSibling;return r}(this,e,t)},getElementById:function(e){var t=null;return D(this.documentElement,(function(n){if(n.nodeType==a&&n.getAttribute("id")==e)return t=n,!0})),t},createElement:function(e){var t=new U;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new w,(t.attributes=new S)._ownerElement=t,t},createDocumentFragment:function(){var e=new K;return e.ownerDocument=this,e.childNodes=new w,e},createTextNode:function(e){var t=new z;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new V;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new Q;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new j;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new X;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new U,i=t.split(":"),r=n.attributes=new S;return n.childNodes=new w,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new j,i=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=t,n}},i(O,P),U.prototype={nodeType:a,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===m?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var i=e.lastChild;n.removeChild(t);i=e.lastChild}return i=e.lastChild,t.parentNode=e,t.previousSibling=i,t.nextSibling=null,i?i.nextSibling=t:e.firstChild=t,e.lastChild=t,k(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var i=this.ownerDocument.createAttributeNS(e,t);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new x(this,(function(t){var n=[];return D(t,(function(i){i===t||i.nodeType!=a||"*"!==e&&i.tagName!=e||n.push(i)})),n}))},getElementsByTagNameNS:function(e,t){return new x(this,(function(n){var i=[];return D(n,(function(r){r===n||r.nodeType!==a||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||i.push(r)})),i}))}},O.prototype.getElementsByTagName=U.prototype.getElementsByTagName,O.prototype.getElementsByTagNameNS=U.prototype.getElementsByTagNameNS,i(U,P),j.prototype.nodeType=o,i(j,P),G.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(y[_])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},i(G,P),z.prototype={nodeName:"#text",nodeType:s,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},i(z,G),H.prototype={nodeName:"#comment",nodeType:d},i(H,G),V.prototype={nodeName:"#cdata-section",nodeType:l},i(V,G),W.prototype.nodeType=p,i(W,P),q.prototype.nodeType=g,i(q,P),Y.prototype.nodeType=c,i(Y,P),X.prototype.nodeType=u,i(X,P),K.prototype.nodeName="#document-fragment",K.prototype.nodeType=m,i(K,P),Q.prototype.nodeType=h,i(Q,P),Z.prototype.serializeToString=function(e,t,n){return J.call(e,t,n)},P.prototype.toString=J;try{if(Object.defineProperty){Object.defineProperty(x.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(P.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case a:case m:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case a:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.DOMImplementation=I,t.XMLSerializer=Z},function(e,t,n){"use strict";e.exports={parseSei:function(e){for(var t=0,n={payloadType:-1,payloadSize:0},i=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)i+=255,t++;for(i+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!n.payload&&4===i){n.payloadType=i,n.payloadSize=r,n.payload=e.subarray(t,t+r);break}t+=r,i=0,r=0}return n},parseUserData:function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var n,i,r,a,o=[];if(!(64&t[0]))return o;for(i=31&t[0],n=0;n<i;n++)a={type:3&t[(r=3*n)+2],pts:e},4&t[r+2]&&(a.ccData=t[r+3]<<8|t[r+4],o.push(a));return o},discardEmulationPreventionBytes:function(e){for(var t,n,i=e.byteLength,r=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=i-r.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===r[0]&&(o++,r.shift()),n[a]=e[o];return n},USER_DATA_REGISTERED_ITU_T_T35:4}},function(e,t,n){"use strict";var i=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var i;return!!e[t]&&(i=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(i,1),i>-1)},this.trigger=function(t){var n,i,r,a;if(n=e[t])if(2===arguments.length)for(r=n.length,i=0;i<r;++i)n[i].call(this,arguments[1]);else{for(a=[],i=arguments.length,i=1;i<arguments.length;++i)a.push(arguments[i]);for(r=n.length,i=0;i<r;++i)n[i].apply(this,a)}},this.dispose=function(){e={}}}};i.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},i.prototype.push=function(e){this.trigger("data",e)},i.prototype.flush=function(e){this.trigger("done",e)},i.prototype.partialFlush=function(e){this.trigger("partialdone",e)},i.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},i.prototype.reset=function(e){this.trigger("reset",e)},e.exports=i},function(e,t,n){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},function(e,t,n){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},i=[],r=0;r<e.length;r++){var a=e[r],l=t.base?a[0]+t.base:a[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var h=s(c),d={css:a[1],media:a[2],sourceMap:a[3]};-1!==h?(o[h].references++,o[h].updater(d)):o.push({identifier:c,updater:g(d,t),references:1}),i.push(c)}return i}function u(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,h=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,r);else{var a=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function f(e,t,n){var i=n.css,r=n.media,a=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,m=0;function g(e,t){var n,i,r;if(t.singleton){var a=m++;n=p||(p=u(t)),i=d.bind(null,n,a,!1),r=d.bind(null,n,a,!0)}else n=u(t),i=f.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=s(n[i]);o[r].references--}for(var a=l(e,t),u=0;u<n.length;u++){var c=s(n[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=a}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(o=i,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),a=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([r]).join("\n")}var o,s,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(r[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);i&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t){e.exports=function(e,t){var n,i=null;try{n=JSON.parse(e,t)}catch(e){i=e}return[i,n]}},function(e,t,n){var i=n(108),r=n(289);function a(t,n,o){return r()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&i(a,n.prototype),a},a.apply(null,arguments)}e.exports=a},function(e,t,n){var i=n(108);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},function(e,t,n){"use strict";(function(t){var i,r=(i=n(0))&&"object"==typeof i&&"default"in i?i.default:i;e.exports=function(e){for(var n=function(e){return r.atob?r.atob(e):t.from(e,"base64").toString("binary")}(e),i=new Uint8Array(n.length),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i}}).call(this,n(39).Buffer)},function(e,t,n){function i(e){this.options=e||{locator:{}}}function r(){this.cdata=!1}function a(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function l(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}i.prototype.parseFromString=function(e,t){var n=this.options,i=new u,a=n.domBuilder||new r,s=n.errorHandler,l=n.locator,c=n.xmlns||{},h={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return l&&a.setDocumentLocator(l),i.errorHandler=function(e,t,n){if(!e){if(t instanceof r)return t;e=t}var i={},a=e instanceof Function;function s(t){var r=e[t];!r&&a&&(r=2==e.length?function(n){e(t,n)}:e),i[t]=r&&function(e){r("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),i}(s,a,l),i.domBuilder=n.domBuilder||a,/\/x?html?$/.test(t)&&(h.nbsp="",h.copy="",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",e?i.parse(e,c,h):i.errorHandler.error("invalid doc source"),a.doc},r.prototype={startDocument:function(){this.doc=(new c).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,i){var r=this.doc,o=r.createElementNS(e,n||t),s=i.length;l(this,o),this.currentElement=o,this.locator&&a(this.locator,o);for(var u=0;u<s;u++){e=i.getURI(u);var c=i.getValue(u),h=(n=i.getQName(u),r.createAttributeNS(e,n));this.locator&&a(i.getLocator(u),h),h.value=h.nodeValue=c,o.setAttributeNode(h)}},endElement:function(e,t,n){var i=this.currentElement;i.tagName;this.currentElement=i.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&a(this.locator,n),l(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=s.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(e);else i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&a(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=s.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&a(this.locator,i),l(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(e,t,n);this.locator&&a(this.locator,r),l(this,r)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){r.prototype[e]=function(){return null}}));var u=n(290).XMLReader,c=t.DOMImplementation=n(109).DOMImplementation;t.XMLSerializer=n(109).XMLSerializer,t.DOMParser=i},function(e,t,n){"use strict";var i=n(110).discardEmulationPreventionBytes,r=n(291).CaptionStream,a=n(28),o=n(46),s=function(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(n<r.size)return r;n-=r.size}return null},l=function(e,t){var n=a.findBox(e,["moof","traf"]),r=a.findBox(e,["mdat"]),l={},u=[];return r.forEach((function(e,t){var i=n[t];u.push({mdat:e,traf:i})})),u.forEach((function(e){var n,r=e.mdat,u=e.traf,c=a.findBox(u,["tfhd"]),h=o.parseTfhd(c[0]),d=h.trackId,f=a.findBox(u,["tfdt"]),p=f.length>0?o.parseTfdt(f[0]).baseMediaDecodeTime:0,m=a.findBox(u,["trun"]);t===d&&m.length>0&&(n=function(e,t,n){var r,a,o,l,u=new DataView(e.buffer,e.byteOffset,e.byteLength),c=[];for(a=0;a+4<e.length;a+=o)if(o=u.getUint32(a),a+=4,!(o<=0))switch(31&e[a]){case 6:var h=e.subarray(a+1,a+1+o),d=s(a,t);r={nalUnitType:"sei_rbsp",size:o,data:h,escapedRBSP:i(h),trackId:n},d?(r.pts=d.pts,r.dts=d.dts,l=d):(r.pts=l.pts,r.dts=l.dts),c.push(r)}return c}(r,function(e,t,n){var i=t,r=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,s=n.trackId,l=[];return e.forEach((function(e){var t=o.parseTrun(e).samples;t.forEach((function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=i,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=i+e.compositionTimeOffset,i+=e.duration})),l=l.concat(t)})),l}(m,p,h),d),l[d]||(l[d]=[]),l[d]=l[d].concat(n))})),l};e.exports=function(){var e,t,n,i,a,o,s=!1;this.isInitialized=function(){return s},this.init=function(t){e=new r,s=!0,o=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/i,e.endTime=e.endPts/i,a.captions.push(e),a.captionStreams[e.stream]=!0}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length)&&(n!==e[0]||i!==t[n])},this.parse=function(e,r,o){var s;if(!this.isInitialized())return null;if(!r||!o)return null;if(this.isNewInit(r,o))n=r[0],i=o[n];else if(null===n||!i)return t.push(e),null;for(;t.length>0;){var u=t.shift();this.parse(u,r,o)}return null!==(s=function(e,t,n){return null===t?null:{seiNals:l(e,t)[t],timescale:n}}(e,n,i))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),a):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;o?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){a.captions=[],a.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,i=null,a?this.clearParsedCaptions():a={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},function(e,t,n){"use strict";var i=n(112),r=n(292).handleRollover,a={};a.ts=n(293),a.aac=n(294);var o=n(295).ONE_SECOND_IN_TS,s=function(e,t,n){for(var i,r,o,s,l=0,u=188,c=!1;u<=e.byteLength;)if(71!==e[l]||71!==e[u]&&u!==e.byteLength)l++,u++;else{switch(i=e.subarray(l,u),a.ts.parseType(i,t.pid)){case"pes":r=a.ts.parsePesType(i,t.table),o=a.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&o&&(s=a.ts.parsePesTime(i))&&(s.type="audio",n.audio.push(s),c=!0)}if(c)break;l+=188,u+=188}for(l=(u=e.byteLength)-188,c=!1;l>=0;)if(71!==e[l]||71!==e[u]&&u!==e.byteLength)l--,u--;else{switch(i=e.subarray(l,u),a.ts.parseType(i,t.pid)){case"pes":r=a.ts.parsePesType(i,t.table),o=a.ts.parsePayloadUnitStartIndicator(i),"audio"===r&&o&&(s=a.ts.parsePesTime(i))&&(s.type="audio",n.audio.push(s),c=!0)}if(c)break;l-=188,u-=188}},l=function(e,t,n){for(var i,r,o,s,l,u,c,h=0,d=188,f=!1,p={data:[],size:0};d<e.byteLength;)if(71!==e[h]||71!==e[d])h++,d++;else{switch(i=e.subarray(h,d),a.ts.parseType(i,t.pid)){case"pes":if(r=a.ts.parsePesType(i,t.table),o=a.ts.parsePayloadUnitStartIndicator(i),"video"===r&&(o&&!f&&(s=a.ts.parsePesTime(i))&&(s.type="video",n.video.push(s),f=!0),!n.firstKeyFrame)){if(o&&0!==p.size){for(l=new Uint8Array(p.size),u=0;p.data.length;)c=p.data.shift(),l.set(c,u),u+=c.byteLength;if(a.ts.videoPacketContainsKeyFrame(l)){var m=a.ts.parsePesTime(l);m?(n.firstKeyFrame=m,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}p.size=0}p.data.push(i),p.size+=i.byteLength}}if(f&&n.firstKeyFrame)break;h+=188,d+=188}for(h=(d=e.byteLength)-188,f=!1;h>=0;)if(71!==e[h]||71!==e[d])h--,d--;else{switch(i=e.subarray(h,d),a.ts.parseType(i,t.pid)){case"pes":r=a.ts.parsePesType(i,t.table),o=a.ts.parsePayloadUnitStartIndicator(i),"video"===r&&o&&(s=a.ts.parsePesTime(i))&&(s.type="video",n.video.push(s),f=!0)}if(f)break;h-=188,d-=188}},u=function(e){var t={pid:null,table:null},n={};for(var r in function(e,t){for(var n,i=0,r=188;r<e.byteLength;)if(71!==e[i]||71!==e[r])i++,r++;else{switch(n=e.subarray(i,r),a.ts.parseType(n,t.pid)){case"pat":t.pid||(t.pid=a.ts.parsePat(n));break;case"pmt":t.table||(t.table=a.ts.parsePmt(n))}if(t.pid&&t.table)return;i+=188,r+=188}}(e,t),t.table){if(t.table.hasOwnProperty(r))switch(t.table[r]){case i.H264_STREAM_TYPE:n.video=[],l(e,t,n),0===n.video.length&&delete n.video;break;case i.ADTS_STREAM_TYPE:n.audio=[],s(e,t,n),0===n.audio.length&&delete n.audio}}return n};e.exports={inspect:function(e,t){var n;return(n=a.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,i=0,r=null,s=null,l=0,u=0;e.length-u>=3;){switch(a.aac.parseType(e,u)){case"timed-metadata":if(e.length-u<10){n=!0;break}if((l=a.aac.parseId3TagSize(e,u))>e.length){n=!0;break}null===s&&(t=e.subarray(u,u+l),s=a.aac.parseAacTimestamp(t)),u+=l;break;case"audio":if(e.length-u<7){n=!0;break}if((l=a.aac.parseAdtsSize(e,u))>e.length){n=!0;break}null===r&&(t=e.subarray(u,u+l),r=a.aac.parseSampleRate(t)),i++,u+=l;break;default:u++}if(n)return null}if(null===r||null===s)return null;var c=o/r;return{audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*i*c,pts:s+1024*i*c}]}}(e):u(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;void 0===n&&(n=e.audio[0].dts),e.audio.forEach((function(e){e.dts=r(e.dts,n),e.pts=r(e.pts,n),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o}))}if(e.video&&e.video.length){var i=t;if(void 0===i&&(i=e.video[0].dts),e.video.forEach((function(e){e.dts=r(e.dts,i),e.pts=r(e.pts,i),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o})),e.firstKeyFrame){var a=e.firstKeyFrame;a.dts=r(a.dts,i),a.pts=r(a.pts,i),a.dtsTime=a.dts/o,a.ptsTime=a.dts/o}}}(n,t),n):null},parseAudioPes_:s}},function(e,t,n){var i,r,a;r=[],void 0===(a="function"==typeof(i=function(){if(THREE)return e.prototype.on=function(e,t,n){var i=function(){};this.rayList[e.id]||(this.rayList[e.id]={target:e,gazeEnter:i,gazeTrigger:i,gazeLeave:i,gazeWait:i}),this.rayList[e.id][t]=n;var r=this;this.targetList=Object.keys(this.rayList).map((function(e){return r.rayList[e].target}))},e.prototype.off=function(e,t){t?this.rayList[e.id][t]=function(){}:(delete this.rayList[e.id],this.targetList=Object.keys(this.rayList).map((function(e){return this.rayList[e].target})))},e.prototype.removeAll=function(){this.rayList={},this.targetList=[],this._lastTarget=null},e.prototype.update=function(e){if(this.targetList.length){this.raycaster.setFromCamera(this._center,e);var t=this.raycaster.intersectObjects(this.targetList);if(t.length>0){var n=t[0].object;this._lastTarget?this._lastTarget.id!==n.id&&(this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._gazeEnterTime=Date.now(),this.rayList[n.id].gazeEnter(n)):(this._gazeEnterTime=Date.now(),this.rayList[n.id].gazeEnter(n)),this.rayList[n.id].gazeTrigger(n),this._delayListener(n.id),this._lastTarget=n}else this._lastTarget&&this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._lastTarget=null}},e.prototype._delayListener=function(e){var t=this._gazeEnterTime,n=this.delayTime,i=this.rayList;t&&Date.now()-t>n&&(i[e].gazeWait(),this._gazeEnterTime=null)},e;function e(){this.raycaster=new THREE.Raycaster,this._center=new THREE.Vector2,this.rayList={},this.targetList=[],this._lastTarget=null,this.delayTime=1500}console.error("THREE is undefined,make sure you have included three.js library first.")})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.FactoryMaker=t.MediaPlayer=void 0;var i=s(n(78)),r=s(n(2)),a=s(n(9)),o=n(68);function s(e){return e&&e.__esModule?e:{default:e}}var l="undefined"!=typeof window&&window||e,u=l.dashjs;u||(u=l.dashjs={}),u.MediaPlayer=i.default,u.FactoryMaker=r.default,u.Debug=a.default,u.Version=(0,o.getVersionString)(),t.default=u,t.MediaPlayer=i.default,t.FactoryMaker=r.default,t.Debug=a.default}).call(this,n(17))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(7)),r=u(n(16)),a=u(n(8)),o=u(n(10)),s=u(n(2)),l=u(n(9));function u(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,s=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0;function I(e){if(!p||!isNaN(m)){var n=m;if(isNaN(n))if(_){n=e.liveStartTime;var i=c.getCurrentDVRInfo(),r=i?i.range:null;if(r){var a=W(y.start,!0);isNaN(a)||(s.info("Start time from URI parameters: "+a),n=Math.max(Math.min(n,a),r.start))}}else{n=y.start;var l=W(y.start,!1);!isNaN(l)&&l<n+y.duration&&(s.info("Start time from URI parameters: "+l),n=Math.max(n,l))}isNaN(n)||n===d.getTime()||(t.trigger(o.default.PLAYBACK_SEEKING,{seekTime:n}),F(n,!1,!0))}}function P(){return parseFloat((L()-B()).toFixed(5))}function L(){return y.start+y.duration}function D(){y&&d&&d.getElement()?d.play():E=!0}function O(){return y&&d?d.isPaused():null}function N(){y&&d&&d.pause()}function k(){return y&&d?d.isSeeking():null}function F(e,n,i){y&&d&&(e!==(isNaN(x)?d.getTime():x)&&(!0===i?(d.removeEventListener("seeking",te),s.info("Requesting internal seek to time: "+e),d.setCurrentTime(e,n)):(x=e,t.trigger(o.default.PLAYBACK_SEEK_ASKED),s.info("Requesting seek to time: "+e),d.setCurrentTime(e,n))))}function B(){return y&&d?d.getTime():null}function U(){var e=B();if(_&&!isNaN(w)){var t=w/1e3;e>t&&(e-=t)}return e}function j(){return y&&d?d.getPlaybackRate():null}function G(){return y&&d?d.getEnded():null}function z(){return _}function H(){if(!_||isNaN(w))return NaN;var e=U();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*f.getClientTimeOffset();return Math.max(((t-w-1e3*e)/1e3).toFixed(3),0)}function V(){E=!1,p=!1,m=NaN,v=0,w=0,x=NaN,d&&(t.off(o.default.STREAM_INITIALIZED,I,this),t.off(o.default.DATA_UPDATE_COMPLETED,K,this),t.off(o.default.BUFFER_LEVEL_STATE_CHANGED,fe,this),t.off(o.default.LOADING_PROGRESS,de,this),t.off(o.default.PLAYBACK_PROGRESS,ce,this),t.off(o.default.PLAYBACK_TIME_UPDATED,ce,this),t.off(o.default.PLAYBACK_ENDED,le,this),t.off(o.default.STREAM_INITIALIZING,me,this),Y(),d.removeEventListener("canplay",Q),d.removeEventListener("play",Z),d.removeEventListener("waiting",J),d.removeEventListener("playing",$),d.removeEventListener("pause",ee),d.removeEventListener("error",ue),d.removeEventListener("seeking",te),d.removeEventListener("seeked",ne),d.removeEventListener("timeupdate",ie),d.removeEventListener("progress",re),d.removeEventListener("ratechange",ae),d.removeEventListener("loadedmetadata",oe),d.removeEventListener("stalled",pe),d.removeEventListener("ended",se)),g=null,d=null,y=null,_=null}function W(e,t){var n=C.getURIFragmentData();if(!n||!n.t)return NaN;return n.t=n.t.split(",")[0],t&&-1!==n.t.indexOf("posix:")?parseInt(n.t.substring(6)):e+parseInt(n.t)}function q(){if(null===g){g=setInterval((function(){var e;t.trigger(o.default.WALLCLOCK_TIME_UPDATED,{isDynamic:_,time:new Date}),z()&&O()&&(e=Date.now(),(!T||e>T+500)&&(T=e,ie()))}),R.get().streaming.wallclockTimeUpdateInterval)}}function Y(){clearInterval(g),g=null}function X(){if(!O()&&_&&0!==d.getReadyState()){var e=U(),t=function(e){var t=c.getCurrentDVRInfo(),n=t?t.range:null;return n?e>n.end?Math.max(n.end-2*y.manifestInfo.minBufferTime,n.start):e>0&&e+.25<n.start&&Math.abs(e-n.start)<31536e4?n.start:e:NaN}(e);!isNaN(t)&&t!==e&&F(t)}}function K(e){if(!e.error){var t=h.convertDataToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&y.id===n.id&&(y=n,X())}}function Q(){t.trigger(o.default.CAN_PLAY)}function Z(){s.info("Native video element event: play"),X(),q(),t.trigger(o.default.PLAYBACK_STARTED,{startTime:B()})}function J(){s.info("Native video element event: waiting"),t.trigger(o.default.PLAYBACK_WAITING,{playingTime:B()})}function $(){s.info("Native video element event: playing"),t.trigger(o.default.PLAYBACK_PLAYING,{playingTime:B()})}function ee(){s.info("Native video element event: pause"),t.trigger(o.default.PLAYBACK_PAUSED,{ended:G()})}function te(){var e=B();isNaN(x)||x===e||(e=x),x=NaN,s.info("Seeking to: "+e),q(),t.trigger(o.default.PLAYBACK_SEEKING,{seekTime:e})}function ne(){s.info("Native video element event: seeked"),t.trigger(o.default.PLAYBACK_SEEKED),d.addEventListener("seeking",te)}function ie(){y&&t.trigger(o.default.PLAYBACK_TIME_UPDATED,{timeToEnd:P(),time:B()})}function re(){t.trigger(o.default.PLAYBACK_PROGRESS)}function ae(){var e=j();s.info("Native video element event: ratechange: ",e),t.trigger(o.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function oe(){s.info("Native video element event: loadedmetadata"),t.trigger(o.default.PLAYBACK_METADATA_LOADED),q()}function se(){s.info("Native video element event: ended"),N(),Y(),t.trigger(o.default.PLAYBACK_ENDED,{isLast:u.getActiveStreamInfo().isLast})}function le(e){g&&e.isLast&&(s.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),d.setCurrentTime(L()),N(),Y())}function ue(e){var n=e.target||e.srcElement;t.trigger(o.default.PLAYBACK_ERROR,{error:n.error})}function ce(){var e,t,n;_&&R.get().streaming.lowLatencyEnabled&&R.get().streaming.liveCatchUpPlaybackRate>0&&!O()&&!k()&&(e=H(),t=Math.abs(e-b.getLiveDelay()),n=b.getLiveCatchupLatencyThreshold(),R.get().streaming.lowLatencyEnabled&&R.get().streaming.liveCatchUpPlaybackRate>0&&B()>0&&t>R.get().streaming.liveCatchUpMinDrift&&(isNaN(n)||e<=n)?function(){if(d){var e=R.get().streaming.liveCatchUpPlaybackRate,t=b.getLiveDelay(),n=H()-t,i=5*n,r=2*e/(1+Math.pow(Math.E,-i)),a=1-e+r;if(S)(function(){var e=null;return u.getActiveStreamProcessors().forEach((function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)})),e})()>t/2?S=!1:n>0&&(a=1);Math.abs(d.getPlaybackRate()-a)>M&&d.setPlaybackRate(a),R.get().streaming.liveCatchUpMaxDrift>0&&!A&&n>R.get().streaming.liveCatchUpMaxDrift?(s.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),A=!0,F(((o=c.getCurrentDVRInfo())?o.range:null).end-b.getLiveDelay(),!0,!1)):A=!1}var o}():he())}function he(){d&&d.setPlaybackRate(1)}function de(e){if(!1===e.stream&&R.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;if(t>b.getLiveDelay()){s.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2));var n={streaming:{liveDelay:t}};R.update(n)}}}function fe(e){e.streamId===y.id&&(R.get().streaming.lowLatencyEnabled?e.state!==r.default.BUFFER_EMPTY||k()||S||(S=!0,he()):d.setStallState(e.mediaType,e.state===r.default.BUFFER_EMPTY))}function pe(e){t.trigger(o.default.PLAYBACK_STALLED,{e:e})}function me(e){!function(e,t){if(e&&e.manifestInfo&&e.manifestInfo.serviceDescriptions){for(var n=void 0,r=0;r<e.manifestInfo.serviceDescriptions.length;r++){var a=e.manifestInfo.serviceDescriptions[r];if(a.schemeIdUri===i.default.SERVICE_DESCRIPTION_LL_SCHEME){n=a;break}}n&&t&&t.supplementalProperties&&"true"===t.supplementalProperties[i.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(n.latency&&n.latency.target>0&&(s.debug("Apply LL properties coming from service description. Target Latency (ms):",n.latency.target),R.update({streaming:{lowLatencyEnabled:!0,liveDelay:n.latency.target/1e3,liveCatchUpMinDrift:n.latency.max>n.latency.target?(n.latency.max-n.latency.target)/1e3:void 0}})),n.playbackRate&&n.playbackRate.max>1&&(s.debug("Apply LL properties coming from service description. Max PlaybackRate:",n.playbackRate.max),R.update({streaming:{lowLatencyEnabled:!0,liveCatchUpPlaybackRate:n.playbackRate.max-1}})))}}(e.streamInfo,e.mediaInfo)}return n={initialize:function(e,n,i){y=e,d.addEventListener("canplay",Q),d.addEventListener("play",Z),d.addEventListener("waiting",J),d.addEventListener("playing",$),d.addEventListener("pause",ee),d.addEventListener("error",ue),d.addEventListener("seeking",te),d.addEventListener("seeked",ne),d.addEventListener("timeupdate",ie),d.addEventListener("progress",re),d.addEventListener("ratechange",ae),d.addEventListener("loadedmetadata",oe),d.addEventListener("stalled",pe),d.addEventListener("ended",se),_=y.manifestInfo.isDynamic,A=!1,S=!1,p=!0===n,m=i;var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",a=/safari/.test(r)&&!/chrome/.test(r);M=a?.25:.02,t.on(o.default.STREAM_INITIALIZED,I,this),t.on(o.default.DATA_UPDATE_COMPLETED,K,this),t.on(o.default.LOADING_PROGRESS,de,this),t.on(o.default.BUFFER_LEVEL_STATE_CHANGED,fe,this),t.on(o.default.PLAYBACK_PROGRESS,ce,this),t.on(o.default.PLAYBACK_TIME_UPDATED,ce,this),t.on(o.default.PLAYBACK_ENDED,le,this),t.on(o.default.STREAM_INITIALIZING,me,this),E&&(E=!1,D())},setConfig:function(e){e&&(e.streamController&&(u=e.streamController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(b=e.mediaPlayerModel),e.adapter&&(h=e.adapter),e.videoModel&&(d=e.videoModel),e.timelineConverter&&(f=e.timelineConverter),e.uriFragmentModel&&(C=e.uriFragmentModel),e.settings&&(R=e.settings))},getStartTimeFromUriParameters:W,getTimeToStreamEnd:P,getTime:B,getNormalizedTime:U,getPlaybackRate:j,getPlayedRanges:function(){return y&&d?d.getPlayedRanges():null},getEnded:G,getIsDynamic:z,getStreamController:function(){return u},computeAndSetLiveDelay:function(e,t,n){var i,r=void 0,a=void 0,o=!isNaN(e)&&isFinite(e)?e:NaN,s=h.getSuggestedPresentationDelay();if(r=R.get().streaming.lowLatencyEnabled?0:b.getLiveDelay()?b.getLiveDelay():null===R.get().streaming.liveDelayFragmentCount||isNaN(R.get().streaming.liveDelayFragmentCount)||isNaN(o)?!0===R.get().streaming.useSuggestedPresentationDelay&&null!==s&&!isNaN(s)&&s>0?s:isNaN(o)?isNaN(n)?4*y.manifestInfo.minBufferTime:4*n:4*o:o*R.get().streaming.liveDelayFragmentCount,null!==(i=h.getAvailabilityStartTime())&&(w=i),t>0){var l=Math.max(t-10,t/2);a=Math.min(r,l)}else a=r;return v=a,a},getLiveDelay:function(){return v},setLiveDelay:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&e<v||(v=e)},getCurrentLiveLatency:H,play:D,isPaused:O,pause:N,isSeeking:k,seek:F,reset:V},s=(0,l.default)(e).getInstance().getLogger(n),V(),n}c.__dashjs_factory_name="PlaybackController",t.default=s.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(36);var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INBAND_EVENTS="inbandEvents",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",e.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",e.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",e.SEEK_TARGET="seekTarget",e.DYNAMIC_STREAM_COMPLETED="dynamicStreamCompleted",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=b(n(7)),r=b(n(16)),a=b(n(127)),o=b(n(101)),s=b(n(8)),l=b(n(10)),u=b(n(2)),c=n(62),h=b(n(9)),d=b(n(59)),f=b(n(18)),p=b(n(64)),m=b(n(193)),g=b(n(194)),v=b(n(12)),y=b(n(15)),_=b(n(195));function b(e){return e&&e.__esModule?e:{default:e}}function E(){var e=this.context,t=(0,s.default)(e).getInstance(),n=void 0,u=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0,I=void 0,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,z=void 0,H=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,X=void 0,K=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,ie=void 0,re=void 0,ae=void 0;function oe(){if(Ce()){var e=q.getPlaybackQuality();e&&A.addDroppedFrames(e)}}function se(){if(!(!ae.get().streaming.jumpGaps||0===ve()||Y.isSeeking()||K||z||H||V)&&++ee>=40){var e=Y.getTime();ie===e?function(e){for(var n=ve(),i=ae.get().streaming.smallGapLimit,r=void 0,a=0;a<n.length;a++){var o=n[a].getBuffer().getAllBufferRanges(),s=void 0;if(o&&!(o.length<=1)){for(var c=0;c<o.length;c++)if(e<o.start(c)){s=o.start(c);break}if(s>0){var h=s-e;h>0&&h<=i&&(void 0===r||s>r)&&(r=s)}}}var d=Y.getTimeToStreamEnd();void 0===r&&!isNaN(d)&&d<i&&(r=e+d);r>0&&(!isNaN(d)&&r>=e+d?(u.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),t.trigger(l.default.PLAYBACK_ENDED,{isLast:De().isLast})):(u.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",r),Y.seek(r,!0,!0)))}(e):ie=e,ee=0}}function le(e){var t=ge(e.seekTime);J&&(he(),Z=!1),$&&(u.debug("[PreloadTimer] stop period preload timer."),clearTimeout($),$=void 0),t===B&&ne&&ne.deactivate(!0),t&&(t!==B||ne&&!B.isActive())?(Ie(c.PlayListTrace.END_OF_PERIOD_STOP_REASON),be(t,B,e.seekTime)):Ie(c.PlayListTrace.USER_REQUEST_STOP_REASON),Pe(c.PlayList.SEEK_START_REASON)}function ue(){u.debug("[onPlaybackStarted]"),Q?(Q=!1,Pe(c.PlayList.INITIAL_PLAYOUT_START_REASON)):K&&(K=!1,Pe(c.PlayList.RESUME_FROM_PAUSE_START_REASON),de())}function ce(e){u.debug("[onPlaybackPaused]"),e.ended||(K=!0,Ie(c.PlayListTrace.USER_REQUEST_STOP_REASON),de())}function he(){u.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(J),J=void 0}function de(){if(Z)if(J)he();else{var e=Y.getTimeToStreamEnd(),n=e>0?1e3*e:0,i=n<2e3?n/4:n-2e3;u.debug("[toggleEndPeriodTimer] Going to fire preload in",i,"milliseconds"),$=setTimeout(me,i),u.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",n,"milliseconds"),J=setTimeout((function(){t.trigger(l.default.PLAYBACK_ENDED,{isLast:De().isLast})}),n)}}function fe(e){if(e.mediaType===i.default.AUDIO||e.mediaType===i.default.VIDEO){var t=De().isLast;W&&!t&&void 0===J&&(u.info("[onTrackBufferingCompleted] end of period detected. Track",e.mediaType,"has finished"),Z=!0,!1===K&&de())}}function pe(){var e=De().isLast;W&&e&&(u.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),S.signalEndOfStream(W))}function me(){var e=De().isLast;if(W&&!e){var t=_e();B.isProtectionCompatible(t)&&(re||B.isMediaCodecCompatible(t))&&(u.info("[onStreamCanLoadNext] Preloading next stream"),B.deactivate(!0),t.preload(W,te),ne=t,t.getProcessors().forEach((function(e){e.setIndexHandlerTime(t.getStartTime())})))}}function ge(e){var t=0,n=null,i=F.length;i>0&&(t+=F[0].getStartTime());for(var r=0;r<i;r++)if(n=F[r],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function ve(){return B?B.getProcessors():[]}function ye(){var e=_e();e?be(e,B,NaN):u.debug("StreamController no next stream found"),Ie(e?c.PlayListTrace.END_OF_PERIOD_STOP_REASON:c.PlayListTrace.END_OF_CONTENT_STOP_REASON),J=void 0,Z=!1}function _e(){if(B){var e=De().start,t=De().duration;return F.filter((function(n){return n.getStreamInfo().start===parseFloat((e+t).toFixed(5))}))[0]}}function be(e,n,i){if(u.info("Switch stream to "+e.getId()+" at t="+i),!(z||!e||n===e&&e.isActive())){z=!0,t.trigger(l.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var r=!1;n&&(r=B.isProtectionCompatible(e)&&(re||B.isMediaCodecCompatible(e))&&!i||e.getPreloaded(),n.deactivate(r)),i=isNaN(i)?!r&&n?e.getStreamInfo().start:NaN:i,B=e,ne=!1,Y.initialize(De(),!!n,i),q.getElement()?Ee(i,null===n,!1,r):Te(i,r)}}function Ee(e,n,i,r){var a=void 0;function o(){W&&"open"==W.readyState&&(u.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),W.removeEventListener("sourceopen",o),W.removeEventListener("webkitsourceopen",o),we(),n||t.trigger(l.default.SOURCE_INITIALIZED),i?B.setMediaSource(W):Te(e,r))}W?r?(Te(e,r),n||t.trigger(l.default.SOURCE_INITIALIZED)):(S.detachMediaSource(q),W.addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=S.attachMediaSource(W,q),u.debug("MediaSource attached to element.  Waiting on open...")):((W=S.createMediaSource()).addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=S.attachMediaSource(W,q),u.debug("MediaSource attached to element.  Waiting on open..."))}function Te(e,n){if(te=B.activate(W,n?te:void 0)){var i=Object.keys(te);i.length>0&&te[i[0]].changeType&&(u.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),re=!0)}Q||isNaN(e)||Y.seek(e),!G&&Q||Y.play(),z=!1,t.trigger(l.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:De()})}function we(e){var t=e||De().manifestInfo.duration,n=S.setDuration(W,t);u.debug("Duration successfully set to: "+n)}function xe(e){for(var t=0,n=F.length;t<n;t++)if(F[t].getId()===e.id)return F[t];return null}function Ae(){try{var n=x.getStreamsInfo();if(0===n.length)throw new Error("There are no streams");A.updateManifestUpdateInfo({currentTime:Y.getTime(),buffered:q.getBufferRange(),presentationStartTime:n[0].start,clientTimeOffset:k.getClientTimeOffset()});for(var r=0,o=n.length;r<o;r++){var s=n[r],c=xe(s);c?c.updateData(s):(c=(0,a.default)(e).create({manifestModel:w,mediaPlayerModel:X,dashMetrics:A,manifestUpdater:E,adapter:x,timelineConverter:k,capabilities:b,errHandler:N,baseURLController:C,abrController:R,playbackController:Y,eventController:P,mediaController:I,textController:L,videoModel:q,settings:ae}),F.push(c),c.initialize(s,U)),A.addManifestUpdateStreamInfo(s)}if(!B){if(x.getIsDynamic()&&F.length){var h=n[0].manifestInfo,d=function(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var r=e[0],a=[i.default.VIDEO,i.default.AUDIO,i.default.FRAGMENTED_TEXT].reduce((function(e,t){var n=x.getMediaInfoForType(r,t);return n&&e.push(n),e}),[]).reduce((function(e,t){var n=x.getVoRepresentations(t);return n&&n.length>0&&n.forEach((function(t){t&&e.push(t)})),e}),[]).reduce((function(e,t){var n=x.convertDataToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e}),[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a))}return isFinite(n)?n:NaN}catch(e){return NaN}}(n,h);Y.computeAndSetLiveDelay(d,h.DVRWindowSize,h.minBufferTime)}var f=null,p=Y.getStartTimeFromUriParameters(n[0].start,x.getIsDynamic());isNaN(p)||(f=ge(p)),!f&&x.getIsDynamic()&&F.length&&(u.debug("Dynamic stream: Trying to find the correct starting period"),f=function(){try{var e=k.calcPresentationTimeFromWallTime(new Date,x.getRegularPeriods()[0]),t=Y.getLiveDelay();return ge(e-t)}catch(e){return null}}()),be(null!==f?f:F[0],null,NaN)}t.trigger(l.default.STREAMS_COMPOSED)}catch(e){N.error(new v.default(y.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",w.getValue())),V=!0,Fe()}}function Se(){var e=w.getValue();U&&(t.trigger(l.default.PROTECTION_CREATED,{controller:U,manifest:e}),U.setMediaElement(q.getElement()),j&&U.setProtectionData(j)),Ae()}function Me(e){if(e.error)V=!0,Fe();else{var t=e.manifest;x.updatePeriods(t);var n=x.getStreamsInfo(void 0,1)[0],r=x.getMediaInfoForType(n,i.default.VIDEO)||x.getMediaInfoForType(n,i.default.AUDIO),a=void 0;if(r&&(a=x.getUseCalculatedLiveEdgeTimeForMediaInfo(r))){u.debug("SegmentTimeline detected using calculated Live Edge Time");ae.update({streaming:{useManifestDateHeaderTimeSource:!1}})}var o=x.getUTCTimingSources(),s=!x.getIsDynamic()||a?o:o.concat(X.getUTCTimingSources()),l=O.isHTTPS(e.manifest.url);s.forEach((function(e){e.value.replace(/.*?:\/\//g,"")===X.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(l?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),l?"https://":"http://"),u.debug("Matching default timing source protocol to manifest protocol: ",e.value))})),C.initialize(t),M.setConfig({dashMetrics:A,baseURLController:C}),M.initialize(s,ae.get().streaming.useManifestDateHeaderTimeSource)}}function Ce(){return!!B&&B.getHasVideoTrack()}function Re(){return!!B&&B.getHasAudioTrack()}function Ie(e,t){t=t||new Date,ve().forEach((function(n){n.finalisePlayList(t,e)})),A.addPlayList()}function Pe(e){A.createPlaylistMetrics(1e3*Y.getTime(),e)}function Le(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}H=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),u.fatal("Video Element Error: "+t),e.error&&u.fatal(e.error),N.error(new v.default(e.error.code,t)),Fe()}}function De(){return B?B.getStreamInfo():null}function Oe(){if(!(T&&T.hasOwnProperty("load")&&k&&k.hasOwnProperty("initialize")&&k.hasOwnProperty("reset")&&k.hasOwnProperty("getClientTimeOffset")&&w&&N&&A&&Y))throw new Error(i.default.MISSING_CONFIG_ERROR)}function Ne(e){isNaN(e.newDuration)||we(e.newDuration)}function ke(){F=[],U=null,z=!1,B=null,H=!1,V=!1,Q=!0,K=!1,G=!0,J=void 0,Z=!1,ee=0}function Fe(){Oe(),M.reset(),Ie(H||V?c.PlayListTrace.FAILURE_STOP_REASON:c.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,n=F?F.length:0;e<n;e++){F[e].reset(H)}!function(){t.off(l.default.PLAYBACK_TIME_UPDATED,oe,this),t.off(l.default.PLAYBACK_SEEKING,le,this),t.off(l.default.PLAYBACK_ERROR,Le,this),t.off(l.default.PLAYBACK_STARTED,ue,this),t.off(l.default.PLAYBACK_PAUSED,ce,this),t.off(l.default.PLAYBACK_ENDED,ye,this),t.off(l.default.MANIFEST_UPDATED,Me,this),t.off(l.default.BUFFERING_COMPLETED,fe,this),t.off(l.default.STREAM_BUFFERING_COMPLETED,pe,this),t.off(l.default.MANIFEST_VALIDITY_CHANGED,Ne,this),t.off(l.default.TIME_SYNCHRONIZATION_COMPLETED,Se,this),t.off(l.default.WALLCLOCK_TIME_UPDATED,se,this),t.off(p.default.METRIC_ADDED,Be,this)}(),C.reset(),E.reset(),P.reset(),A.clearAllCurrentMetrics(),w.setValue(null),T.reset(),k.reset(),D.reset(),W&&(S.detachMediaSource(q),W=null),q=null,U&&(U.setMediaElement(null),U=null,j=null,w.getValue()&&t.trigger(l.default.PROTECTION_DESTROYED,{data:w.getValue().url})),t.trigger(l.default.STREAM_TEARDOWN_COMPLETE),ke()}function Be(e){if(e.metric===r.default.DVR_INFO){var t=Re()?i.default.AUDIO:i.default.VIDEO;e.mediaType===t&&S.setSeekable(W,e.value.range.start,e.value.range.end)}}return n={initialize:function(n,i){Oe(),G=n,j=i,k.initialize(),(E=(0,o.default)(e).create()).setConfig({manifestModel:w,adapter:x,manifestLoader:T,errHandler:N,settings:ae}),E.initialize(),(P=(0,_.default)(e).getInstance()).setConfig({manifestUpdater:E,playbackController:Y}),P.start(),function(){t.on(l.default.PLAYBACK_TIME_UPDATED,oe,this),t.on(l.default.PLAYBACK_SEEKING,le,this),t.on(l.default.PLAYBACK_ERROR,Le,this),t.on(l.default.PLAYBACK_STARTED,ue,this),t.on(l.default.PLAYBACK_PAUSED,ce,this),t.on(l.default.PLAYBACK_ENDED,ye,this),t.on(l.default.MANIFEST_UPDATED,Me,this),t.on(l.default.BUFFERING_COMPLETED,fe,this),t.on(l.default.STREAM_BUFFERING_COMPLETED,pe,this),t.on(l.default.MANIFEST_VALIDITY_CHANGED,Ne,this),t.on(l.default.TIME_SYNCHRONIZATION_COMPLETED,Se,this),t.on(l.default.WALLCLOCK_TIME_UPDATED,se,this),t.on(p.default.METRIC_ADDED,Be,this)}()},getActiveStreamInfo:De,hasVideoTrack:Ce,hasAudioTrack:Re,switchToVideoElement:function(e){B&&(Y.initialize(De()),Ee(e,!1,!0,!1))},getStreamById:function(e){return F.filter((function(t){return t.getId()===e}))[0]},getStreamForTime:ge,getTimeRelativeToStreamId:function(e,t){for(var n=null,i=0,r=0,a=null,o=0;o<F.length;o++){if(r=(n=F[o]).getStartTime(),a=n.getDuration(),Number.isFinite(r)&&(i=r),n.getId()===t)return e-i;Number.isFinite(a)&&(i+=a)}return null},load:function(e){Oe(),T.load(e)},loadWithManifest:function(e){!function(){if(!E||!E.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),E.setManifest(e)},getActiveStreamProcessors:ve,setConfig:function(e){e&&(e.capabilities&&(b=e.capabilities),e.manifestLoader&&(T=e.manifestLoader),e.manifestModel&&(w=e.manifestModel),e.mediaPlayerModel&&(X=e.mediaPlayerModel),e.protectionController&&(U=e.protectionController),e.adapter&&(x=e.adapter),e.dashMetrics&&(A=e.dashMetrics),e.errHandler&&(N=e.errHandler),e.timelineConverter&&(k=e.timelineConverter),e.videoModel&&(q=e.videoModel),e.playbackController&&(Y=e.playbackController),e.abrController&&(R=e.abrController),e.mediaController&&(I=e.mediaController),e.textController&&(L=e.textController),e.settings&&(ae=e.settings),e.baseURLController&&(C=e.baseURLController))},setProtectionData:function(e){j=e},reset:Fe},u=(0,h.default)(e).getInstance().getLogger(n),M=(0,m.default)(e).getInstance(),S=(0,g.default)(e).getInstance(),D=(0,d.default)(e).getInstance(),O=(0,f.default)(e).getInstance(),ke(),n}E.__dashjs_factory_name="StreamController",t.default=u.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(7)),r=g(n(13)),a=g(n(128)),o=g(n(178)),s=g(n(191)),l=g(n(8)),u=g(n(10)),c=g(n(9)),h=g(n(15)),d=g(n(2)),f=g(n(12)),p=g(n(30)),m=g(n(18));function g(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=(0,l.default)(t).getInstance(),d=(0,m.default)(t).getInstance(),g=e.manifestModel,v=e.mediaPlayerModel,y=e.manifestUpdater,_=e.adapter,b=e.capabilities,E=e.errHandler,T=e.timelineConverter,w=e.dashMetrics,x=e.abrController,A=e.playbackController,S=e.eventController,M=e.mediaController,C=e.textController,R=e.videoModel,I=e.settings,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,z=void 0,H=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,X=void 0,K=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function Q(e){for(var t=O?O.length:0,i=0;i<t;i++){O[i].getFragmentModel().removeExecutedRequestsBeforeTime(ee()+$()),O[i].reset(!1,e)}O=[],k=!1,F=!1,be(!1),n.off(u.default.CURRENT_TRACK_CHANGED,se,P)}function Z(){Q(),D=null,N=!1,B=!1,U=!1,j={},G=!1}function J(){A&&A.pause(),H&&(H.reset(),H=null),Z(),n.off(u.default.DATA_UPDATE_COMPLETED,pe,P),n.off(u.default.BUFFERING_COMPLETED,fe,P),n.off(u.default.INBAND_EVENTS,me,P),z&&(n.off(u.default.KEY_ERROR,ae,P),n.off(u.default.SERVER_CERTIFICATE_UPDATED,ae,P),n.off(u.default.LICENSE_REQUEST_COMPLETE,ae,P),n.off(u.default.KEY_SYSTEM_SELECTED,ae,P),n.off(u.default.KEY_SESSION_CREATED,ae,P),n.off(u.default.KEY_STATUSES_CHANGED,ae,P)),be(!1)}function $(){return D?D.duration:NaN}function ee(){return D?D.start:NaN}function te(){if(!D.manifestInfo.isDynamic)return NaN;for(var e=0;e<O.length;e++)if(O[e].getType()===i.default.AUDIO||O[e].getType()===i.default.VIDEO)return O[e].getLiveStartTime();return NaN}function ne(){return D?D.id:null}function ie(){return D}function re(){if(!(R&&x&&x.hasOwnProperty("getBitrateList")&&_&&_.hasOwnProperty("getAllMediaInfoForType")&&_.hasOwnProperty("getEventsFor")))throw new Error(i.default.MISSING_CONFIG_ERROR)}function ae(e){e.error&&(E.error(e.error),L.fatal(e.error.message),J())}function oe(e){var t,n=e?e.type:null,r=void 0;if(n===i.default.MUXED)return r="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",L.fatal(r),E.error(new f.default(h.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,r,g.getValue())),!1;if(n===i.default.TEXT||n===i.default.FRAGMENTED_TEXT||n===i.default.EMBEDDED_TEXT||n===i.default.IMAGE)return!0;if(t=e.codec,L.debug(n+" codec: "+t),e.contentProtection&&!b.supportsEncryptedMedia())E.error(new f.default(h.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,h.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!b.supportsCodec(t))return r=n+"Codec ("+t+") is not supported.",L.error(r),!1;return!0}function se(e){if(D&&e.newMediaInfo.streamInfo.id===D.id){var t=e.newMediaInfo,n=g.getValue();_.setCurrentMediaInfo(D.id,t.type,t);var r=ge(t);if(r){var a=A.getTime();L.info("Stream -  Process track changed at current time "+a),L.debug("Stream -  Update stream controller"),n.refreshManifestOnSwitchTrack?(L.debug("Stream -  Refreshing manifest for switch track"),X=e,y.refreshManifest()):(r.selectMediaInfo(t),t.type!==i.default.FRAGMENTED_TEXT?(x.updateTopQualityIndex(t),r.switchTrackAsked(),r.getFragmentModel().abortRequests()):(r.getScheduleController().setSeekTarget(a),r.setIndexHandlerTime(a),r.resetIndexHandler()))}}}function le(o,l){var c,h=_.getAllMediaInfoForType(D,o),d=null;if(h&&0!==h.length){o===i.default.VIDEO&&(B=!0),o===i.default.AUDIO&&(U=!0);for(var f=0,p=h.length;f<p;f++)if(d=h[f],o===i.default.EMBEDDED_TEXT)C.addEmbeddedTrack(d);else{if(!oe(d))continue;M.addTrack(d)}o!==i.default.EMBEDDED_TEXT&&0!==M.getTracksFor(o,D).length&&(o!==i.default.IMAGE?(M.checkInitialMediaSettingsForType(o,D),c=M.getCurrentTrackFor(o,D),n.trigger(u.default.STREAM_INITIALIZING,{streamInfo:D,mediaInfo:d}),function(n,r,o,s){var l=H.getModel(ne(),n?n.type:null),u=(0,a.default)(t).create({streamInfo:D,type:n?n.type:null,mimeType:n?n.mimeType:null,timelineConverter:T,adapter:_,manifestModel:g,mediaPlayerModel:v,fragmentModel:l,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,abrController:x,playbackController:A,mediaController:M,textController:C,errHandler:E,settings:I,boxParser:q});if(u.initialize(o,B),x.updateTopQualityIndex(n),s?(u.setBuffer(s.buffer),u.setIndexHandlerTime(s.currentTime),O[s.replaceIdx]=u):O.push(u),!s||!s.ignoreMediaInfo)if(!n||n.type!==i.default.TEXT&&n.type!==i.default.FRAGMENTED_TEXT)u.addMediaInfo(n,!0);else{for(var c=void 0,h=0;h<r.length;h++)r[h].index===n.index&&(c=h),u.addMediaInfo(r[h]);u.selectMediaInfo(r[c])}}(c,h,l)):V=(0,s.default)(t).create({streamInfo:D,adapter:_,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:Y,eventBus:n,events:u.default,dashConstants:r.default}))}else L.info("No "+o+" data.")}function ue(){if(S){var e=_.getEventsFor(D);S.addInlineEvents(e)}}function ce(e){var t=_.getAdaptationForType(D?D.index:null,e,D);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter((function(e,n){if(0===n)return!0;var i=_.getCodec(t,n,!0);return!!b.supportsCodec(i)||(L.error("[Stream] codec not supported: "+i),!1)})))}function he(){for(var e=O.length,t=!!j.audio||!!j.video?new f.default(h.default.DATA_UPDATE_FAILED_ERROR_CODE,h.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(O[r].isUpdating()||G)return;if(F){if(z)for(var a=0;a<e&&O[a];a++)O[a].getType()!==i.default.AUDIO&&O[a].getType()!==i.default.VIDEO&&O[a].getType()!==i.default.FRAGMENTED_TEXT||z.initializeForMedia(O[a].getMediaInfo());t?E.error(t):N||(N=!0,T.setTimeSyncCompleted(!0),n.trigger(u.default.STREAM_INITIALIZED,{streamInfo:D,liveStartTime:te()}));for(var o=0;o<e&&O[o];o++)O[o].getScheduleController().start()}}function de(e){for(var t={},n=0,i=O.length;n<i;n++){var r=O[n].createBuffer(e);r&&(t[O[n].getType()]=r.getBuffer())}return t}function fe(e){if(e.streamId===D.id){var t=ve(),r=t.length;if(0!==r){for(var a=0;a<r;a++)if(!t[a].isBufferingCompleted()&&(t[a].getType()===i.default.AUDIO||t[a].getType()===i.default.VIDEO))return void L.warn("onBufferingCompleted - One streamProcessor has finished but",t[a].getType(),"one is not buffering completed");L.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),n.trigger(u.default.STREAM_BUFFERING_COMPLETED,{streamInfo:D})}else L.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}}function pe(e){D&&e.sender.getStreamId()===D.id&&(j[e.sender.getType()]=e.error,he())}function me(e){var t;D&&e.sender.getStreamInfo().id===D.id&&(t=e.events,S&&S.addInbandEvents(t))}function ge(e){return e?ve().filter((function(t){return t.getType()===e.type}))[0]:null}function ve(){for(var e=[],t=void 0,n=void 0,r=0;r<O.length;r++)(t=(n=O[r]).getType())!==i.default.AUDIO&&t!==i.default.VIDEO&&t!==i.default.FRAGMENTED_TEXT&&t!==i.default.TEXT||e.push(n);return e}function ye(e,t){if(!e)return!1;var n=e.getStreamInfo(),i=ie();if(!n||!i)return!1;var r=_.getAdaptationForType(n.index,t,n),a=_.getAdaptationForType(i.index,t,i);return r&&a?!r.ContentProtection&&!a.ContentProtection:!r&&!a}function _e(e,t){if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var n=e.getStreamInfo(),i=ie();if(!n||!i)return!1;var r=_.getAdaptationForType(n.index,t,n),a=_.getAdaptationForType(i.index,t,i);if(!r||!a)return!r&&!a;var o=r&&a&&r.mimeType===a.mimeType,s=a.Representation_asArray.map((function(e){return e.codecs})),l=r.Representation_asArray.map((function(e){return e.codecs})),u=l.some((function(e){return s.indexOf(e)>-1})),c=l.some((function(e){return s.some((function(t){return function(e,t){for(var n=e.split(".")[0],i=0===t.indexOf(n),r=void 0,a=0;a<K.length;a++)if(K[a].codec===n){r=K[a];break}if(r)return i||r.compatibleCodecs.some((function(e){return 0===t.indexOf(e)}));return i}(t,e)}))}));return u||c&&o}function be(e){W=e}function Ee(){return W}return P={initialize:function(e,t){D=e,(z=t)&&(n.on(u.default.KEY_ERROR,ae,P),n.on(u.default.SERVER_CERTIFICATE_UPDATED,ae,P),n.on(u.default.LICENSE_REQUEST_COMPLETE,ae,P),n.on(u.default.KEY_SYSTEM_SELECTED,ae,P),n.on(u.default.KEY_SESSION_CREATED,ae,P),n.on(u.default.KEY_STATUSES_CHANGED,ae,P))},activate:function(e,t){if(!k){var r=void 0;return n.on(u.default.CURRENT_TRACK_CHANGED,se,P),Ee()?(!function(){if(G=!0,re(),ce(i.default.VIDEO),ce(i.default.AUDIO),F=!0,G=!1,0===O.length){var e="No streams to play.";E.error(new f.default(h.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,g.getValue())),L.debug(e)}else he()}(),r=t):r=function(e,t){re();var n=R.getElement();ue(),G=!0,ce(i.default.VIDEO),ce(i.default.AUDIO),(!n||n&&/^VIDEO$/i.test(n.nodeName))&&le(i.default.VIDEO,e);le(i.default.AUDIO,e),le(i.default.TEXT,e),le(i.default.FRAGMENTED_TEXT,e),le(i.default.EMBEDDED_TEXT,e),le(i.default.MUXED,e),le(i.default.IMAGE,e);var r=de(t);if(F=!0,G=!1,0===O.length){var a="No streams to play.";E.error(new f.default(h.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,g.getValue())),L.fatal(a)}else he();return r}(e,t),k=!0,r}return t},deactivate:Q,isActive:function(){return k},getDuration:$,getStartTime:ee,getId:ne,getStreamInfo:ie,getHasAudioTrack:function(){return U},getHasVideoTrack:function(){return B},preload:function(e,t){ue(),le(i.default.VIDEO,e),le(i.default.AUDIO,e),le(i.default.TEXT,e),le(i.default.FRAGMENTED_TEXT,e),le(i.default.EMBEDDED_TEXT,e),le(i.default.MUXED,e),le(i.default.IMAGE,e),de(t),n.on(u.default.CURRENT_TRACK_CHANGED,se,P);for(var r=0;r<O.length&&O[r];r++)O[r].getScheduleController().start();be(!0)},getThumbnailController:function(){return V},getBitrateListFor:function(e){if(re(),e===i.default.IMAGE)return V?V.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<O.length;n++)if((t=O[n]).getType()===e)return t.getMediaInfo();return null}(e);return x.getBitrateList(t)},updateData:function(e){L.info("Manifest updated... updating data system wide."),k=!1,G=!0,D=e,S&&ue(),ce(i.default.VIDEO),ce(i.default.AUDIO);for(var t=0,n=O.length;t<n;t++){var r=O[t];r.updateStreamInfo(D);var a=_.getMediaInfoForType(D,r.getType());x.updateTopQualityIndex(a),r.addMediaInfo(a,!0)}if(X&&X.newMediaInfo.type!==i.default.FRAGMENTED_TEXT){var o=ge(X.oldMediaInfo);if(!o)return;o.switchTrackAsked(),X=void 0}G=!1,he()},reset:J,getProcessors:ve,setMediaSource:function(e){for(var t=0;t<O.length;)oe(O[t].getMediaInfo())?(O[t].setMediaSource(e),t++):(O[t].reset(),O.splice(t,1));for(var n=0;n<O.length;n++)O[n].dischargePreBuffer();if(0===O.length){var i="No streams to play.";E.error(new f.default(h.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i+"nostreams",g.getValue())),L.fatal(i)}},isMediaCodecCompatible:function(e){return _e(e,i.default.VIDEO)&&_e(e,i.default.AUDIO)},isProtectionCompatible:function(e){return ye(e,i.default.VIDEO)&&ye(e,i.default.AUDIO)},getPreloaded:Ee},Y=(0,c.default)(t).getInstance(),L=Y.getLogger(P),Z(),q=(0,p.default)(t).getInstance(),H=(0,o.default)(t).create({mediaPlayerModel:v,dashMetrics:w,errHandler:E,settings:I,boxParser:q,dashConstants:r.default,urlUtils:d}),n.on(u.default.BUFFERING_COMPLETED,fe,P),n.on(u.default.DATA_UPDATE_COMPLETED,pe,P),n.on(u.default.INBAND_EVENTS,me,P),P}v.__dashjs_factory_name="Stream",t.default=d.default.getClassFactory(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=A(n(7)),r=A(n(13)),a=A(n(16)),o=A(n(29)),s=A(n(80)),l=A(n(166)),u=A(n(168)),c=A(n(170)),h=A(n(171)),d=A(n(2)),f=n(20),p=A(n(8)),m=A(n(10)),g=A(n(93)),v=A(n(15)),y=A(n(12)),_=A(n(9)),b=A(n(61)),E=A(n(18)),T=A(n(30)),w=A(n(21)),x=n(62);function A(e){return e&&e.__esModule?e:{default:e}}function S(e){e=e||{};var t=this.context,n=(0,p.default)(t).getInstance(),d=e.streamInfo,A=e.type,S=e.errHandler,M=e.mimeType,C=e.timelineConverter,R=e.adapter,I=e.manifestModel,P=e.mediaPlayerModel,L=e.fragmentModel,D=e.abrController,O=e.playbackController,N=e.mediaController,k=e.textController,F=e.dashMetrics,B=e.settings,U=e.boxParser,j=void 0,G=void 0,z=void 0,H=void 0,V=void 0,W=void 0,q=void 0,Y=void 0,X=void 0,K=void 0;function Q(){V=[],H=null}function Z(e){e.sender.getType()===ie()&&e.sender.getStreamId()===d.id&&(e.error||q.setCurrentRepresentation(R.convertDataToRepresentationInfo(e.currentRepresentation)),e.error&&e.error.code!==v.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE||ne())}function J(e){if(A===e.mediaType&&d.id===e.streamInfo.id){var t=se(e.newQuality);q.setCurrentRepresentation(t),F.pushPlayListTraceMetrics(new Date,x.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),F.createPlaylistTraceMetrics(t.id,1e3*O.getTime(),O.getPlaybackRate())}}function $(e){e.streamId===d.id&&e.mediaType===A&&(F.addBufferLevel(A,new Date,1e3*e.bufferLevel),I.getValue().doNotUpdateDVRWindowOnBufferUpdated||ne())}function ee(e){e.streamId===d.id&&e.mediaType===A&&(F.addBufferState(A,e.state,q.getBufferTarget()),e.state!==a.default.BUFFER_EMPTY||O.isSeeking()||F.pushPlayListTraceMetrics(new Date,x.PlayListTrace.REBUFFERING_REASON))}function te(e){e.streamId===d.id&&e.mediaType===A&&(e.unintended?L.removeExecutedRequestsAfterTime(e.from):L.syncExecutedRequestsWithBufferedRange(W.getBuffer().getAllBufferRanges(),d.duration))}function ne(){var e=d.manifestInfo,t=e.isDynamic,n=C.calcSegmentAvailabilityRange(Y.getCurrentRepresentation(),t);F.addDVRInfo(ie(),O.getTime(),e,n)}function ie(){return A}function re(){return W?W.getBuffer():null}function ae(){return V}function oe(){return H}function se(e){var t=void 0;return void 0!==e?((0,f.checkInteger)(e),t=Y?Y.getRepresentationForQuality(e):null):t=Y?Y.getCurrentRepresentation():null,R.convertDataToRepresentationInfo(t)}function le(e){if(e.sender&&e.mediaType===A&&e.streamId===d.id&&(!R.getIsTextTrack(M)||k.isTextEnabled())&&W&&e.representationId&&!W.appendInitSegment(e.representationId)){var t=K?K.getInitRequest(oe(),Y.getCurrentRepresentation()):null;q.processInitRequest(t)}}function ue(e){if(e.sender&&e.mediaType===A&&e.streamId===d.id){var t=void 0;W.getIsPruningInProgress()||(t=function(e,t){var n=se(),r=!isNaN(e),a=O.getNormalizedTime(),o=r?e:fe(),s=!1,l=void 0;if(isNaN(o)||ie()===i.default.FRAGMENTED_TEXT&&!k.isTextEnabled())return null;if(W){var u=W.getRangeAt(o),c=W.getRangeAt(a);if((null!==u||null!==c)&&!r)if(!u||c&&c.start!=u.start&&c.end!=u.end)W.getBuffer().hasDiscontinuitiesAfter(a)&&ie()!==i.default.FRAGMENTED_TEXT&&(L.removeExecutedRequestsAfterTime(c.end),s=!0)}if(t)o=t.startTime+t.duration/2,l=pe(n,o,{timeThreshold:0,ignoreIsFinished:!0});else for(l=pe(n,r||s?o:void 0,{keepIdx:!r&&!s});l&&l.action!==w.default.ACTION_COMPLETE&&L.isFragmentLoaded(l);)l=pe(n);return l}(e.seekTarget,e.replacement))&&(q.setSeekTarget(NaN),e.replacement||(isNaN(t.startTime+t.duration)||de(t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+q.getTimeToLoadDelay(),q.setTimeToLoadDelay(0))),q.processMediaRequest(t)}}function ce(e){var i=e.chunk;if(i.streamId===d.id&&i.mediaInfo.type==A){var r=i.bytes,a=i.quality,s=se(a),l=Y&&s?Y.getRepresentationForQuality(s.quality):null,u=R.getEventsFor(s.mediaInfo),c=R.getEventsFor(s,l);if(u&&u.length>0||c&&c.length>0){var h=function(e,n,i,r){for(var a=Math.max(!n||isNaN(n.startTime)?0:n.startTime,0),o=[],s=[],l=i.concat(r),u=0,c=l.length;u<c;u++)o[l[u].schemeIdUri+"/"+l[u].value]=l[u];for(var h=(0,T.default)(t).getInstance().parse(e).getBoxes("emsg"),d=0,f=h.length;d<f;d++){var p=R.getEvent(h[d],o,a);p&&s.push(p)}return s}(r,L.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:a,index:i.index})[0],u,c);n.trigger(m.default.INBAND_EVENTS,{sender:j,events:h})}}}function he(e){e.mediaType===A&&e.streamId===d.id&&(de(e.time),q.setSeekTarget(e.time))}function de(e){K&&K.setCurrentTime(e)}function fe(){return K?K.getCurrentTime():NaN}function pe(e,t,n){var i=null;if(K){var r=Y&&e?Y.getRepresentationForQuality(e.quality):null;i=void 0!==t&&void 0!==n?K.getSegmentRequestForTime(oe(),r,t,n):K.getNextSegmentRequest(oe(),r)}return i}return j={initialize:function(a,o){K=(0,g.default)(t).create({streamInfo:d,type:A,timelineConverter:C,dashMetrics:F,mediaPlayerModel:P,baseURLController:e.baseURLController,errHandler:S,settings:B,boxParser:U,events:m.default,eventBus:n,errors:v.default,debug:(0,_.default)(t).getInstance(),requestModifier:(0,b.default)(t).getInstance(),dashConstants:r.default,constants:i.default,urlUtils:(0,E.default)(t).getInstance()}),(z=d.manifestInfo.isDynamic)&&(X=(0,h.default)(t).create({timelineConverter:C})),K.initialize(z),D.registerStreamType(A,j),Y=(0,c.default)(t).create({streamId:d.id,type:A,abrController:D,dashMetrics:F,playbackController:O,timelineConverter:C,dashConstants:r.default,events:m.default,eventBus:n,errors:v.default}),(W=function(e){var n=null;if(!e)return S.error(new y.default(v.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,v.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null;n=e===i.default.VIDEO||e===i.default.AUDIO?(0,s.default)(t).create({streamInfo:d,type:e,mediaPlayerModel:P,manifestModel:I,fragmentModel:L,errHandler:S,mediaController:N,representationController:Y,adapter:R,textController:k,abrController:D,playbackController:O,settings:B}):(0,l.default)(t).create({streamInfo:d,type:e,mimeType:M,mediaPlayerModel:P,manifestModel:I,fragmentModel:L,errHandler:S,mediaController:N,representationController:Y,adapter:R,textController:k,abrController:D,playbackController:O,settings:B});return n}(A))&&W.initialize(a),(q=(0,u.default)(t).create({streamId:d.id,type:A,mimeType:M,adapter:R,dashMetrics:F,mediaPlayerModel:P,fragmentModel:L,abrController:D,playbackController:O,textController:k,mediaController:N,bufferController:W,settings:B})).initialize(o),!1},isUpdating:function(){return!!Y&&Y.isUpdating()},getType:ie,getBufferController:function(){return W},getFragmentModel:function(){return L},getScheduleController:function(){return q},getRepresentationController:function(){return Y},getRepresentationInfo:se,getBufferLevel:function(){return W?W.getBufferLevel():0},isBufferingCompleted:function(){return!!W&&W.getIsBufferingCompleted()},createBuffer:function(e){return re()||W?W.createBuffer(V,e):null},updateStreamInfo:function(e){d=e},getStreamInfo:function(){return d},selectMediaInfo:function(e){e===H||e&&H&&e.type!==H.type||(H=e);var t=R.getRealAdaptation(d,H),n=R.getVoRepresentations(H);if(Y){var r=Y.getData(),a=D.getTopQualityIndexFor(A,d.id),o=D.getMinAllowedIndexFor(A),s=void 0,l=null;null!==r&&r.id==t.id||A===i.default.FRAGMENTED_TEXT?s=D.getQualityFor(A):(l=D.getThroughputHistory().getAverageThroughput(A)||D.getInitialBitrateFor(A),s=D.getQualityForBitrate(H,l)),void 0!==o&&s<o&&(s=o),s>a&&(s=a),K.setMimeType(H?H.mimeType:null),Y.updateData(t,n,A,s)}},addMediaInfo:function(e,t){-1===V.indexOf(e)&&V.push(e),t&&this.selectMediaInfo(e)},getLiveStartTime:function(){if(!z)return NaN;if(!X)return NaN;var e=NaN,t=se(),n=function(e,t){try{var n=null,i=O.getLiveDelay(),r=isNaN(d.manifestInfo.DVRWindowSize)?i:d.manifestInfo.DVRWindowSize,a=.1*r,o=void 0;if(!isFinite(r)||pe(t,e-r+a,{ignoreIsFinished:!0}))for(;!n&&i<=r;)(n=pe(t,o=e-i,{ignoreIsFinished:!0}))||(i+=1);return n&&O.setLiveDelay(i,!0),G.debug("live edge: "+e+", live delay: "+i+", live target: "+o),n}catch(e){return null}}(X.getLiveEdge(t),t);return n&&(e=B.get().streaming.lowLatencyEnabled?n.duration<P.getLiveDelay()?n.startTime:n.startTime+n.duration-P.getLiveDelay():n.startTime),e},switchTrackAsked:function(){q.switchTrackAsked()},getMediaInfoArr:ae,getMediaInfo:oe,getMediaSource:function(){return W.getMediaSource()},setMediaSource:function(e){W.setMediaSource(e,ae())},dischargePreBuffer:function(){W.dischargePreBuffer()},getBuffer:re,setBuffer:function(e){W.setBuffer(e)},setIndexHandlerTime:de,getIndexHandlerTime:fe,resetIndexHandler:function(){K&&K.resetIndex()},getInitRequest:function(e){(0,f.checkInteger)(e);var t=Y?Y.getRepresentationForQuality(e):null;return K?K.getInitRequest(oe(),t):null},getFragmentRequest:pe,finalisePlayList:function(e,t){F.pushPlayListTraceMetrics(e,t)},reset:function(e,t){K&&K.reset(),W&&(W.reset(e,t),W=null),q&&(q.reset(),q=null),Y&&(Y.reset(),Y=null),X&&(X.reset(),X=null),D&&D.unRegisterStreamType(A),n.off(m.default.DATA_UPDATE_COMPLETED,Z,j),n.off(m.default.QUALITY_CHANGE_REQUESTED,J,j),n.off(m.default.INIT_FRAGMENT_NEEDED,le,j),n.off(m.default.MEDIA_FRAGMENT_NEEDED,ue,j),n.off(m.default.MEDIA_FRAGMENT_LOADED,ce,j),n.off(m.default.BUFFER_LEVEL_UPDATED,$,j),n.off(m.default.BUFFER_LEVEL_STATE_CHANGED,ee,j),n.off(m.default.BUFFER_CLEARED,te,j),n.off(m.default.SEEK_TARGET,he,j),Q(),A=null,d=null}},G=(0,_.default)(t).getInstance().getLogger(j),Q(),n.on(m.default.DATA_UPDATE_COMPLETED,Z,j,p.default.EVENT_PRIORITY_HIGH),n.on(m.default.QUALITY_CHANGE_REQUESTED,J,j),n.on(m.default.INIT_FRAGMENT_NEEDED,le,j),n.on(m.default.MEDIA_FRAGMENT_NEEDED,ue,j),n.on(m.default.MEDIA_FRAGMENT_LOADED,ce,j),n.on(m.default.BUFFER_LEVEL_UPDATED,$,j),n.on(m.default.BUFFER_LEVEL_STATE_CHANGED,ee,j),n.on(m.default.BUFFER_CLEARED,te,j),n.on(m.default.SEEK_TARGET,he,j),j}S.__dashjs_factory_name="StreamProcessor",t.default=d.default.getClassFactory(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(7)),r=n(14),a=y(n(130)),o=y(n(30)),s=y(n(82)),l=y(n(2)),u=y(n(9)),c=y(n(52)),h=y(n(152)),d=y(n(51)),f=y(n(79)),p=y(n(8)),m=y(n(10)),g=y(n(12)),v=y(n(15));function y(e){return e&&e.__esModule?e:{default:e}}function _(){var e=this.context,t=(0,p.default)(e).getInstance(),n=!1,l=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,w=void 0,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0,I=void 0,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,z=void 0;function H(){R=null,P=NaN,L=[],N=null,I=!1}function V(){H(),M=[],x=null}function W(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&K(t.bytes,t)}function q(){F=[],(C=(0,c.default)(e).getInstance()).setConfig({videoModel:D}),C.initialize(),_=(0,o.default)(e).getInstance(),k=null,B=0,j=[],U=null,n=!0,G=(0,h.default)(e).getInstance();var i=O.getActiveStreamProcessors();for(var r in i)if("video"===i[r].getType()){z=i[r].getRepresentationInfo().MSETimeOffset;break}t.on(m.default.VIDEO_CHUNK_RECEIVED,W,this),t.on(m.default.BUFFER_CLEARED,Z,this)}function Y(e){k=e}function X(e,t){var n,r,o=new a.default,s={subtitle:"subtitles",caption:"captions"};o.captionData=e,o.lang=t.lang,o.labels=t.labels,o.id=t.id?t.id:t.index,o.index=t.index,o.isTTML=(n=!1,t.codec&&t.codec.search(i.default.STPP)>=0&&(n=!0),t.mimeType&&t.mimeType.search(i.default.TTML)>=0&&(n=!0),n),o.defaultTrack=function(e){var t=!1;F.length>1&&e.isEmbedded?t=e.id&&e.id===i.default.CC1:1===F.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===F.length&&(t=e.index===M[0].index);return t}(t),o.isFragmented=!E.getIsTextTrack(t.mimeType),o.isEmbedded=!!t.isEmbedded,o.kind=r=(r=t.roles.length>0?s[t.roles[0]]:s.caption)===s.caption||r===s.subtitle?r:s.caption,o.roles=t.roles,o.accessibility=t.accessibility;var l=(M?M.length:0)+F.length;C.addTextTrack(o,l)}function K(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=t.mediaInfo,p=h.type,m=h.mimeType,E=h.codec||m;if(E){if(p===i.default.FRAGMENTED_TEXT)if(I||"InitializationSegment"!==t.segmentType){if(!I)return;if(a=(u=_.getSamplesInfo(e)).sampleList,null===N&&a.length>0&&(N=a[0].cts-t.start*P),E.search(i.default.STPP)>=0)for(x=null!==x?x:Q(E),o=0;o<a.length;o++){var w=a[o],A=w.cts,S=A-N;this.buffered.add(S/P,(S+w.duration)/P);var M=new DataView(e,w.offset,w.subSizes[0]);c=d.default.Utils.dataViewToString(M,i.default.UTF8);var L=[],O=w.offset+w.subSizes[0];for(s=1;s<w.subSizes.length;s++){var H=new Uint8Array(e,O,w.subSizes[s]),V=String.fromCharCode.apply(null,H);L.push(V),O+=w.subSizes[s]}try{var W=T.getValue().ttmlTimeIsRelative?A/P:0;n=x.parse(c,W,A/P,(A+w.duration)/P,L),C.addCaptions(k,N/P,n)}catch(e){R.removeExecutedRequestsBeforeTime(),this.remove(),y.error("TTML parser error: "+e.message)}}else{var q=[];for(o=0;o<a.length;o++){var Y=a[o];Y.cts-=N,this.buffered.add(Y.cts/P,(Y.cts+Y.duration)/P);var K=e.slice(Y.offset,Y.offset+Y.size),Z=d.default.parseBuffer(K);for(s=0;s<Z.boxes.length;s++){var J=Z.boxes[s];if(y.debug("VTT box1: "+J.type),"vtte"!==J.type&&"vttc"===J.type)for(y.debug("VTT vttc boxes.length = "+J.boxes.length),l=0;l<J.boxes.length;l++){var $=J.boxes[l];if(y.debug("VTT box2: "+$.type),"payl"===$.type){var ee=$.cue_text;y.debug("VTT cue_text = "+ee);var te=Y.cts/P,ne=(Y.cts+Y.duration)/P;q.push({start:te,end:ne,data:ee,styles:{}}),y.debug("VTT "+te+"-"+ne+" : "+ee)}}}}q.length>0&&C.addCaptions(k,0,q)}}else I=!0,P=_.getMediaTimescaleFromMoov(e);else if(p===i.default.TEXT){var ie=new DataView(e,0,e.byteLength);c=d.default.Utils.dataViewToString(ie,i.default.UTF8);try{n=Q(E).parse(c,0),C.addCaptions(C.getCurrentTrackIdx(),0,n)}catch(e){b.error(new g.default(v.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,v.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,c))}}else if(p===i.default.VIDEO)if(t.segmentType===r.HTTPRequest.INIT_SEGMENT_TYPE){if(0===B)for(B=_.getMediaTimescaleFromMoov(e),o=0;o<F.length;o++)X(null,F[o])}else{if(0===B)return void y.warn("CEA-608: No timescale for embeddedTextTrack yet");var re=function(e,t){return function(e,n,i){var r=null;r=D.getTTMLRenderingDiv()?G.createHTMLCaptionsFromScreen(D.getElement(),e,n,i):[{start:e,end:n,data:i.getDisplayText(),styles:{}}],r&&C.addCaptions(t,0,r)}},ae=(u=_.getSamplesInfo(e)).lastSequenceNumber;if(!j[0]&&!j[1]){var oe=void 0,se=void 0;for(o=0;o<F.length;o++){if(F[o].id===i.default.CC1?(0,se=C.getTrackIdxForId(i.default.CC1)):F[o].id===i.default.CC3&&(1,se=C.getTrackIdxForId(i.default.CC3)),-1===se)return void y.warn("CEA-608: data before track is ready.");oe=re(0,se),j[o]=new f.default.Cea608Parser(o+1,{newCue:oe},null)}}if(B){if(null!==U&&ae!==U+u.numSequences)for(o=0;o<j.length;o++)j[o]&&j[o].reset();for(var le=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},i=new DataView(e),r=0;r<t.length;r++)for(var a=t[r],o=f.default.findCea608Nalus(i,a.offset,a.size),s=null,l=0,u=0;u<o.length;u++)for(var c=f.default.extractCea608DataFromRange(i,o[u]),h=0;h<2;h++)c[h].length>0&&(a.cts!==s?l=0:l+=1,n.fields[h].push([a.cts+z*B,c[h],l]),s=a.cts);return n.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),n}(e,u.sampleList),ue=0;ue<j.length;ue++){var ce=le.fields[ue],he=j[ue];if(he)for(o=0;o<ce.length;o++)he.addData(ce[o][0]/B,ce[o][1])}U=ae}}}else y.error("No text type defined")}function Q(e){var t=void 0;return e.search(i.default.VTT)>=0?t=A:(e.search(i.default.TTML)>=0||e.search(i.default.STPP)>=0)&&(t=S),t}function Z(e){F.forEach((function(t){var n=C.getTrackIdxForId(t.id);n>=0&&C.deleteCuesFromTrackIdx(n,e.from,e.to)}))}return l={initialize:function(t,r,a,u){n||q(),C.setConfig({videoModel:D}),C.initialize(),_||(_=(0,o.default)(e).getInstance()),function(t,n,r,a){var o=!E.getIsTextTrack(t);if(M=M.concat(r),o){R=a,l.buffered=(0,s.default)(e).create(),L=w.getTracksFor(i.default.FRAGMENTED_TEXT,n);for(var u=w.getCurrentTrackFor(i.default.FRAGMENTED_TEXT,n),c=0;c<L.length;c++)if(L[c]===u){Y(c);break}}for(var h=0;h<M.length;h++)X(null,M[h])}(t,r,a,u)},append:K,abort:function(){C.deleteAllTextTracks(),H(),_=null,M=[]},addEmbeddedTrack:function(e){if(n||q(),e)if(e.id===i.default.CC1||e.id===i.default.CC3){for(var t=0;t<F.length;t++)if(F[t].id===e.id)return;F.push(e)}else y.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(m.default.VIDEO_CHUNK_RECEIVED,W,this),t.off(m.default.BUFFER_CLEARED,Z,this),C&&C.deleteAllTextTracks(),n=!1,F=[],j=[null,null],U=null},setConfig:function(e){e&&(e.errHandler&&(b=e.errHandler),e.adapter&&(E=e.adapter),e.manifestModel&&(T=e.manifestModel),e.mediaController&&(w=e.mediaController),e.videoModel&&(D=e.videoModel),e.streamController&&(O=e.streamController),e.textTracks&&(C=e.textTracks),e.vttParser&&(A=e.vttParser),e.ttmlParser&&(S=e.ttmlParser))},getConfig:function(){return{fragmentModel:R,fragmentedTracks:L,videoModel:D}},setCurrentFragmentedTrackIdx:Y,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){V(),O=null,D=null,C=null}},y=(0,u.default)(e).getInstance().getLogger(l),V(),l}_.__dashjs_factory_name="TextSourceBuffer",t.default=l.default.getSingletonFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(132)),r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(t){var i=[];if(!t||!e||"function"!=typeof e.fetchAll)return i;for(var r=e.fetchAll(t),a=void 0,o=0,s=r.length;o<s;o++)(a=n(r[o]))&&i.push(a);return i}function n(e){if(!e)return null;var t=new i.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}o.__dashjs_factory_name="IsoFile",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var i=0;i<t.references.length;i++){var r={reference_type:t.references[i].reference_type,referenced_size:t.references[i].referenced_size,subsegment_duration:t.references[i].subsegment_duration};this.references.push(r)}}break;case"emsg":this.id=t.id,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}}}return i(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=i}},function(e,t,n){!function(e,t,n,i){e.generateISD=function(e,t,n){var i=new o(e),r={};for(var s in e.head.layout.regions){var l=a(e,t,e.head.layout.regions[s],e.body,null,"",e.head.layout.regions[s],n,r);null!==l&&i.contents.push(l.element)}return i};var r=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function a(e,t,o,u,c,h,d,f,p){if(t<d.begin||t>=d.end)return null;var m="regionID"in d&&""!==d.regionID?d.regionID:h;if(null!==c&&m!==o.id&&(!("contents"in d)||"contents"in d&&0===d.contents.length||""!==m))return null;var g=new s(d);for(var v in d.sets)t<d.sets[v].begin||t>=d.sets[v].end||(g.styleAttrs[d.sets[v].qname]=d.sets[v].value);var y,_={};for(var b in g.styleAttrs)if(_[b]=!0,b===n.byName.writingMode.qname&&!(n.byName.direction.qname in g.styleAttrs)){var E=g.styleAttrs[b];"lrtb"===E||"lr"===E?g.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==E&&"rl"!==E||(g.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==c)for(var T in n.all){var w=n.all[T];if(w.qname===n.byName.textDecoration.qname){var x=c.styleAttrs[w.qname],A=g.styleAttrs[w.qname],S=[];void 0===A?S=x:-1===A.indexOf("none")?((-1===A.indexOf("noUnderline")&&-1!==x.indexOf("underline")||-1!==A.indexOf("underline"))&&S.push("underline"),(-1===A.indexOf("noLineThrough")&&-1!==x.indexOf("lineThrough")||-1!==A.indexOf("lineThrough"))&&S.push("lineThrough"),(-1===A.indexOf("noOverline")&&-1!==x.indexOf("overline")||-1!==A.indexOf("overline"))&&S.push("overline")):S.push("none"),g.styleAttrs[w.qname]=S}else if(w.qname!==n.byName.fontSize.qname||w.qname in g.styleAttrs||"span"!==g.kind||"textContainer"!==g.styleAttrs[n.byName.ruby.qname])if(w.qname!==n.byName.fontSize.qname||w.qname in g.styleAttrs||"span"!==g.kind||"text"!==g.styleAttrs[n.byName.ruby.qname])w.inherit&&w.qname in c.styleAttrs&&!(w.qname in g.styleAttrs)&&(g.styleAttrs[w.qname]=c.styleAttrs[w.qname]);else{var M=c.styleAttrs[n.byName.fontSize.qname];"textContainer"===c.styleAttrs[n.byName.ruby.qname]?g.styleAttrs[w.qname]=M:g.styleAttrs[w.qname]=new i.ComputedLength(.5*M.rw,.5*M.rh)}else{var C=c.styleAttrs[n.byName.fontSize.qname];g.styleAttrs[w.qname]=new i.ComputedLength(.5*C.rw,.5*C.rh)}}for(var R in n.all){var I=n.all[R];if(!(I.qname in g.styleAttrs)&&!(I.qname===n.byName.position.qname&&n.byName.origin.qname in g.styleAttrs||I.qname===n.byName.origin.qname&&n.byName.position.qname in g.styleAttrs)){var P=e.head.styling.initials[I.qname]||I.initial;("region"===g.kind||!1===I.inherit&&null!==P)&&(g.styleAttrs[I.qname]=I.parse(P),_[I.qname]=!0)}}for(var L in n.all){var D=n.all[L];if(D.qname in _&&null!==D.compute){var O=D.compute(e,c,g,g.styleAttrs[D.qname],p);null!==O?g.styleAttrs[D.qname]=O:(g.styleAttrs[D.qname]=D.compute(e,c,g,D.parse(D.initial),p),l(f,"Style '"+D.qname+"' on element '"+g.kind+"' cannot be computed"))}}if("none"===g.styleAttrs[n.byName.display.qname])return null;for(var N in null===c?y=null===u?[]:[u]:"contents"in d&&(y=d.contents),y){var k=a(e,t,o,u,g,m,y[N],f,p);null!==k&&g.contents.push(k.element)}for(var F in g.styleAttrs){var B=!1;if("span"===g.kind){var U=g.styleAttrs[n.byName.ruby.qname];(B=("container"===U||"textContainer"===U||"baseContainer"===U)&&-1!==r.indexOf(F))||(B="container"!==U&&F===n.byName.rubyAlign.qname),B||(B=!("textContainer"===U||"text"===U)&&F===n.byName.rubyPosition.qname)}if(!B)B=-1===n.byQName[F].applies.indexOf(g.kind);B&&delete g.styleAttrs[F]}if("span"===g.kind&&g.text&&"default"===g.space){var j=g.text.replace(/[\t\r\n ]+/g," ");g.text=j}if("p"===g.kind){var G=[];!function e(t,n){if("contents"in t)for(var i in t.contents)e(t.contents[i],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}(g,G);for(var z=0,H="after_br",V=0;;)if("after_br"===H)z>=G.length||"br"===G[z].kind?(H="before_br",V=z,z--):("preserve"!==G[z].space&&(G[z].text=G[z].text.replace(/^[\t\r\n ]+/g,"")),G[z].text.length>0?(H="looking_br",z++):G.splice(z,1));else if("before_br"===H)if(z<0||"br"===G[z].kind){if(H="after_br",(z=V+1)>=G.length)break}else if("preserve"!==G[z].space&&(G[z].text=G[z].text.replace(/[\t\r\n ]+$/g,"")),G[z].text.length>0){if(H="after_br",(z=V+1)>=G.length)break}else G.splice(z,1),z--;else z>=G.length||"br"===G[z].kind?(H="before_br",V=z,z--):z++;!function e(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}(g)}return"div"===g.kind&&n.byName.backgroundImage.qname in g.styleAttrs||"br"===g.kind||"image"===g.kind||"contents"in g&&g.contents.length>0||"span"===g.kind&&null!==g.text||"region"===g.kind&&"always"===g.styleAttrs[n.byName.showBackground.qname]?{region_id:m,element:g}:null}function o(e){this.contents=[],this.aspectRatio=e.aspectRatio}function s(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function l(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(37):imscNames,"undefined"==typeof imscStyles?n(53):imscStyles,"undefined"==typeof imscUtils?n(38):imscUtils)},function(e,t,n){!function(e,t,n,i,r){function a(e,t,n,i){var r=i&&"seq"===i.timeContainer,o=0;i&&(o=r&&n?n.end:i.begin),t.begin=t.explicit_begin?t.explicit_begin+o:o;var s=t.begin,l=null;for(var u in t.sets)a(e,t.sets[u],l,t),s="seq"===t.timeContainer?t.sets[u].end:Math.max(s,t.sets[u].end),l=t.sets[u];if("contents"in t)for(var c in t.contents)a(e,t.contents[c],l,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),l=t.contents[c];else s=r?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,o+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=o+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function o(e){this.node=e}function s(){this.events=[],this.head=new l,this.body=null}function l(){this.styling=new u,this.layout=new d}function u(){this.styles={},this.initials={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function h(){this.styleAttrs=null}function d(){this.regions={}}function f(e,t){p.call(this,"image"),this.src=e,this.type=t}function p(e){this.kind=e}function m(e){this.id=e}function g(e){this.regionID=e}function v(e){this.styleAttrs=e}function y(e){this.sets=e}function _(e){this.contents=e}function b(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function E(){p.call(this,"body")}function T(){p.call(this,"div")}function w(){p.call(this,"p")}function x(){p.call(this,"span")}function A(){p.call(this,"span")}function S(){p.call(this,"br")}function M(){}function C(){}function R(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function I(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function P(e,t){var n={};if(null!==e)for(var r in e.attributes){var a=e.attributes[r].uri+" "+e.attributes[r].local,o=i.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[r].value);null!==s?(n[a]=s,o===i.byName.zIndex&&F(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):B(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[r].value)}}return n}function L(e,t,n){for(var i in e.attributes)if(e.attributes[i].uri===t&&e.attributes[i].local===n)return e.attributes[i].value;return null}function D(e,t,n){var i,r=null;return null!==(i=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(r=parseFloat(i[1])/t):null!==(i=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(r=parseFloat(i[1])/e):null!==(i=/^(\d+(?:\.\d+)?)ms$/.exec(n))?r=parseFloat(i[1])/1e3:null!==(i=/^(\d+(?:\.\d+)?)s$/.exec(n))?r=parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)h$/.exec(n))?r=3600*parseFloat(i[1]):null!==(i=/^(\d+(?:\.\d+)?)m$/.exec(n))?r=60*parseFloat(i[1]):null!==(i=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?r=3600*parseInt(i[1])+60*parseInt(i[2])+parseFloat(i[3]):null!==(i=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(r=3600*parseInt(i[1])+60*parseInt(i[2])+parseInt(i[3])+(null===i[4]?0:parseInt(i[4])/t)),r}function O(e,t,n){for(;t.styleRefs.length>0;){var i=t.styleRefs.pop();i in e.styles?(O(e,e.styles[i],n),k(e.styles[i].styleAttrs,t.styleAttrs)):B(n,"Non-existant style id referenced")}}function N(e,t,n,i){for(var r=t.length-1;r>=0;r--){var a=t[r];a in e.styles?k(e.styles[a].styleAttrs,n):B(i,"Non-existant style id referenced")}}function k(e,t){for(var n in e)n in t||(t[n]=e[n])}function F(e,t){if(e&&e.warn&&e.warn(t))throw t}function B(e,t){if(e&&e.error&&e.error(t))throw t}function U(e,t){throw e&&e.fatal&&e.fatal(t),t}function j(e,t){for(var n,i=0,r=e.length-1;i<=r;){var a=e[n=Math.floor((i+r)/2)];if(a<t)i=n+1;else{if(!(a>t))return{found:!0,index:n};r=n-1}}return{found:!1,index:i}}e.fromXML=function(e,r,p){var m=t.parser(!0,{xmlns:!0}),g=[],v=[],y=[],_=0,b=null;m.onclosetag=function(e){if(g[0]instanceof u)for(var t in g[0].styles)O(g[0],g[0].styles[t],r);else if(g[0]instanceof w||g[0]instanceof x){if(g[0].contents.length>1){var i,a=[g[0].contents[0]];for(i=1;i<g[0].contents.length;i++)g[0].contents[i]instanceof A&&a[a.length-1]instanceof A?a[a.length-1].text+=g[0].contents[i].text:a.push(g[0].contents[i]);g[0].contents=a}g[0]instanceof x&&1===g[0].contents.length&&g[0].contents[0]instanceof A&&(g[0].text=g[0].contents[0].text,delete g[0].contents)}else g[0]instanceof o&&(g[0].node.uri===n.ns_tt&&"metadata"===g[0].node.local?_--:_>0&&p&&"onCloseTag"in p&&p.onCloseTag());y.shift(),v.shift(),g.shift()},m.ontext=function(e){if(void 0===g[0]);else if(g[0]instanceof x||g[0]instanceof w){if(g[0]instanceof x){var t=g[0].styleAttrs[i.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var n=new A;n.initFromText(b,g[0],e,y[0],r),g[0].contents.push(n)}else g[0]instanceof o&&_>0&&p&&"onText"in p&&p.onText(e)},m.onopentag=function(e){var t=e.attributes["xml:space"];t?y.unshift(t.value):0===y.length?y.unshift("default"):y.unshift(y[0]);var a=e.attributes["xml:lang"];if(a?v.unshift(a.value):0===v.length?v.unshift(""):v.unshift(v[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==b&&U(r,"Two <tt> elements at ("+this.line+","+this.column+")"),(b=new s).initFromNode(e,r),g.unshift(b);else if("head"===e.local)g[0]instanceof s||U(r,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),g.unshift(b.head);else if("styling"===e.local)g[0]instanceof l||U(r,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),g.unshift(b.head.styling);else if("style"===e.local){var m;g[0]instanceof u?((m=new c).initFromNode(e,r),m.id?b.head.styling.styles[m.id]=m:B(r,"<style> element missing @id attribute"),g.unshift(m)):g[0]instanceof M?((m=new c).initFromNode(e,r),k(m.styleAttrs,g[0].styleAttrs),g.unshift(m)):U(r,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var A;if(g[0]instanceof u){for(var R in(A=new h).initFromNode(e,r),A.styleAttrs)b.head.styling.initials[R]=A.styleAttrs[R];g.unshift(A)}else U(r,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)g[0]instanceof l||U(r,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),g.unshift(b.head.layout);else if("region"===e.local){g[0]instanceof d||U(r,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var I=new M;I.initFromNode(b,e,r),!I.id||I.id in b.head.layout.regions?B(r,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):b.head.layout.regions[I.id]=I,g.unshift(I)}else if("body"===e.local){g[0]instanceof s||U(r,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==b.body&&U(r,"Second <body> element at "+this.line+","+this.column+")");var P=new E;P.initFromNode(b,e,r),b.body=P,g.unshift(P)}else if("div"===e.local){g[0]instanceof T||g[0]instanceof E||U(r,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var L=new T;L.initFromNode(b,g[0],e,r);var D=L.styleAttrs[i.byName.backgroundImage.qname];D&&(L.contents.push(new f(D)),delete L.styleAttrs[i.byName.backgroundImage.qname]),g[0].contents.push(L),g.unshift(L)}else if("image"===e.local){g[0]instanceof T||U(r,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var O=new f;O.initFromNode(b,g[0],e,r),g[0].contents.push(O),g.unshift(O)}else if("p"===e.local){g[0]instanceof T||U(r,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var N=new w;N.initFromNode(b,g[0],e,r),g[0].contents.push(N),g.unshift(N)}else if("span"===e.local){g[0]instanceof x||g[0]instanceof w||U(r,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var F=new x;F.initFromNode(b,g[0],e,y[0],r),g[0].contents.push(F),g.unshift(F)}else if("br"===e.local){g[0]instanceof x||g[0]instanceof w||U(r,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var j=new S;j.initFromNode(b,g[0],e,r),g[0].contents.push(j),g.unshift(j)}else if("set"===e.local){g[0]instanceof x||g[0]instanceof w||g[0]instanceof T||g[0]instanceof E||g[0]instanceof M||g[0]instanceof S||U(r,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new C;G.initFromNode(b,g[0],e,r),g[0].sets.push(G),g.unshift(G)}else g.unshift(new o(e));else g.unshift(new o(e));if(g[0]instanceof o)if(e.uri===n.ns_tt&&"metadata"===e.local)_++;else if(_>0&&p&&"onOpenTag"in p){var z=[];for(var H in e.attributes)z[e.attributes[H].uri+" "+e.attributes[H].local]={uri:e.attributes[H].uri,local:e.attributes[H].local,value:e.attributes[H].value};p.onOpenTag(e.uri,e.local,z)}},m.write(e).close(),delete b.head.styling.styles;var R=!1;for(var I in b.head.layout.regions){R=!0;break}if(!R){var P=M.prototype.createDefaultRegion();b.head.layout.regions[P.id]=P}for(var L in b.head.layout.regions)a(b,b.head.layout.regions[L],null,null);return b.body&&a(b,b.body,null,null),b.body&&function e(t){if(!("contents"in t))return;for(var n=("styleAttrs"in t?t.styleAttrs[i.byName.ruby.qname]:null),r="span"===t.kind&&("container"===n||"textContainer"===n||"baseContainer"===n),a=t.contents.length-1;a>=0;a--)!r||"styleAttrs"in t.contents[a]&&i.byName.ruby.qname in t.contents[a].styleAttrs?e(t.contents[a]):delete t.contents[a]}(b.body),b},s.prototype.initFromNode=function(e,t){var i=function(e,t){var i=L(e,n.ns_ttp,"cellResolution"),r=15,a=32;if(null!==i){var o=/(\d+) (\d+)/.exec(i);null!==o?(a=parseInt(o[1]),r=parseInt(o[2])):F(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:r}}(e,t);this.cellLength={h:new r.ComputedLength(0,1/i.h),w:new r.ComputedLength(1/i.w,0)};var a=function(e,t){var i,r=L(e,n.ns_ttp,"frameRate"),a=30;if(null!==r){null!==(i=/(\d+)/.exec(r))?a=parseInt(i[1]):F(t,"Malformed frame rate attribute (using initial value instead)")}var o=L(e,n.ns_ttp,"frameRateMultiplier"),s=1;if(null!==o){null!==(i=/(\d+) (\d+)/.exec(o))?s=parseInt(i[1])/parseInt(i[2]):F(t,"Malformed frame rate multiplier attribute (using initial value instead)")}var l=s*a,u=1,c=L(e,n.ns_ttp,"tickRate");if(null===c)null!==r&&(u=l);else{null!==(i=/(\d+)/.exec(c))?u=parseInt(i[1]):F(t,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:l,tickRate:u}}(e,t);this.effectiveFrameRate=a.effectiveFrameRate,this.tickRate=a.tickRate,this.aspectRatio=function(e,t){var i=L(e,n.ns_ittp,"aspectRatio");null===i&&(i=L(e,n.ns_ttp,"displayAspectRatio"));var r=null;if(null!==i){var a=/(\d+)\s+(\d+)/.exec(i);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?r=o/s:B(t,"Illegal aspectRatio values (ignoring)")}else B(t,"Malformed aspectRatio attribute (ignoring)")}return r}(e,t);var o=L(e,n.ns_ttp,"timeBase");null!==o&&"media"!==o&&U(t,"Unsupported time base");var s=function(e,t){var i=L(e,n.ns_tts,"extent");if(null===i)return null;var a=i.split(" ");if(2!==a.length)return F(t,"Malformed extent (ignoring)"),null;var o=r.parseLength(a[0]),s=r.parseLength(a[1]);if(!s||!o)return F(t,"Malformed extent values (ignoring)"),null;return{h:s,w:o}}(e,t);null===s?this.pxLength={h:null,w:null}:("px"===s.h.unit&&"px"===s.w.unit||U(t,"Extent on TT must be in px or absent"),this.pxLength={h:new r.ComputedLength(0,1/s.h.value),w:new r.ComputedLength(1/s.w.value,0)}),this.dimensions={h:new r.ComputedLength(0,1),w:new r.ComputedLength(1,0)}},s.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=j(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=j(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},s.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},s.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(e,t){this.id=R(e),this.styleAttrs=P(e,t),this.styleRefs=I(e)},h.prototype.initFromNode=function(e,t){for(var i in this.styleAttrs={},e.attributes)if(e.attributes[i].uri===n.ns_itts||e.attributes[i].uri===n.ns_ebutts||e.attributes[i].uri===n.ns_tts){var r=e.attributes[i].uri+" "+e.attributes[i].local;this.styleAttrs[r]=e.attributes[i].value}},f.prototype.initFromNode=function(e,t,n,i){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||B(i,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||B(i,"Invalid image@type attribute"),v.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),g.prototype.initFromNode.call(this,e,t,n,i)},m.prototype.initFromNode=function(e,t,n,i){this.id=R(n)},g.prototype.initFromNode=function(e,t,n,i){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},v.prototype.initFromNode=function(e,t,n,i){this.styleAttrs=P(n,i),null!==e.head&&null!==e.head.styling&&N(e.head.styling,I(n),this.styleAttrs,i)},y.prototype.initFromNode=function(e,t,n,i){this.sets=[]},_.prototype.initFromNode=function(e,t,n,i){this.contents=[]},b.prototype.initFromNode=function(e,t,n,i){var r=function(e,t,n,i){var r=null;n&&"begin"in n.attributes&&null===(r=D(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&F(i,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=D(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&F(i,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;n&&"end"in n.attributes&&null===(o=D(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&F(i,"Malformed end value (ignoring)");return{explicit_begin:r,explicit_end:o,explicit_dur:a}}(e,0,n,i);this.explicit_begin=r.explicit_begin,this.explicit_end=r.explicit_end,this.explicit_dur=r.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(B(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,i)},E.prototype.initFromNode=function(e,t,n){v.prototype.initFromNode.call(this,e,null,t,n),b.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),g.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n)},T.prototype.initFromNode=function(e,t,n,i){v.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),g.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i)},w.prototype.initFromNode=function(e,t,n,i){v.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),g.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i)},x.prototype.initFromNode=function(e,t,n,i,r){v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),this.space=i},A.prototype.initFromText=function(e,t,n,i,r){b.prototype.initFromNode.call(this,e,t,null,r),this.text=n,this.space=i},S.prototype.initFromNode=function(e,t,n,i){g.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i)},M.prototype.createDefaultRegion=function(){var e=new M;return m.call(e,""),v.call(e,{}),y.call(e,[]),b.call(e,0,Number.POSITIVE_INFINITY,null),e},M.prototype.initFromNode=function(e,t,n){m.prototype.initFromNode.call(this,e,null,t,n),v.prototype.initFromNode.call(this,e,null,t,n),b.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&N(e.head.styling,I(t),this.styleAttrs,n)},C.prototype.initFromNode=function(e,t,n,i){b.prototype.initFromNode.call(this,e,t,n,i);var r=P(n,i);for(var a in this.qname=null,this.value=null,r){if(this.qname){B(i,"More than one style specified on set");break}this.qname=a,this.value=r[a]}}}(t,"undefined"==typeof sax?n(136):sax,"undefined"==typeof imscNames?n(37):imscNames,"undefined"==typeof imscStyles?n(53):imscStyles,"undefined"==typeof imscUtils?n(38):imscUtils)},function(e,t,n){(function(e){!function(t){t.parser=function(e,t){return new a(e,t)},t.SAXParser=a,t.SAXStream=s,t.createStream=function(e,t){return new s(e,t)},t.MAX_BUFFER_LENGTH=65536;var i,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(e,n){if(!(this instanceof a))return new a(e,n);!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(this),this.q=this.c="",this.bufferCheckPosition=t.MAX_BUFFER_LENGTH,this.opt=n||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!e,this.noscript=!(!e&&!this.opt.noscript),this.state=A.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(p)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),M(this,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),a.prototype={end:function(){L(this)},write:function(e){if(this.error)throw this.error;if(this.closed)return P(this,"Cannot write after close. Assign an onready handler.");if(null===e)return L(this);"object"==typeof e&&(e=e.toString());var n=0,i="";for(;i=G(e,n++),this.c=i,i;)switch(this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++),this.state){case A.BEGIN:if(this.state=A.BEGIN_WHITESPACE,"\ufeff"===i)continue;j(this,i);continue;case A.BEGIN_WHITESPACE:j(this,i);continue;case A.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=n-1;i&&"<"!==i&&"&"!==i;)(i=G(e,n++))&&this.trackPosition&&(this.position++,"\n"===i?(this.line++,this.column=0):this.column++);this.textNode+=e.substring(a,n-1)}"<"!==i||this.sawRoot&&this.closedRoot&&!this.strict?(!E(l,i)||this.sawRoot&&!this.closedRoot||D(this,"Text data outside of root node."),"&"===i?this.state=A.TEXT_ENTITY:this.textNode+=i):(this.state=A.OPEN_WAKA,this.startTagPosition=this.position);continue;case A.SCRIPT:"<"===i?this.state=A.SCRIPT_ENDING:this.script+=i;continue;case A.SCRIPT_ENDING:"/"===i?this.state=A.CLOSE_TAG:(this.script+="<"+i,this.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===i)this.state=A.SGML_DECL,this.sgmlDecl="";else if(b(l,i));else if(b(m,i))this.state=A.OPEN_TAG,this.tagName=i;else if("/"===i)this.state=A.CLOSE_TAG,this.tagName="";else if("?"===i)this.state=A.PROC_INST,this.procInstName=this.procInstBody="";else{if(D(this,"Unencoded <"),this.startTagPosition+1<this.position){var o=this.position-this.startTagPosition;i=new Array(o).join(" ")+i}this.textNode+="<"+i,this.state=A.TEXT}continue;case A.SGML_DECL:"[CDATA["===(this.sgmlDecl+i).toUpperCase()?(C(this,"onopencdata"),this.state=A.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+i==="--"?(this.state=A.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+i).toUpperCase()?(this.state=A.DOCTYPE,(this.doctype||this.sawRoot)&&D(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===i?(C(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=A.TEXT):b(h,i)?(this.state=A.SGML_DECL_QUOTED,this.sgmlDecl+=i):this.sgmlDecl+=i;continue;case A.SGML_DECL_QUOTED:i===this.q&&(this.state=A.SGML_DECL,this.q=""),this.sgmlDecl+=i;continue;case A.DOCTYPE:">"===i?(this.state=A.TEXT,C(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=i,"["===i?this.state=A.DOCTYPE_DTD:b(h,i)&&(this.state=A.DOCTYPE_QUOTED,this.q=i));continue;case A.DOCTYPE_QUOTED:this.doctype+=i,i===this.q&&(this.q="",this.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:this.doctype+=i,"]"===i?this.state=A.DOCTYPE:b(h,i)&&(this.state=A.DOCTYPE_DTD_QUOTED,this.q=i);continue;case A.DOCTYPE_DTD_QUOTED:this.doctype+=i,i===this.q&&(this.state=A.DOCTYPE_DTD,this.q="");continue;case A.COMMENT:"-"===i?this.state=A.COMMENT_ENDING:this.comment+=i;continue;case A.COMMENT_ENDING:"-"===i?(this.state=A.COMMENT_ENDED,this.comment=I(this.opt,this.comment),this.comment&&C(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+i,this.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==i?(D(this,"Malformed comment"),this.comment+="--"+i,this.state=A.COMMENT):this.state=A.TEXT;continue;case A.CDATA:"]"===i?this.state=A.CDATA_ENDING:this.cdata+=i;continue;case A.CDATA_ENDING:"]"===i?this.state=A.CDATA_ENDING_2:(this.cdata+="]"+i,this.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===i?(this.cdata&&C(this,"oncdata",this.cdata),C(this,"onclosecdata"),this.cdata="",this.state=A.TEXT):"]"===i?this.cdata+="]":(this.cdata+="]]"+i,this.state=A.CDATA);continue;case A.PROC_INST:"?"===i?this.state=A.PROC_INST_ENDING:b(l,i)?this.state=A.PROC_INST_BODY:this.procInstName+=i;continue;case A.PROC_INST_BODY:if(!this.procInstBody&&b(l,i))continue;"?"===i?this.state=A.PROC_INST_ENDING:this.procInstBody+=i;continue;case A.PROC_INST_ENDING:">"===i?(C(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=A.TEXT):(this.procInstBody+="?"+i,this.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:b(g,i)?this.tagName+=i:(O(this),">"===i?F(this):"/"===i?this.state=A.OPEN_TAG_SLASH:(E(l,i)&&D(this,"Invalid character in tag name"),this.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===i?(F(this,!0),B(this)):(D(this,"Forward-slash in opening tag not followed by >"),this.state=A.ATTRIB);continue;case A.ATTRIB:if(b(l,i))continue;">"===i?F(this):"/"===i?this.state=A.OPEN_TAG_SLASH:b(m,i)?(this.attribName=i,this.attribValue="",this.state=A.ATTRIB_NAME):D(this,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===i?this.state=A.ATTRIB_VALUE:">"===i?(D(this,"Attribute without value"),this.attribValue=this.attribName,k(this),F(this)):b(l,i)?this.state=A.ATTRIB_NAME_SAW_WHITE:b(g,i)?this.attribName+=i:D(this,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===i)this.state=A.ATTRIB_VALUE;else{if(b(l,i))continue;D(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",C(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===i?F(this):b(m,i)?(this.attribName=i,this.state=A.ATTRIB_NAME):(D(this,"Invalid attribute name"),this.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(b(l,i))continue;b(h,i)?(this.q=i,this.state=A.ATTRIB_VALUE_QUOTED):(D(this,"Unquoted attribute value"),this.state=A.ATTRIB_VALUE_UNQUOTED,this.attribValue=i);continue;case A.ATTRIB_VALUE_QUOTED:if(i!==this.q){"&"===i?this.state=A.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=i;continue}k(this),this.q="",this.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:b(l,i)?this.state=A.ATTRIB:">"===i?F(this):"/"===i?this.state=A.OPEN_TAG_SLASH:b(m,i)?(D(this,"No whitespace between attributes"),this.attribName=i,this.attribValue="",this.state=A.ATTRIB_NAME):D(this,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(E(d,i)){"&"===i?this.state=A.ATTRIB_VALUE_ENTITY_U:this.attribValue+=i;continue}k(this),">"===i?F(this):this.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(this.tagName)">"===i?B(this):b(g,i)?this.tagName+=i:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=A.SCRIPT):(E(l,i)&&D(this,"Invalid tagname in closing tag"),this.state=A.CLOSE_TAG_SAW_WHITE);else{if(b(l,i))continue;E(m,i)?this.script?(this.script+="</"+i,this.state=A.SCRIPT):D(this,"Invalid tagname in closing tag."):this.tagName=i}continue;case A.CLOSE_TAG_SAW_WHITE:if(b(l,i))continue;">"===i?B(this):D(this,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var s,u;switch(this.state){case A.TEXT_ENTITY:s=A.TEXT,u="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:s=A.ATTRIB_VALUE_QUOTED,u="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:s=A.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===i?(this[u]+=U(this),this.entity="",this.state=s):b(this.entity.length?y:v,i)?this.entity+=i:(D(this,"Invalid character in entity name"),this[u]+="&"+this.entity+i,this.entity="",this.state=s);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),i=0,a=0,o=r.length;a<o;a++){var s=e[r[a]].length;if(s>n)switch(r[a]){case"textNode":R(e);break;case"cdata":C(e,"oncdata",e.cdata),e.cdata="";break;case"script":C(e,"onscript",e.script),e.script="";break;default:P(e,"Max buffer length exceeded: "+r[a])}i=Math.max(i,s)}var l=t.MAX_BUFFER_LENGTH-i;e.bufferCheckPosition=l+e.position}(this);return this}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;R(e=this),""!==e.cdata&&(C(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(C(e,"onscript",e.script),e.script="")}};try{i=n(139).Stream}catch(e){i=function(){}}var o=t.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,t){if(!(this instanceof s))return new s(e,t);i.apply(this),this._parser=new a(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(i.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)){if(!this._decoder){var i=n(57).StringDecoder;this._decoder=new i("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),i.prototype.on.call(n,e,t)};var l="\r\n\t ",u="0124356789",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",h="'\"",d=l+">",f="http://www.w3.org/XML/1998/namespace",p={xml:f,xmlns:"http://www.w3.org/2000/xmlns/"};l=_(l),u=_(u),c=_(c);var m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function _(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}function b(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function E(e,t){return!b(e,t)}h=_(h),d=_(d);var T,w,x,A=0;for(var S in t.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var n=t.ENTITIES[e],i="number"==typeof n?String.fromCharCode(n):n;t.ENTITIES[e]=i})),t.STATE)t.STATE[t.STATE[S]]=S;function M(e,t,n){e[t]&&e[t](n)}function C(e,t,n){e.textNode&&R(e),M(e,t,n)}function R(e){e.textNode=I(e.opt,e.textNode),e.textNode&&M(e,"ontext",e.textNode),e.textNode=""}function I(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function P(e,t){return R(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,M(e,"onerror",t),e}function L(e){return e.sawRoot&&!e.closedRoot&&D(e,"Unclosed root tag"),e.state!==A.BEGIN&&e.state!==A.BEGIN_WHITESPACE&&e.state!==A.TEXT&&P(e,"Unexpected end"),R(e),e.c="",e.closed=!0,M(e,"onend"),a.call(e,e.strict,e.opt),e}function D(e,t){if("object"!=typeof e||!(e instanceof a))throw new Error("bad call to strictFail");e.strict&&P(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,C(e,"onopentagstart",n)}function N(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),i=n[0],r=n[1];return t&&"xmlns"===e&&(i="xmlns",r=""),{prefix:i,local:r}}function k(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=N(e.attribName,!0),n=t.prefix,i=t.local;if("xmlns"===n)if("xml"===i&&e.attribValue!==f)D(e,"xml: prefix must be bound to "+f+"\nActual: "+e.attribValue);else if("xmlns"===i&&"http://www.w3.org/2000/xmlns/"!==e.attribValue)D(e,"xmlns: prefix must be bound to http://www.w3.org/2000/xmlns/\nActual: "+e.attribValue);else{var r=e.tag,a=e.tags[e.tags.length-1]||e;r.ns===a.ns&&(r.ns=Object.create(a.ns)),r.ns[i]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,C(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var n=e.tag,i=N(e.tagName);n.prefix=i.prefix,n.local=i.local,n.uri=n.ns[i.prefix]||"",n.prefix&&!n.uri&&(D(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=i.prefix);var r=e.tags[e.tags.length-1]||e;n.ns&&r.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){C(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],l=s[0],u=s[1],c=N(l,!0),h=c.prefix,d=c.local,f=""===h?"":n.ns[h]||"",p={name:l,value:u,prefix:h,local:d,uri:f};h&&"xmlns"!==h&&!f&&(D(e,"Unbound namespace prefix: "+JSON.stringify(h)),p.uri=h),e.tag.attributes[l]=p,C(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),C(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=A.TEXT:e.state=A.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function B(e){if(!e.tagName)return D(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=A.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=A.SCRIPT);C(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var i=n;t--;){if(e.tags[t].name===i)break;D(e,"Unexpected close tag")}if(t<0)return D(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=A.TEXT);e.tagName=n;for(var r=e.tags.length;r-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,C(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach((function(t){var n=a.ns[t];C(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=A.TEXT}function U(e){var t,n=e.entity,i=n.toLowerCase(),r="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[i]?e.ENTITIES[i]:("#"===(n=i).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),r=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),r=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),r.toLowerCase()!==n?(D(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function j(e,t){"<"===t?(e.state=A.OPEN_WAKA,e.startTagPosition=e.position):E(l,t)&&(D(e,"Non-whitespace before first tag."),e.textNode=t,e.state=A.TEXT)}function G(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}A=t.STATE,String.fromCodePoint||(T=String.fromCharCode,w=Math.floor,x=function(){var e,t,n=16384,i=[],r=-1,a=arguments.length;if(!a)return"";for(var o="";++r<a;){var s=Number(arguments[r]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?i.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,i.push(e,t)),(r+1===a||i.length>n)&&(o+=T.apply(null,i),i.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(t)}).call(this,n(39).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=u(e),o=i[0],s=i[1],l=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),c=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[c++]=255&t);1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,a=[],o=0,s=n-r;o<s;o+=16383)a.push(c(e,o,o+16383>s?s:o+16383));1===r?(t=e[n-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return a.join("")};for(var i=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)i[s]=o[s],r[o.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var r,a,o=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(i[(a=r)>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,d=n?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-c)-1,f>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=i;c>0;o=256*o+e[t+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),a-=u}return(f?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,n,i,r,a){var o,s,l,u=8*a-r-1,c=(1<<u)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*l-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&s,f+=p,s/=256,r-=8);for(o=o<<r|s,u+=r;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},function(e,t,n){e.exports=r;var i=n(54).EventEmitter;function r(){i.call(this)}n(24)(r,i),r.Readable=n(55),r.Writable=n(147),r.Duplex=n(148),r.Transform=n(149),r.PassThrough=n(150),r.Stream=r,r.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var o=!1;function s(){o||(o=!0,e.end())}function l(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",r),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},function(e,t){},function(e,t,n){"use strict";var i=n(42).Buffer,r=n(142);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,n,r,a=i.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=a,r=s,t.copy(n,r),s+=o.data.length,o=o.next;return a},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new a(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(144),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(17))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,a,o,s,l=1,u={},c=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){a.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[l]=r,i(l),l++},d.clearImmediate=f}function f(e){delete u[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(17),n(40))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,n(17))},function(e,t,n){"use strict";e.exports=a;var i=n(88),r=Object.create(n(31));function a(e){if(!(this instanceof a))return new a(e);i.call(this,e)}r.inherits=n(24),r.inherits(a,i),a.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(56)},function(e,t,n){e.exports=n(22)},function(e,t,n){e.exports=n(55).Transform},function(e,t,n){e.exports=n(55).PassThrough},function(e,t,n){!function(e,t,n){function i(e,t,s){var u;if("region"===s.kind)(u=document.createElement("div")).style.position="absolute";else if("body"===s.kind)u=document.createElement("div");else if("div"===s.kind)u=document.createElement("div");else if("image"===s.kind){if(u=document.createElement("img"),null!==e.imgResolver&&null!==s.src){var c=e.imgResolver(s.src,u);c&&(u.src=c),u.height=e.regionH,u.width=e.regionW}}else if("p"===s.kind)u=document.createElement("p");else if("span"===s.kind){if("container"===s.styleAttrs[n.byName.ruby.qname])u=document.createElement("ruby"),e.ruby=!0;else if("base"===s.styleAttrs[n.byName.ruby.qname])u=document.createElement("rb");else if("text"===s.styleAttrs[n.byName.ruby.qname])u=document.createElement("rt");else if("baseContainer"===s.styleAttrs[n.byName.ruby.qname])u=document.createElement("rbc");else if("textContainer"===s.styleAttrs[n.byName.ruby.qname])u=document.createElement("rtc");else{if("delimiter"===s.styleAttrs[n.byName.ruby.qname])return;u=document.createElement("span")}var h=s.styleAttrs[n.byName.textEmphasis.qname];h&&"none"!==h.style&&(e.textEmphasis=!0)}else"br"===s.kind&&(u=document.createElement("br"));if(u){for(var d in t.appendChild(u),u.style.margin="0",l){var f=l[d],p=s.styleAttrs[f.qname];void 0!==p&&null!==f.map&&f.map(e,u,s,p)}var m=u;if("region"===s.kind){var g=s.styleAttrs[n.byName.writingMode.qname];"lrtb"===g||"lr"===g?(e.ipd="lr",e.bpd="tb"):"rltb"===g||"rl"===g?(e.ipd="rl",e.bpd="tb"):"tblr"===g?(e.ipd="tb",e.bpd="lr"):"tbrl"!==g&&"tb"!==g||(e.ipd="tb",e.bpd="rl")}var v=s.styleAttrs[n.byName.linePadding.qname];if(v&&!v.isZero()){var y=v.toUsedLength(e.w,e.h);if(y>0){var _=Math.ceil(y)+"px";"tb"===e.bpd?(m.style.paddingLeft=_,m.style.paddingRight=_):(m.style.paddingTop=_,m.style.paddingBottom=_),e.lp=v}}var b=s.styleAttrs[n.byName.multiRowAlign.qname];if(b&&"auto"!==b){var E=document.createElement("span");E.style.display="inline-block",E.style.textAlign=b,u.appendChild(E),m=E,e.mra=b}var T=s.styleAttrs[n.byName.rubyReserve.qname];if(T&&"none"!==T[0]&&(e.rubyReserve=T),s.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===s.kind&&s.text)if(n.byName.textCombine.qname in s.styleAttrs&&"all"===s.styleAttrs[n.byName.textCombine.qname][0])u.textContent=s.text;else for(var w="",x=0;x<s.text.length;x++){w+=s.text.charAt(x);var A=s.text.charCodeAt(x);if(A<55296||A>56319||x===s.text.length){var S=document.createElement("span");S.textContent=w,u.appendChild(S),w=""}}for(var M in s.contents)i(e,m,s.contents[M]);var C=[];if((e.lp||e.mra||e.flg||e.ruby||e.textEmphasis||e.rubyReserve)&&"p"===s.kind&&(o(e,m,C,null),e.rubyReserve&&(!function(e,t){for(var n=0;n<e.length;n++){var i,r,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="",a.appendChild(o);var s=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]?((i=document.createElement("rtc")).style.rubyPosition="under",i.textContent="",i.style.fontSize=s,(r=document.createElement("rtc")).style.rubyPosition="over",r.textContent="",r.style.fontSize=s,a.appendChild(i),a.appendChild(r)):((i=document.createElement("rtc")).textContent="",i.style.fontSize=s,"after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?i.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"under":"over":i.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"over":"under",a.appendChild(i));e[n].elements[0].node.parentElement.insertBefore(a,e[n].elements[0].node)}}(C,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(!function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].rbc.length;i++){var r;if(!e[n].rbc[i].style.rubyPosition)r="tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[i].style.rubyPosition=r}}(C,e),e.ruby=null),e.textEmphasis&&(!function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].te.length;i++){var r;if(!e[n].te[i].style.textEmphasisPosition||"none"===e[n].te[i].style.textEmphasisPosition)r="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[i].style.textEmphasisPosition=r}}(C,e),e.textEmphasis=null),e.mra&&(!function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var i=document.createElement("br"),r=e[t].elements[n-1].node;r.parentElement.insertBefore(i,r.nextSibling)}}}(C),e.mra=null),e.lp&&(!function(e,t,n){for(var i in e){var r=e[i].elements.length,a=e[i].elements[e[i].start_elem],o=e[i].elements[e[i].end_elem],s=Math.ceil(t)+"px",l="-"+Math.ceil(t)+"px";0!==r&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=l):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=l):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=l),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=l):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=l):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=l))}}(C,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),e.flg)){var R=a(m.getBoundingClientRect(),e);!function(e,t,n,i){for(var r=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,l;if(o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2,a>0)for(var u=0;u<e[a-1].elements.length;u++)null!==e[a-1].elements[u].bgcolor&&(l=e[a-1].elements[u],r*(l.after-o)<0&&(s=Math.ceil(Math.abs(o-l.after))+"px",l.node.style.backgroundColor=l.bgcolor,"lr"===i.bpd?l.node.style.paddingRight=s:"rl"===i.bpd?l.node.style.paddingLeft=s:"tb"===i.bpd&&(l.node.style.paddingBottom=s)));if(a<e.length)for(var c=0;c<e[a].elements.length;c++)null!==(l=e[a].elements[c]).bgcolor&&r*(l.before-o)>0&&(s=Math.ceil(Math.abs(l.before-o))+"px",l.node.style.backgroundColor=l.bgcolor,"lr"===i.bpd?l.node.style.paddingLeft=s:"rl"===i.bpd?l.node.style.paddingRight=s:"tb"===i.bpd&&(l.node.style.paddingTop=s))}}(C,R.before,R.after,e),e.flg=null}if("region"===s.kind&&(o(e,m,C),"tb"===e.bpd&&e.enableRollUp&&s.contents.length>0&&"after"===s.styleAttrs[n.byName.displayAlign.qname])){var I=new r(""===s.id?"_":s.id,C);if(e.currentISDState[I.id]=I,e.previousISDState&&I.id in e.previousISDState&&e.previousISDState[I.id].plist.length>0&&I.plist.length>1&&I.plist[I.plist.length-2].text===e.previousISDState[I.id].plist[e.previousISDState[I.id].plist.length-1].text){var P=u.firstElementChild,L=I.plist[I.plist.length-1].after-I.plist[I.plist.length-1].before;P.style.bottom="-"+L+"px",P.style.transition="transform 0.4s",P.style.position="relative",P.style.transform="translateY(-"+L+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+s.kind)}function r(e,t){this.id=e,this.plist=t}function a(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function o(e,t,n,i){if("rt"!==t.localName&&"rtc"!==t.localName){var r,s,l,u,c=t.style.backgroundColor||i;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var h=t.getBoundingClientRect();if(0===h.height||0===h.width)return;var d=a(h,e);if(0!==n.length&&(r=d.before,s=d.after,l=n[n.length-1].before,u=n[n.length-1].after,s<u&&r>l||u<=s&&l>=r)){var f=Math.sign(d.after-d.before),p=Math.sign(d.end-d.start);f*(d.before-n[n.length-1].before)<0&&(n[n.length-1].before=d.before),f*(d.after-n[n.length-1].after)>0&&(n[n.length-1].after=d.after),p*(d.start-n[n.length-1].start)<0&&(n[n.length-1].start=d.start,n[n.length-1].start_elem=n[n.length-1].elements.length),p*(d.end-n[n.length-1].end)>0&&(n[n.length-1].end=d.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:d.before,after:d.after,start:d.start,end:d.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:d.before,after:d.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var m=t.firstChild;m;)m.nodeType===Node.ELEMENT_NODE&&(o(e,m,n,c),"ruby"===m.localName||"rtc"===m.localName?n.length>0&&n[n.length-1].rbc.push(m):"span"===m.localName&&m.style.textEmphasisStyle&&"none"!==m.style.textEmphasisStyle&&n.length>0&&n[n.length-1].te.push(m)),m=m.nextSibling}}function s(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,r,a,o,s,l,u){var c=r||t.clientHeight,h=a||t.clientWidth;if(null!==e.aspectRatio){var d=c*e.aspectRatio;d>h?c=Math.round(h/e.aspectRatio):h=d}var f=document.createElement("div");f.style.position="relative",f.style.width=h+"px",f.style.height=c+"px",f.style.margin="auto",f.style.top=0,f.style.bottom=0,f.style.left=0,f.style.right=0,f.style.zIndex=0;var p={h:c,w:h,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:l,enableRollUp:u||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var m in t.appendChild(f),e.contents)i(p,f,e.contents[m]);return p.currentISDState};var l=[new s("http://www.w3.org/ns/ttml#styling backgroundColor",(function(e,t,n,i){0!==i[3]&&(t.style.backgroundColor="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")")})),new s("http://www.w3.org/ns/ttml#styling color",(function(e,t,n,i){t.style.color="rgba("+i[0].toString()+","+i[1].toString()+","+i[2].toString()+","+(i[3]/255).toString()+")"})),new s("http://www.w3.org/ns/ttml#styling direction",(function(e,t,n,i){t.style.direction=i})),new s("http://www.w3.org/ns/ttml#styling display",(function(e,t,n,i){})),new s("http://www.w3.org/ns/ttml#styling displayAlign",(function(e,t,n,i){t.style.display="flex",t.style.flexDirection="column","before"===i?t.style.justifyContent="flex-start":"center"===i?t.style.justifyContent="center":"after"===i&&(t.style.justifyContent="flex-end")})),new s("http://www.w3.org/ns/ttml#styling extent",(function(e,t,n,i){e.regionH=i.h.toUsedLength(e.w,e.h),e.regionW=i.w.toUsedLength(e.w,e.h);var r=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(r=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-r+"px",t.style.width=e.regionW-a+"px"})),new s("http://www.w3.org/ns/ttml#styling fontFamily",(function(e,t,n,i){var r=[];for(var a in i)"monospaceSerif"===i[a]?(r.push("Courier New"),r.push('"Liberation Mono"'),r.push("Courier"),r.push("monospace")):"proportionalSansSerif"===i[a]?(r.push("Arial"),r.push("Helvetica"),r.push('"Liberation Sans"'),r.push("sans-serif")):"monospace"===i[a]?r.push("monospace"):"sansSerif"===i[a]?r.push("sans-serif"):"serif"===i[a]?r.push("serif"):"monospaceSansSerif"===i[a]?(r.push("Consolas"),r.push("monospace")):"proportionalSerif"===i[a]?r.push("serif"):r.push(i[a]);t.style.fontFamily=r.join(",")})),new s("http://www.w3.org/ns/ttml#styling shear",(function(e,t,n,i){if(0!==i){var r=-.9*i;"tb"===e.bpd?t.style.transform="skewX("+r+"deg)":t.style.transform="skewY("+r+"deg)"}})),new s("http://www.w3.org/ns/ttml#styling fontSize",(function(e,t,n,i){t.style.fontSize=i.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling fontStyle",(function(e,t,n,i){t.style.fontStyle=i})),new s("http://www.w3.org/ns/ttml#styling fontWeight",(function(e,t,n,i){t.style.fontWeight=i})),new s("http://www.w3.org/ns/ttml#styling lineHeight",(function(e,t,n,i){t.style.lineHeight="normal"===i?"normal":i.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling opacity",(function(e,t,n,i){t.style.opacity=i})),new s("http://www.w3.org/ns/ttml#styling origin",(function(e,t,n,i){t.style.top=i.h.toUsedLength(e.w,e.h)+"px",t.style.left=i.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling overflow",(function(e,t,n,i){t.style.overflow=i})),new s("http://www.w3.org/ns/ttml#styling padding",(function(e,t,n,i){var r=[];r[0]=i[0].toUsedLength(e.w,e.h)+"px",r[1]=i[3].toUsedLength(e.w,e.h)+"px",r[2]=i[2].toUsedLength(e.w,e.h)+"px",r[3]=i[1].toUsedLength(e.w,e.h)+"px",t.style.padding=r.join(" ")})),new s("http://www.w3.org/ns/ttml#styling position",(function(e,t,n,i){t.style.top=i.h.toUsedLength(e.w,e.h)+"px",t.style.left=i.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling rubyAlign",(function(e,t,n,i){t.style.rubyAlign=i})),new s("http://www.w3.org/ns/ttml#styling rubyPosition",(function(e,t,n,i){var r;"before"!==i&&"after"!==i||(r="tb"===e.bpd||"rl"===e.bpd?"before"===i?"over":"under":"before"===i?"under":"over",t.parentElement.style.rubyPosition=r)})),new s("http://www.w3.org/ns/ttml#styling showBackground",null),new s("http://www.w3.org/ns/ttml#styling textAlign",(function(e,t,i,r){var a,o=i.styleAttrs[n.byName.direction.qname];a="start"===r?"rtl"===o?"right":"left":"end"===r?"rtl"===o?"left":"right":r,t.style.textAlign=a})),new s("http://www.w3.org/ns/ttml#styling textDecoration",(function(e,t,n,i){t.style.textDecoration=i.join(" ").replace("lineThrough","line-through")})),new s("http://www.w3.org/ns/ttml#styling textOutline",(function(e,t,n,i){})),new s("http://www.w3.org/ns/ttml#styling textShadow",(function(e,t,i,r){var a=i.styleAttrs[n.byName.textOutline.qname];if("none"===r&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a&&o.push("rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+") 0px 0px "+a.thickness.toUsedLength(e.w,e.h)+"px"),"none"!==r)for(var s in r)o.push(r[s].x_off.toUsedLength(e.w,e.h)+"px "+r[s].y_off.toUsedLength(e.w,e.h)+"px "+r[s].b_radius.toUsedLength(e.w,e.h)+"px rgba("+r[s].color[0].toString()+","+r[s].color[1].toString()+","+r[s].color[2].toString()+","+(r[s].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}})),new s("http://www.w3.org/ns/ttml#styling textCombine",(function(e,t,n,i){t.style.textCombineUpright=i.join(" ")})),new s("http://www.w3.org/ns/ttml#styling textEmphasis",(function(e,t,n,i){var r;"none"!==i.style?("auto"===i.style?t.style.textEmphasisStyle="filled":t.style.textEmphasisStyle=i.style+" "+i.symbol,("before"===i.position||"after"===i.position)&&(r="tb"===e.bpd?"before"===i.position?"left over":"left under":"rl"===e.bpd?"before"===i.position?"right under":"left under":"before"===i.position?"left under":"right under",t.style.textEmphasisPosition=r)):t.style.textEmphasisStyle="none"})),new s("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(e,t,n,i){var r;r="bidiOverride"===i?"bidi-override":i,t.style.unicodeBidi=r})),new s("http://www.w3.org/ns/ttml#styling visibility",(function(e,t,n,i){t.style.visibility=i})),new s("http://www.w3.org/ns/ttml#styling wrapOption",(function(e,t,n,i){"wrap"===i?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"})),new s("http://www.w3.org/ns/ttml#styling writingMode",(function(e,t,n,i){"lrtb"===i||"lr"===i||"rltb"===i||"rl"===i?e.writingMode="horizontal-tb":"tblr"===i?e.writingMode="vertical-lr":"tbrl"!==i&&"tb"!==i||(e.writingMode="vertical-rl"),t.style.writingMode=e.writingMode})),new s("http://www.w3.org/ns/ttml#styling zIndex",(function(e,t,n,i){t.style.zIndex=i})),new s("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(e,t,n,i){e.displayForcedOnlyMode&&!1===i&&(t.style.visibility="hidden")}))],u={};for(var c in l)u[l[c].qname]=l[c]}(t,"undefined"==typeof imscNames?n(37):imscNames,"undefined"==typeof imscStyles?n(53):imscStyles,"undefined"==typeof imscUtils?n(38):imscUtils)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function i(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function r(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?i(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?i(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(i,s,l,u){var c=null,h=!1,d=-1,f={start:s,end:l,spans:[]},p="style_cea608_white_black",m={},g={},v=[],y=void 0,_=void 0;for(y=0;y<15;++y){var b=u.rows[y],E="",T=null;if(!1===b.isEmpty()){var w=t(b.chars);null===c&&(c={x:w,y1:y,y2:y+1,p:[]}),w!==d&&h&&(c.p.push(f),f={start:s,end:l,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c={x:w,y1:y,y2:y+1,p:[]});for(var x=0;x<b.chars.length;++x){var A=b.chars[x],S=A.penState;if(null===T||!S.equals(T)){E.trim().length>0&&(f.spans.push({name:p,line:E,row:y}),E="");var M="style_cea608_"+S.foreground+"_"+S.background;S.underline&&(M+="_underline"),S.italics&&(M+="_italics"),g.hasOwnProperty(M)||(g[M]=JSON.parse(JSON.stringify(S))),T=S,p=M}E+=A.uchar}E.trim().length>0&&f.spans.push({name:p,line:E,row:y}),h=!0,d=w}else h=!1,d=-1,c&&(c.p.push(f),f={start:s,end:l,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null)}c&&(c.p.push(f),c.y2=y+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null);var C=[];for(y=0;y<v.length;++y){var R=v[y],I="sub_cea608_"+e++,P=document.createElement("div");P.id=I;var L=n(R);P.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+L;var D=document.createElement("div");D.className="paragraph bodyStyle",D.style.cssText=r(i);var O=document.createElement("div");O.className="cueUniWrapper",O.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<R.p.length;++N){var k=R.p[N],F=0;for(_=0;_<k.spans.length;++_){var B=k.spans[_];if(B.line.length>0){if(0!==_&&F!=B.row){var U=document.createElement("br");U.className="lineBreak",O.appendChild(U)}var j=!1;F===B.row&&(j=!0),F=B.row;var G=g[B.name],z=document.createElement("span");z.className="spanPadding "+B.name+" customSpanColor",z.style.cssText=r(i,G),0!==_&&j?_===k.spans.length-1?z.textContent=o(B.line):z.textContent=B.line:k.spans.length>1&&_<k.spans.length-1&&B.row===k.spans[_+1].row?z.textContent=a(B.line):z.textContent=B.line.trim(),O.appendChild(z)}}}D.appendChild(O),P.appendChild(D);var H={bodyStyle:["%",90]};for(var V in g)g.hasOwnProperty(V)&&(H[V]=["%",90]);C.push({type:"html",start:s,end:l,cueHTMLElement:P,cueID:I,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return C}}}o.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0;function l(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function u(e){var t=e.split(a),n=t[1].split(s);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:c(n)}}function c(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}})),t}function h(e,t){for(var n,i=t,r="",o="";""!==e[i]&&i<e.length;)i++;if((n=i-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(a)){r="";break}r+=o,s!==n-1&&(r+="\n")}else(o=e[t]).match(a)||(r=o);return r}return t={parse:function(e){var t,r=[],s=void 0;if(!e)return r;t=(e=e.split(i)).length,s=-1;for(var c=0;c<t;c++){var d=e[c];if(d.length>0&&"WEBVTT"!==d&&d.match(a)){var f=u(d),p=f.cuePoints,m=f.styles,g=h(e,c+1),v=l(p[0].replace(o,"")),y=l(p[1].replace(o,""));!isNaN(v)&&!isNaN(y)&&v>=s&&y>v?""!==g?(s=v,r.push({start:v,end:y,data:g,styles:m})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return r}},n=(0,r.default)(e).getInstance().getLogger(t),i=/(?:\r\n|\r|\n)/gm,a=/-->/,o=/(^[\s]+|[\s]+$)/g,s=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",t.default=i.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(2)),r=l(n(9)),a=l(n(8)),o=l(n(10)),s=n(83);function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,i=void 0,l=0;return n={parse:function(e,n,r,a,u){var c="",h=[],d=void 0,f=void 0,p=void 0,m={},g={},v="",y="",_={onOpenTag:function(e,t,n){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!n[" imagetype"]||"PNG"!==n[" imagetype"].value)return void i.warn("smpte-tt imagetype != PNG. Discarded");v=n["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){v&&(g[v]=y.trim()),y="",v=""},onText:function(e){v&&(y+=e)}};if(!e)throw c="no ttml data to parse",new Error(c);m.data=e,t.trigger(o.default.TTML_TO_PARSE,m);var b=(0,s.fromXML)(m.data,(function(e){c=e}),_);t.trigger(o.default.TTML_PARSED,{ttmlString:m.data,ttmlDoc:b});var E,T=b.getMediaTimeEvents();for(p=0;p<T.length;p++){var w=(0,s.generateISD)(b,T[p],(function(e){c=e}));w.contents.some((function(e){return e.contents.length}))&&(d=T[p]+n<r?r:T[p]+n)<(f=T[p+1]+n>a?a:T[p+1]+n)&&h.push({start:d,end:f,type:"html",cueID:(E=void 0,E="cue_TTML_"+l,l++,E),isd:w,images:u,embeddedImages:g})}if(""!==c)throw i.error(c),new Error(c);return h}},i=(0,r.default)(e).getInstance().getLogger(n),n}u.__dashjs_factory_name="TTMLParser",t.default=i.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(9)),r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=this.context,n=void 0,r=void 0,a=void 0,o=[],s=e;function l(e,t){o=o.filter((function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))}))}return n={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var i={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(i,"length",{get:function(){return e.length}}),i},append:function(e){"InitializationSegment"!==e.segmentType?(o.push(e),o.sort((function(e,t){return e.start-t.start})),a=null):a=e,r.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),s&&s({chunk:e})},remove:l,abort:function(){},discharge:function(e,t){var n=function(e,t){return o.filter((function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)}))}(e,t);return a&&(n.push(a),a=null),l(e,t),n},reset:function(){o=[],a=null,s=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},r=(0,i.default)(t).getInstance().getLogger(n),n}o.__dashjs_factory_name="PreBufferSink";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(2)),r=l(n(9)),a=l(n(19)),o=l(n(7)),s=l(n(16));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=this.context,n=e.dashMetrics,i=void 0,l=void 0;return i={getMaxIndex:function(e){var i=(0,a.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return i;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(o.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaInfo(),u=e.getMediaType(),c=n.getCurrentBufferState(u),h=e.getScheduleController(),d=e.getAbrController(),f=e.getStreamInfo(),p=f&&f.manifestInfo?f.manifestInfo.isDynamic:null,m=d.getThroughputHistory(),g=m.getSafeAverageThroughput(u,p),v=m.getAverageLatency(u),y=e.useBufferOccupancyABR();return isNaN(g)||!c||y||d.getAbandonmentStateFor(u)!==s.default.ABANDON_LOAD&&(c.state===s.default.BUFFER_LOADED||p)&&(i.quality=d.getQualityForBitrate(r,g,v),h.setTimeToLoadDelay(0),l.debug("["+u+"] requesting switch to index: ",i.quality,"Average throughput",Math.round(g),"kbps"),i.reason={throughput:g,latency:v}),i},reset:function(){}},l=(0,r.default)(t).getInstance().getLogger(i),i}u.__dashjs_factory_name="ThroughputRule",t.default=i.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(8)),r=c(n(10)),a=c(n(2)),o=c(n(9)),s=c(n(19)),l=c(n(7)),u=c(n(16));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),a=e.dashMetrics,c=void 0,h=void 0,d=void 0;function f(){(d={})[l.default.VIDEO]={ignoreCount:2},d[l.default.AUDIO]={ignoreCount:2}}function p(){f()}function m(e){isNaN(e.startTime)||e.mediaType!==l.default.AUDIO&&e.mediaType!==l.default.VIDEO||d[e.mediaType].ignoreCount>0&&d[e.mediaType].ignoreCount--}return c={getMaxIndex:function(e){var n=(0,s.default)(t).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!a||!a.hasOwnProperty("getCurrentBufferLevel")||!a.hasOwnProperty("getCurrentBufferState"))throw new Error(l.default.MISSING_CONFIG_ERROR)}();var i=e.getMediaType(),r=a.getCurrentBufferState(i),o=e.getRepresentationInfo().fragmentDuration;if(function(e){return d[e].ignoreCount>0}(i)||!o)return n;if(r&&r.state===u.default.BUFFER_EMPTY)h.debug("["+i+"] Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var c=e.getMediaInfo(),f=e.getAbrController(),p=f.getThroughputHistory(),m=a.getCurrentBufferLevel(i),g=p.getAverageThroughput(i),v=p.getAverageLatency(i),y=g*(m/o)*.5;n.quality=f.getQualityForBitrate(c,y,v),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){f(),n.off(r.default.PLAYBACK_SEEKING,p,c),n.off(r.default.BYTES_APPENDED_END_FRAGMENT,m,c)}},h=(0,o.default)(t).getInstance().getLogger(c),f(),n.on(r.default.PLAYBACK_SEEKING,p,c),n.on(r.default.BYTES_APPENDED_END_FRAGMENT,m,c),c}h.__dashjs_factory_name="InsufficientBufferRule",t.default=a.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(19)),r=o(n(2)),a=o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,r=e.dashMetrics,o=e.settings,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0;function f(){c={},h={},d=[]}return l={shouldAbandon:function(e){var a=(0,i.default)(t).create(i.default.NO_CHANGE,{name:s.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return a;var l=e.getMediaInfo(),f=e.getMediaType(),p=e.getCurrentRequest();if(!isNaN(p.index)){!function(e,t){c[e]=c[e]||{},c[e][t]=c[e][t]||{}}(f,p.index);var m=n.getStableBufferTime();if(r.getCurrentBufferLevel(f)>m)return a;var g=c[f][p.index];if(null===g||null===p.firstByteDate||h.hasOwnProperty(g.id))return a;if(void 0===g.firstByteTime&&(d[f]=[],g.firstByteTime=p.firstByteDate.getTime(),g.segmentDuration=p.duration,g.bytesTotal=p.bytesTotal,g.id=p.index),g.bytesLoaded=p.bytesLoaded,g.elapsedTime=(new Date).getTime()-g.firstByteTime,g.bytesLoaded>0&&g.elapsedTime>0&&function(e,t){d[e]=d[e]||[],d[e].push(t)}(f,Math.round(8*g.bytesLoaded/g.elapsedTime)),d[f].length>=5&&g.elapsedTime>500&&g.bytesLoaded<g.bytesTotal){var v=d[f].reduce((function(e,t){return e+t}),0);if(g.measuredBandwidthInKbps=Math.round(v/d[f].length),g.estimatedTimeOfDownload=+(8*g.bytesTotal/g.measuredBandwidthInKbps/1e3).toFixed(2),g.estimatedTimeOfDownload<1.8*g.segmentDuration||0===e.getRepresentationInfo().quality)return a;if(!h.hasOwnProperty(g.id)){var y=e.getAbrController(),_=g.bytesTotal-g.bytesLoaded,b=y.getBitrateList(l),E=y.getQualityForBitrate(l,g.measuredBandwidthInKbps*o.get().streaming.abr.bandwidthSafetyFactor),T=y.getMinAllowedIndexFor(f),w=void 0!==T?Math.max(T,E):E;_>g.bytesTotal*b[w].bitrate/b[y.getQualityFor(f)].bitrate&&(a.quality=w,a.reason.throughput=g.measuredBandwidthInKbps,a.reason.fragmentID=g.id,h[g.id]=g,u.debug("["+f+"] frag id",g.id," is asking to abandon and switch to quality to ",w," measured bandwidth was",g.measuredBandwidthInKbps),delete c[f][g.id])}}else g.bytesLoaded===g.bytesTotal&&delete c[f][g.id]}return a},reset:f},u=(0,a.default)(t).getInstance().getLogger(l),f(),l}s.__dashjs_factory_name="AbandonRequestsRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(19)),a=o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){var i=(0,r.default)(e).create();if(!t||!t.hasOwnProperty("getDroppedFramesHistory"))return i;var a=t.getDroppedFramesHistory();if(a){for(var o=a.getFrameHistory(),s=0,l=0,u=r.default.NO_CHANGE,c=1;c<o.length;c++)if(o[c]&&(s=o[c].droppedVideoFrames,(l=o[c].totalVideoFrames)>375&&s/l>.15)){u=c-1,n.debug("index: "+u+" Dropped Frames: "+s+" Total Frames: "+l);break}return(0,r.default)(e).create(u,{droppedFrames:s})}return i}},n=(0,a.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="DroppedFramesRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(9)),a=o(n(19));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){for(var i=t?t.getSwitchHistory():null,r=i?i.getSwitchRequests():[],o=0,s=0,l=0,u=(0,a.default)(e).create(),c=0;c<r.length;c++)if(void 0!==r[c]&&(o+=r[c].drops,s+=r[c].noDrops,l+=r[c].dropSize,o+s>=6&&o/s>.075)){u.quality=c>0&&r[c].drops>0?c-1:c,u.reason={index:u.quality,drops:o,noDrops:s,dropSize:l},n.debug("Switch history rule index: "+u.quality+" samples: "+(o+s)+" drops: "+o);break}return u}},n=(0,r.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="SwitchHistoryRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(16)),r=c(n(19)),a=c(n(2)),o=n(14),s=c(n(8)),l=c(n(10)),u=c(n(9));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=e.dashMetrics,a=e.mediaPlayerModel,c=(0,s.default)(t).getInstance(),h=void 0,d=void 0,f=void 0;function p(e,t,n){var i=n.reduce((function(e,t,i){return t>n[e]?i:e}),0);if(0===i)return null;var r=Math.max(e,10+2*t.length),a=(n[i]-1)/(r/10-1);return{gp:a,Vp:10/a}}function m(e){var t={},n=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),i=function(e){return e.map((function(e){return Math.log(e)}))}(n);i=i.map((function(e){return e-i[0]+1}));var r=a.getStableBufferTime(),o=p(r,n,i);return o?(t.state=1,t.bitrates=n,t.utilities=i,t.stableBufferTime=r,t.Vp=o.Vp,t.gp=o.gp,t.lastQuality=0,g(t)):t.state=0,t}function g(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function v(e,t){var i=a.getStableBufferTime();if(e.stableBufferTime!==i){var r=p(i,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var o=n.getCurrentBufferLevel(t),s=o+e.placeholderBuffer;s-=10,s*=r.Vp/e.Vp,s+=10,e.stableBufferTime=i,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,s-o)}}}function y(e,t){return e.Vp*(e.utilities[t]+e.gp)}function _(e,t){for(var n=e.bitrates[t],i=e.utilities[t],r=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],l=e.Vp*(e.gp+(n*s-o*i)/(n-o));r=Math.max(r,l)}return r}function b(){for(var e in f)f.hasOwnProperty(e)&&2===f[e].state&&(f[e].placeholderBuffer=0)}function E(){for(var e in f)if(f.hasOwnProperty(e)){var t=f[e];0!==t.state&&(t.state=1,g(t))}}function T(){}function w(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=f[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,A(t,e.chunk.mediaInfo.type)}}}function x(e){if(e&&e.metric===i.default.HTTP_REQUEST&&e.value&&e.value.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=f[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),A(t,e.mediaType))}}function A(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var i=n.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=y(e,e.lastQuality),a=Math.max(0,r-i);e.placeholderBuffer=Math.min(a,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function S(e){if(e){var t=f[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function M(e){if(e){var t=f[e.mediaType];if(t&&0!==t.state){var i=n.getCurrentBufferLevel(e.mediaType),r=void 0;r=t.abrQuality>0?_(t,t.abrQuality):10;var a=Math.max(0,r-i);t.placeholderBuffer=Math.min(t.placeholderBuffer,a)}}}function C(){f={}}return h={getMaxIndex:function(e){var i=(0,r.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return i;var a=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),l=e.getStreamInfo(),u=e.getAbrController(),c=u.getThroughputHistory(),h=l?l.id:null,p=l&&l.manifestInfo&&l.manifestInfo.isDynamic,b=e.useBufferOccupancyABR();if(i.reason=i.reason||{},!b)return i;s.setTimeToLoadDelay(0);var E=function(e){var t=e.getMediaType(),n=f[t];return n?0!==n.state&&v(n,t):(n=m(e),f[t]=n),n}(e);if(0===E.state)return i;var T=n.getCurrentBufferLevel(o),w=c.getAverageThroughput(o,p),x=c.getSafeAverageThroughput(o,p),A=c.getAverageLatency(o),S=void 0;if(i.reason.state=E.state,i.reason.throughput=w,i.reason.latency=A,isNaN(w))return i;switch(E.state){case 1:S=u.getQualityForBitrate(a,x,A),i.quality=S,i.reason.throughput=x,E.placeholderBuffer=Math.max(0,_(E,S)-T),E.lastQuality=S,!isNaN(E.lastSegmentDurationS)&&T>=E.lastSegmentDurationS&&(E.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var i=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,i)}}else{var r=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,r)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,v(e,t)}(E,o),S=function(e,t){for(var n=e.bitrates.length,i=NaN,r=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(r)||o>=r)&&(r=o,i=a)}return i}(E,T+E.placeholderBuffer);var M=u.getQualityForBitrate(a,x,A);S>E.lastQuality&&S>M&&(S=Math.max(M,E.lastQuality));var C=Math.max(0,T+E.placeholderBuffer-y(E,S));C<=E.placeholderBuffer?(E.placeholderBuffer-=C,C=0):(C-=E.placeholderBuffer,E.placeholderBuffer=0,S<u.getTopQualityIndexFor(o,h)?s.setTimeToLoadDelay(1e3*C):C=0),i.quality=S,i.reason.throughput=w,i.reason.latency=A,i.reason.bufferLevel=T,i.reason.placeholderBuffer=E.placeholderBuffer,i.reason.delay=C,E.lastQuality=S;break;default:d.debug("BOLA ABR rule invoked in bad state."),i.quality=u.getQualityForBitrate(a,x,A),i.reason.state=E.state,i.reason.throughput=x,i.reason.latency=A,E.state=1,g(E)}return i},reset:function(){C(),c.off(l.default.BUFFER_EMPTY,b,h),c.off(l.default.PLAYBACK_SEEKING,E,h),c.off(l.default.PERIOD_SWITCH_STARTED,T,h),c.off(l.default.MEDIA_FRAGMENT_LOADED,w,h),c.off(l.default.METRIC_ADDED,x,h),c.off(l.default.QUALITY_CHANGE_REQUESTED,S,h),c.off(l.default.FRAGMENT_LOADING_ABANDONED,M,h)}},d=(0,u.default)(t).getInstance().getLogger(h),C(),c.on(l.default.BUFFER_EMPTY,b,h),c.on(l.default.PLAYBACK_SEEKING,E,h),c.on(l.default.PERIOD_SWITCH_STARTED,T,h),c.on(l.default.MEDIA_FRAGMENT_LOADED,w,h),c.on(l.default.METRIC_ADDED,x,h),c.on(l.default.QUALITY_CHANGE_REQUESTED,S,h),c.on(l.default.FRAGMENT_LOADING_ABANDONED,M,h),h}h.__dashjs_factory_name="BolaRule",t.default=a.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).abrController,n=e.switchHistory,i=e.droppedFramesHistory,r=e.currentRequest,a=e.useBufferOccupancyABR,o=e.streamProcessor?e.streamProcessor.getScheduleController():null,s=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;function l(){return s?s.mediaInfo:null}return{getMediaType:function(){var e=l();return e?e.type:null},getMediaInfo:l,getDroppedFramesHistory:function(){return i},getCurrentRequest:function(){return r},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=l();return e?e.streamInfo:null},getScheduleController:function(){return o},getAbrController:function(){return t},getRepresentationInfo:function(){return s},useBufferOccupancyABR:function(){return a}}}o.__dashjs_factory_name="RulesContext",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(19));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[],t=[];return{push:function(n){n.newValue===r.default.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var i=n.newValue-n.oldValue,a=i<0?1:0,o=a?-i:0,s=a?0:1;if(e[n.oldValue].drops+=a,e[n.oldValue].dropSize+=o,e[n.oldValue].noDrops+=s,t.push({idx:n.oldValue,noDrop:s,drop:a,dropSize:o}),t.length>8){var l=t.shift();e[l.idx].drops-=l.drop,e[l.idx].dropSize-=l.dropSize,e[l.idx].noDrops-=l.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var s=i.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e=[],t=0,n=0;return{push:function(i,r){var a=r&&r.droppedVideoFrames?r.droppedVideoFrames:0,o=r&&r.totalVideoFrames?r.totalVideoFrames:0,s=a-t;t=a;var l=o-n;n=o,isNaN(i)||(e[i]?(e[i].droppedVideoFrames+=s,e[i].totalVideoFrames+=l):e[i]={droppedVideoFrames:s,totalVideoFrames:l})},getFrameHistory:function(){return e},reset:function(i){e=[],t=i.droppedVideoFrames,n=i.totalVideoFrames}}}o.__dashjs_factory_name="DroppedFramesHistory";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(7)),r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).settings,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0;function l(e,t,n,i){var r=Math.pow(.5,n/i.fast);e.fastEstimate=(1-r)*t+r*e.fastEstimate;var a=Math.pow(.5,n/i.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function u(e,l,u){return t.get().streaming.abr.movingAverageMethod!==i.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?s.throughputHalfLife:s.latencyHalfLife,i=e?a[t]:o[t];if(!i||i.totalWeight<=0)return NaN;var r=i.fastEstimate/(1-Math.pow(.5,i.totalWeight/n.fast)),l=i.slowEstimate/(1-Math.pow(.5,i.totalWeight/n.slow));return e?Math.min(r,l):Math.max(r,l)}(e,l):function(e,t,i){var a=function(e,t,i){var a=void 0,o=void 0;if(e?(a=n[t],o=i?3:4):(a=r[t],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var l=a[a.length-s]/a[a.length-s-1];if((l>=1.3||l<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,t,i),o=(e?n:r)[t];if(0===a||!o||0===o.length)return NaN;return(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length}(e,l,u)}function c(e,t){return u(!0,e,t)}function h(e){n[e]=n[e]||[],r[e]=r[e]||[],a[e]=a[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[e]=o[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function d(){n={},r={},a={},o={}}var f={push:function(e,u,c){if(u.trace&&u.trace.length){var d=u.tresponse.getTime()-u.trequest.getTime()||1,f=u._tfinish.getTime()-u.tresponse.getTime()||1,p=u.trace.reduce((function(e,t){return e+t.b[0]}),0),m=void 0;m=t.get().streaming.lowLatencyEnabled?u.trace.reduce((function(e,t){return e+t.d}),0):c?f:d+f;var g=Math.round(8*p/m);if(h(e),function(e,n,r){return e===i.default.VIDEO?r<t.get().streaming.cacheLoadThresholds[i.default.VIDEO]:e===i.default.AUDIO?r<t.get().streaming.cacheLoadThresholds[i.default.AUDIO]:void 0}(e,0,f)){if(n[e].length>0&&!n[e].hasCachedEntries)return;n[e].hasCachedEntries=!0}else n[e]&&n[e].hasCachedEntries&&function(e){delete n[e],delete r[e],delete a[e],delete o[e],h(e)}(e);n[e].push(g),n[e].length>20&&n[e].shift(),r[e].push(d),r[e].length>20&&r[e].shift(),l(a[e],g,.001*f,s.throughputHalfLife),l(o[e],d,1,s.latencyHalfLife)}},getAverageThroughput:c,getSafeAverageThroughput:function(e,n){var i=c(e,n);return isNaN(i)||(i*=t.get().streaming.abr.bandwidthSafetyFactor),i},getAverageLatency:function(e){return u(!1,e)},reset:d};return s={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},d(),f}o.__dashjs_factory_name="ThroughputHistory",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(7)),r=s(n(2)),a=s(n(80)),o=s(n(167));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t,n=this.context,r=void 0;function s(){return r.getBuffer()}return t={getBufferControllerType:function(){return r.getBufferControllerType()},initialize:function(e,t){return r.initialize(e,t)},createBuffer:function(e){return r.createBuffer(e)},getType:function(){return r.getType()},getBuffer:s,setBuffer:function(e){r.setBuffer(e)},getBufferLevel:function(){return r.getBufferLevel()},setMediaSource:function(e){r.setMediaSource(e)},getMediaSource:function(){return r.getMediaSource()},getIsBufferingCompleted:function(){return r.getIsBufferingCompleted()},getIsPruningInProgress:function(){return r.getIsPruningInProgress()},dischargePreBuffer:function(){return r.dischargePreBuffer()},appendInitSegment:function(e){r.appendInitSegment(e)},getRangeAt:function(e){return r.getRangeAt(e)},reset:function(e){r.reset(e)},updateTimestampOffset:function(e){var t=s();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)}},r=e.type===i.default.FRAGMENTED_TEXT?(0,a.default)(n).create({streamInfo:e.streamInfo,type:e.type,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,fragmentModel:e.fragmentModel,errHandler:e.errHandler,mediaController:e.mediaController,representationController:e.representationController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,settings:e.settings}):(0,o.default)(n).create({streamInfo:e.streamInfo,type:e.type,mimeType:e.mimeType,fragmentModel:e.fragmentModel,errHandler:e.errHandler}),t}l.__dashjs_factory_name="TextBufferController",t.default=r.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(7)),r=d(n(8)),a=d(n(10)),o=d(n(2)),s=d(n(59)),l=d(n(81)),u=d(n(50)),c=d(n(12)),h=d(n(15));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=(0,r.default)(t).getInstance(),o=(0,u.default)(t).getInstance(),d=e.errHandler,f=e.streamInfo,p=e.type,m=e.mimeType,g=e.fragmentModel,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function w(e){b=e}function x(e){e.sender.getStreamId()!==f.id||e.sender.getType()!==p||e.error||null===T.extract(f.id,e.currentRepresentation.id)&&(y=!1,n.trigger(a.default.INIT_FRAGMENT_NEEDED,{sender:v,streamId:f.id,mediaType:p,representationId:e.currentRepresentation.id}))}function A(e){e.chunk.streamId===f.id&&e.chunk.mediaInfo.type===p&&e.chunk.bytes&&(T.save(e.chunk),E.append(e.chunk),y=!0,n.trigger(a.default.STREAM_COMPLETED,{request:e.request}))}return v={getBufferControllerType:function(){return"NotFragmentedTextBufferController"},initialize:function(e){w(e),T=(0,s.default)(t).getInstance()},createBuffer:function(e){var n=e[0];try{if(E=(0,l.default)(t).create(b,n),!_){var r=E.getBuffer();r.hasOwnProperty(i.default.INITIALIZE)&&r.initialize(m,f,e,g),_=!0}return E}catch(e){if(n&&(n.isText||-1!==n.codec.indexOf('codecs="stpp')||-1!==n.codec.indexOf('codecs="wvtt')))try{E=o.getTextSourceBuffer()}catch(e){d.error(new c.default(h.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,h.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p+" : "+e.message))}else d.error(new c.default(h.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,h.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p))}},getType:function(){return p},getBuffer:function(){return E},getBufferLevel:function(){return 0},setMediaSource:w,getMediaSource:function(){return b},getIsBufferingCompleted:function(){return y},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},appendInitSegment:function(e){return null!==T.extract(f.id,e)},getRangeAt:function(){return null},reset:function(e){n.off(a.default.DATA_UPDATE_COMPLETED,x,v),n.off(a.default.INIT_FRAGMENT_LOADED,A,v),!e&&E&&(E.abort(),E.reset(),E=null)},updateTimestampOffset:function(e){E.timestampOffset===e||isNaN(e)||(E.timestampOffset=e)}},_=!1,b=null,y=!1,n.on(a.default.DATA_UPDATE_COMPLETED,x,v),n.on(a.default.INIT_FRAGMENT_LOADED,A,v),v}f.__dashjs_factory_name="NotFragmentedTextBufferController",t.default=o.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(7)),r=d(n(16)),a=d(n(169)),o=d(n(29)),s=d(n(8)),l=d(n(10)),u=d(n(2)),c=d(n(9)),h=d(n(58));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),u=e.adapter,d=e.dashMetrics,f=e.mediaPlayerModel,p=e.fragmentModel,m=e.abrController,g=e.playbackController,v=e.textController,y=e.streamId,_=e.type,b=e.mimeType,E=e.mediaController,T=e.bufferController,w=e.settings,x=void 0,A=void 0,S=void 0,M=void 0,C=void 0,R=void 0,I=void 0,P=void 0,L=void 0,D=void 0,O=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,z=void 0,H=void 0;function V(){return!1===C}function W(){V()||S&&!T.getIsBufferingCompleted()&&(A.debug("Schedule Controller starts"),C=!1,d.createPlaylistTraceMetrics(S.id,1e3*g.getTime(),g.getPlaybackRate()),M&&(M=!1),X(0))}function q(){C||(A.debug("Schedule Controller stops"),C=!0,clearTimeout(P))}function Y(){if(C||R||g.isPaused()&&!w.get().streaming.scheduleWhilePaused||(_===i.default.FRAGMENTED_TEXT||_===i.default.TEXT)&&!v.isTextEnabled()||T.getIsBufferingCompleted())q();else{!function(){var e=g.getTime(),t=1.5;if(isNaN(S.fragmentDuration)){var n=d.getCurrentSchedulingInfo(S.mediaInfo.type);t=n?1.5*n.duration:1.5}var i=p.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(i&&-1===B.indexOf(i)&&!u.getIsTextTrack(b)){var a=w.get().streaming.fastSwitchEnabled,s=T.getBufferLevel(),l=m.getAbandonmentStateFor(_),c=!E.isCurrentTrack(i.mediaInfo)&&E.getSwitchMode(i.mediaInfo.type)===h.default.TRACK_SWITCH_MODE_NEVER_REPLACE,f=i.quality<S.quality;a&&(c||f)&&s>=t&&l!==r.default.ABANDON_LOAD?(Q(i),H=!0,A.debug("Reloading outdated fragment at index: ",i.index)):i.quality>S.quality&&!j&&he(g.getTime()+s)}}();var e=B.length>0;if(j||isNaN(F)||U||e||function(e,t){k[t]=k[t]||{};var n=m.getTopQualityIndexFor(e,t);return k[t][e]!=n&&(A.info("Top quality "+e+" index has changed from "+k[t][e]+" to "+n),k[t][e]=n,!0)}(_,y)||O.execute(_,S,D)){K(!0),!e&&z&&m.checkPlaybackQuality(_),function(){if(S.quality===F&&!U||j){var e=B.shift();e&&e.isInitializationRequest()?(n.trigger(l.default.INIT_FRAGMENT_NEEDED,{sender:x,streamId:y,mediaType:_,representationId:e.representationId}),z=!1):(n.trigger(l.default.MEDIA_FRAGMENT_NEEDED,{sender:x,streamId:y,mediaType:_,seekTarget:L,replacement:e}),z=!0)}else U?(A.debug("Switch track for "+_+", representation id = "+S.id),(j=E.getSwitchMode(_)===h.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&T.replaceBuffer&&T.replaceBuffer(),U=!1):A.debug("Quality has changed, get init request for representationid = "+S.id),n.trigger(l.default.INIT_FRAGMENT_NEEDED,{sender:x,streamId:y,mediaType:_,representationId:S.id}),F=S.quality,z=!1}()}else X(500)}}function X(e){clearTimeout(P),P=setTimeout(Y,e)}function K(e){R!==e?R=e:A.debug("isFragmentProcessingInProgress is already equal to",e)}function Q(e){B.push(e)}function Z(e){if(g&&p){var t=p.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:g.getTime(),threshold:0})[0];t&&g.getTime()>=t.startTime&&((!N.mediaInfo||t.mediaInfo.type===N.mediaInfo.type&&t.mediaInfo.id!==N.mediaInfo.id)&&e&&n.trigger(l.default.TRACK_CHANGE_RENDERED,{mediaType:_,oldMediaInfo:N.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===N.quality&&t.adaptationIndex===N.adaptationIndex||!e||n.trigger(l.default.QUALITY_CHANGE_RENDERED,{mediaType:_,oldQuality:N.quality,newQuality:t.quality}),N={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function J(e){e.request.mediaInfo.streamInfo.id===y&&e.request.mediaType===_&&(q(),K(!1),A.info("Stream is complete"))}function $(e){e.request.mediaInfo.streamInfo.id===y&&e.request.mediaType===_&&(A.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),u.getIsTextTrack(b)&&K(!1),e.error&&e.request.serviceLocation&&!C&&(Q(e.request),K(!1),X(0)),j&&(G=e.request))}function ee(){Z(!0)}function te(e){if(e.streamId===y&&e.mediaType===_)if(j&&!isNaN(e.startTime)&&(j=!1,p.addExecutedRequest(G)),K(!1),H&&!isNaN(e.startTime)){var t=g.getTime(),n=e.startTime+S.fragmentDuration,i=1.5*S.fragmentDuration;X(t+i>=n?0:1e3*(n-(t+i))),H=!1}else X(0)}function ne(e){e.streamId===y&&e.mediaType===_&&(A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),g.isSeeking()||U||(A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),Q(e.request)),K(!1),X(0))}function ie(e){e.sender.getType()===_&&e.sender.getStreamId()}function re(e){_===e.mediaType&&y===e.streamId&&q()}function ae(e){e.streamId===y&&e.mediaType===_&&e.hasEnoughSpaceToAppend&&e.quotaExceeded&&C&&W()}function oe(e){e.streamId===y&&e.mediaType===_&&(q(),K(!1))}function se(){p.abortRequests(),q()}function le(){!C&&w.get().streaming.scheduleWhilePaused||W()}function ue(e){he(e.seekTime),de(0),C&&W();var t=S.DVRWindow&&g?S.DVRWindow.end-g.getTime():NaN;d.updateManifestUpdateInfo({latency:t}),R?(A.debug("Abort requests"),p.abortRequests()):X(0)}function ce(e){d.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function he(e){L=e}function de(e){I=e}function fe(){z=!0,R=!1,I=0,L=NaN,M=!0,F=NaN,N={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},k={},B=[],C=!0,U=!1,j=!1,G=null,H=!1}return x={initialize:function(e){D=e,O=(0,a.default)(t).create({abrController:m,dashMetrics:d,mediaPlayerModel:f,textController:v,settings:w}),n.on(l.default.DATA_UPDATE_STARTED,ie,this),n.on(l.default.FRAGMENT_LOADING_COMPLETED,$,this),n.on(l.default.STREAM_COMPLETED,J,this),n.on(l.default.BUFFER_CLEARED,ae,this),n.on(l.default.BYTES_APPENDED_END_FRAGMENT,te,this),n.on(l.default.QUOTA_EXCEEDED,oe,this),n.on(l.default.PLAYBACK_SEEKING,ue,this),n.on(l.default.PLAYBACK_STARTED,le,this),n.on(l.default.PLAYBACK_RATE_CHANGED,ce,this),n.on(l.default.PLAYBACK_TIME_UPDATED,ee,this),n.on(l.default.URL_RESOLUTION_FAILED,se,this),n.on(l.default.FRAGMENT_LOADING_ABANDONED,ne,this),n.on(l.default.BUFFERING_COMPLETED,re,this)},getType:function(){return _},getStreamId:function(){return y},setCurrentRepresentation:function(e){S=e},setSeekTarget:he,setTimeToLoadDelay:de,getTimeToLoadDelay:function(){return I},switchTrackAsked:function(){U=!0},isStarted:V,start:W,stop:q,reset:function(){n.off(l.default.DATA_UPDATE_STARTED,ie,this),n.off(l.default.FRAGMENT_LOADING_COMPLETED,$,this),n.off(l.default.STREAM_COMPLETED,J,this),n.off(l.default.BUFFER_CLEARED,ae,this),n.off(l.default.BYTES_APPENDED_END_FRAGMENT,te,this),n.off(l.default.QUOTA_EXCEEDED,oe,this),n.off(l.default.PLAYBACK_SEEKING,ue,this),n.off(l.default.PLAYBACK_STARTED,le,this),n.off(l.default.PLAYBACK_RATE_CHANGED,ce,this),n.off(l.default.PLAYBACK_TIME_UPDATED,ee,this),n.off(l.default.URL_RESOLUTION_FAILED,se,this),n.off(l.default.FRAGMENT_LOADING_ABANDONED,ne,this),n.off(l.default.BUFFERING_COMPLETED,re,this),q(),Z(!1),fe()},getBufferTarget:function(){return O.getBufferTarget(_,S,D)},processInitRequest:function(e){e&&(K(!0),p.executeRequest(e))},processMediaRequest:function(e){e?(A.debug("Next fragment request url is "+e.url),p.executeRequest(e)):(g.getIsDynamic()&&A.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),K(!1),X(w.get().streaming.lowLatencyEnabled?100:500))}},A=(0,c.default)(t).getInstance().getLogger(x),fe(),x}f.__dashjs_factory_name="ScheduleController",t.default=u.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(7)),r=o(n(2)),a=o(n(16));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).dashMetrics,n=e.mediaPlayerModel,r=e.textController,o=e.abrController,s=e.settings;function l(e,l,u){var c=NaN;if(!e||!l)return c;if(e===i.default.FRAGMENTED_TEXT)if(r.isTextEnabled())if(isNaN(l.fragmentDuration)){var h=t.getCurrentSchedulingInfo(a.default.SCHEDULING_INFO);c=h?h.duration:0}else c=l.fragmentDuration;else c=0;else if(e===i.default.AUDIO&&u){var d=t.getCurrentBufferLevel(i.default.VIDEO);c=isNaN(l.fragmentDuration)?d:Math.max(d,l.fragmentDuration)}else{var f=l.mediaInfo.streamInfo;if(o.isPlayingAtTopQuality(f))c=f.manifestInfo.duration>=s.get().streaming.longFormContentDurationThreshold?s.get().streaming.bufferTimeAtTopQualityLongForm:s.get().streaming.bufferTimeAtTopQuality;else c=n.getStableBufferTime()}return c}return{execute:function(e,n,i){return!e||!n||t.getCurrentBufferLevel(e)<l(e,n,i)},getBufferTarget:l}}s.__dashjs_factory_name="BufferLevelRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(7)),r=o(n(12)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).eventBus,n=e.events,a=e.errors,o=e.abrController,s=e.dashMetrics,l=e.playbackController,u=e.timelineConverter,c=e.type,h=e.streamId,d=e.dashConstants,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){if(!(o&&s&&l&&u))throw new Error(i.default.MISSING_CONFIG_ERROR)}function _(){return m}function b(){return v}function E(){p=null,m=!0,g=[]}function T(){return c}function w(){y();var e=new Date,t=b(),n=1e3*l.getTime();t&&s.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function x(e){return null==e||e>=g.length?null:g[e]}function A(e,t){var n;(e.segmentAvailabilityRange=u.calcSegmentAvailabilityRange(e,t),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)?C(new r.default(a.SEGMENTS_UNAVAILABLE_ERROR_CODE,a.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end})):t&&(n=e.segmentAvailabilityRange.end,u.setExpectedLiveEdge(n),s.updateManifestUpdateInfo({presentationStartTime:n}))}function S(e,i){y();for(var r=0,a=g.length;r<a;r++)A(g[r],e),i&&t.trigger(n.REPRESENTATION_UPDATE_STARTED,{sender:f,representation:g[r]})}function M(){m=!0,t.trigger(n.DATA_UPDATE_STARTED,{sender:f})}function C(e){m=!1;var i={sender:f,data:p,currentRepresentation:v};e&&(i.error=e),t.trigger(n.DATA_UPDATE_COMPLETED,i)}function R(e){var i=e;t.trigger(n.AST_IN_FUTURE,{delay:i}),setTimeout((function(){_()||(M(),g.forEach((function(e){e.segmentAvailabilityRange=null})),S(l.getIsDynamic(),!0))}),i)}function I(e){if(e.sender.getType()===T()&&e.sender.getStreamInfo().id===h&&_())if(e.error)C(e.error);else{var t,n=e.sender.getStreamInfo(),i=e.representation,u=s.getCurrentManifestUpdate(),c=!1,f=0,p=void 0;if(i.adaptation.period.mpd.manifest.type!==d.DYNAMIC||i.adaptation.period.mpd.manifest.ignorePostponeTimePeriod||(f=function(e,t){try{var n=l.getStreamController().getActiveStreamInfo(),i=e.segmentAvailabilityRange.start;n&&n.id&&n.id!==t.id&&(i=Math.min(l.getTime(),i));var r=e.segmentAvailabilityRange.end-i;return 1e3*(l.getLiveDelay()-r)}catch(e){return 0}}(i,n)),f>0)return R(f),void C(new r.default(a.SEGMENTS_UPDATE_FAILED_ERROR_CODE,a.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(u){for(var m=0;m<u.representationInfo.length;m++)if((p=u.representationInfo[m]).index===i.index&&p.mediaType===T()){c=!0;break}c||s.addManifestUpdateRepresentationInfo(i,T())}(function(){for(var e=0,t=g.length;e<t;e++){var n=g[e].segmentInfoType;if(null===g[e].segmentAvailabilityRange||!g[e].hasInitialization()||(n===d.SEGMENT_BASE||n===d.BASE_URL)&&!g[e].segments)return!1}return!0})()&&(o.setPlaybackQuality(T(),n,(t=v,g.indexOf(t))),s.updateManifestUpdateInfo({latency:v.segmentAvailabilityRange.end-l.getTime()}),s.getCurrentRepresentationSwitch(b().adaptation.type)||w(),C())}}function P(e){e.isDynamic&&S(e.isDynamic)}function L(e){e.mediaType===T()&&h===e.streamInfo.id&&(v=x(e.newQuality),w())}function D(e){if(e.newDuration){var t=b();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return f={getData:function(){return p},isUpdating:_,updateData:function(e,t,n,r){y(),M(),g=t,v=x(r),p=e,n===i.default.VIDEO||n===i.default.AUDIO||n===i.default.FRAGMENTED_TEXT?S(l.getIsDynamic(),!0):C()},updateRepresentation:A,getCurrentRepresentation:b,getRepresentationForQuality:x,getType:T,getStreamId:function(){return h},reset:function(){t.off(n.QUALITY_CHANGE_REQUESTED,L,f),t.off(n.REPRESENTATION_UPDATE_COMPLETED,I,f),t.off(n.WALLCLOCK_TIME_UPDATED,P,f),t.off(n.MANIFEST_VALIDITY_CHANGED,D,f),E()}},E(),t.on(n.QUALITY_CHANGE_REQUESTED,L,f),t.on(n.REPRESENTATION_UPDATE_COMPLETED,I,f),t.on(n.WALLCLOCK_TIME_UPDATED,P,f),t.on(n.MANIFEST_VALIDITY_CHANGED,D,f),f}s.__dashjs_factory_name="RepresentationController",t.default=a.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(7));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;return{getLiveEdge:function(e){!function(){if(!t||!t.hasOwnProperty("getExpectedLiveEdge"))throw new Error(r.default.MISSING_CONFIG_ERROR)}();var n=e.DVRWindow?e.DVRWindow.end:0,i=n;return e.useCalculatedLiveEdgeTime&&(i=t.getExpectedLiveEdge(),t.setClientTimeOffset(i-n)),i},reset:function(){t=null}}}o.__dashjs_factory_name="LiveEdgeFinder",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(2)),r=l(n(173)),a=l(n(174)),o=l(n(175)),s=l(n(176));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t,n=this.context,i=e.events,l=e.eventBus,u=e.dashConstants,c=void 0;function h(e){return e?e.segments?c[u.SEGMENT_BASE]:c[e.segmentInfoType]:null}return t={initialize:function(t){c[u.SEGMENT_TIMELINE]=(0,r.default)(n).create(e,t),c[u.SEGMENT_TEMPLATE]=(0,a.default)(n).create(e,t),c[u.SEGMENT_LIST]=(0,o.default)(n).create(e,t),c[u.SEGMENT_BASE]=(0,s.default)(n).create(e,t)},update:function(e,t,n,r,a){r||l.trigger(i.SEGMENTBASE_INIT_REQUEST_NEEDED,{mimeType:n,representation:e}),a||l.trigger(i.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:n,mediaType:t,representation:e})},getSegmentByIndex:function(e,t,n){var i=h(e);return i?i.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=h(e);return n?n.getSegmentByTime(e,t):null}},c={},t}u.__dashjs_factory_name="SegmentsController";var c=i.default.getClassFactory(u);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(7)),a=n(25);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcMediaTimeFromPresentationTime")||!n.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function o(e,i){var r,a,o,s=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,l=s.SegmentTimeline,u=s.SegmentURL_asArray,c=0,h=0,d=-1,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0;o=e.timescale;var _=!1;for(p=0,a=(r=l.S_asArray).length;p<a&&!_;p++){if(g=0,(f=r[p]).hasOwnProperty("r")&&(g=f.r),f.hasOwnProperty("t")&&(h=(c=f.t)/o),g<0){if((y=r[p+1])&&y.hasOwnProperty("t"))v=y.t/o;else{var b=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;v=n.calcMediaTimeFromPresentationTime(b,e),e.segmentDuration=f.d/o}g=Math.ceil((v-h)/(f.d/o))-1}for(m=0;m<=g&&!_;m++)(_=i(c,h,s,u,f,o,++d,p))&&(e.segmentDuration=f.d/o,(m<g-1||p<a-1)&&d++),h=(c+=f.d)/o}e.availableSegmentsNumber=d}return{getSegmentByIndex:function(e,r,s){if(i(),!e)return null;var l=null,u=!1;return o(e,(function(i,r,o,c,h,d,f,p){if(u||s<0){var m=o.media,g=h.mediaRange;return c&&(m=c[p].media||"",g=c[p].mediaRange),l=(0,a.getTimeBasedSegment)(n,t,e,i,h.d,d,m,g,f,h.tManifest),!0}return r>=s-.5*h.d/d&&(u=!0),!1})),l},getSegmentByTime:function(e,r){if(i(),!e)return null;void 0===r&&(r=null);var s=null,l=n.calcMediaTimeFromPresentationTime(r,e);return o(e,(function(i,r,o,u,c,h,d,f){if(l<r+c.d/h){var p=o.media,m=c.mediaRange;return u&&(p=u[f].media||"",m=u[f].mediaRange),s=(0,a.getTimeBasedSegment)(n,t,e,i,c.d,h,p,m,d,c.tManifest),!0}return!1})),s}}}s.__dashjs_factory_name="TimelineSegmentsGetter";var l=i.default.getClassFactory(s);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(7)),a=n(25);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function o(e,r){if(i(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;r=Math.max(r,0);var s=(0,a.getIndexBasedSegment)(n,t,e,r);if(s){s.replacementTime=(r-1)*e.segmentDuration;var l=o.media;l=(0,a.replaceTokenForTemplate)(l,"Number",s.replacementNumber),l=(0,a.replaceTokenForTemplate)(l,"Time",s.replacementTime),s.media=l}var u=e.segmentDuration,c=e.segmentAvailabilityRange;return isNaN(u)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((c.end-c.start)/u),s}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/r))}}}s.__dashjs_factory_name="TemplateSegmentsGetter";var l=i.default.getClassFactory(s);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(7)),a=n(25);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function i(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function o(e,r){if(i(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,l=e.startNumber,u=null;if(r<s){var c=o.SegmentURL_asArray[r];(u=(0,a.getIndexBasedSegment)(n,t,e,r))&&(u.replacementTime=(l+r-1)*e.segmentDuration,u.media=c.media?c.media:"",u.mediaRange=c.mediaRange,u.index=r,u.indexRange=c.indexRange)}return e.availableSegmentsNumber=s,u}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(i(),!e)return null;var r=e.segmentDuration;if(isNaN(r))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/r))}}}s.__dashjs_factory_name="ListSegmentsGetter";var l=i.default.getClassFactory(s);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(7));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(r.default.MISSING_CONFIG_ERROR)}function i(e,t){if(n(),!e)return null;var i=e.segments?e.segments.length:-1,r=void 0;if(t<i&&(r=e.segments[t])&&r.availabilityIdx===t)return r;for(var a=0;a<i;a++)if((r=e.segments[a])&&r.availabilityIdx===t)return r;return null}return{getSegmentByIndex:i,getSegmentByTime:function(e,r){return n(),i(e,function(e,t){if(!e)return-1;var n=e.segments,i=n?n.length:null,r=-1,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0;if(n&&i>0)for(u=0;u<i;u++)if(o=n[u],s=o.presentationStartTime,l=o.duration,t+(a=l/2)>=s&&t-a<s+l){r=o.availabilityIdx;break}return r}(e,t.calcPeriodRelativeTimeFromMpdRelativeTime(e,r)))}}}o.__dashjs_factory_name="SegmentBaseGetter";var s=i.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e=void 0,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,i=/^https:\/\//i,r=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;h(e)&&(n=l),d(e)&&(n=u);var i=n(t),r="/"!==i.charAt(i.length-1)&&"/"!==e.charAt(0)?"/":"";return[i,e].join(r)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function l(e){var t=e.match(r);return t?t[1]:""}function u(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function h(e){return c(e)&&"/"===e.charAt(0)}function d(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:h,isSchemeRelative:d,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return i.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}o.__dashjs_factory_name="DefaultURLUtils",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(7)),r=f(n(179)),a=f(n(29)),o=f(n(180)),s=f(n(61)),l=f(n(8)),u=f(n(10)),c=f(n(15)),h=f(n(2)),d=f(n(9));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){e=e||{};var t=this.context,n=(0,l.default)(t).getInstance(),h=e.errHandler,f=e.mediaPlayerModel,p=e.dashMetrics,m=(0,d.default)(t).getInstance(),g=void 0,v=void 0,y=void 0;function _(){for(var e in y)y[e].reset();y={}}function b(e){if(e.sender){var t=e.request,a=e.response,o=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==i.default.AUDIO&&e.request.mediaType!==i.default.VIDEO&&e.request.mediaType!==i.default.FRAGMENTED_TEXT||n.trigger(u.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),a&&s){var l=function(e,t,n,i){var a=new r.default;return a.streamId=n,a.mediaInfo=t.mediaInfo,a.segmentType=t.type,a.start=t.startTime,a.duration=t.duration,a.end=a.start+a.duration,a.bytes=e,a.index=t.index,a.quality=t.quality,a.representationId=t.representationId,a.endFragment=i,a}(a,t,s.id,e.type!==u.default.FRAGMENT_LOADING_PROGRESS);n.trigger(o?u.default.INIT_FRAGMENT_LOADED:u.default.MEDIA_FRAGMENT_LOADED,{chunk:l,request:t})}else v.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return g={getModel:function(i,r){var l=y[r];return l||(l=(0,a.default)(t).create({streamId:i,dashMetrics:p,fragmentLoader:(0,o.default)(t).create({dashMetrics:p,mediaPlayerModel:f,errHandler:h,requestModifier:(0,s.default)(t).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:n,events:u.default,errors:c.default,dashConstants:e.dashConstants,urlUtils:e.urlUtils}),debug:m,eventBus:n,events:u.default}),y[r]=l),l},reset:function(){n.off(u.default.FRAGMENT_LOADING_COMPLETED,b,this),n.off(u.default.FRAGMENT_LOADING_PROGRESS,b,this),_()}},v=m.getLogger(g),_(),n.on(u.default.FRAGMENT_LOADING_COMPLETED,b,g),n.on(u.default.FRAGMENT_LOADING_PROGRESS,b,g),g}p.__dashjs_factory_name="FragmentController",t.default=h.default.getClassFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(7)),r=l(n(32)),a=l(n(190)),o=l(n(12)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t=this.context,n=e.eventBus,s=e.events,l=e.urlUtils,u=e.errors,c=void 0,h=void 0;return c={checkForExistence:function(e){var t=function(t){n.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var i=new a.default(e.url);h.load({request:i,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var t=function(t,i){n.trigger(s.LOADING_COMPLETED,{request:e,response:t||null,error:i||null,sender:c})};e?h.load({request:e,progress:function(t){n.trigger(s.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&n.trigger(s.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:c})},success:function(e){t(e)},error:function(e,n,i){t(void 0,new o.default(u.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,i,n))},abort:function(e){e&&n.trigger(s.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:c})}}):t(void 0,new o.default(u.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,u.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){h&&h.abort()},reset:function(){h&&(h.abort(),h=null)}},h=(0,r.default)(t).create({errHandler:e.errHandler,errors:u,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:l,constants:i.default,boxParser:e.boxParser,dashConstants:e.dashConstants}),c}u.__dashjs_factory_name="FragmentLoader",t.default=s.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(63)),r=c(n(182)),a=n(14),o=c(n(2)),s=c(n(12)),l=c(n(95)),u=c(n(66));function c(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){e=e||{};var t,n,o=this.context,c=e.errHandler,d=e.dashMetrics,f=e.mediaPlayerModel,p=e.requestModifier,m=e.boxParser,g=e.useFetch||!1,v=e.errors,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function w(e,t){var n=e.request,l=[],h=!0,v=!0,x=new Date,A=x,S=0,M=void 0;if(!p||!d||!c)throw new Error("config object is not correct or missing");var C=function(e){v=!1,n.requestStartDate=x,n.requestEndDate=new Date,n.firstByteDate=n.firstByteDate||x,n.checkExistenceOnly||(d.addHttpRequest(n,M.response?M.response.responseURL:null,M.response?M.response.status:null,M.response&&M.response.getAllResponseHeaders?M.response.getAllResponseHeaders():M.response?M.response.responseHeaders:[],e?l:null),n.type===a.HTTPRequest.MPD_TYPE&&d.addManifestUpdate(n.type,n.requestStartDate,n.requestEndDate))},R=function(){if(-1!==y.indexOf(M)&&(y.splice(y.indexOf(M),1),v))if(C(!1),t>0){t--;var i={config:e};b.push(i),i.timeout=setTimeout((function(){-1!==b.indexOf(i)&&(b.splice(b.indexOf(i),1),w(e,t))}),f.getRetryIntervalsForType(n.type))}else c.error(new s.default(E[n.type],n.url+" is not available",{request:n,response:M.response})),e.error&&e.error(n,"error",M.response.statusText),e.complete&&e.complete(n,M.response.statusText)},I=void 0;I=g&&window.fetch&&"arraybuffer"===n.responseType&&n.type===a.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,r.default)(o).create({requestModifier:p,boxParser:m}):(0,i.default)(o).create({requestModifier:p});var P=p.modifyRequestURL(n.url),L=function(e){try{var t=[],n=T.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(n);P=u.default.addAditionalQueryParameterToUrl(P,L);var D=n.checkExistenceOnly?a.HTTPRequest.HEAD:a.HTTPRequest.GET,O=f.getXHRWithCredentialsForType(n.type);M={url:P,method:D,withCredentials:O,request:n,onload:function(){M.response.status>=200&&M.response.status<=299&&(C(!0),e.success&&e.success(M.response.response,M.response.statusText,M.response.responseURL),e.complete&&e.complete(n,M.response.statusText))},onend:R,onerror:R,progress:function(t){var i=new Date;h&&(h=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(n.firstByteDate=i)),t.lengthComputable&&(n.bytesLoaded=t.loaded,n.bytesTotal=t.total),t.noTrace||(l.push({s:A,d:t.time?t.time:i.getTime()-A.getTime(),b:[t.loaded?t.loaded-S:0]}),A=i,S=t.loaded),e.progress&&t&&e.progress(t)},onabort:function(){e.abort&&e.abort(n)},loader:I};var N=(new Date).getTime();if(isNaN(n.delayLoadingTime)||N>=n.delayLoadingTime)y.push(M),I.load(M);else{var k={httpRequest:M};_.push(k),k.delayTimeout=setTimeout((function(){if(-1!==_.indexOf(k)){_.splice(_.indexOf(k),1);try{x=new Date,A=x,y.push(k.httpRequest),I.load(k.httpRequest)}catch(e){k.httpRequest.onerror()}}}),n.delayLoadingTime-N)}}return t={load:function(e){e.request?w(e,f.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){b.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),b=[],_.forEach((function(e){return clearTimeout(e.delayTimeout)})),_=[],y.forEach((function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e)})),y=[]}},y=[],_=[],b=[],T=(0,l.default)(o).getInstance(),h(n={},a.HTTPRequest.MPD_TYPE,v.DOWNLOAD_ERROR_ID_MANIFEST_CODE),h(n,a.HTTPRequest.XLINK_EXPANSION_TYPE,v.DOWNLOAD_ERROR_ID_XLINK_CODE),h(n,a.HTTPRequest.INIT_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),h(n,a.HTTPRequest.MEDIA_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),h(n,a.HTTPRequest.INDEX_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),h(n,a.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),h(n,a.HTTPRequest.OTHER_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),E=n,t}d.__dashjs_factory_name="HTTPLoader";var f=o.default.getClassFactory(d);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).requestModifier,n=e.boxParser;function i(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function r(e,t){if((e=e.filter((function(n){return n.bytes>t/4/e.length}))).length>1){var n=0,i=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach((function(t,r){var a=e[r+1];if(a){var o=a.ts-t.ts;n+=o<i?o:0}})),n}return null}return{load:function(e){var a=new Date,o=e.request,s=new Headers;o.range&&s.append("Range","bytes="+o.range),o.requestStartDate||(o.requestStartDate=a),t&&t.modifyRequestHeader({setRequestHeader:function(e,t){s.append(e,t)}});var l=void 0;"function"==typeof window.AbortController&&(l=new AbortController,e.abortController=l,l.signal.onabort=e.onabort);var u={method:e.method,headers:s,credentials:e.withCredentials?"include":void 0,signal:l?l.signal:void 0};fetch(e.url,u).then((function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var a="",o=!0,s=!1,l=void 0;try{for(var u,c=t.headers.keys()[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;a+=h+": "+t.headers.get(h)+"\r\n"}}catch(e){s=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw l}}if(e.response.responseHeaders=a,!t.body)return t.arrayBuffer().then((function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()}));var d=parseInt(t.headers.get("Content-Length"),10),f=0,p=!1,m=new Uint8Array,g=0;e.reader=t.body.getReader();var v=[];i(e,(function t(a){var o=a.value;if(a.done)return m&&(e.progress({loaded:f,total:isNaN(d)?f:d,lengthComputable:!0,time:r(v,f),stream:!0}),e.response.response=m.buffer),e.onload(),void e.onend();if(o&&o.length>0){m=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(m,o),f+=o.length,v.push({ts:Date.now(),bytes:o.length});var s=n.findLastTopIsoBoxCompleted(["moov","mdat"],m,g);if(s.found){var l=s.lastCompletedOffset+s.size,u=void 0;l===m.length?(u=m,m=new Uint8Array):(u=new Uint8Array(m.subarray(0,l)),m=m.subarray(l)),e.progress({data:u.buffer,lengthComputable:!1,noTrace:!0}),g=0}else g=s.lastCompletedOffset,p||(e.progress({lengthComputable:!1,noTrace:!0}),p=!0)}i(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:r}}o.__dashjs_factory_name="FetchLoader";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(13),o=(i=a)&&i.__esModule?i:{default:i};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return r(e,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==o.default.BASE_URL&&this.segmentInfoType!==o.default.SEGMENT_BASE&&!this.indexRange}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};i.DEFAULT_ID="defaultId",t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""}},function(e,t,n){"use strict";var i=Array.isArray,r=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var o,s,l,u=i(t),c=i(n);if(u&&c){if((s=t.length)!=n.length)return!1;for(o=s;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(u!=c)return!1;var h=t instanceof Date,d=n instanceof Date;if(h!=d)return!1;if(h&&d)return t.getTime()==n.getTime();var f=t instanceof RegExp,p=n instanceof RegExp;if(f!=p)return!1;if(f&&p)return t.toString()==n.toString();var m=r(t);if((s=m.length)!==r(n).length)return!1;for(o=s;0!=o--;)if(!a.call(n,m[o]))return!1;for(o=s;0!=o--;)if(!e(t[l=m[o]],n[l]))return!1;return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(21);var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkForExistenceOnly=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(2)),r=u(n(7)),a=u(n(192)),o=u(n(100)),s=u(n(92)),l=n(25);function u(e){return e&&e.__esModule?e:{default:e}}function c(e){var t,n=this.context,i=void 0;function u(){i&&i.reset()}return t={provide:function(e,t){if("function"==typeof t){var n,r=i.getCurrentTrack(),o=void 0;if(!r||r.segmentDuration<=0||null==e)t(null);else{isNaN(r.segmentDuration)&&(o=i.getThumbnailRequestForTime(e))&&(r.segmentDuration=o.duration),n=e%r.segmentDuration;var s=Math.floor(n*r.tilesHor*r.tilesVert/r.segmentDuration),u=new a.default;if(u.width=Math.floor(r.widthPerTile),u.height=Math.floor(r.heightPerTile),u.x=Math.floor(s%r.tilesHor)*r.widthPerTile,u.y=Math.floor(s/r.tilesHor)*r.heightPerTile,"readThumbnail"in r)return r.readThumbnail(e,(function(e){u.url=e,t(u)}));if(o)u.url=o.url,r.segmentDuration=NaN;else{var c=Math.floor(e/r.segmentDuration);u.url=function(e,t){var n=t+e.startNumber,i=(0,l.replaceTokenForTemplate)(e.templateUrl,"Number",n);return i=(0,l.replaceTokenForTemplate)(i,"Time",(n-1)*e.segmentDuration),i=(0,l.replaceTokenForTemplate)(i,"Bandwidth",e.bandwidth),(0,l.unescapeDollarsInTemplate)(i)}(r,c)}t(u)}}},setTrackByIndex:function(e){i.setTrackByIndex(e)},getCurrentTrackIndex:function(){return i.getCurrentTrackIndex()},getBitrateList:function(){var e=i.getTracks(),t=0;return e.map((function(e){var n=new s.default;return n.mediaType=r.default.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n}))},reset:u},u(),i=(0,o.default)(n).create({streamInfo:e.streamInfo,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants}),t}c.__dashjs_factory_name="ThumbnailController",t.default=i.default.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(12)),r=n(14),a=h(n(8)),o=h(n(10)),s=h(n(15)),l=h(n(2)),u=h(n(9)),c=h(n(18));function h(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context,t=(0,a.default)(e).getInstance(),n=(0,c.default)(e).getInstance(),l=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(e){f=e}function _(e){d=e}function b(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]&&(n=60*parseInt(i[9],10)+parseInt(i[10],10),t+=("+"===i[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function E(e){return Date.parse(e)}function T(e){return Date.parse(e)}function w(e,t,n){n()}function x(e,t,n){var i=b(e);isNaN(i)?n():t(i)}function A(e,t,i,a,o){var s,l,u=!1,c=new XMLHttpRequest,h=o?r.HTTPRequest.HEAD:r.HTTPRequest.GET,d=t.match(/\S+/g);if(t=d.shift(),s=function(){u||(u=!0,d.length?A(e,d.join(" "),i,a,o):a())},l=function(){var t=void 0,n=void 0;200===c.status&&(t=o?c.getResponseHeader("Date"):c.response,n=e(t),isNaN(n)||(i(n),u=!0))},n.isRelative(t)){var f=v.resolve();f&&(t=n.resolve(t,f.url))}c.open(h,t),c.timeout=5e3,c.onload=l,c.onloadend=s,c.send()}function S(e,t,n){A(T,e,t,n,!0)}function M(e,n,r){y(!1),t.trigger(o.default.TIME_SYNCHRONIZATION_COMPLETED,{time:n,offset:r,error:e?new i.default(s.default.TIME_SYNC_FAILED_ERROR_CODE,s.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}return l={initialize:function(e,t){p=t,d=0,f=!1,m={"urn:mpeg:dash:utc:http-head:2014":S,"urn:mpeg:dash:utc:http-xsdate:2014":A.bind(null,b),"urn:mpeg:dash:utc:http-iso:2014":A.bind(null,E),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":S,"urn:mpeg:dash:utc:http-xsdate:2012":A.bind(null,b),"urn:mpeg:dash:utc:http-iso:2012":A.bind(null,E),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":w,"urn:mpeg:dash:utc:ntp:2014":w,"urn:mpeg:dash:utc:sntp:2014":w},f||function e(t,n){var i=n||0,r=t[i],a=function(e,t){var n,i,r=!e||!t;r&&p?(n=g.getLatestMPDRequestHeaderValueByID("Date"),i=null!==n?new Date(n).getTime():Number.NaN,isNaN(i)?M(!0):(_(i-(new Date).getTime()),M(!1,i/1e3,d))):M(r,e,t)};y(!0),r?m.hasOwnProperty(r.schemeIdUri)?m[r.schemeIdUri](r.value,(function(e){var t=(new Date).getTime(),n=function(e,t){return e-t}(e,t);_(n),h.info("Local time: "+new Date(t)),h.info("Server time: "+new Date(e)),h.info("Server Time - Local Time (ms): "+n),a(e,n)}),(function(){e(t,i+1)})):e(t,i+1):(_(0),a())}(e)},getOffsetToDeviceTimeMs:function(){return d},setConfig:function(e){e&&(e.dashMetrics&&(g=e.dashMetrics),e.baseURLController&&(v=e.baseURLController))},reset:function(){y(!1)}},h=(0,u.default)(e).getInstance().getLogger(l),l}d.__dashjs_factory_name="TimeSyncController";var f=l.default.getSingletonFactory(d);f.HTTP_TIMEOUT_MS=5e3,l.default.updateSingletonFactory(d.__dashjs_factory_name,f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=void 0,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var n=e.sourceBuffers,i=0;i<n.length;i++){if(n[i].updating)return;if(0===n[i].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,r.default)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",t.default=i.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(2)),r=l(n(9)),a=l(n(8)),o=l(n(10)),s=l(n(63));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,i=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0;function v(){if(!f||!p)throw new Error("setConfig function has to be called previously")}function y(){g=!1,l={},u={},c={},h=null,m=!1,d=Date.now()/1e3}function _(){try{null!==h&&g&&(clearInterval(h),h=null,g=!1,function(){try{A(u),A(l)}catch(e){}}())}catch(e){throw e}}function b(e){try{if(1==e.eventStream.value){var n=e.eventStream.timescale||1,r=e.calculatedPresentationTime/n,a=void 0;a=4294967295==e.calculatedPresentationTime?NaN:(e.calculatedPresentationTime+e.duration)/n,i.info("Manifest validity changed: Valid until: "+r+"; remaining duration: "+a),t.trigger(o.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:a,newManifestValidAfter:NaN})}}catch(e){}}function E(){try{if(!m){var e=p.getTime(),t=e-d;t=d>0?Math.max(0,t):0,T(u,t,e),T(l,t,e),function(){try{if(c)for(var e=p.getTime(),t=Object.keys(c),n=0;n<t.length;n++){var r=t[n],a=c[r];null!==a&&(a.duration+a.calculatedPresentationTime)/a.eventStream.timescale<e&&(i.debug("Remove Event "+r+" at time "+e),a=null,delete c[r])}}catch(e){}}(),d=e}m=!1}catch(e){m=!1}}function T(e,t,n){try{if(e)for(var r=Object.keys(e),a=0;a<r.length;a++){var o=r[a],s=e[o];if(void 0!==s){var l=s.calculatedPresentationTime/s.eventStream.timescale;l<=n&&l+t>=n?S(o,s,e):(w(n,t,l)||x(s))&&(i.debug("Deleting event "+o+" as it is expired or invalid"),delete e[o])}}}catch(e){}}function w(e,t,n){try{return e-t>n}catch(e){return!1}}function x(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime/1e3>t}catch(e){return!1}}function A(e){try{var t=Object.keys(e),n=p.getTime();if(!t||0===t.length)return;var i=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.duration)?e[t[0]].eventStream.period.duration:NaN,r=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.start)?e[t[0]].eventStream.period.start:NaN;if(isNaN(i)||isNaN(r))return;t.forEach((function(t){var i=e[t],r=i.calculatedPresentationTime/i.eventStream.timescale;Math.abs(r-n)<300&&S(t,i,e)}))}catch(e){}}function S(n,r,a){try{var o=p.getTime();r.duration>0&&(c[n]=r),"urn:mpeg:dash:event:2012"===r.eventStream.schemeIdUri&&1==r.eventStream.value?0===r.duration&&0===r.presentationTimeDelta||(i.debug("Starting manifest refresh event "+n+" at "+o),function(){try{v(),f.refreshManifest()}catch(e){}}()):"urn:mpeg:dash:event:callback:2015"===r.eventStream.schemeIdUri&&1==r.eventStream.value?(i.debug("Starting callback event "+n+" at "+o),function(t){try{(0,s.default)(e).create({}).load({method:"get",url:t,request:{responseType:"arraybuffer"}})}catch(e){throw e}}(r.messageData)):(i.debug("Starting event "+n+" at "+o),t.trigger(r.eventStream.schemeIdUri,{event:r})),delete a[n]}catch(e){}}return n={addInlineEvents:function(e){try{if(v(),e)for(var t=0;t<e.length;t++){var n=e[t];l[n.id]=n,i.debug("Add inline event with id "+n.id)}i.debug("Added "+e.length+" inline events")}catch(e){throw e}},addInbandEvents:function(e){try{v();for(var t=0;t<e.length;t++){var n=e[t];n.id in u?i.debug("Repeated event with id "+n.id):("urn:mpeg:dash:event:2012"===n.eventStream.schemeIdUri&&void 0===u[n.id]&&b(n),u[n.id]=n,i.debug("Add inband event with id "+n.id))}E()}catch(e){throw e}},start:function(){try{v(),i.debug("Start Event Controller"),g||isNaN(100)||(g=!0,h=setInterval(E,100))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(f=e.manifestUpdater),e.playbackController&&(p=e.playbackController)}catch(e){throw e}},reset:function(){_(),y()}},i=(0,r.default)(e).getInstance().getLogger(n),y(),n}u.__dashjs_factory_name="EventController",t.default=i.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(197)),r=c(n(198)),a=c(n(18)),o=c(n(98)),s=c(n(2)),l=c(n(8)),u=c(n(10));function c(e){return e&&e.__esModule?e:{default:e}}function h(){var e=void 0,t=void 0,n=this.context,s=(0,l.default)(n).getInstance(),c=(0,a.default)(n).getInstance(),h=void 0,d=void 0;function f(e){h.invalidateSelectedIndexes(e.entry)}return e={reset:function(){h.reset(),d.reset()},initialize:function(e){var n;h.setConfig({adapter:t}),n=e,h.update(n),d.chooseSelector(t.getIsDVB(n))},resolve:function(e){var t=h.getForPath(e).reduce((function(e,t){var n=d.select(t);return n?(c.isRelative(n.url)?e.url=c.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new o.default}),new o.default);if(!c.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(h=e.baseURLTreeModel),e.baseURLSelector&&(d=e.baseURLSelector),e.adapter&&(t=e.adapter)}},h=(0,i.default)(n).create(),d=(0,r.default)(n).create(),s.on(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,f,e),e}h.__dashjs_factory_name="BaseURLController",t.default=s.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(99)),r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||NaN},this.children=[]};function s(){var e,t=void 0,n=void 0,r=this.context,a=(0,i.default)(r).getInstance();function s(e,t,i){var r=n.getBaseURLsFromElement(i);e[t]?a.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=NaN):e[t]=new o(r)}function l(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var i=n.getBaseURLsFromElement(e);a.areEqual(i,t.data.baseUrls)||(t.data.baseUrls=i,t.data.selectedIdx=NaN),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,i){s(t.children,i,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,r){s(t.children[i].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach((function(e,n){s(t.children[i].children[r].children,n,e)}))}))}))}function u(){t=new o}return e={reset:u,update:function(e){l(e)},getForPath:function(e){var n=t,i=[n.data];return e&&e.forEach((function(e){(n=n.children[e])&&i.push(n.data)})),i.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){!function e(n,i){var r=i||t;n(r.data),r.children&&r.children.forEach((function(t){return e(n,t)}))}((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=NaN)}))},setConfig:function(e){e.adapter&&(n=e.adapter)}},u(),e}s.__dashjs_factory_name="BaseURLTreeModel",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(15)),r=d(n(8)),a=d(n(10)),o=d(n(199)),s=d(n(200)),l=d(n(201)),u=d(n(2)),c=d(n(12)),h=n(20);function d(e){return e&&e.__esModule?e:{default:e}}function f(){var e,t=this.context,n=(0,r.default)(t).getInstance(),u=void 0,d=void 0,f=void 0,p=void 0;function m(){u.reset()}return e={chooseSelector:function(e){(0,h.checkParameterType)(e,"boolean"),p=e?f:d},select:function(e){if(e){var t=e.baseUrls,r=e.selectedIdx;if(!isNaN(r))return t[r];var o=p.select(t);return o?(e.selectedIdx=t.indexOf(o),o):(n.trigger(a.default.URL_RESOLUTION_FAILED,{error:new c.default(i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(p===d&&m()))}},reset:m,setConfig:function(e){e.selector&&(p=e.selector)}},u=(0,o.default)(t).create({updateEventName:a.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:a.default.SERVICE_LOCATION_BLACKLIST_ADD}),d=(0,l.default)(t).create({blacklistController:u}),f=(0,s.default)(t).create({blacklistController:u}),p=d,e}f.__dashjs_factory_name="BaseURLSelector",t.default=u.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r=a(n(8));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=[],n=(0,r.default)(this.context).getInstance(),i=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(i,{entry:e}))}function s(e){o(e.entry)}return function(){a&&n.on(a,s,this)}(),{add:o,contains:function(e){return!!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[]}}}o.__dashjs_factory_name="BlackListController",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],i=0,r=void 0,a=void 0;if((a=e.sort((function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n})).filter((function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority}))).length)return a.length>1&&(a.forEach((function(e){t+=e.dvb_weight,n.push(t)})),r=Math.floor(Math.random()*(t-1)),n.every((function(e,t){return i=t,!(r<e)}))),a[i]}((n=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)})).filter((function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)}))));var n}}}o.__dashjs_factory_name="DVBSelector",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n=0,i=void 0;return e&&e.some((function(e,i){return n=i,!t.contains(e.serviceLocation)}))&&(i=e[n]),i}}}o.__dashjs_factory_name="BasicSelector",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(7)),r=g(n(13)),a=g(n(203)),o=g(n(32)),s=g(n(18)),l=g(n(102)),u=g(n(12)),c=n(14),h=g(n(8)),d=g(n(10)),f=g(n(15)),p=g(n(2)),m=g(n(205));function g(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=e.debug,p=(0,h.default)(t).getInstance(),g=(0,s.default)(t).getInstance(),v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=e.mssHandler,w=e.errHandler;function x(e){p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return v={load:function(e){var r=new l.default(e,c.HTTPRequest.MPD_TYPE);_.load({request:r,success:function(r,a,o){if(b){var s=void 0,l=void 0,c=void 0;if(o&&o!==e?(l=g.parseBaseUrl(o),s=o):(g.isRelative(e)&&(e=g.resolve(e,window.location.href)),l=g.parseBaseUrl(e)),null===E&&(E=function(e){var i=null;return e.indexOf("SmoothStreamingMedia")>-1?(T&&(i=T.createMssParser(),T.registerEvents()),i):e.indexOf("MPD")>-1?(0,m.default)(t).create({debug:n}):i}(r)),null!==E){b.setMatchers(E.getMatchers()),b.setIron(E.getIron());try{c=E.parse(r)}catch(t){return void p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}c?(c.url=s||e,c.originalUrl||(c.originalUrl=c.url),c.hasOwnProperty(i.default.LOCATION)&&(l=g.parseBaseUrl(c.Location_asArray[0]),y.debug("BaseURI set by Location to: "+l)),c.baseUri=l,c.loadedTime=new Date,b.resolveManifestOnLoad(c),p.trigger(d.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:r})):p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}},error:function(t,n,i){p.trigger(d.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new u.default(f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+i)})}})},reset:function(){p.off(d.default.XLINK_READY,x,v),b&&(b.reset(),b=null),_&&(_.abort(),_=null),T&&T.reset()}},y=n.getLogger(v),p.on(d.default.XLINK_READY,x,v),_=(0,o.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:g,constants:i.default,dashConstants:r.default,errors:f.default}),b=(0,a.default)(t).create({errHandler:w,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),E=null,v}v.__dashjs_factory_name="ManifestLoader";var y=p.default.getClassFactory(v);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(204)),r=c(n(8)),a=c(n(10)),o=c(n(2)),s=c(n(103)),l=c(n(18)),u=c(n(13));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=(0,r.default)(t).getInstance(),o=(0,l.default)(t).getInstance(),c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0;function g(e,t,n){var i={},r=void 0,a=void 0;i.elements=e,i.type=t,i.resolveType=n,0===i.elements.length&&y(i);for(var s=0;s<i.elements.length;s++)r=i.elements[s],a=o.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,m.load(a,r,i)}function v(e){var t,n=void 0,i="";if(n=e.element,t=e.resolveObject,n.resolvedContent){var r=0;0===n.resolvedContent.indexOf("<?xml")&&(r=n.resolvedContent.indexOf("?>")+2),i=n.resolvedContent.substr(0,r)+"<response>"+n.resolvedContent.substr(r)+"</response>",n.resolvedContent=p.xml_str2json(i)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&y(t)}function y(e){var t=[],i=void 0,r=void 0;if(function(e){var t=[],n=void 0,i=void 0,r=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(n=e.elements[a],i=n.type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[i].length;o++)r=n.resolvedContent[i][o],t.push(r)}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[i].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[i].splice(n.index+s,0,t[s]);t=[]}e.elements.length>0&&d.run(f)}(e),"onActuate"===e.resolveType&&n.trigger(a.default.XLINK_READY,{manifest:f}),"onLoad"===e.resolveType)switch(e.type){case u.default.PERIOD:for(i=0;i<f[u.default.PERIOD+"_asArray"].length;i++)(r=f[u.default.PERIOD+"_asArray"][i]).hasOwnProperty(u.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(_(r[u.default.ADAPTATION_SET+"_asArray"],r,u.default.ADAPTATION_SET,"onLoad"))),r.hasOwnProperty(u.default.EVENT_STREAM+"_asArray")&&(t=t.concat(_(r[u.default.EVENT_STREAM+"_asArray"],r,u.default.EVENT_STREAM,"onLoad")));g(t,u.default.ADAPTATION_SET,"onLoad");break;case u.default.ADAPTATION_SET:n.trigger(a.default.XLINK_READY,{manifest:f})}}function _(e,t,n,i){var r=[],a=void 0,o=void 0,s=void 0;for(o=e.length-1;o>=0;o--)(a=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===i&&(s=b(a["xlink:href"],t,n,o,i,a),r.push(s));return r}function b(e,t,n,i,r,a){return{url:e,parentElement:t,type:n,index:i,resolveType:r,originalContent:a,resolvedContent:null,resolved:!1}}return c={resolveManifestOnLoad:function(e){p=new s.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:h}),g(_((f=e).Period_asArray,f,u.default.PERIOD,"onLoad"),u.default.PERIOD,"onLoad")},setMatchers:function(e){e&&(h=e)},setIron:function(e){e&&(d=e)},reset:function(){n.off(a.default.XLINK_ELEMENT_LOADED,v,c),m&&(m.reset(),m=null)}},n.on(a.default.XLINK_ELEMENT_LOADED,v,c),m=(0,i.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),c}h.__dashjs_factory_name="XlinkController",t.default=o.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(12)),r=h(n(32)),a=n(14),o=h(n(102)),s=h(n(8)),l=h(n(10)),u=h(n(2)),c=h(n(15));function h(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),u=(0,r.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings?e.settings.get().streaming.lowLatencyEnabled:null,errors:c.default});return{load:function(e,t,r){var s=function(a,o){t.resolved=!0,t.resolvedContent=a||null,n.trigger(l.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:r,error:a||o?null:new i.default(c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)s(null,!0);else{var h=new o.default(e,a.HTTPRequest.XLINK_EXPANSION_TYPE);u.load({request:h,success:function(e){s(e)},error:function(){s(null)}})}},reset:function(){u&&(u.abort(),u=null)}}}d.__dashjs_factory_name="XlinkLoader",t.default=u.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(2)),r=d(n(206)),a=d(n(103)),o=d(n(207)),s=d(n(208)),l=d(n(209)),u=d(n(210)),c=d(n(211)),h=d(n(213));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=e.debug,i=void 0,d=void 0,f=void 0,p=void 0,m=void 0;return i={parse:function(e){var t=void 0,n=window.performance.now();if(!(t=p.xml_str2json(e)))throw new Error("parsing the manifest failed");var i=window.performance.now();m.run(t);var r=window.performance.now();return d.info("Parsing complete: ( xml2json: "+(i-n).toPrecision(3)+"ms, objectiron: "+(r-i).toPrecision(3)+"ms, total: "+((r-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return f},getIron:function(){return m}},d=n.getLogger(i),f=[new s.default,new l.default,new u.default,new o.default],p=new a.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!0,matchers:f}),m=(0,r.default)(t).create({adaptationset:new c.default,period:new h.default}),i}f.__dashjs_factory_name="DashParser",t.default=i.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(2),o=(i=a)&&i.__esModule?i:{default:i};function s(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,i){for(var a=0,o=e.length;a<o;++a){var s=e[a];if(n[s.name])if(i[s.name]){if(s.merge){var l=n[s.name],u=i[s.name];"object"===(void 0===l?"undefined":r(l))&&"object"===(void 0===u?"undefined":r(u))?t(l,u):i[s.name]=l+u}}else i[s.name]=n[s.name]}}function i(e,t){for(var r=0,a=e.children.length;r<a;++r){var o=e.children[r],s=t[o.name+"_asArray"];if(s)for(var l=0,u=s.length;l<u;++l){var c=s[l];n(e.properties,t,c),i(o,c)}}}return{run:function(t){if(null===t||"object"!==(void 0===t?"undefined":r(t)))return t;if("period"in e)for(var n=e.period,a=t.Period_asArray,o=0,s=a.length;o<s;++o){var l=a[o];if(i(n,l),"adaptationset"in e){var u=l.AdaptationSet_asArray;if(u)for(var c=e.adaptationset,h=0,d=u.length;h<d;++h)i(c,u[h])}}return t}}}s.__dashjs_factory_name="ObjectIron";var l=o.default.getClassFactory(s);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(43)),r=a(n(13));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e,t){var n,i=(o(n={},r.default.MPD,[r.default.ID,r.default.PROFILES]),o(n,r.default.PERIOD,[r.default.ID]),o(n,r.default.BASE_URL,[r.default.SERVICE_LOCATION,r.default.BYTE_RANGE]),o(n,r.default.SEGMENT_BASE,[r.default.INDEX_RANGE]),o(n,r.default.INITIALIZATION,[r.default.RANGE]),o(n,r.default.REPRESENTATION_INDEX,[r.default.RANGE]),o(n,r.default.SEGMENT_LIST,[r.default.INDEX_RANGE]),o(n,r.default.BITSTREAM_SWITCHING,[r.default.RANGE]),o(n,r.default.SEGMENT_URL,[r.default.MEDIA_RANGE,r.default.INDEX_RANGE]),o(n,r.default.SEGMENT_TEMPLATE,[r.default.INDEX_RANGE,r.default.MEDIA,r.default.INDEX,r.default.INITIALIZATION_MINUS,r.default.BITSTREAM_SWITCHING_MINUS]),o(n,r.default.ASSET_IDENTIFIER,[r.default.VALUE,r.default.ID]),o(n,r.default.EVENT_STREAM,[r.default.VALUE]),o(n,r.default.ADAPTATION_SET,[r.default.PROFILES,r.default.MIME_TYPE,r.default.SEGMENT_PROFILES,r.default.CODECS,r.default.CONTENT_TYPE]),o(n,r.default.FRAME_PACKING,[r.default.VALUE,r.default.ID]),o(n,r.default.AUDIO_CHANNEL_CONFIGURATION,[r.default.VALUE,r.default.ID]),o(n,r.default.CONTENT_PROTECTION,[r.default.VALUE,r.default.ID]),o(n,r.default.ESSENTIAL_PROPERTY,[r.default.VALUE,r.default.ID]),o(n,r.default.SUPPLEMENTAL_PROPERTY,[r.default.VALUE,r.default.ID]),o(n,r.default.INBAND_EVENT_STREAM,[r.default.VALUE,r.default.ID]),o(n,r.default.ACCESSIBILITY,[r.default.VALUE,r.default.ID]),o(n,r.default.ROLE,[r.default.VALUE,r.default.ID]),o(n,r.default.RATING,[r.default.VALUE,r.default.ID]),o(n,r.default.VIEWPOINT,[r.default.VALUE,r.default.ID]),o(n,r.default.CONTENT_COMPONENT,[r.default.CONTENT_TYPE]),o(n,r.default.REPRESENTATION,[r.default.ID,r.default.DEPENDENCY_ID,r.default.MEDIA_STREAM_STRUCTURE_ID]),o(n,r.default.SUBSET,[r.default.ID]),o(n,r.default.METRICS,[r.default.METRICS_MINUS]),o(n,r.default.REPORTING,[r.default.VALUE,r.default.ID]),n);if(i.hasOwnProperty(t)){var a=i[t];return void 0!==a&&a.indexOf(e.name)>=0}return!1}),(function(e){return String(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(43)),r=o(n(7)),a=o(n(13));function o(e){return e&&e.__esModule?e:{default:e}}var s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){for(var t=[a.default.MIN_BUFFER_TIME,a.default.MEDIA_PRESENTATION_DURATION,a.default.MINIMUM_UPDATE_PERIOD,a.default.TIMESHIFT_BUFFER_DEPTH,a.default.MAX_SEGMENT_DURATION,a.default.MAX_SUBSEGMENT_DURATION,a.default.SUGGESTED_PRESENTATION_DELAY,a.default.START,r.default.START_TIME,a.default.DURATION],n=t.length,i=0;i<n;i++)if(e.nodeName===t[i])return s.test(e.value);return!1}),(function(e){var t=s.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(43),a=(i=r)&&i.__esModule?i:{default:i};var o=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return o.test(e.value)}),(function(e){var t=o.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&1e3*parseFloat(t[7])||0),t[9]&&t[10]){var i=60*parseInt(t[9],10)+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*i*60*1e3}return new Date(n)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(43),a=(i=r)&&i.__esModule?i:{default:i};var o=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return o.test(e.value)}),(function(e){return parseFloat(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(104)),r=a(n(13));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[r.default.PROFILES,r.default.WIDTH,r.default.HEIGHT,r.default.SAR,r.default.FRAMERATE,r.default.AUDIO_SAMPLING_RATE,r.default.MIME_TYPE,r.default.SEGMENT_PROFILES,r.default.CODECS,r.default.MAXIMUM_SAP_PERIOD,r.default.START_WITH_SAP,r.default.MAX_PLAYOUT_RATE,r.default.CODING_DEPENDENCY,r.default.SCAN_TYPE,r.default.FRAME_PACKING,r.default.AUDIO_CHANNEL_CONFIGURATION,r.default.CONTENT_PROTECTION,r.default.ESSENTIAL_PROPERTY,r.default.SUPPLEMENTAL_PROPERTY,r.default.INBAND_EVENT_STREAM];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default.ADAPTATION_SET,e,[new i.default(r.default.REPRESENTATION,e,[new i.default(r.default.SUB_REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n;this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}return i(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(104)),r=a(n(13));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[r.default.SEGMENT_BASE,r.default.SEGMENT_TEMPLATE,r.default.SEGMENT_LIST];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r.default.PERIOD,e,[new i.default(r.default.ADAPTATION_SET,e,[new i.default(r.default.REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(8)),r=o(n(10)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,i.default)(e).getInstance();return{error:function(e){t.trigger(r.default.ERROR,{error:e})}}}s.__dashjs_factory_name="ErrorHandler",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(){var e,t=void 0;return e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return!(!("MediaSource"in window)||!MediaSource.isTypeSupported(e))||!(!("WebKitMediaSource"in window)||!WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e}},t=!1,e}o.__dashjs_factory_name="Capabilities",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(217)),r=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;return{initialize:function(t){if(e=new i.default,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var r=t.substr(n+1).split("&"),a=0,o=r.length;a<o;++a){var s=r[a],l=s.indexOf("=");if(-1!==l){var u=s.substring(0,l);e.hasOwnProperty(u)&&(e[u]=s.substr(l+1))}}},getURIFragmentData:function(){return e}}}o.__dashjs_factory_name="URIFragmentModel",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(8)),r=o(n(10)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0;return{getValue:function(){return n},setValue:function(e){n=e,e&&t.trigger(r.default.MANIFEST_LOADED,{data:e})}}}s.__dashjs_factory_name="ManifestModel",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(96)),r=u(n(2)),a=u(n(7)),o=u(n(91)),s=u(n(65)),l=n(20);function u(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=void 0,n=void 0,r=void 0,u={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},c=this.context,h=(0,s.default)(c).getInstance();function d(e){var t=void 0;for(t=0;t<r.length;t++)if(r[t].rulename===e)return t;return-1}function f(){return h.get().streaming.lowLatencyEnabled?h.get().streaming.liveDelay||3:h.get().streaming.liveDelay}function p(e,n){m(e,n);var r=new i.default;r.schemeIdUri=e,r.value=n,t.push(r)}function m(e,n){(0,l.checkParameterType)(e,"string"),(0,l.checkParameterType)(n,"string"),t.forEach((function(i,r){i.schemeIdUri===e&&i.value===n&&t.splice(r,1)}))}return e={getABRCustomRules:function(){return r},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==o.default.ABANDON_FRAGMENT_RULES&&e!==o.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw a.default.BAD_ARGUMENT_ERROR;var i=d(t);-1===i?r.push({type:e,rulename:t,rule:n}):(r[i].type=e,r[i].rule=n)},removeABRCustomRule:function(e){if(e){var t=d(e);-1!==t&&r.splice(t,1)}else r=[]},getStableBufferTime:function(){if(h.get().streaming.lowLatencyEnabled)return.6*f();var e=h.get().streaming.stableBufferTime;return e>-1?e:h.get().streaming.fastSwitchEnabled?20:12},getRetryAttemptsForType:function(e){var t=isNaN(h.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:h.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return h.get().streaming.lowLatencyEnabled?h.get().streaming.retryAttempts[e]*t:h.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(h.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:h.get().streaming.retryIntervals.lowLatencyReductionFactor;return h.get().streaming.lowLatencyEnabled?h.get().streaming.retryIntervals[e]/t:h.get().streaming.retryIntervals[e]},getLiveDelay:f,getLiveCatchupLatencyThreshold:function(){try{var e=h.get().streaming.liveCatchupLatencyThreshold,t=f();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=h.get().streaming.liveCatchUpMinDrift,i=!isNaN(t)&&t?isNaN(n)?f():h.get().streaming.liveCatchUpMinDrift+f():NaN;return i&&!isNaN(i)?2*i:NaN}catch(e){return NaN}},addUTCTimingSource:p,removeUTCTimingSource:m,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){p(u.scheme,u.value)},setXHRWithCredentialsForType:function e(t,i){t?n[t]=!!i:Object.keys(n).forEach((function(t){e(t,i)}))},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},getDefaultUtcTimingSource:function(){return u},reset:function(){}},t=[],n={default:!1},r=[],e}c.__dashjs_factory_name="MediaPlayerModel",t.default=r.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(2)),r=s(n(8)),a=s(n(10)),o=s(n(9));function s(e){return e&&e.__esModule?e:{default:e}}function l(){var e=void 0,t=void 0,n=void 0,i=void 0,s=void 0,l=this.context,u=(0,r.default)(l).getInstance(),c=[];function h(){n&&(n.playbackRate=s||1,n.removeEventListener("canplay",h))}function d(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",h):n.playbackRate=e)}function f(){return c.length>0}function p(e){var t=c.indexOf(e),i=void 0;null!==e&&(-1!==t&&c.splice(t,1),n&&!1===f()&&0===n.playbackRate&&(d(s||1),n.paused||((i=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(i))))}function m(){if(n&&f()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function g(){return n?n.buffered:null}function v(e,t,i,r,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===i&&n.textTracks[o].isTTML===r&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null}return e={initialize:function(){u.on(a.default.PLAYBACK_PLAYING,m,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=g(),n=e,i=9999999999;if(t)for(var r=0;r<t.length;r++){var a=t.start(r),o=t.end(r),s=Math.abs(a-e),l=Math.abs(o-e);if(e>=a&&e<=o)return e;s<i&&(i=s,n=a),l<i&&(i=l,n=o)}return n}(e):e,n.currentTime=e}catch(t){0===n.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout((function(){n.currentTime=e}),400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&u.trigger(a.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")}))}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:d,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;if(null===e||n.seeking||-1!==c.indexOf(e))return;c.push(e),n&&1===c.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),s=n.playbackRate,d(0),n.dispatchEvent(t))}(e):p(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return i},setTTMLRenderingDiv:function(e){(i=e).style.position="absolute",i.style.display="flex",i.style.overflow="hidden",i.style.pointerEvents="none",i.style.top=0,i.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:g,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:v,addTextTrack:function(e,t,i,r,a){if(!n)return null;var o=v(e,t,i,r,a);return o||((o=n.addTextTrack(e,t,i)).isEmbedded=a,o.isTTML=r),o},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){u.off(a.default.PLAYBACK_PLAYING,m,this)}},t=(0,o.default)(l).getInstance().getLogger(e),e}l.__dashjs_factory_name="VideoModel",t.default=i.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(9)),a=o(n(7));function o(e){return e&&e.__esModule?e:{default:e}}var s=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}];function l(e){e=e||{};var t=this.context,n=e.settings,i=void 0,o=void 0,l=void 0;function u(e){if(void 0!==l)return l;l=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return o.warn("DOMStorage access denied: "+e.message),l}if(!t||"localStorage"!==e&&"sessionStorage"!==e)return l;try{t.setItem("1","1"),t.removeItem("1"),l=!0}catch(e){o.warn("DOMStorage is supported, but cannot be used: "+e.message)}return l}function c(){return 6e5*Math.round((new Date).getTime()/6e5)}function h(e,t){return u(e)&&n.get().streaming[t+"CachingInfo"].enabled}function d(){if(!n)throw new Error(a.default.MISSING_CONFIG_ERROR)}return i={getSavedBitrateSettings:function(e){var t=NaN;if(d(),h("localStorage","lastBitrate")){var i="dashjs_?_bitrate".replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(i))||{},a=(new Date).getTime()-parseInt(r.timestamp,10)>=n.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(r.bitrate);isNaN(s)||a?a&&localStorage.removeItem(i):(t=s,o.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(h("localStorage","lastBitrate")&&t){var n="dashjs_?_bitrate".replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:c()}))}catch(e){o.error(e.message)}}},getSavedMediaSettings:function(e){var t=null;if(d(),h("localStorage","lastMediaSettings")){var i="dashjs_?_settings".replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(i))||{},a=(new Date).getTime()-parseInt(r.timestamp,10)>=n.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=r.settings,a&&(localStorage.removeItem(i),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(h("localStorage","lastMediaSettings")){var n="dashjs_?_settings".replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:c()}))}catch(e){o.error(e.message)}}}},o=(0,r.default)(t).getInstance().getLogger(i),u("localStorage")&&s.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){o.error(e.message)}}})),i}l.__dashjs_factory_name="DOMStorage";var u=i.default.getSingletonFactory(l);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(2)),r=o(n(223)),a=o(n(224));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.eventBus,i=e.events,o=e.dashMetrics,s=e.mediaPlayerModel,l=e.errHandler,u=e.baseURLController,c=e.debug,h=e.boxParser,d=e.requestModifier,f=e.errors,p=void 0,m=void 0,g=void 0;function v(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}function y(e){v(e.mimeType)?g.loadInitialization(e.representation):m.loadInitialization(e.representation)}function _(e){v(e.mimeType)?g.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback):m.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback)}return p={initialize:function(){n.on(i.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.on(i.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p),m.initialize(),g.initialize()},reset:function(){n.off(i.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.off(i.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p)}},m=(0,r.default)(t).getInstance(),g=(0,a.default)(t).getInstance(),m.setConfig({baseURLController:u,dashMetrics:o,mediaPlayerModel:s,errHandler:l,eventBus:n,events:i,errors:f,debug:c,boxParser:h,requestModifier:d}),g.setConfig({baseURLController:u,dashMetrics:o,mediaPlayerModel:s,errHandler:l,eventBus:n,events:i,errors:f,debug:c,requestModifier:d}),p}s.__dashjs_factory_name="SegmentBaseController";var l=i.default.getSingletonFactory(s);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(60)),r=l(n(12)),a=l(n(2)),o=l(n(21)),s=l(n(32));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=void 0,n=void 0,a=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0;function E(){if(!b||!b.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function T(e){if(e.url){var t=new o.default;return t.setInfo(e),t}}function w(e,t,n){e?m.trigger(p.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):m.trigger(p.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new r.default(g.SEGMENT_BASE_LOADER_ERROR_CODE,g.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}return t={setConfig:function(e){e.baseURLController&&(b=e.baseURLController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(d=e.mediaPlayerModel),e.errHandler&&(a=e.errHandler),e.settings&&(h=e.settings),e.boxParser&&(l=e.boxParser),e.events&&(p=e.events),e.eventBus&&(m=e.eventBus),e.debug&&(n=e.debug.getLogger(t)),e.requestModifier&&(u=e.requestModifier),e.errors&&(g=e.errors),e.urlUtils&&(_=e.urlUtils),e.constants&&(v=e.constants),e.dashConstants&&(y=e.dashConstants)},initialize:function(){f=(0,s.default)(e).create({errHandler:a,dashMetrics:c,mediaPlayerModel:d,requestModifier:u,useFetch:h?h.get().streaming.lowLatencyEnabled:null,boxParser:l,errors:g,urlUtils:_,constants:v,dashConstants:y})},loadInitialization:function e(t,i){E();var r=null,a=t?b.resolve(t.path):null,o=i||{init:!0,url:a?a.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:t&&t.adaptation?t.adaptation.type:null};n.debug("Start searching for initialization.");var s=T(o);f.load({request:s,success:function(n){o.bytesLoaded=o.range.end,(r=l.findInitRange(n))?(t.range=r,m.trigger(p.INITIALIZATION_LOADED,{representation:t})):(o.range.end=o.bytesLoaded+o.bytesToLoad,e(t,o))},error:function(){m.trigger(p.INITIALIZATION_LOADED,{representation:t})}}),n.debug("Perform init search: "+o.url)},loadSegments:function e(t,r,a,o,s){if(E(),a&&(void 0===a.start||void 0===a.end)){var u=a?a.toString().split("-"):null;a=u?{start:parseFloat(u[0]),end:parseFloat(u[1])}:null}o=o||w;var c=null,h=null,d=!!a,p=t?b.resolve(t.path):null,m={init:!1,url:p?p.url:void 0,range:d?a:{start:0,end:1500},searching:!d,bytesLoaded:s?s.bytesLoaded:0,bytesToLoad:1500,mediaType:t&&t.adaptation?t.adaptation.type:null},g=T(m);f.load({request:g,success:function(a){var s=m.bytesToLoad,u=a.byteLength;if(m.bytesLoaded=m.range.end-m.range.start,c=l.parse(a),(h=c.getBox("sidx"))&&h.isComplete){var d=h.references,f=void 0,p=void 0;if(null!=d&&d.length>0&&(f=1===d[0].reference_type),f){n.debug("Initiate multiple SIDX load."),m.range.end=m.range.start+h.size;var g=void 0,v=void 0,y=void 0,_=void 0,b=[],E=0,T=(h.offset||m.range.start)+h.size,w=function(e){e?(b=b.concat(e),++E>=v&&(b.sort((function(e,t){return e.startTime-t.startTime<0?-1:0})),o(b,t,r))):o(null,t,r)};for(g=0,v=d.length;g<v;g++)y=T,_=T+d[g].referenced_size-1,T+=d[g].referenced_size,e(t,null,{start:y,end:_},w,m)}else n.debug("Parsing segments from SIDX. representation "+t.adaptation.type+" - id: "+t.id+" for range : "+m.range.start+" - "+m.range.end),p=function(e,t){for(var n=e.references,r=n.length,a=e.timescale,o=e.earliest_presentation_time,s=t.range.start+e.offset+e.first_offset+e.size,l=[],u=void 0,c=void 0,h=void 0,d=void 0,f=0;f<r;f++)h=n[f].subsegment_duration,d=n[f].referenced_size,(u=new i.default).duration=h,u.startTime=o,u.timescale=a,c=s+d-1,u.mediaRange=s+"-"+c,l.push(u),o+=h,s+=d;return l}(h,m),o(p,t,r)}else{if(h)m.range.start=h.offset||m.range.start,m.range.end=m.range.start+(h.size||s);else{if(u<m.bytesLoaded)return void o(null,t,r);var x=c.getLastBox();x&&x.size?(m.range.start=x.offset+x.size,m.range.end=m.range.start+s):m.range.end+=s}e(t,r,m.range,o,m)}},error:function(){o(null,t,r)}}),n.debug("Perform SIDX load: "+m.url+" with range : "+m.range.start+" - "+m.range.end)},reset:function(){f.abort(),f=null,a=null,l=null,u=null}}}u.__dashjs_factory_name="SegmentBaseLoader",t.default=a.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(225)),r=c(n(7)),a=c(n(2)),o=c(n(60)),s=c(n(21)),l=c(n(32)),u=c(n(12));function c(e){return e&&e.__esModule?e:{default:e}}function h(){var e=this.context,t=void 0,n=void 0,a=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(t,r,s,l){var u,c,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0;for(d=[],p=0,c=(u=function(t){var n=[],r=(0,i.default)(e).create({data:t}),o=void 0,s=void 0;for(r.consumeTagAndSize(a.Segment.Cues);r.moreData()&&r.consumeTagAndSize(a.Segment.Cues.CuePoint,!0);){for((o={}).CueTime=r.parseTag(a.Segment.Cues.CuePoint.CueTime),o.CueTracks=[];r.moreData()&&r.consumeTag(a.Segment.Cues.CuePoint.CueTrackPositions,!0);){var l=r.getMatroskaCodedNum(),u=r.getPos();if((s={}).Track=r.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===s.Track)throw new Error("Cue track cannot be 0");s.ClusterPosition=r.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.CueTracks.push(s),r.setPos(u+l)}if(0===o.CueTracks.length)throw new Error("Mandatory cuetrack not found");n.push(o)}if(0===n.length)throw new Error("mandatory cuepoint not found");return n}(t)).length;p<c;p+=1)f=new o.default,h=0,h=p<u.length-1?u[p+1].CueTime-u[p].CueTime:l-u[p].CueTime,f.duration=h,f.startTime=u[p].CueTime,f.timescale=1e3,m=u[p].CueTracks[0].ClusterPosition+r,g=p<u.length-1?u[p+1].CueTracks[0].ClusterPosition+r-1:s-1,f.mediaRange=m+"-"+g,d.push(f);return n.debug("Parsed cues: "+d.length+" cues."),d}function E(){if(!_||!_.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function T(e,t,n){e?g.trigger(v.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):g.trigger(v.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new u.default(y.SEGMENT_BASE_LOADER_ERROR_CODE,y.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function w(e){var t=new s.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(r.default.MISSING_CONFIG_ERROR);_=e.baseURLController,d=e.dashMetrics,f=e.mediaPlayerModel,c=e.errHandler,m=e.settings,v=e.events,g=e.eventBus,y=e.errors,n=e.debug.getLogger(t),h=e.requestModifier},initialize:function(){p=(0,l.default)(e).create({errHandler:c,dashMetrics:d,mediaPlayerModel:f,requestModifier:h,useFetch:m?m.get().streaming.lowLatencyEnabled:null,errors:y})},loadInitialization:function(e,t){E();var i=null,r=e?_.resolve(e.path):null,a=e?e.range.split("-"):null,o=t||{range:{start:a?parseFloat(a[0]):null,end:a?parseFloat(a[1]):null},request:i,url:r?r.url:void 0,init:!0,mediaType:e&&e.adaptation?e.adaptation.type:null};n.info("Start loading initialization."),i=w(o),p.load({request:i,success:function(){g.trigger(v.INITIALIZATION_LOADED,{representation:e})},error:function(){g.trigger(v.INITIALIZATION_LOADED,{representation:e})}}),n.debug("Perform init load: "+o.url)},loadSegments:function(t,r,o,s){E();var l=null,u=t?_.resolve(t.path):null,c=u?u.url:void 0,h={bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:l,url:c,init:!1,mediaType:t&&t.adaptation?t.adaptation.type:null};s=s||T,l=w(h),n.debug("Parsing ebml header"),p.load({request:l,success:function(l){!function(t,r,o,s){if(t&&0!==t.byteLength){var l,u=(0,i.default)(e).create({data:t}),c=void 0,h=void 0,d=void 0,f=o?o.split("-"):null,m=null,g={url:r,range:{start:f?parseFloat(f[0]):null,end:f?parseFloat(f[1]):null},request:m};for(n.debug("Parse EBML header: "+g.url),u.skipOverElement(a.EBML),u.consumeTag(a.Segment),d=u.getMatroskaCodedNum(),d+=u.getPos(),l=u.getPos();u.moreData()&&!u.consumeTagAndSize(a.Segment.Info,!0);)if(!(u.skipOverElement(a.Segment.SeekHead,!0)||u.skipOverElement(a.Segment.Tracks,!0)||u.skipOverElement(a.Segment.Cues,!0)||u.skipOverElement(a.Void,!0)))throw new Error("no valid top level element found");for(;void 0===c;){var v=u.getMatroskaCodedNum(!0),y=u.getMatroskaCodedNum();switch(v){case a.Segment.Info.Duration.tag:c=u[a.Segment.Info.Duration.parse](y);break;default:u.setPos(u.getPos()+y)}}m=w(g);p.load({request:m,success:function(e){h=b(e,l,d,c),s(h)},error:function(){n.error("Download Error: Cues "+g.url),s(null)}}),n.debug("Perform cues load: "+g.url+" bytes="+g.range.start+"-"+g.range.end)}else s(null)}(l,c,o,(function(e){s(e,t,r)}))},error:function(){s(null,t,r)}})},reset:function(){c=null,h=null}},a={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}h.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=a.default.getSingletonFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(2),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t=void 0,n=new DataView(e.data),i=0;function r(e,t){var r=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(i)!==e.tag&&(r=!1),a=4):e.tag>65535?(256*n.getUint16(i)+n.getUint8(i+2)!==e.tag&&(r=!1),a=3):e.tag>255?(n.getUint16(i)!==e.tag&&(r=!1),a=2):(n.getUint8(i)!==e.tag&&(r=!1),a=1),!r&&e.required&&!t)throw new Error("required tag not found");return r&&(i+=a),r}function a(e){var t=1,r=128,a=-1,o=0,s=n.getUint8(i),l=0;for(l=0;l<8;l+=1){if((s&r)===r){o=void 0===e?s&~r:s,a=l;break}r>>=1}for(l=0;l<a;l+=1,t+=1)o=o<<8|255&n.getUint8(i+t);return i+=t,o}return t={getPos:function(){return i},setPos:function(e){i=e},consumeTag:r,consumeTagAndSize:function(e,t){var n=r(e,t);return n&&a(),n},parseTag:function(e){var n;return r(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n=r(e,t),o=void 0;return n&&(o=a(),i+=o),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=n.getFloat32(i),i+=4;break;case 8:t=n.getFloat64(i),i+=8}return t},getMatroskaUint:function(e){for(var t=0,r=0;r<e;r+=1)t<<=8,t|=255&n.getUint8(i+r);return i+=e,t},moreData:function(){return i<n.byteLength}}}o.__dashjs_factory_name="EBMLParser",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(13)),r=h(n(227)),a=h(n(228)),o=h(n(229)),s=h(n(230)),l=h(n(97)),u=h(n(2)),c=h(n(67));function h(e){return e&&e.__esModule?e:{default:e}}function d(){var e,t=void 0,n=void 0,u=void 0,h=void 0,d=void 0,f=void 0,p=this.context;function m(e,r,a){var o,s=t.getAdaptationsForType(n[0].mpd.manifest,e,r);if(!s||0===s.length)return null;if(s.length>1&&a){var l=g(a,r);if(h[a.id]&&h[a.id][r])for(var u=0,c=s.length;u<c;u++)if(h[a.id][r].isMediaInfoEqual(l[u]))return s[u];for(var d=0,f=s.length;d<f;d++)if(o=s[d],t.getRolesForAdaptation(o).filter((function(e){return e.value===i.default.MAIN}))[0])return s[d]}return s[0]}function g(e,i,r){var a,o=n,s=r,l=[],c=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;if(s)S(),o=v(s);else{if(!(n.length>0))return l;s=n[0].mpd.manifest}var y=T(e,o);y&&(g=y.id);var _=t.getAdaptationsForType(s,e?e.index:null,i!==d.EMBEDDED_TEXT?i:d.VIDEO);if(!_||0===_.length)return l;for(u[g]=u[g]||t.getAdaptationsForPeriod(y),p=0,a=_.length;p<a;p++)if(c=_[p],f=t.getIndexForAdaptation(c,s,e.index),h=w(u[g][f]),i===d.EMBEDDED_TEXT){var b=h.accessibility.length;for(m=0;m<b;m++)if(h){var E=h.accessibility[m];if(0===E.indexOf("cea-608:")){var A=E.substring(8).split(";");if("CC"===A[0].substring(0,2))for(m=0;m<A.length;m++)h||(h=w.call(this,u[g][f])),x(h,A[m].substring(0,3),A[m].substring(4)),l.push(h),h=null;else for(m=0;m<A.length;m++)h||(h=w.call(this,u[g][f])),x(h,"CC"+(m+1),A[m]),l.push(h),h=null}else 0===E.indexOf("cea-608")&&(x(h,d.CC1,"eng"),l.push(h),h=null)}}else i===d.IMAGE?(h.type=d.IMAGE,l.push(h),h=null):h&&l.push(h);return l}function v(e){var n=y(e);return t.getRegularPeriods(n)}function y(e){var n=b(e);return t.getMpd(n)}function _(){n=[],u={},h={}}function b(e){return e||(n.length>0?n[0].mpd.manifest:null)}function E(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&u[e.streamInfo.id]?u[e.streamInfo.id][e.index]:null}function T(e,t){for(var n=t.length,i=0;i<n;i++){var r=t[i];if(e&&e.id===r.id)return r}return null}function w(e){if(!e)return null;var n,i=new a.default,r=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return i.id=e.id,i.index=e.index,i.type=e.type,i.streamInfo=A(e.period),i.representationCount=t.getRepresentationCount(r),i.labels=t.getLabelsForAdaptation(r),i.lang=t.getLanguageForAdaptation(r),n=t.getViewpointForAdaptation(r),i.viewpoint=n?n.value:void 0,i.accessibility=t.getAccessibilityForAdaptation(r).map((function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==f&&(n=t?"cea-608:"+t:"cea-608",i.embeddedCaptions=!0),n})),i.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(r).map((function(e){return e.value})),0===i.audioChannelConfiguration.length&&Array.isArray(r.Representation_asArray)&&r.Representation_asArray.length>0&&(i.audioChannelConfiguration=t.getAudioChannelConfigurationForRepresentation(r.Representation_asArray[0]).map((function(e){return e.value}))),i.roles=t.getRolesForAdaptation(r).map((function(e){return e.value})),i.codec=t.getCodec(r),i.mimeType=t.getMimeType(r),i.contentProtection=t.getContentProtectionData(r),i.bitrateList=t.getBitrateListForAdaptation(r),i.contentProtection&&i.contentProtection.forEach((function(e){e.KID=t.getKID(e)})),i.isText=t.getIsTextTrack(i.mimeType),i.supplementalProperties=t.getSupplementalPropperties(r),i}function x(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=d.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function A(e){var n,i,r=new o.default;return r.id=e.id,r.index=e.index,r.start=e.start,r.duration=e.duration,r.manifestInfo=(n=e.mpd,(i=new s.default).DVRWindowSize=n.timeShiftBufferDepth,i.loadedTime=n.manifest.loadedTime,i.availableFrom=n.availabilityStartTime,i.minBufferTime=n.manifest.minBufferTime,i.maxFragmentDuration=n.maxSegmentDuration,i.duration=t.getDuration(n.manifest),i.isDynamic=t.getIsDynamic(n.manifest),i.serviceDescriptions=t.getServiceDescriptions(n.manifest),i.protocol=n.manifest.protocol,i),r.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<1,r}function S(){if(!d)throw new Error("setConfig function has to be called previously")}function M(e){return n.length>0?n[0].mpd.manifest.Period_asArray[e]:null}function C(e,t,n){var i=void 0,r=void 0,a=void 0,o=void 0,s=void 0;if(e)for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)for(a=i[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(r=a[s]).id)return n?s:r;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=C(M(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=C(e,t,!0);return null!==n?n:-1}(M(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var i,r=void 0,a=void 0,o=void 0;if(!e||!n)return-1;for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)if(r=i[o],a=r.Representation_asArray,t.getIsTypeOf(r,n))return a.length;return-1}(M(n),e)},convertDataToRepresentationInfo:function(e){if(e){var n=new r.default,i=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],a=t.getRepresentationFor(e.index,i);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(a),n.DVRWindow=e.segmentAvailabilityRange,n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,n.mediaInfo=w(e.adaptation),n}return null},getDataForMedia:E,getStreamsInfo:function(e,t){var i=[],r=n;if(e&&(S(),r=v(e)),r.length>0){(!t||t>r.length)&&(t=r.length);for(var a=0;a<t;a++)i.push(A(r[a]))}return i},getMediaInfoForType:function(e,i){if(0===n.length||!e)return null;var r=T(e,n);if(!r)return null;var a=r.id;u[a]=u[a]||t.getAdaptationsForPeriod(r);var o=m(e.index,i,e);if(!o)return null;var s=t.getIndexForAdaptation(o,n[0].mpd.manifest,e.index);return w(u[a][s])},getAllMediaInfoForType:g,getAdaptationForType:m,getRealAdaptation:function(e,i){var r,a=void 0,o=T(e,n);return r=i?i.id:null,n.length>0&&o&&(a=r?t.getAdaptationForId(r,n[0].mpd.manifest,o.index):t.getAdaptationForIndex(i?i.index:null,n[0].mpd.manifest,o.index)),a},getVoRepresentations:function(e){var n=E(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,i){var s=[];if(n.length>0){var l=n[0].mpd.manifest;e instanceof o.default?s=t.getEventsForPeriod(T(e,n)):e instanceof a.default?s=t.getEventStreamForAdaptationSet(l,E(e)):e instanceof r.default&&(s=t.getEventStreamForRepresentation(l,i))}return s},getEvent:function(e,t,n){if(!e||!t)return null;var i=new l.default,r=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,c=e.id,h=e.message_data,d=n*o+s;return t[r+"/"+a]?(i.eventStream=t[r+"/"+a],i.eventStream.value=a,i.eventStream.timescale=o,i.duration=u,i.id=c,i.calculatedPresentationTime=d,i.messageData=h,i.presentationTimeDelta=s,i):null},setConfig:function(e){e&&(e.constants&&(d=e.constants),e.cea608parser&&(f=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;S(),n=v(e),u={}},getUseCalculatedLiveEdgeTimeForMediaInfo:function(e){var n=E(e);return t.getUseCalculatedLiveEdgeTimeForAdaptation(n)},getIsTextTrack:function(e){return t.getIsTextTrack(e)},getUTCTimingSources:function(){var e=b();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=n.length>0?n[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=y(e);return t.getAvailabilityStartTime(n)},getIsDynamic:function(e){var n=b(e);return t.getIsDynamic(n)},getDuration:function(e){var n=b(e);return t.getDuration(n)},getRegularPeriods:v,getLocation:function(e){return t.getLocation(e)},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,i){return t.getCodec(e,n,i)},getVoAdaptations:function(){return u},getVoPeriods:function(){return n},setCurrentMediaInfo:function(e,t,n){h[e]=h[e]||{},h[e][t]=h[e][t]||{},h[e][t]=n},reset:_},t=(0,c.default)(p).getInstance(),_(),e}d.__dashjs_factory_name="DashAdapter",t.default=u.default.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return i(e,[{key:"isMediaInfoEqual",value:function(e){if(!e)return!1;var t=this.id===e.id,n=this.viewpoint===e.viewpoint,i=this.lang===e.lang,r=this.roles.toString()===e.roles.toString(),a=this.accessibility.toString()===e.accessibility.toString(),o=this.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return t&&n&&i&&r&&a&&o}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(7)),r=n(14),a=c(n(2)),o=c(n(16)),s=c(n(232)),l=c(n(233)),u=n(62);function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t,n=this.context,a=void 0,c=void 0,h=void 0,d=e.metricsModel;function f(e){var t=d.getMetricsFor(e,!0);if(!t)return null;var n=t.HttpList,i=null,r=void 0;if(!n||n.length<=0)return null;for(r=n.length-1;r>=0;){if(n[r].responsecode){i=n[r];break}r--}return i}function p(e){var t=d.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function m(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}function g(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),i=0,r=n.length;i<r;i++){var a=n[i],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}return t={getCurrentRepresentationSwitch:function(e){return m(d.getMetricsFor(e,!0),o.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return m(d.getMetricsFor(e,!0),o.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=m(d.getMetricsFor(e,!0),o.default.BUFFER_LEVEL);return t?s.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:f,getHttpRequests:p,getCurrentDroppedFrames:function(){return m(d.getMetricsFor(i.default.VIDEO,!0),o.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return m(d.getMetricsFor(e,!0),o.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return m(e?d.getMetricsFor(e,!0):d.getMetricsFor(i.default.VIDEO,!0)||d.getMetricsFor(i.default.AUDIO,!0),o.default.DVR_INFO)},getCurrentManifestUpdate:function(){return m(d.getMetricsFor(i.default.STREAM),o.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},i=f(e);return i&&(n=g(i._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e){var t,n={},a=void 0,o=void 0;for(o=(t=p(i.default.STREAM)).length-1;o>=0;o--)if((a=t[o]).type===r.HTTPRequest.MPD_TYPE){n=g(a._responseHeaders);break}return void 0===n[e]?null:n[e]},addRepresentationSwitch:function(e,t,n,i,r){d.addRepresentationSwitch(e,t,n,i,r)},addDVRInfo:function(e,t,n,i){d.addDVRInfo(e,t,n,i)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();d.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();d.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();d.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){d.addManifestUpdate(i.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,i,r){d.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,i,r)},addSchedulingInfo:function(e,t){d.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){d.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){d.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){d.addBufferState(e,t,n)},addDroppedFrames:function(e){d.addDroppedFrames(i.default.VIDEO,e)},addPlayList:function(){h&&(d.addPlayList(h),h=null)},addDVBErrors:function(e){d.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(h=new u.PlayList).start=new Date,h.mstart=e,h.starttype=t},createPlaylistTraceMetrics:function(e,t,n){!0===a&&(a=!1,(c=new u.PlayListTrace).representationid=e,c.start=new Date,c.mstart=t,c.playbackspeed=null!==n?n.toString():null)},updatePlayListTraceMetrics:function(e){if(c)for(var t in c)c[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===a&&h&&c&&c.start){var n=c.start,i=e.getTime()-n.getTime();c.duration=i,c.stopreason=t,h.trace.push(c),a=!0}},clearAllCurrentMetrics:function(){d.clearAllCurrentMetrics()}},d=d||(0,l.default)(n).getInstance({settings:e.settings}),a=!0,c=null,h=null,t}h.__dashjs_factory_name="DashMetrics",t.default=a.default.getSingletonFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){if(void 0===n||0==+n)return Math[e](t);if(n=+n,null===(t=+t)||isNaN(t)||!("number"==typeof n&&n%1==0))return NaN;return t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))}("round",e,t)}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(7)),r=y(n(16)),a=y(n(234)),o=n(14),s=y(n(235)),l=y(n(236)),u=y(n(237)),c=y(n(238)),h=y(n(239)),d=n(240),f=y(n(241)),p=y(n(8)),m=y(n(242)),g=y(n(10)),v=y(n(2));function y(e){return e&&e.__esModule?e:{default:e}}function _(e){var t,n=(e=e||{}).settings,v=this.context,y=(0,p.default)(v).getInstance(),_=void 0;function b(){y.trigger(g.default.METRICS_CHANGED)}function E(e){y.trigger(g.default.METRIC_CHANGED,{mediaType:e}),b()}function T(e,t,n){y.trigger(g.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),E(e)}function w(e,t,n){y.trigger(g.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),E(e)}function x(e,t){var n=null;return e?(_.hasOwnProperty(e)?n=_[e]:t||(n=new a.default,_[e]=n),n):n}function A(e,t,i){var r=x(e);null!==r&&(r[t].push(i),r[t].length>n.get().streaming.metricsMaxListDepth&&r[t].shift())}function S(e,t,n){A(e,t,n),w(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete _[e],E(e)},clearAllCurrentMetrics:function(){_={},b()},getMetricsFor:x,addHttpRequest:function e(t,n,i,a,s,l,u,c,h,d,f,p,m,g,v){var y=new o.HTTPRequest;l&&l!==a&&(e(t,null,i,a,s,null,null,c,h,null,null,null,m,null,null),y.actualurl=l),y.tcpid=n,y.type=i,y.url=a,y.range=c,y.trequest=h,y.tresponse=d,y.responsecode=p,y._tfinish=f,y._stream=t,y._mediaduration=m,y._quality=s,y._responseHeaders=g,y._serviceLocation=u,v?v.forEach((function(e){!function(e,t,n,i){var r=new o.HTTPRequestTrace;r.s=t,r.d=n,r.b=i,e.trace.push(r),e.interval||(e.interval=0),e.interval+=n}(y,e.s,e.d,e.b)})):(delete y.interval,delete y.trace),S(t,r.default.HTTP_REQUEST,y)},addRepresentationSwitch:function(e,t,n,i,a){var o=new s.default;o.t=t,o.mt=n,o.to=i,a?o.lto=a:delete o.lto,S(e,r.default.TRACK_SWITCH,o)},addBufferLevel:function(e,t,n){var i=new l.default;i.t=t,i.level=n,S(e,r.default.BUFFER_LEVEL,i)},addBufferState:function(e,t,n){var i=new u.default;i.target=n,i.state=t,S(e,r.default.BUFFER_STATE,i)},addDVRInfo:function(e,t,n,i){var a=new c.default;a.time=t,a.range=i,a.manifestInfo=n,S(e,r.default.DVR_INFO,a)},addDroppedFrames:function(e,t){var n=new h.default,i=x(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,i.length>0&&i[i.length-1]==n||S(e,r.default.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,i,a,o,s,l,u){var c=new f.default;c.mediaType=e,c.t=t,c.type=n,c.startTime=i,c.availabilityStartTime=a,c.duration=o,c.quality=s,c.range=l,c.state=u,S(e,r.default.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var i=new m.default;i.loadingRequests=t,i.executedRequests=n,x(e).RequestsQueue=i,w(e,r.default.REQUESTS_QUEUE,i)},addManifestUpdate:function(e,t,n,a,o,s,l,u,c,h){var f=new d.ManifestUpdate;f.mediaType=e,f.type=t,f.requestTime=n,f.fetchTime=a,f.availabilityStartTime=o,f.presentationStartTime=s,f.clientTimeOffset=l,f.currentTime=u,f.buffered=c,f.latency=h,A(i.default.STREAM,r.default.MANIFEST_UPDATE,f),w(e,r.default.MANIFEST_UPDATE,f)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];T(e.mediaType,r.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,i,a){if(e){var o=new d.ManifestUpdateStreamInfo;o.id=t,o.index=n,o.start=i,o.duration=a,e.streamInfo.push(o),T(e.mediaType,r.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,i,a,o,s,l){if(e&&e.representationInfo){var u=new d.ManifestUpdateRepresentationInfo;u.id=t,u.index=n,u.streamIndex=i,u.mediaType=a,u.startNumber=s,u.fragmentInfoType=l,u.presentationTimeOffset=o,e.representationInfo.push(u),T(e.mediaType,r.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,S(i.default.STREAM,r.default.PLAY_LIST,e)},addDVBErrors:function(e){S(i.default.STREAM,r.default.DVB_ERRORS,e)}},_={},t}_.__dashjs_factory_name="MetricsModel",t.default=v.default.getSingletonFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(16),a=(i=r)&&i.__esModule?i:{default:i};t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=a.default.BUFFER_EMPTY}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.ManifestUpdate=function e(){i(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},t.ManifestUpdateStreamInfo=function e(){i(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},t.ManifestUpdateRepresentationInfo=function e(){i(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(8)),r=l(n(10)),a=l(n(2)),o=l(n(13)),s=l(n(67));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e,t=this.context,n=(0,i.default)(t).getInstance(),a=void 0,l=void 0,u=void 0,c=void 0;function h(e){l=e}function d(e,t,n,i){return i?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-l)):t.availabilityStartTime}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*l)/1e3}function p(e){u||void 0!==e.offset&&(h(e.offset/1e3),u=!0)}function m(){l=0,u=!1,c=NaN}function g(){n.off(r.default.TIME_SYNCHRONIZATION_COMPLETED,p,this),m()}return e={initialize:function(){m(),n.on(r.default.TIME_SYNCHRONIZATION_COMPLETED,p,this)},isTimeSyncCompleted:function(){return u},setTimeSyncCompleted:function(e){u=e},getClientTimeOffset:function(){return l},setClientTimeOffset:h,getExpectedLiveEdge:function(){return c},setExpectedLiveEdge:function(e){c=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return d.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return d.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,i={start:n.start,end:n.start+n.duration};if(!t)return i;if(!u&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var r=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0);if(e.segmentInfoType===o.default.SEGMENT_TIMELINE&&n.mpd.timeShiftBufferDepth===Number.POSITIVE_INFINITY)return function(e){var t,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],i=a.getRepresentationFor(e.index,n),r=i.SegmentTemplate.SegmentTimeline,o=i.SegmentTemplate.timescale,s=r.S_asArray,l={start:0,end:0},u=0,c=void 0,h=void 0,d=void 0;for(l.start=s[0].t/o,d=0,t=s.length;d<t;d++)c=s[d],h=0,c.hasOwnProperty("r")&&(h=c.r),u+=c.d/o*(1+h);return l.end=l.start+u,l}(e);var s=f(new Date,n),l=n.start+n.duration;i.start=Math.max(s-n.mpd.timeShiftBufferDepth,n.start);var c=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<r?r-e.availabilityTimeOffset:r;return i.end=s>=l&&s-c<l?l:s-c,i},getPeriodEnd:function(e,t){var n=e.adaptation.period;if(!t)return n.start+n.duration;if(!u&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),r=f(new Date,n),a=n.start+n.duration,o=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return Math.min(r-o,a)},calcWallTimeForSegment:function(e,t){var n=void 0,i=void 0,r=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,i=e.presentationStartTime+n,r=new Date(e.availabilityStartTime.getTime()+1e3*i)),r},reset:g},a=(0,s.default)(t).getInstance(),g(),e}u.__dashjs_factory_name="TimelineConverter",t.default=a.default.getSingletonFactory(u)},function(e,t,n){"use strict";var i={encode:function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|63&i)):i<65536?(t.push(224|i>>12),t.push(128|63&i>>6),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|63&i>>12),t.push(128|63&i>>6),t.push(128|63&i))}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var i=e[n++];i<128||(i<224?(i=(31&i)<<6,i|=63&e[n++]):i<240?(i=(15&i)<<12,i|=(63&e[n++])<<6,i|=63&e[n++]):(i=(7&i)<<18,i|=(63&e[n++])<<12,i|=(63&e[n++])<<6,i|=63&e[n++])),t.push(String.fromCharCode(i))}return t.join("")}},r={};!function(e){var t=function(t){for(var n=0,i=[],r=0|t.length/3;0<r--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,i.push(e.charAt(63&a>>18)),i.push(e.charAt(63&a>>12)),i.push(e.charAt(63&a>>6)),i.push(e.charAt(63&a))}if(2==t.length-n){a=(t[n]<<16)+(t[n+1]<<8);i.push(e.charAt(63&a>>18)),i.push(e.charAt(63&a>>12)),i.push(e.charAt(63&a>>6)),i.push("=")}else if(1==t.length-n){a=t[n]<<16;i.push(e.charAt(63&a>>18)),i.push(e.charAt(63&a>>12)),i.push("==")}return i.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,i=[],r=0|e.length/4;0<r--;){var a=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];i.push(255&a>>16),i.push(255&a>>8),i.push(255&a),t+=4}return i&&("="==e.charAt(t-2)?(i.pop(),i.pop()):"="==e.charAt(t-1)&&i.pop()),i},l={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}};r.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},r.encodeASCII=function(e){var n=l.encode(e);return t(n)},r.decodeASCII=function(e){var t=o(e);return l.decode(t)},r.encode=function(e){var n=i.encode(e);return t(n)},r.decode=function(e){var t=o(e);return i.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=r.decode,t.decodeArray=r.decodeArray,t.encode=r.encode,t.encodeASCII=r.encodeASCII},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(246)),r=l(n(44)),a=l(n(248)),o=l(n(106)),s=l(n(105));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context;return{createMetricsReporting:function(t){return(0,i.default)(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}),(0,a.default)(e).create(t)},getReportingFactory:function(){return(0,s.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,o.default)(e).getInstance()}}}u.__dashjs_factory_name="MetricsReporting";var c=dashjs.FactoryMaker.getClassFactory(u);c.events=r.default,dashjs.FactoryMaker.updateClassFactory(u.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(247)),r=a(n(44));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=void 0,n=void 0,a=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,l=e.events;function u(e){var t=new i.default;if(n){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function h(e){u({errorcode:i.default.BASE_URL_CHANGED,servicelocation:e.entry})}function d(){u({errorcode:i.default.BECAME_REPORTER})}function f(e){switch(e.metric){case s.HTTP_REQUEST:(0===(t=e.value).responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&u({errorcode:t.responsecode||i.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}var t}function p(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=i.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=i.default.CORRUPT_MEDIA_OTHER;break;default:return}u({errorcode:t})}function m(){a.on(l.MANIFEST_UPDATED,c,t),a.on(l.SERVICE_LOCATION_BLACKLIST_CHANGED,h,t),a.on(l.METRIC_ADDED,f,t),a.on(l.METRIC_UPDATED,f,t),a.on(l.PLAYBACK_ERROR,p,t),a.on(r.default.BECAME_REPORTING_PLAYER,d,t)}return t={initialise:m,reset:function(){a.off(l.MANIFEST_UPDATED,c,t),a.off(l.SERVICE_LOCATION_BLACKLIST_CHANGED,h,t),a.off(l.METRIC_ADDED,f,t),a.off(l.METRIC_UPDATED,f,t),a.off(l.PLAYBACK_ERROR,p,t),a.off(r.default.BECAME_REPORTING_PLAYER,d,t)}},m(),t}o.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};i.SSL_CONNECTION_FAILED_PREFIX="SSL",i.DNS_RESOLUTION_FAILED="C00",i.HOST_UNREACHABLE="C01",i.CONNECTION_REFUSED="C02",i.CONNECTION_ERROR="C03",i.CORRUPT_MEDIA_ISOBMFF="M00",i.CORRUPT_MEDIA_OTHER="M01",i.BASE_URL_CHANGED="F00",i.BECAME_REPORTER="S00",t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(249)),r=o(n(260)),a=o(n(44));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t={},n=this.context,o=e.eventBus,s=e.events;function l(s){if(!s.error){var l=Object.keys(t);(0,r.default)(n).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(s.manifest).forEach((function(r){var a=JSON.stringify(r);if(t.hasOwnProperty(a))l.splice(a,1);else try{var o=(0,i.default)(n).create(e);o.initialize(r),t[a]=o}catch(e){}})),l.forEach((function(e){t[e].reset(),delete t[e]})),o.trigger(a.default.METRICS_INITIALISATION_COMPLETE)}}function u(){Object.keys(t).forEach((function(e){t[e].reset()})),t={}}return o.on(s.MANIFEST_UPDATED,l),o.on(s.STREAM_TEARDOWN_COMPLETE,u),{reset:function(){o.off(s.MANIFEST_UPDATED,l),o.off(s.STREAM_TEARDOWN_COMPLETE,u)}}}s.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(250)),r=o(n(251)),a=o(n(255));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=void 0,n=void 0,o=void 0,s=this.context;function l(){t&&t.reset(),n&&n.reset(),o&&o.reset()}return{initialize:function(u){try{(o=(0,i.default)(s).create({mediaElement:e.mediaElement})).initialize(u.Range),(n=(0,r.default)(s).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(u.Reporting,o),(t=(0,a.default)(s).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(u.metrics,n)}catch(e){throw l(),e}},reset:l}}s.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(82),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t,n=!1,i=this.context,r=void 0,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,n=t+e.duration;r.add(t,n)})),n=!!e[0]._useWallClockTime)},reset:function(){r.clear()},isEnabled:function(){var e,t=r.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:o.currentTime;for(var i=0;i<t;i+=1){var a=r.start(i),s=r.end(i);if(a<=e&&e<s)return!0}return!1}},r=(0,a.default)(i).create(),t}o.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(105),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=[],n=(0,a.default)(this.context).getInstance(e);return{initialize:function(e,i){e.some((function(e){var r=n.create(e,i);if(r)return t.push(r),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,n){t.forEach((function(t){return t.report(e,n)}))}}}o.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(253)),r=a(n(254));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t,n=this.context,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=[],d=e.metricsConstants;function f(){s=!1,l=!1,u=null,c=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),l&&c.isEnabled()&&t.forEach((function(t){var n=a.serialise(t);e!==d.DVB_ERRORS&&(n="metricname="+e+"&"+n),function(e,t,n){var i=new XMLHttpRequest,r=function(){var e=h.indexOf(i);-1!==e&&(h.splice(e,1),i.status>=200&&i.status<300?t&&t():n&&n())};h.push(i);try{i.open("GET",e),i.onloadend=r,i.onerror=r,i.send()}catch(e){i.onerror()}}(n=u+"?"+n,null,(function(){l=!1}))}))},initialize:function(e,t){var n=void 0;if(c=t,!(u=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");s||((n=e["dvb:probability"]||e["dvb:priority"]||0)&&(1e3===n||n/1e3>=o.random())&&(l=!0),s=!0)},reset:function(){f()}},a=(0,i.default)(n).getInstance(),o=(0,r.default)(n).getInstance(),f(),t}o.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";function i(){return{serialise:function e(t){var n=[],i=[],r=void 0,a=void 0;for(r in t)if(t.hasOwnProperty(r)&&0!==r.indexOf("_")){if(null==(a=t[r])&&(a=""),Array.isArray(a)){if(!a.length)continue;i=[],a.forEach((function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);i.push(n?t:e(t))})),a=i.map(encodeURIComponent).join(",")}else"string"==typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"==typeof a&&(a=Math.round(a));n.push(r+"="+a)}return n.join("&")}}}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},function(e,t,n){"use strict";function i(){var e,t=window.crypto||window.msCrypto,n=Uint32Array,i=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,r=void 0,a=void 0;function o(){t&&(r||(r=new n(10)),t.getRandomValues(r),a=0)}return e={random:function(e,n){var s=void 0;return e||(e=0),n||(n=1),t?(a===r.length&&o(),s=r[a]/i,a+=1):s=Math.random(),s*(n-e)+e}},o(),e}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(106),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t=[],n=void 0,i=this.context,r=e.eventBus,o=e.events,s=(0,a.default)(i).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function l(e){t.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return n={initialize:function(e,i){e.split(",").forEach((function(e,n,r){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=r[n+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete r[n+1])}(a=s.create(e,i))&&t.push(a)})),r.on(o.METRIC_ADDED,l,n),r.on(o.METRIC_UPDATED,l,n)},reset:function(){r.off(o.METRIC_ADDED,l,n),r.off(o.METRIC_UPDATED,l,n),t.forEach((function(e){return e.reset()})),t=[]}}}o.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(107),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=this.context,l=(0,a.default)(s).getInstance(),u=[],c=e.metricsConstants;function h(){var e=function(){try{return Object.keys(u).map((function(e){return u[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(i,e))}return{initialize:function(e,a,o){a&&(n=l.validateN(o),t=a,i=l.reconstructFullMetricName(e,o),r=setInterval(h,n))},reset:function(){clearInterval(r),r=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===c.BUFFER_LEVEL&&(u[n]=t)}}}o.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(44),a=(i=r)&&i.__esModule?i:{default:i};t.default=dashjs.FactoryMaker.getClassFactory((function(e){var t=void 0,n=(e=e||{}).eventBus,i=e.metricsConstants;function r(){n.off(a.default.METRICS_INITIALISATION_COMPLETE,r,this),n.trigger(a.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,i){i&&(t=i,n.on(a.default.METRICS_INITIALISATION_COMPLETE,r,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===i.DVB_ERRORS&&t&&t.report(e,n)}}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(107),a=(i=r)&&i.__esModule?i:{default:i};function o(e){e=e||{};var t=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=[],l=(0,a.default)(this.context).getInstance(),u=e.metricsConstants;function c(){var e=s;e.length&&t&&t.report(r,e),s=[]}return{initialize:function(e,a,s,u){a&&(n=l.validateN(s),t=a,u&&u.length&&(i=u),r=l.reconstructFullMetricName(e,s,u),o=setInterval(c,n))},reset:function(){clearInterval(o),o=null,n=null,i=null,s=[],t=null},handleNewMetric:function(e,t){e===u.HTTP_REQUEST&&(i&&i!==t.type||s.push(t))}}}o.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";function i(){var e=void 0,t=void 0;return{initialize:function(n,i){e=n,t=i},reset:function(){t=null,e=void 0},handleNewMetric:function(n,i){n===e&&t&&t.report(e,i)}}}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(261)),r=o(n(262)),a=o(n(263));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).adapter,n=e.constants;return{getMetrics:function(e){var o=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach((function(s){var l=new i.default,u=t.getIsDynamic(e);s.hasOwnProperty("metrics")&&(l.metrics=s.metrics,s.Range_asArray&&s.Range_asArray.forEach((function(i){var a=new r.default;a.starttime=function(e,i,r){var a=void 0,o=void 0,s=0;return i?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,r&&r.hasOwnProperty(n.START_TIME)&&(o+=r.starttime),o}(e,u,i),i.hasOwnProperty("duration")?a.duration=i.duration:a.duration=t.getDuration(e),a._useWallClockTime=u,l.Range.push(a)})),s.Reporting_asArray&&(s.Reporting_asArray.forEach((function(e){var t=new a.default;if(e.hasOwnProperty(n.SCHEME_ID_URI)){for(var i in t.schemeIdUri=e.schemeIdUri,e)e.hasOwnProperty(i)&&(t[i]=e[i]);l.Reporting.push(t)}})),o.push(l)))})),o}}}s.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(265)),r=c(n(45)),a=c(n(275)),o=c(n(33)),s=c(n(276)),l=c(n(277)),u=c(n(278));function c(e){return e&&e.__esModule?e:{default:e}}var h=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],d=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function f(){var e=void 0,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];if("function"==typeof e[i[Object.keys(i)[0]]])return i}return null}return e={createProtectionSystem:function(a){var o=null,c=(0,r.default)(t).getInstance();c.setConfig({debug:a.debug,BASE64:a.BASE64}),c.initialize();var f=function(i){var r=i.debug,a=r.getLogger(e),o=i.eventBus,c=i.errHandler,f=i.videoModel?i.videoModel.getElement():null;return f&&void 0===f.onencrypted||f&&void 0===f.mediaKeys?n(f,d)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,l.default)(t).create({debug:r,eventBus:o,events:i.events,api:n(f,d)})):n(f,h)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,u.default)(t).create({debug:r,eventBus:o,errHandler:c,events:i.events,api:n(f,h)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,s.default)(t).create({debug:r,eventBus:o,events:i.events}))}(a);return!o&&f&&(o=(0,i.default)(t).create({protectionModel:f,protectionKeyController:c,eventBus:a.eventBus,debug:a.debug,events:a.events,BASE64:a.BASE64,constants:a.constants}),a.capabilities.setEncryptedMediaSupported(!0)),o}}}f.__dashjs_factory_name="Protection";var p=dashjs.FactoryMaker.getClassFactory(f);p.events=a.default,p.errors=o.default,dashjs.FactoryMaker.updateClassFactory(f.__dashjs_factory_name,p),t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=u(n(26)),a=u(n(266)),o=u(n(69)),s=u(n(33)),l=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=(e=e||{}).protectionKeyController,n=e.protectionModel,u=e.eventBus,c=e.events,h=e.debug,d=e.BASE64,f=e.constants,p=[],m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function w(){if(!(u&&u.hasOwnProperty("on")&&t&&t.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function x(e,i){var a=r.default.getPSSHForKeySystem(T,e),o=M(T);if(a){for(var h=n.getAllInitData(),d=0;d<h.length;d++)if(t.initDataEquals(a,h[d]))return void g.warn("DRM: Ignoring initData because we have already seen it!");try{n.createKeySession(a,o,R(T),i)}catch(e){u.trigger(c.KEY_SESSION_CREATED,{data:null,error:new l.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e?n.createKeySession(e,o,R(T),i):u.trigger(c.KEY_SESSION_CREATED,{data:null,error:new l.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(T?T.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function A(e,t){w(),n.loadKeySession(e,t,R(T))}function S(e){w(),e?(n.setMediaElement(e),u.on(c.NEED_KEY,O,this)):null===e&&(n.setMediaElement(e),u.off(c.NEED_KEY,O,this))}function M(e){var t=null;if(e){var n=e.systemString;_&&(t=n in _?_[n]:null)}return t}function C(e){var t=M(e),n=[],i=[],r=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:E,s=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:E,l=R(e),u=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",c=t&&t.persistentState?t.persistentState:"temporary"===l?"optional":"required";return y.forEach((function(e){e.type===f.AUDIO?n.push(new a.default(e.codec,r)):e.type===f.VIDEO&&i.push(new a.default(e.codec,s))})),new o.default(n,i,u,c,[l])}function R(e){var t=M(e);return t&&t.sessionType?t.sessionType:b}function I(e,i){var r=this,a=[];e=e.sort((function(t,n){return(_&&_[t.ks.systemString]&&_[t.ks.systemString].priority>=0?_[t.ks.systemString].priority:e.length)-(_&&_[n.ks.systemString]&&_[n.ks.systemString].priority>=0?_[n.ks.systemString].priority:e.length)}));var o=void 0;if(T)for(o=0;o<e.length;o++){if(T===e[o].ks)if("break"===function(){a.push({ks:e[o].ks,configs:[C(T)]});return u.on(c.KEY_SYSTEM_ACCESS_COMPLETE,(function t(n){u.off(c.KEY_SYSTEM_ACCESS_COMPLETE,t,r),n.error?i||u.trigger(c.KEY_SYSTEM_SELECTED,{error:new l.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+n.error)}):(g.info("DRM: KeySystem Access Granted"),u.trigger(c.KEY_SYSTEM_SELECTED,{data:n.data}),e[o].sessionId?A(e[o].sessionId,e[o].initData):e[o].initData&&x(e[o].initData,e[o].cdmData))}),r),n.requestKeySystemAccess(a),"break"}())break}else if(void 0===T){T=null,v.push(e);for(var h=0;h<e.length;h++)a.push({ks:e[h].ks,configs:[C(e[h].ks)]});var f=void 0,p=function e(t){u.off(c.KEY_SYSTEM_ACCESS_COMPLETE,e,r),t.error?(T=void 0,u.off(c.INTERNAL_KEY_SYSTEM_SELECTED,m,r),i||u.trigger(c.KEY_SYSTEM_SELECTED,{data:null,error:new l.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+t.error)})):(f=t.data,g.info("DRM: KeySystem Access Granted ("+f.keySystem.systemString+")!  Selecting key system..."),n.selectKeySystem(f))},m=function e(a){if(u.off(c.INTERNAL_KEY_SYSTEM_SELECTED,e,r),u.off(c.KEY_SYSTEM_ACCESS_COMPLETE,p,r),a.error)T=void 0,i||u.trigger(c.KEY_SYSTEM_SELECTED,{data:null,error:new l.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+a.error)});else{if(!n)return;T=n.getKeySystem(),u.trigger(c.KEY_SYSTEM_SELECTED,{data:f});var h=M(T);h&&h.serverCertificate&&h.serverCertificate.length>0&&n.setServerCertificate(d.decodeArray(h.serverCertificate).buffer);for(var m=0;m<v.length;m++)for(o=0;o<v[m].length;o++)if(T===v[m][o].ks){if(t.isClearKey(T)&&h&&h.hasOwnProperty("clearkeys")){var g={kids:Object.keys(h.clearkeys)};v[m][o].initData=(new TextEncoder).encode(JSON.stringify(g))}v[m][o].sessionId?A(v[m][o].sessionId,v[m][o].initData):null!==v[m][o].initData&&x(v[m][o].initData,v[m][o].cdmData);break}}};u.on(c.INTERNAL_KEY_SYSTEM_SELECTED,m,r),u.on(c.KEY_SYSTEM_ACCESS_COMPLETE,p,r),n.requestKeySystemAccess(a)}else v.push(e)}function P(e,t){u.trigger(c.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function L(e){e.error?u.trigger(c.KEY_STATUSES_CHANGED,{data:null,error:e.error}):g.debug("DRM: key status = "+e.status)}function D(e){g.debug("DRM: onKeyMessage");var a=e.data;u.trigger(c.KEY_MESSAGE,{data:a});var o=a.messageType?a.messageType:"license-request",h=a.message,d=a.sessionToken,f=M(T),p=T?T.systemString:null,m=t.getLicenseServer(T,f,o),v={sessionToken:d,messageType:o};if(h&&0!==h.byteLength){if(!m)return g.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+d.getSessionID()),void P(v);if(t.isClearKey(T)){var y=t.processClearKeyLicenseRequest(T,f,h);if(y)return g.debug("DRM: ClearKey license request handled by application!"),P(v),void n.updateKeySession(d,y)}var _=null;if(f&&f.serverURL){var b=f.serverURL;"string"==typeof b&&""!==b?_=b:"object"===(void 0===b?"undefined":i(b))&&b.hasOwnProperty(o)&&(_=b[o])}else f&&f.laURL&&""!==f.laURL?_=f.laURL:(_=T.getLicenseServerURLFromInitData(r.default.getPSSHData(d.initData)))||(_=e.data.laURL);if(_=m.getServerURLFromMessage(_,h,o)){var E={},w=!1,x=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(w=!0),E[t]=e[t]};f&&x(f.httpRequestHeaders),x(T.getRequestHeadersFromMessage(h)),f&&"boolean"==typeof f.withCredentials&&(w=f.withCredentials);var A=function(e,t,n,i){var r=e.response?m.getErrorResponse(e.response,n,i):"NONE";P(t,new l.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+r))},S=T.getLicenseRequestFromMessage(h),C=m.getHTTPMethod(o),R=m.getResponseType(p,o),I=f&&!isNaN(f.httpTimeout)?f.httpTimeout:8e3;!function e(t,n,i,r,a,o,s,l,u,c,h){var d=new XMLHttpRequest;d.open(i,t,!0),d.responseType=r,d.withCredentials=a,l>0&&(d.timeout=l);for(var f in n)d.setRequestHeader(f,n[f]);var p=function(){s--,setTimeout((function(){e(t,n,i,r,a,o,s,l,u,c,h)}),1e3)};d.onload=function(){200===this.status||s<=0?u(this):(g.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+s),p())},d.ontimeout=d.onerror=function(){s<=0?h(this):(g.warn("License request network request failed . Retrying it... Pending retries: "+s),p())},d.onabort=function(){c(this)},d.send(o)}(_,E,C,R,w,S,3,I,(function(e){if(n)if(200===e.status){var t=m.getLicenseMessage(e.response,p,o);null!==t?(P(v),n.updateKeySession(d,t)):A(e,v,p,o)}else A(e,v,p,o)}),(function(e){P(v,new l.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+p+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}),(function(e){P(v,new l.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+p+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}))}else P(v,new l.default(s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else P(v,new l.default(s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function O(e,i){if(g.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===y.length&&(g.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(i=void 0===i?1:i+1)<5))p.push(setTimeout((function(){O(e,i)}),500));else{var a=e.key.initData;if(ArrayBuffer.isView(a)&&(a=a.buffer),T){var o=r.default.getPSSHForKeySystem(T,a);if(o)for(var s=n.getAllInitData(),l=0;l<s.length;l++)if(t.initDataEquals(o,s[l]))return void g.warn("DRM: Ignoring initData because we have already seen it!")}g.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(a)));var u=t.getSupportedKeySystems(a,_);0!==u.length?I(u,!1):g.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else g.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return m={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");w(),u.on(c.INTERNAL_KEY_MESSAGE,D,this),u.on(c.INTERNAL_KEY_STATUS_CHANGED,L,this),y.push(e);var n=t.getSupportedKeySystemsFromContentProtection(e.contentProtection);n&&n.length>0&&I(n,!0)},createKeySession:x,loadKeySession:A,removeKeySession:function(e){w(),n.removeKeySession(e)},closeKeySession:function(e){w(),n.closeKeySession(e)},setServerCertificate:function(e){w(),n.setServerCertificate(e)},setMediaElement:S,setSessionType:function(e){b=e},setRobustnessLevel:function(e){E=e},setProtectionData:function(e){_=e,t.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return w(),t.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return t?t.getKeySystems():[]},setKeySystems:function(e){t&&t.setKeySystems(e)},stop:function(){n&&n.stop()},reset:function(){w(),u.off(c.INTERNAL_KEY_MESSAGE,D,this),u.off(c.INTERNAL_KEY_STATUS_CHANGED,L,this),S(null),T=void 0,n&&(n.reset(),n=null),p.forEach((function(e){return clearTimeout(e)})),p=[],y=[]}},g=h.getLogger(m),v=[],y=[],b="temporary",E="",m}c.__dashjs_factory_name="ProtectionController",t.default=dashjs.FactoryMaker.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(70)),r=s(n(71)),a=s(n(26)),o=s(n(23));function s(e){return e&&e.__esModule?e:{default:e}}var l="e2719d58-a985-b3c9-781a-b030af78d30e",u=o.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=(e=e||{}).BASE64;return{uuid:l,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:u,getInitData:function(e){return a.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<a.kids.length;s++){var l=a.kids[s],u=e.clearkeys&&e.clearkeys.hasOwnProperty(l)?e.clearkeys[l]:null;if(!u)throw new Error("DRM: ClearKey keyID ("+l+") is not known!");o.push(new i.default(l,u))}n=new r.default(o)}return n}}}c.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(70)),r=s(n(71)),a=s(n(26)),o=s(n(23));function s(e){return e&&e.__esModule?e:{default:e}}var l="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",u=o.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=void 0,n=e.BASE64,o=e.debug.getLogger(t);return t={uuid:l,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:u,getInitData:function(e){return a.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],l=0;l<a.kids.length;l++){var u=a.kids[l],c=e.clearkeys&&e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!c)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");s.push(new i.default(u,c))}n=new r.default(s),o.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}c.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(26)),r=a(n(23));function a(e){return e&&e.__esModule?e:{default:e}}var o="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",s=r.default.WIDEVINE_KEYSTEM_STRING;function l(e){var t=null,n=(e=e||{}).BASE64;return{uuid:o,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:s,init:function(e){e&&(t=e)},getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}l.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(26)),r=a(n(23));function a(e){return e&&e.__esModule?e:{default:e}}var o="9a04f079-9840-4286-ab92-e65be0885f95",s=r.default.PLAYREADY_KEYSTEM_STRING,l=void 0;function u(e){var t="utf-16",n=(e=e||{}).BASE64;function r(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:o,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:s,getInitData:function(e){var t,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=0,c=null,h=void 0,d=void 0;if(r(),!e)return null;if("pssh"in e)return i.default.parseInitDataFromContentProtection(e,n);if("pro"in e)c=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;c=n.decodeArray(e.prheader.__text)}return t=c.length,a=4+s.length+l.length+4+t,o=new ArrayBuffer(a),h=new Uint8Array(o),(d=new DataView(o)).setUint32(u,a),u+=4,h.set(s,u),u+=s.length,h.set(l,u),u+=l.length,d.setUint32(u,t),u+=4,h.set(c,u),u+=t,h.buffer},getRequestHeadersFromMessage:function(e){var n,i=void 0,r={},a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,o);for(var s=(i=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),l=i.getElementsByTagName("value"),u=0;u<s.length;u++)r[s[u].childNodes[0].nodeValue]=l[u].childNodes[0].nodeValue;return r.hasOwnProperty("Content")&&(r["Content-Type"]=r.Content,delete r.Content),r.hasOwnProperty("Content-Type")||(r["Content-Type"]="text/xml; charset=utf-8"),r},getLicenseRequestFromMessage:function(e){var i=null,a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);r();var s=String.fromCharCode.apply(null,o),l=a.parseFromString(s,"application/xml");if(!l.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var u=l.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return u&&(i=n.decode(u)),i},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),i=6,r=new DOMParser,a=0;a<n;a++){var o=t.getUint16(i,!0);i+=2;var s=t.getUint16(i,!0);if(i+=2,1===o){var l=e.slice(i,i+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),c=r.parseFromString(u,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var h=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(h)return h}if(c.getElementsByTagName("LUI_URL")[0]){var d=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(d)return d}}else i+=s}return null},getCDMData:function(){var e=void 0,t=void 0,i=void 0,a=void 0;if(r(),l&&l.cdmData){for(e=[],a=0;a<l.cdmData.length;++a)e.push(l.cdmData.charCodeAt(a)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=n.encode(e),t='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",e),i=[],a=0;a<t.length;++a)i.push(t.charCodeAt(a)),i.push(0);return new Uint8Array(i).buffer}return null},getSessionId:function(e){return l&&l.sessionId?l.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e},init:function(e){e&&(l=e)}}}u.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(23),a=(i=r)&&i.__esModule?i:{default:i};function o(e){var t=(e=e||{}).BASE64,n={};n[a.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[a.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,i){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[i].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}o.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";function i(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var i=t(n),r=(new window.DOMParser).parseFromString(i,"text/xml"),a=r?r.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o?o.getElementsByTagNameNS(e,"Fault")[0]:null)return null}return n}function i(n){var i="",r="",a="",o=-1,s=-1;if(window.DOMParser){var l=t(n),u=(new window.DOMParser).parseFromString(l,"text/xml"),c=u?u.getElementsByTagNameNS(e,"Envelope")[0]:null,h=c?c.getElementsByTagNameNS(e,"Body")[0]:null,d=h?h.getElementsByTagNameNS(e,"Fault")[0]:null,f=d?d.getElementsByTagName("detail")[0]:null,p=f?f.getElementsByTagName("Exception")[0]:null,m=null;if(null===d)return l;i=(m=d.getElementsByTagName("faultstring")[0].firstChild)?m.nodeValue:null,null!==p&&(r=(m=p.getElementsByTagName("StatusCode")[0])?m.firstChild.nodeValue:null,o=(a=(m=p.getElementsByTagName("Message")[0])?m.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var g="code: "+r+", name: "+i;return a&&(g+=", message: "+a),g}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return i.call(this,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},function(e,t,n){"use strict";function i(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(t,"__esModule",{value:!0}),i.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(70)),r=a(n(71));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var i=0;i<n.kids.length;i++)e+=n.kids[i]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var a=e.keys[n],o=a.kid.replace(/=/g,""),s=a.k.replace(/=/g,"");t.push(new i.default(o,s))}return new r.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}o.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(36);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((i=r)&&i.__esModule?i:{default:i}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(45)),r=c(n(72)),a=c(n(33)),o=c(n(12)),s=c(n(73)),l=c(n(74)),u=c(n(23));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,h=e.debug,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function E(e){for(var t=0;t<v.length;t++)if(v[t]===e){v.splice(t,1);break}}function T(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function w(e,t,i,r){var l={session:e,initData:t,sessionId:r,handleEvent:function(e){switch(e.type){case"keystatuseschange":n.trigger(c.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=T(arguments);switch(e.status){case"expired":n.trigger(c.INTERNAL_KEY_STATUS_CHANGED,{error:new o.default(a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:n.trigger(c.INTERNAL_KEY_STATUS_CHANGED,e)}}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new s.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){var e=T(arguments);"usable"===e.status&&(t=!0)})),t},getSessionType:function(){return i}};return e.addEventListener("keystatuseschange",l),e.addEventListener("message",l),e.closed.then((function(){E(l),f.debug("DRM: Session closed.  SessionID = "+l.getSessionID()),n.trigger(c.KEY_SESSION_CLOSED,{data:l.getSessionID()})})),v.push(l),l}return d={getAllInitData:function(){for(var e=[],t=0;t<v.length;t++)v[t].initData&&e.push(v[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,i){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess)return void n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"});!function(i){var r=t[i].ks,a=t[i].configs,o=r.systemString;o===u.default.PLAYREADY_KEYSTEM_STRING&&"required"===a[0].persistentState&&(o+=".recommendation"),navigator.requestMediaKeySystemAccess(o,a).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,i=new l.default(r,t);i.mksa=e,n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:i})})).catch((function(r){++i<t.length?e(t,i):n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+r.message})}))}(i)}(e,0)},getKeySystem:function(){return p},selectKeySystem:function(e){e.mksa.createMediaKeys().then((function(t){p=e.keySystem,g=t,m?m.setMediaKeys(g).then((function(){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)})):n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)})).catch((function(){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))},setMediaElement:function(e){m!==e&&(m&&(m.removeEventListener("encrypted",y),m.setMediaKeys&&m.setMediaKeys(null)),(m=e)&&(m.addEventListener("encrypted",y),m.setMediaKeys&&g&&m.setMediaKeys(g)))},setServerCertificate:function(e){if(!p||!g)throw new Error("Can not set server certificate until you have selected a key system");g.setServerCertificate(e).then((function(){f.info("DRM: License server certificate successfully updated."),n.trigger(c.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){n.trigger(c.SERVER_CERTIFICATE_UPDATED,{error:new o.default(a.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,a.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e,t,i){if(!p||!g)throw new Error("Can not create sessions until you have selected a key system");var r=g.createSession(i),s=w(r,e,i),l=this.getKeySystem().systemString===u.default.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";r.generateRequest(l,e).then((function(){f.debug("DRM: Session created.  SessionID = "+s.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:s})})).catch((function(e){E(s),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var i=e.session;_.isClearKey(p)&&(t=t.toJWK()),i.update(t).catch((function(t){n.trigger(c.KEY_ERROR,{data:new o.default(a.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e,t,i){if(!p||!g)throw new Error("Can not load sessions until you have selected a key system");for(var r=0;r<v.length;r++)if(e===v[r].sessionId)return void f.warn("DRM: Ignoring session ID because we have already seen it!");var s=g.createSession(i),l=w(s,t,i,e);s.load(e).then((function(t){t?(f.debug("DRM: Session loaded.  SessionID = "+l.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:l})):(E(l),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))})).catch((function(t){E(l),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){f.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),n.trigger(c.KEY_SESSION_REMOVED,{data:e.getSessionID()})}),(function(t){n.trigger(c.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})}))},closeKeySession:function(e){b(e).catch((function(t){E(e),n.trigger(c.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})}))},stop:function(){for(var e=void 0,t=0;t<v.length;t++)(e=v[t]).getUsable()||b(e).catch((function(){E(e)}))},reset:function(){var e=v.length,t=void 0;0!==e?function(){for(var i=function(e){E(e),0===v.length&&(m?(m.removeEventListener("encrypted",y),m.setMediaKeys(null).then((function(){n.trigger(c.TEARDOWN_COMPLETE)}))):n.trigger(c.TEARDOWN_COMPLETE))},r=0;r<e;r++)!function(e){t.session.closed.then((function(){i(e)})),b(t).catch((function(){i(e)}))}(t=v[r])}():n.trigger(c.TEARDOWN_COMPLETE)}},f=h.getLogger(d),p=null,m=null,g=null,v=[],_=(0,i.default)(t).getInstance(),y={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new r.default(t,e.initDataType)})}}}},d}h.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(45)),r=c(n(72)),a=c(n(12)),o=c(n(33)),s=c(n(73)),l=c(n(69)),u=c(n(74));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,h=e.debug,d=e.api,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;function T(){try{for(var e=0;e<_.length;e++)w(_[e]);m&&m.removeEventListener(d.needkey,b),n.trigger(c.TEARDOWN_COMPLETE)}catch(e){n.trigger(c.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function w(e){var t=e.session;t.removeEventListener(d.error,e),t.removeEventListener(d.message,e),t.removeEventListener(d.ready,e),t.removeEventListener(d.close,e);for(var n=0;n<_.length;n++)if(_[n]===e){_.splice(n,1);break}t[d.release]()}function x(){var e=null,t=function(){m.removeEventListener("loadedmetadata",e),m[d.setMediaKeys](v),n.trigger(c.VIDEO_ELEMENT_SELECTED)};m.readyState>=1?t():(e=t.bind(this),m.addEventListener("loadedmetadata",e))}return f={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,i=0;i<e.length;i++)for(var r=e[i].ks.systemString,a=e[i].configs,o=null,s=null,h=0;h<a.length;h++){var f=a[h].audioCapabilities,p=a[h].videoCapabilities;if(f&&0!==f.length){o=[];for(var m=0;m<f.length;m++)window[d.MediaKeys].isTypeSupported(r,f[m].contentType)&&o.push(f[m])}if(p&&0!==p.length){s=[];for(var g=0;g<p.length;g++)window[d.MediaKeys].isTypeSupported(r,p[g].contentType)&&s.push(p[g])}if(!(!o&&!s||o&&0===o.length||s&&0===s.length)){t=!0;var v=new l.default(o,s),y=E.getKeySystemBySystemString(r);n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:new u.default(y,v)});break}}t||n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return g},selectKeySystem:function(e){try{v=e.mediaKeys=new window[d.MediaKeys](e.keySystem.systemString),g=e.keySystem,y=e,m&&x(),n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+g.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){m!==e&&(m&&m.removeEventListener(d.needkey,b),(m=e)&&(m.addEventListener(d.needkey,b),v&&x()))},createKeySession:function(e,t,i,r){if(!g||!v||!y)throw new Error("Can not create sessions until you have selected a key system");var l=null;if(y.ksConfiguration.videoCapabilities&&y.ksConfiguration.videoCapabilities.length>0&&(l=y.ksConfiguration.videoCapabilities[0]),null===l&&y.ksConfiguration.audioCapabilities&&y.ksConfiguration.audioCapabilities.length>0&&(l=y.ksConfiguration.audioCapabilities[0]),null===l)throw new Error("Can not create sessions for unknown content types.");var u=l.contentType,h=v.createSession(u,new Uint8Array(e),r?new Uint8Array(r):null),f=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case d.error:n.trigger(c.KEY_ERROR,{data:new a.default(o.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case d.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new s.default(this,t,e.destinationURL)});break;case d.ready:p.debug("DRM: Key added."),n.trigger(c.KEY_ADDED);break;case d.close:p.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),n.trigger(c.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(h,e);h.addEventListener(d.error,f),h.addEventListener(d.message,f),h.addEventListener(d.ready,f),h.addEventListener(d.close,f),_.push(f),p.debug("DRM: Session created.  SessionID = "+f.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:f})},updateKeySession:function(e,t){var n=e.session;E.isClearKey(g)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:w,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:T,reset:T},p=h.getLogger(f),m=null,g=null,v=null,y=null,_=[],E=(0,i.default)(t).getInstance(),b={handleEvent:function(e){switch(e.type){case d.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new r.default(t,"cenc")})}}}},f}h.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(45)),r=c(n(72)),a=c(n(12)),o=c(n(73)),s=c(n(69)),l=c(n(74)),u=c(n(33));function c(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,h=e.debug,d=e.api,f=e.errHandler,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function w(){g&&S();for(var e=0;e<b.length;e++)x(b[e]);n.trigger(c.TEARDOWN_COMPLETE)}function x(e){try{g[d.cancelKeyRequest](v.systemString,e.sessionID)}catch(t){n.trigger(c.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function A(e,t){if(t&&e){for(var n=e.length,i=0;i<n;i++)if(e[i].sessionID==t)return e[i];return null}return null}function S(){g.removeEventListener(d.keyerror,T),g.removeEventListener(d.needkey,T),g.removeEventListener(d.keymessage,T),g.removeEventListener(d.keyadded,T)}return p={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);for(var n=0;n<b.length;n++)e.push(b[n].initData);return e},requestKeySystemAccess:function(e){var t=g;t||(t=document.createElement("video"));for(var i=!1,r=0;r<e.length;r++)for(var a=e[r].ks.systemString,o=e[r].configs,u=null,h=0;h<o.length;h++){var d=o[h].videoCapabilities;if(d&&0!==d.length){u=[];for(var f=0;f<d.length;f++)""!==t.canPlayType(d[f].contentType,a)&&u.push(d[f])}if(u&&(!u||0!==u.length)){i=!0;var p=new s.default(null,u),m=y.getKeySystemBySystemString(a);n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:new l.default(m,p)});break}}i||n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){v=e.keySystem,n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(g!==e){if(g){S();for(var t=0;t<b.length;t++)x(b[t]);b=[]}(g=e)&&(g.addEventListener(d.keyerror,T),g.addEventListener(d.needkey,T),g.addEventListener(d.keymessage,T),g.addEventListener(d.keyadded,T),n.trigger(c.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!v)throw new Error("Can not create sessions until you have selected a key system");if(E||0===b.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return _.push(t),g[d.generateKeyRequest](v.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(y.isClearKey(v))for(var i=0;i<t.keyPairs.length;i++)g[d.addKey](v.systemString,t.keyPairs[i].key,t.keyPairs[i].keyID,n);else g[d.addKey](v.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)},closeKeySession:x,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:w,reset:w},m=h.getLogger(p),g=null,v=null,_=[],b=[],y=(0,i.default)(t).getInstance(),T={handleEvent:function(e){var t=null;switch(e.type){case d.needkey:var i=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new r.default(i,"cenc")});break;case d.keyerror:if((t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t){var s=u.default.MEDIA_KEYERR_CODE,l="";switch(e.errorCode.code){case 1:s=u.default.MEDIA_KEYERR_UNKNOWN_CODE,l+="MEDIA_KEYERR_UNKNOWN - "+u.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:s=u.default.MEDIA_KEYERR_CLIENT_CODE,l+="MEDIA_KEYERR_CLIENT - "+u.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:s=u.default.MEDIA_KEYERR_SERVICE_CODE,l+="MEDIA_KEYERR_SERVICE - "+u.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:s=u.default.MEDIA_KEYERR_OUTPUT_CODE,l+="MEDIA_KEYERR_OUTPUT - "+u.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:s=u.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,l+="MEDIA_KEYERR_HARDWARECHANGE - "+u.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:s=u.default.MEDIA_KEYERR_DOMAIN_CODE,l+="MEDIA_KEYERR_DOMAIN - "+u.default.MEDIA_KEYERR_DOMAIN_MESSAGE}l+="  System Code = "+e.systemCode,n.trigger(c.KEY_ERROR,{data:new a.default(s,l,t)})}else m.error("No session token found for key error");break;case d.keyadded:(t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t?(m.debug("DRM: Key added."),n.trigger(c.KEY_ADDED,{data:t})):m.debug("No session token found for key added");break;case d.keymessage:if((E=null!==e.sessionId&&void 0!==e.sessionId)?!(t=A(b,e.sessionId))&&_.length>0&&(t=_.shift(),b.push(t),t.sessionID=e.sessionId,n.trigger(c.KEY_SESSION_CREATED,{data:t})):_.length>0&&(t=_.shift(),b.push(t),0!==_.length&&f.error(new a.default(u.default.MEDIA_KEY_MESSAGE_ERROR_CODE,u.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var h=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=h,n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new o.default(t,h,e.defaultURL)})}else m.warn("No session token found for key message")}}},p}h.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(78),a=(i=r)&&i.__esModule?i:{default:i};var o=function(){var e=void 0;function t(t,n,i){if(!t||!/^VIDEO$/i.test(t.nodeName))return null;if(t._dashjs_player)return t._dashjs_player;var r=void 0,o=t.id||t.name||"video element";if(!(n=n||[].slice.call(t.querySelectorAll("source")).filter((function(e){return"application/dash+xml"==e.type}))[0])&&t.src)(n=document.createElement("source")).src=t.src;else if(!n&&!t.src)return null;return i=i||{},(r=(0,a.default)(i).create()).initialize(t,n.src,t.autoplay),e||(e=r.getDebug().getLogger()),e.debug("Converted "+o+" to dash.js player and added content: "+n.src),t._dashjs_player=r,r}function n(e){return/^VIDEO$/i.test(e.nodeName)?e:n(e.parentNode)}return{create:t,createAll:function(e,i){var r=[];e=e||"[data-dashjs-player]";for(var a=(i=i||document).querySelectorAll(e),o=0;o<a.length;o++){var s=t(a[o],null);r.push(s)}for(var l=i.querySelectorAll('source[type="application/dash+xml"]'),u=0;u<l.length;u++){var c=t(n(l[u]),null);r.push(c)}return r}}}(),s=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?o.createAll():s=window.setInterval((function(){window.dashjs&&(window.clearInterval(s),o.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),o.createAll()}))),t.default=o},function(e,t){},function(e,t,n){var i=n(282),r=n(6);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?r(e):t}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(17))},function(e,t){e.exports=function(e){if(!e)return!1;var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},function(e,t,n){var i=n(1),r=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function a(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function o(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function s(){this.values=r(null)}function l(e,t,n,i){var r=i?e.split(i):[e];for(var a in r)if("string"==typeof r[a]){var o=r[a].split(n);if(2===o.length)t(o[0],o[1])}}function u(e,t,n){var i=e;function r(){var t=o(e);if(null===t)throw new a(a.Errors.BadTimeStamp,"Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function u(){e=e.replace(/^\s+/,"")}if(u(),t.startTime=r(),u(),"--\x3e"!==e.substr(0,3))throw new a(a.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),u(),t.endTime=r(),u(),function(e,t){var i=new s;l(e,(function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];i.integer(e,o),i.percent(e,o)&&i.set("snapToLines",!1),i.alt(e,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start","center","end"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");try{t.line=i.get("line","auto")}catch(e){}t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100);try{t.align=i.get("align","center")}catch(e){t.align=i.get("align","middle")}try{t.position=i.get("position","auto")}catch(e){t.position=i.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=i.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}a.prototype=r(Error.prototype),a.prototype.constructor=a,a.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var c=i.createElement("textarea"),h={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},d={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},f={v:"title",lang:"lang"},p={rt:"ruby"};function m(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function i(e){return c.innerHTML=e,e=c.textContent,c.textContent="",e}function r(e,t){return!p[t.localName]||p[t.localName]===e.localName}function a(t,n){var i=h[t];if(!i)return null;var r=e.document.createElement(i),a=f[t];return a&&n&&(r[a]=n.trim()),r}for(var s,l=e.document.createElement("div"),u=l,m=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode(i(s)));else{if("/"===s[1]){m.length&&m[m.length-1]===s.substr(2).replace(">","")&&(m.pop(),u=u.parentNode);continue}var g,v=o(s.substr(1,s.length-2));if(v){g=e.document.createProcessingInstruction("timestamp",v),u.appendChild(g);continue}var y=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(g=a(y[1],y[3])))continue;if(!r(u,g))continue;if(y[2]){var _=y[2].split(".");_.forEach((function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(d.hasOwnProperty(n)){var i=t?"background-color":"color",r=d[n];g.style[i]=r}})),g.className=_.join(" ")}m.push(y[1]),u.appendChild(g),u=g}return l}var g=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function v(e){for(var t=0;t<g.length;t++){var n=g[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function y(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function r(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?r(e):t.childNodes?(i(e,t),r(e)):void 0}for(i(t,e);n=r(t);)for(var a=0;a<n.length;a++)if(v(n.charCodeAt(a)))return"rtl";return"ltr"}function _(){}function b(e,t,n){_.call(this),this.cue=t,this.cueDiv=m(e,t.text);var i={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(i,this.cueDiv),this.div=e.document.createElement("div"),i={direction:y(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(i),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"center":r=t.position-t.size/2;break;case"end":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,n,i,r;if(e.div){n=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||n,this.bottom=e.bottom||r+(e.height||n),this.width=e.width||i,this.lineHeight=void 0!==t?t:e.lineHeight}function T(e,t,n,i){var r=new E(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,i=0,r=0;r<n.length&&n[r]!==t;r++)"showing"===n[r].mode&&i++;return-1*++i}(a),s=[];if(a.snapToLines){var l;switch(a.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(o),h=n[l]+u,d=s[0];Math.abs(c)>h&&(c=c<0?-1:1,c*=Math.ceil(h/u)*u),o<0&&(c+=""===a.vertical?n.height:n.width,s=s.reverse()),r.move(d,c)}else{var f=r.lineHeight/n.height*100;switch(a.lineAlign){case"center":o-=f/2;break;case"end":o-=f}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],r=new E(t)}var p=function(e,t){for(var r,a=new E(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(i);)e.move(t[s]);if(e.within(n))return e;var l=e.intersectPercentage(n);o>l&&(r=new E(e),o=l),e=new E(a)}return r||a}(r,s);t.move(p.toCSSCompatValues(n))}function w(){}_.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},_.prototype.formatStyle=function(e,t){return 0===e?0:e+t},b.prototype=r(_.prototype),b.prototype.constructor=b,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||n}},w.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},w.convertCueToDOMTree=function(e,t){return e&&t?m(e,t):null};w.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var r=[],a=E.getSimpleBoxPosition(i),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var n,s,l=0;l<t.length;l++)s=t[l],n=new b(e,s,o),i.appendChild(n.div),T(0,n,a,r),s.displayState=n.div,r.push(E.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)i.appendChild(t[s].displayState)},w.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},w.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof a))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?l(e,(function(e,n){switch(e){case"X-TIMESTAMP-MAP":!function(e){var n=new s;l(e,(function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",o(t))}}),/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}(n)}}),/=/):l(e,(function(e,n){switch(e){case"Region":!function(e){var n=new s;if(l(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var r=new s;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"])}}),/=/,/\s/),n.has("id")){var i=new(t.vttjs.VTTRegion||t.window.VTTRegion);i.width=n.get("width",100),i.lines=n.get("lines",3),i.regionAnchorX=n.get("regionanchorX",0),i.regionAnchorY=n.get("regionanchorY",100),i.viewportAnchorX=n.get("viewportanchorX",0),i.viewportAnchorY=n.get("viewportanchorY",100),i.scroll=n.get("scroll",""),t.onregion&&t.onregion(i),t.regionList.push({id:n.get("id"),region:i})}}(n)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var c=(r=n()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new a(a.Errors.BadSignature);t.state="HEADER"}for(var h=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(h?h=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(e){t.cue.align="middle"}if(t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{u(r,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var d=-1!==r.indexOf("--\x3e");if(!r||d&&(h=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new a(a.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}},e.exports=w},function(e,t){var n={"":1,lr:1,rl:1},i={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function r(e){return"string"==typeof e&&(!!i[e.toLowerCase()]&&e.toLowerCase())}function a(e,t,i){this.hasBeenReset=!1;var a="",o=!1,s=e,l=t,u=i,c=null,h="",d=!0,f="auto",p="start",m="auto",g="auto",v=100,y="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return a},set:function(e){a=""+e}},pauseOnExit:{enumerable:!0,get:function(){return o},set:function(e){o=!!e}},startTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");s=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return h},set:function(e){var t=function(e){return"string"==typeof e&&(!!n[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");h=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return d},set:function(e){d=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=r(e);t?(p=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=r(e);t?(g=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return v},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");v=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return y},set:function(e){var t=r(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");y=t,this.hasBeenReset=!0}}}),this.displayState=void 0}a.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=a},function(e,t){var n={"":!0,up:!0};function i(e){return"number"==typeof e&&e>=0&&e<=100}e.exports=function(){var e=100,t=3,r=0,a=100,o=0,s=100,l="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!i(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!i(e))throw new Error("RegionAnchorX must be between 0 and 100.");a=e}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!i(e))throw new Error("RegionAnchorY must be between 0 and 100.");r=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!i(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!i(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return l},set:function(e){var t=function(e){return"string"==typeof e&&(!!n[e.toLowerCase()]&&e.toLowerCase())}(e);!1===t?console.warn("Scroll: an invalid or illegal string was specified."):l=t}}})}},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,i=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+n.source+i.source+"*(?::"+n.source+i.source+"*)?$");function a(){}function o(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function s(e,t,n,i,r,a){for(var o,s=++t,l=0;;){var u=e.charAt(s);switch(u){case"=":if(1===l)o=e.slice(t,s),l=3;else{if(2!==l)throw new Error("attribute equal must after attrName");l=3}break;case"'":case'"':if(3===l||1===l){if(1===l&&(a.warning('attribute value must after "="'),o=e.slice(t,s)),t=s+1,!((s=e.indexOf(u,t))>0))throw new Error("attribute value no end '"+u+"' match");c=e.slice(t,s).replace(/&#?\w+;/g,r),n.add(o,c,t-1),l=5}else{if(4!=l)throw new Error('attribute value must after "="');c=e.slice(t,s).replace(/&#?\w+;/g,r),n.add(o,c,t),a.warning('attribute "'+o+'" missed start quot('+u+")!!"),t=s+1,l=5}break;case"/":switch(l){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:l=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==l&&n.setTagName(e.slice(t,s)),s;case">":switch(l){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(c=e.slice(t,s)).slice(-1)&&(n.closed=!0,c=c.slice(0,-1));case 2:2===l&&(c=o),4==l?(a.warning('attribute "'+c+'" missed quot(")!!'),n.add(o,c.replace(/&#?\w+;/g,r),t)):("http://www.w3.org/1999/xhtml"===i[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),n.add(c,c,t));break;case 3:throw new Error("attribute value missed!!")}return s;case"":u=" ";default:if(u<=" ")switch(l){case 0:n.setTagName(e.slice(t,s)),l=6;break;case 1:o=e.slice(t,s),l=2;break;case 4:var c=e.slice(t,s).replace(/&#?\w+;/g,r);a.warning('attribute "'+c+'" missed quot(")!!'),n.add(o,c,t);case 5:l=6}else switch(l){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===i[""]&&o.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),n.add(o,o,t),t=s,l=1;break;case 5:a.warning('attribute space is required"'+o+'"!!');case 6:l=1,t=s;break;case 3:l=4,t=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function l(e,t,n){for(var i=e.tagName,r=null,a=e.length;a--;){var o=e[a],s=o.qName,l=o.value;if((f=s.indexOf(":"))>0)var u=o.prefix=s.slice(0,f),c=s.slice(f+1),d="xmlns"===u&&c;else c=s,u=null,d="xmlns"===s&&"";o.localName=c,!1!==d&&(null==r&&(r={},h(n,n={})),n[d]=r[d]=l,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,l))}for(a=e.length;a--;){(u=(o=e[a]).prefix)&&("xml"===u&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(o.uri=n[u||""]))}var f;(f=i.indexOf(":"))>0?(u=e.prefix=i.slice(0,f),c=e.localName=i.slice(f+1)):(u=null,c=e.localName=i);var p=e.uri=n[u||""];if(t.startElement(p,c,i,e),!e.closed)return e.currentNSMap=n,e.localNSMap=r,!0;if(t.endElement(p,c,i),r)for(u in r)t.endPrefixMapping(u)}function u(e,t,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(r.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,i),r.characters(o,0,o.length),a)}return t+1}function c(e,t,n,i){var r=i[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),i[n]=r),r<t}function h(e,t){for(var n in e)t[n]=e[n]}function d(e,t,n,i){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(i.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var a=function(e,t){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;r.lastIndex=t,r.exec(e);for(;n=r.exec(e);)if(i.push(n),n[1])return i}(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],l=o>3&&/^public$/i.test(a[2][0])&&a[3][0],u=o>4&&a[4][0],c=a[o-1];return n.startDTD(s,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),c.index+c[0].length}}return-1}function f(e,t,n){var i=e.indexOf("?>",t);if(i){var r=e.substring(t,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(r){r[0].length;return n.processingInstruction(r[1],r[2]),i+2}return-1}return-1}function p(e){}function m(e,t){return e.__proto__=t,e}a.prototype={parse:function(e,t,n){var i=this.domBuilder;i.startDocument(),h(t,t={}),function(e,t,n,i,r){function a(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(r.error("entity not found:"+e),e)}function h(t){if(t>T){var n=e.substring(T,t).replace(/&#?\w+;/g,a);_&&m(T),i.characters(n,0,t-T),T=t}}function m(t,n){for(;t>=v&&(n=y.exec(e));)g=n.index,v=g+n[0].length,_.lineNumber++;_.columnNumber=t-g+1}var g=0,v=0,y=/.*(?:\r\n?|\n)|.*$/g,_=i.locator,b=[{currentNSMap:t}],E={},T=0;for(;;){try{var w=e.indexOf("<",T);if(w<0){if(!e.substr(T).match(/^\s*$/)){var x=i.doc,A=x.createTextNode(e.substr(T));x.appendChild(A),i.currentElement=A}return}switch(w>T&&h(w),e.charAt(w+1)){case"/":var S=e.indexOf(">",w+3),M=e.substring(w+2,S),C=b.pop();S<0?(M=e.substring(w+2).replace(/[\s<].*/,""),r.error("end tag name: "+M+" is not complete:"+C.tagName),S=w+1+M.length):M.match(/\s</)&&(M=M.replace(/[\s<].*/,""),r.error("end tag name: "+M+" maybe not complete"),S=w+1+M.length);var R=C.localNSMap,I=C.tagName==M;if(I||C.tagName&&C.tagName.toLowerCase()==M.toLowerCase()){if(i.endElement(C.uri,C.localName,M),R)for(var P in R)i.endPrefixMapping(P);I||r.fatalError("end tag name: "+M+" is not match the current start tagName:"+C.tagName)}else b.push(C);S++;break;case"?":_&&m(w),S=f(e,w,i);break;case"!":_&&m(w),S=d(e,w,i,r);break;default:_&&m(w);var L=new p,D=b[b.length-1].currentNSMap,O=(S=s(e,w,L,D,a,r),L.length);if(!L.closed&&c(e,S,L.tagName,E)&&(L.closed=!0,n.nbsp||r.warning("unclosed xml attribute")),_&&O){for(var N=o(_,{}),k=0;k<O;k++){var F=L[k];m(F.offset),F.locator=o(_,{})}i.locator=N,l(L,i,D)&&b.push(L),i.locator=_}else l(L,i,D)&&b.push(L);"http://www.w3.org/1999/xhtml"!==L.uri||L.closed?S++:S=u(e,S,L.tagName,a,i)}}catch(e){r.error("element parse error: "+e),S=-1}S>T?T=S:h(Math.max(w,T)+1)}}(e,t,n,i,this.errorHandler),i.endDocument()}},p.prototype={setTagName:function(e){if(!r.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!r.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},m({},m.prototype)instanceof m||(m=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=a},function(e,t,n){"use strict";var i=n(111),r=n(110),a=function(){a.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new c(0,0),new c(0,1),new c(1,0),new c(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};a.prototype=new i,a.prototype.push=function(e){var t,n,i;if("sei_rbsp"===e.nalUnitType&&(t=r.parseSei(e.escapedRBSP)).payloadType===r.USER_DATA_REGISTERED_ITU_T_T35&&(n=r.parseUserData(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));i=r.parseCaptionPackets(e.pts,n),this.captionPackets_=this.captionPackets_.concat(i),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},a.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},a.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},a.prototype.flush=function(){return this.flushStream("flush")},a.prototype.partialFlush=function(){return this.flushStream("partialFlush")},a.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},a.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},a.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},a.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},a.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},s=function(e){return null===e?"":(e=o[e]||e,String.fromCharCode(e))},l=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],u=function(){for(var e=[],t=15;t--;)e.push("");return e},c=function(e,t){c.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,i,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=u();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=u();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=u()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(i,r))a=s((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(i,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=s((i=(3&i)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(i,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(i,r))this.column_+=3&r;else if(this.isPAC(i,r)){var o=l.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(i)&&(0===r&&(r=null),a=s(i),a+=s(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};c.prototype=new i,c.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},c.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=u(),this.nonDisplayed_=u(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},c.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},c.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},c.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},c.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},c.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},c.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},c.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},c.prototype.isNormalChar=function(e){return e>=32&&e<=127},c.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=u(),this.displayed_=u()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},c.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},c.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},c.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},c.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},c.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},c.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},e.exports={CaptionStream:a,Cea608Stream:c}},function(e,t,n){"use strict";var i=n(111),r=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},a=function(e){var t,n;a.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=r(e.dts,n),e.pts=r(e.pts,n),t=e.dts,this.trigger("data",e))},this.flush=function(){n=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,t=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};a.prototype=new i,e.exports={TimestampRolloverStream:a,handleRollover:r}},function(e,t,n){"use strict";var i=n(112),r=function(e){var t=31&e[1];return t<<=8,t|=e[2]},a=function(e){return!!(64&e[1])},o=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},s=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};e.exports={parseType:function(e,t){var n=r(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=a(e),n=4+o(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=a(e),i=4+o(e);if(n&&(i+=e[i]+1),1&e[i+5]){var r;r=3+((15&e[i+1])<<8|e[i+2])-4;for(var s=12+((15&e[i+10])<<8|e[i+11]);s<r;){var l=i+s;t[(31&e[l+1])<<8|e[l+2]]=e[l],s+=5+((15&e[l+3])<<8|e[l+4])}return t}},parsePayloadUnitStartIndicator:a,parsePesType:function(e,t){switch(t[r(e)]){case i.H264_STREAM_TYPE:return"video";case i.ADTS_STREAM_TYPE:return"audio";case i.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!a(e))return null;var t=4+o(e);if(t>=e.byteLength)return null;var n,i=null;return 192&(n=e[t+7])&&((i={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,i.pts*=4,i.pts+=(6&e[t+13])>>>1,i.dts=i.pts,64&n&&(i.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,i.dts*=4,i.dts+=(6&e[t+18])>>>1)),i},videoPacketContainsKeyFrame:function(e){for(var t=4+o(e),n=e.subarray(t),i=0,r=0,a=!1;r<n.byteLength-3;r++)if(1===n[r+2]){i=r+5;break}for(;i<n.byteLength;)switch(n[i]){case 0:if(0!==n[i-1]){i+=2;break}if(0!==n[i-2]){i++;break}r+3!==i-2&&"slice_layer_without_partitioning_rbsp_idr"===s(31&n[r+3])&&(a=!0);do{i++}while(1!==n[i]&&i<n.length);r=i-2,i+=3;break;case 1:if(0!==n[i-1]||0!==n[i-2]){i+=3;break}"slice_layer_without_partitioning_rbsp_idr"===s(31&n[r+3])&&(a=!0),r=i-2,i+=3;break;default:i+=3}return n=n.subarray(r),i-=r,r=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===s(31&n[r+3])&&(a=!0),a}}},function(e,t,n){"use strict";var i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]};e.exports={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,i=e[t+4]<<3;return 6144&e[t+3]|i|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return i[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,i;t=10,64&e[5]&&(t+=4,t+=r(e.subarray(10,14)));do{if((n=r(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){i=e.subarray(t+10,t+n+10);for(var a=0;a<i.byteLength;a++)if(0===i[a]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,n){var i,r="";for(i=t;i<n;i++)r+="%"+("00"+e[i].toString(16)).slice(-2);return r}(i,0,a))){var o=i.subarray(a+1),s=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;return s*=4,s+=3&o[7]}break}}t+=10,t+=n}while(t<e.byteLength);return null}}},function(e,t){var n,i,r,a,o,s,l;n=function(e){return 9e4*e},i=function(e,t){return e*t},r=function(e){return e/9e4},a=function(e,t){return e/t},o=function(e,t){return n(a(e,t))},s=function(e,t){return i(r(e),t)},l=function(e,t,n){return r(n?e:e-t)},e.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:n,secondsToAudioTs:i,videoTsToSeconds:r,audioTsToSeconds:a,audioTsToVideoTs:o,videoTsToAudioTs:s,metadataTsToSeconds:l}},function(e,t,n){"use strict";(function(e){var t=n(4),i=n(35),r=n.n(i);
/*! @name videojs-xr @version 0.0.2 @license MIT */
function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function l(e,t){return e(t={exports:{}},t.exports),t.exports}var u=l((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),c={}.hasOwnProperty,h=function(e,t){return c.call(e,t)},d=function(e){try{return!!e()}catch(e){return!0}},f=!d((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),p=l((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)})),m=(p.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),g=function(e){if(!m(e))throw TypeError(e+" is not an object!");return e},v=u.document,y=m(v)&&m(v.createElement),_=function(e){return y?v.createElement(e):{}},b=!f&&!d((function(){return 7!=Object.defineProperty(_("div"),"a",{get:function(){return 7}}).a})),E=function(e,t){if(!m(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!m(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!m(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!m(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")},T=Object.defineProperty,w={f:f?Object.defineProperty:function(e,t,n){if(g(e),t=E(t,!0),g(n),b)try{return T(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},x=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},A=f?function(e,t,n){return w.f(e,t,x(1,n))}:function(e,t,n){return e[t]=n,e},S=0,M=Math.random(),C=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++S+M).toString(36))},R=l((function(e){var t=u["__core-js_shared__"]||(u["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:p.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),I=R("native-function-to-string",Function.toString),P=l((function(e){var t=C("src"),n=(""+I).split("toString");p.inspectSource=function(e){return I.call(e)},(e.exports=function(e,i,r,a){var o="function"==typeof r;o&&(h(r,"name")||A(r,"name",i)),e[i]!==r&&(o&&(h(r,t)||A(r,t,e[i]?""+e[i]:n.join(String(i)))),e===u?e[i]=r:a?e[i]?e[i]=r:A(e,i,r):(delete e[i],A(e,i,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||I.call(this)}))})),L=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},D=function(e,t,n){if(L(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}},O=function(e,t,n){var i,r,a,o,s=e&O.F,l=e&O.G,c=e&O.S,h=e&O.P,d=e&O.B,f=l?u:c?u[t]||(u[t]={}):(u[t]||{}).prototype,m=l?p:p[t]||(p[t]={}),g=m.prototype||(m.prototype={});for(i in l&&(n=t),n)a=((r=!s&&f&&void 0!==f[i])?f:n)[i],o=d&&r?D(a,u):h&&"function"==typeof a?D(Function.call,a):a,f&&P(f,i,a,e&O.U),m[i]!=a&&A(m,i,o),h&&g[i]!=a&&(g[i]=a)};u.core=p,O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var N=O,k=l((function(e){var t=C("meta"),n=w.f,i=0,r=Object.isExtensible||function(){return!0},a=!d((function(){return r(Object.preventExtensions({}))})),o=function(e){n(e,t,{value:{i:"O"+ ++i,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!m(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!h(e,t)){if(!r(e))return"F";if(!n)return"E";o(e)}return e[t].i},getWeak:function(e,n){if(!h(e,t)){if(!r(e))return!0;if(!n)return!1;o(e)}return e[t].w},onFreeze:function(e){return a&&s.NEED&&r(e)&&!h(e,t)&&o(e),e}}})),F=(k.KEY,k.NEED,k.fastKey,k.getWeak,k.onFreeze,l((function(e){var t=R("wks"),n=u.Symbol,i="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=i&&n[e]||(i?n:C)("Symbol."+e))}).store=t}))),B=w.f,U=F("toStringTag"),j=function(e,t,n){e&&!h(e=n?e:e.prototype,U)&&B(e,U,{configurable:!0,value:t})},G={f:F},z=w.f,H=function(e){var t=p.Symbol||(p.Symbol=u.Symbol||{});"_"==e.charAt(0)||e in t||z(t,e,{value:G.f(e)})},V={}.toString,W=function(e){return V.call(e).slice(8,-1)},q=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==W(e)?e.split(""):Object(e)},Y=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},X=function(e){return q(Y(e))},K=Math.ceil,Q=Math.floor,Z=function(e){return isNaN(e=+e)?0:(e>0?Q:K)(e)},J=Math.min,$=function(e){return e>0?J(Z(e),9007199254740991):0},ee=Math.max,te=Math.min,ne=function(e,t){return(e=Z(e))<0?ee(e+t,0):te(e,t)},ie=function(e){return function(t,n,i){var r,a=X(t),o=$(a.length),s=ne(i,o);if(e&&n!=n){for(;o>s;)if((r=a[s++])!=r)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},re=R("keys"),ae=function(e){return re[e]||(re[e]=C(e))},oe=ie(!1),se=ae("IE_PROTO"),le=function(e,t){var n,i=X(e),r=0,a=[];for(n in i)n!=se&&h(i,n)&&a.push(n);for(;t.length>r;)h(i,n=t[r++])&&(~oe(a,n)||a.push(n));return a},ue="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ce=Object.keys||function(e){return le(e,ue)},he={f:Object.getOwnPropertySymbols},de={f:{}.propertyIsEnumerable},fe=Array.isArray||function(e){return"Array"==W(e)},pe=f?Object.defineProperties:function(e,t){g(e);for(var n,i=ce(t),r=i.length,a=0;r>a;)w.f(e,n=i[a++],t[n]);return e},me=u.document,ge=me&&me.documentElement,ve=ae("IE_PROTO"),ye=function(){},_e=function(){var e,t=_("iframe"),n=ue.length;for(t.style.display="none",ge.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),_e=e.F;n--;)delete _e.prototype[ue[n]];return _e()},be=Object.create||function(e,t){var n;return null!==e?(ye.prototype=g(e),n=new ye,ye.prototype=null,n[ve]=e):n=_e(),void 0===t?n:pe(n,t)},Ee=ue.concat("length","prototype"),Te={f:Object.getOwnPropertyNames||function(e){return le(e,Ee)}},we=Te.f,xe={}.toString,Ae="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Se={f:function(e){return Ae&&"[object Window]"==xe.call(e)?function(e){try{return we(e)}catch(e){return Ae.slice()}}(e):we(X(e))}},Me=Object.getOwnPropertyDescriptor,Ce={f:f?Me:function(e,t){if(e=X(e),t=E(t,!0),b)try{return Me(e,t)}catch(e){}if(h(e,t))return x(!de.f.call(e,t),e[t])}},Re=k.KEY,Ie=Ce.f,Pe=w.f,Le=Se.f,De=u.Symbol,Oe=u.JSON,Ne=Oe&&Oe.stringify,ke=F("_hidden"),Fe=F("toPrimitive"),Be={}.propertyIsEnumerable,Ue=R("symbol-registry"),je=R("symbols"),Ge=R("op-symbols"),ze=Object.prototype,He="function"==typeof De,Ve=u.QObject,We=!Ve||!Ve.prototype||!Ve.prototype.findChild,qe=f&&d((function(){return 7!=be(Pe({},"a",{get:function(){return Pe(this,"a",{value:7}).a}})).a}))?function(e,t,n){var i=Ie(ze,t);i&&delete ze[t],Pe(e,t,n),i&&e!==ze&&Pe(ze,t,i)}:Pe,Ye=function(e){var t=je[e]=be(De.prototype);return t._k=e,t},Xe=He&&"symbol"==typeof De.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof De},Ke=function(e,t,n){return e===ze&&Ke(Ge,t,n),g(e),t=E(t,!0),g(n),h(je,t)?(n.enumerable?(h(e,ke)&&e[ke][t]&&(e[ke][t]=!1),n=be(n,{enumerable:x(0,!1)})):(h(e,ke)||Pe(e,ke,x(1,{})),e[ke][t]=!0),qe(e,t,n)):Pe(e,t,n)},Qe=function(e,t){g(e);for(var n,i=function(e){var t=ce(e),n=he.f;if(n)for(var i,r=n(e),a=de.f,o=0;r.length>o;)a.call(e,i=r[o++])&&t.push(i);return t}(t=X(t)),r=0,a=i.length;a>r;)Ke(e,n=i[r++],t[n]);return e},Ze=function(e){var t=Be.call(this,e=E(e,!0));return!(this===ze&&h(je,e)&&!h(Ge,e))&&(!(t||!h(this,e)||!h(je,e)||h(this,ke)&&this[ke][e])||t)},Je=function(e,t){if(e=X(e),t=E(t,!0),e!==ze||!h(je,t)||h(Ge,t)){var n=Ie(e,t);return!n||!h(je,t)||h(e,ke)&&e[ke][t]||(n.enumerable=!0),n}},$e=function(e){for(var t,n=Le(X(e)),i=[],r=0;n.length>r;)h(je,t=n[r++])||t==ke||t==Re||i.push(t);return i},et=function(e){for(var t,n=e===ze,i=Le(n?Ge:X(e)),r=[],a=0;i.length>a;)!h(je,t=i[a++])||n&&!h(ze,t)||r.push(je[t]);return r};He||(P((De=function(){if(this instanceof De)throw TypeError("Symbol is not a constructor!");var e=C(arguments.length>0?arguments[0]:void 0),t=function(n){this===ze&&t.call(Ge,n),h(this,ke)&&h(this[ke],e)&&(this[ke][e]=!1),qe(this,e,x(1,n))};return f&&We&&qe(ze,e,{configurable:!0,set:t}),Ye(e)}).prototype,"toString",(function(){return this._k})),Ce.f=Je,w.f=Ke,Te.f=Se.f=$e,de.f=Ze,he.f=et,f&&P(ze,"propertyIsEnumerable",Ze,!0),G.f=function(e){return Ye(F(e))}),N(N.G+N.W+N.F*!He,{Symbol:De});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;tt.length>nt;)F(tt[nt++]);for(var it=ce(F.store),rt=0;it.length>rt;)H(it[rt++]);N(N.S+N.F*!He,"Symbol",{for:function(e){return h(Ue,e+="")?Ue[e]:Ue[e]=De(e)},keyFor:function(e){if(!Xe(e))throw TypeError(e+" is not a symbol!");for(var t in Ue)if(Ue[t]===e)return t},useSetter:function(){We=!0},useSimple:function(){We=!1}}),N(N.S+N.F*!He,"Object",{create:function(e,t){return void 0===t?be(e):Qe(be(e),t)},defineProperty:Ke,defineProperties:Qe,getOwnPropertyDescriptor:Je,getOwnPropertyNames:$e,getOwnPropertySymbols:et}),Oe&&N(N.S+N.F*(!He||d((function(){var e=De();return"[null]"!=Ne([e])||"{}"!=Ne({a:e})||"{}"!=Ne(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=t=i[1],(m(t)||void 0!==e)&&!Xe(e))return fe(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Xe(t))return t}),i[1]=t,Ne.apply(Oe,i)}}),De.prototype[Fe]||A(De.prototype,Fe,De.prototype.valueOf),j(De,"Symbol"),j(Math,"Math",!0),j(u.JSON,"JSON",!0),N(N.S,"Object",{create:be}),N(N.S+N.F*!f,"Object",{defineProperty:w.f}),N(N.S+N.F*!f,"Object",{defineProperties:pe});var at=function(e,t){var n=(p.Object||{})[e]||Object[e],i={};i[e]=t(n),N(N.S+N.F*d((function(){n(1)})),"Object",i)},ot=Ce.f;at("getOwnPropertyDescriptor",(function(){return function(e,t){return ot(X(e),t)}}));var st=function(e){return Object(Y(e))},lt=ae("IE_PROTO"),ut=Object.prototype,ct=Object.getPrototypeOf||function(e){return e=st(e),h(e,lt)?e[lt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ut:null};at("getPrototypeOf",(function(){return function(e){return ct(st(e))}})),at("keys",(function(){return function(e){return ce(st(e))}})),at("getOwnPropertyNames",(function(){return Se.f}));var ht=k.onFreeze;at("freeze",(function(e){return function(t){return e&&m(t)?e(ht(t)):t}}));var dt=k.onFreeze;at("seal",(function(e){return function(t){return e&&m(t)?e(dt(t)):t}}));var ft=k.onFreeze;at("preventExtensions",(function(e){return function(t){return e&&m(t)?e(ft(t)):t}})),at("isFrozen",(function(e){return function(t){return!m(t)||!!e&&e(t)}})),at("isSealed",(function(e){return function(t){return!m(t)||!!e&&e(t)}})),at("isExtensible",(function(e){return function(t){return!!m(t)&&(!e||e(t))}}));var pt=Object.assign,mt=!pt||d((function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=pt({},e)[n]||Object.keys(pt({},t)).join("")!=i}))?function(e,t){for(var n=st(e),i=arguments.length,r=1,a=he.f,o=de.f;i>r;)for(var s,l=q(arguments[r++]),u=a?ce(l).concat(a(l)):ce(l),c=u.length,h=0;c>h;)o.call(l,s=u[h++])&&(n[s]=l[s]);return n}:pt;N(N.S+N.F,"Object",{assign:mt});var gt=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};N(N.S,"Object",{is:gt});var vt=function(e,t){if(g(e),!m(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},yt={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=D(Function.call,Ce.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,i){return vt(e,i),t?e.__proto__=i:n(e,i),e}}({},!1):void 0),check:vt};N(N.S,"Object",{setPrototypeOf:yt.set});var _t=F("toStringTag"),bt="Arguments"==W(function(){return arguments}()),Et=function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),_t))?n:bt?W(t):"Object"==(i=W(t))&&"function"==typeof t.callee?"Arguments":i},Tt={};Tt[F("toStringTag")]="z",Tt+""!="[object z]"&&P(Object.prototype,"toString",(function(){return"[object "+Et(this)+"]"}),!0);var wt=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},xt=[].slice,At={},St=function(e,t,n){if(!(t in At)){for(var i=[],r=0;r<t;r++)i[r]="a["+r+"]";At[t]=Function("F,a","return new F("+i.join(",")+")")}return At[t](e,n)},Mt=Function.bind||function(e){var t=L(this),n=xt.call(arguments,1),i=function(){var r=n.concat(xt.call(arguments));return this instanceof i?St(t,r.length,r):wt(t,r,e)};return m(t.prototype)&&(i.prototype=t.prototype),i};N(N.P,"Function",{bind:Mt});var Ct=w.f,Rt=Function.prototype,It=/^\s*function ([^ (]*)/;"name"in Rt||f&&Ct(Rt,"name",{configurable:!0,get:function(){try{return(""+this).match(It)[1]}catch(e){return""}}});var Pt=F("hasInstance"),Lt=Function.prototype;Pt in Lt||w.f(Lt,Pt,{value:function(e){if("function"!=typeof this||!m(e))return!1;if(!m(this.prototype))return e instanceof this;for(;e=ct(e);)if(this.prototype===e)return!0;return!1}});var Dt="\t\n\v\f\r \u2028\u2029\ufeff",Ot="["+Dt+"]",Nt=RegExp("^"+Ot+Ot+"*"),kt=RegExp(Ot+Ot+"*$"),Ft=function(e,t,n){var i={},r=d((function(){return!!Dt[e]()||""!=""[e]()})),a=i[e]=r?t(Bt):Dt[e];n&&(i[n]=a),N(N.P+N.F*r,"String",i)},Bt=Ft.trim=function(e,t){return e=String(Y(e)),1&t&&(e=e.replace(Nt,"")),2&t&&(e=e.replace(kt,"")),e},Ut=Ft,jt=u.parseInt,Gt=Ut.trim,zt=/^[-+]?0[xX]/,Ht=8!==jt(Dt+"08")||22!==jt(Dt+"0x16")?function(e,t){var n=Gt(String(e),3);return jt(n,t>>>0||(zt.test(n)?16:10))}:jt;N(N.G+N.F*(parseInt!=Ht),{parseInt:Ht});var Vt=u.parseFloat,Wt=Ut.trim,qt=1/Vt(Dt+"-0")!=-1/0?function(e){var t=Wt(String(e),3),n=Vt(t);return 0===n&&"-"==t.charAt(0)?-0:n}:Vt;N(N.G+N.F*(parseFloat!=qt),{parseFloat:qt});var Yt=yt.set,Xt=function(e,t,n){var i,r=t.constructor;return r!==n&&"function"==typeof r&&(i=r.prototype)!==n.prototype&&m(i)&&Yt&&Yt(e,i),e},Kt=Te.f,Qt=Ce.f,Zt=w.f,Jt=Ut.trim,$t=u.Number,en=$t,tn=$t.prototype,nn="Number"==W(be(tn)),rn="trim"in String.prototype,an=function(e){var t=E(e,!1);if("string"==typeof t&&t.length>2){var n,i,r,a=(t=rn?t.trim():Jt(t,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+t}for(var o,s=t.slice(2),l=0,u=s.length;l<u;l++)if((o=s.charCodeAt(l))<48||o>r)return NaN;return parseInt(s,i)}}return+t};if(!$t(" 0o1")||!$t("0b1")||$t("+0x1")){$t=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof $t&&(nn?d((function(){tn.valueOf.call(n)})):"Number"!=W(n))?Xt(new en(an(t)),n,$t):an(t)};for(var on,sn=f?Kt(en):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),ln=0;sn.length>ln;ln++)h(en,on=sn[ln])&&!h($t,on)&&Zt($t,on,Qt(en,on));$t.prototype=tn,tn.constructor=$t,P(u,"Number",$t)}var un=function(e,t){if("number"!=typeof e&&"Number"!=W(e))throw TypeError(t);return+e},cn=function(e){var t=String(Y(this)),n="",i=Z(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n},hn=1..toFixed,dn=Math.floor,fn=[0,0,0,0,0,0],pn="Number.toFixed: incorrect invocation!",mn=function(e,t){for(var n=-1,i=t;++n<6;)i+=e*fn[n],fn[n]=i%1e7,i=dn(i/1e7)},gn=function(e){for(var t=6,n=0;--t>=0;)n+=fn[t],fn[t]=dn(n/e),n=n%e*1e7},vn=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==fn[e]){var n=String(fn[e]);t=""===t?n:t+cn.call("0",7-n.length)+n}return t},yn=function(e,t,n){return 0===t?n:t%2==1?yn(e,t-1,n*e):yn(e*e,t/2,n)};N(N.P+N.F*(!!hn&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!d((function(){hn.call({})}))),"Number",{toFixed:function(e){var t,n,i,r,a=un(this,pn),o=Z(e),s="",l="0";if(o<0||o>20)throw RangeError(pn);if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(s="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*yn(2,69,1))-69)<0?a*yn(2,-t,1):a/yn(2,t,1),n*=4503599627370496,(t=52-t)>0){for(mn(0,n),i=o;i>=7;)mn(1e7,0),i-=7;for(mn(yn(10,i,1),0),i=t-1;i>=23;)gn(1<<23),i-=23;gn(1<<i),mn(1,1),gn(2),l=vn()}else mn(0,n),mn(1<<-t,0),l=vn()+cn.call("0",o);return l=o>0?s+((r=l.length)<=o?"0."+cn.call("0",o-r)+l:l.slice(0,r-o)+"."+l.slice(r-o)):s+l}});var _n=1..toPrecision;N(N.P+N.F*(d((function(){return"1"!==_n.call(1,void 0)}))||!d((function(){_n.call({})}))),"Number",{toPrecision:function(e){var t=un(this,"Number#toPrecision: incorrect invocation!");return void 0===e?_n.call(t):_n.call(t,e)}}),N(N.S,"Number",{EPSILON:Math.pow(2,-52)});var bn=u.isFinite;N(N.S,"Number",{isFinite:function(e){return"number"==typeof e&&bn(e)}});var En=Math.floor,Tn=function(e){return!m(e)&&isFinite(e)&&En(e)===e};N(N.S,"Number",{isInteger:Tn}),N(N.S,"Number",{isNaN:function(e){return e!=e}});var wn=Math.abs;N(N.S,"Number",{isSafeInteger:function(e){return Tn(e)&&wn(e)<=9007199254740991}}),N(N.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),N(N.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),N(N.S+N.F*(Number.parseFloat!=qt),"Number",{parseFloat:qt}),N(N.S+N.F*(Number.parseInt!=Ht),"Number",{parseInt:Ht});var xn=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},An=Math.sqrt,Sn=Math.acosh;N(N.S+N.F*!(Sn&&710==Math.floor(Sn(Number.MAX_VALUE))&&Sn(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:xn(e-1+An(e-1)*An(e+1))}});var Mn=Math.asinh;N(N.S+N.F*!(Mn&&1/Mn(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var Cn=Math.atanh;N(N.S+N.F*!(Cn&&1/Cn(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var Rn=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};N(N.S,"Math",{cbrt:function(e){return Rn(e=+e)*Math.pow(Math.abs(e),1/3)}}),N(N.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var In=Math.exp;N(N.S,"Math",{cosh:function(e){return(In(e=+e)+In(-e))/2}});var Pn=Math.expm1,Ln=!Pn||Pn(10)>22025.465794806718||Pn(10)<22025.465794806718||-2e-17!=Pn(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:Pn;N(N.S+N.F*(Ln!=Math.expm1),"Math",{expm1:Ln});var Dn=Math.pow,On=Dn(2,-52),Nn=Dn(2,-23),kn=Dn(2,127)*(2-Nn),Fn=Dn(2,-126),Bn=Math.fround||function(e){var t,n,i=Math.abs(e),r=Rn(e);return i<Fn?r*(i/Fn/Nn+1/On-1/On)*Fn*Nn:(n=(t=(1+Nn/On)*i)-(t-i))>kn||n!=n?r*(1/0):r*n};N(N.S,"Math",{fround:Bn});var Un=Math.abs;N(N.S,"Math",{hypot:function(e,t){for(var n,i,r=0,a=0,o=arguments.length,s=0;a<o;)s<(n=Un(arguments[a++]))?(r=r*(i=s/n)*i+1,s=n):r+=n>0?(i=n/s)*i:n;return s===1/0?1/0:s*Math.sqrt(r)}});var jn=Math.imul;N(N.S+N.F*d((function(){return-5!=jn(4294967295,5)||2!=jn.length})),"Math",{imul:function(e,t){var n=+e,i=+t,r=65535&n,a=65535&i;return 0|r*a+((65535&n>>>16)*a+r*(65535&i>>>16)<<16>>>0)}}),N(N.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),N(N.S,"Math",{log1p:xn}),N(N.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),N(N.S,"Math",{sign:Rn});var Gn=Math.exp;N(N.S+N.F*d((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(Ln(e)-Ln(-e))/2:(Gn(e-1)-Gn(-e-1))*(Math.E/2)}});var zn=Math.exp;N(N.S,"Math",{tanh:function(e){var t=Ln(e=+e),n=Ln(-e);return t==1/0?1:n==1/0?-1:(t-n)/(zn(e)+zn(-e))}}),N(N.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var Hn=String.fromCharCode,Vn=String.fromCodePoint;N(N.S+N.F*(!!Vn&&1!=Vn.length),"String",{fromCodePoint:function(e){for(var t,n=[],i=arguments.length,r=0;i>r;){if(t=+arguments[r++],ne(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?Hn(t):Hn(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}}),N(N.S,"String",{raw:function(e){for(var t=X(e.raw),n=$(t.length),i=arguments.length,r=[],a=0;n>a;)r.push(String(t[a++])),a<i&&r.push(String(arguments[a]));return r.join("")}}),Ut("trim",(function(e){return function(){return e(this,3)}}));var Wn=function(e){return function(t,n){var i,r,a=String(Y(t)),o=Z(n),s=a.length;return o<0||o>=s?e?"":void 0:(i=a.charCodeAt(o))<55296||i>56319||o+1===s||(r=a.charCodeAt(o+1))<56320||r>57343?e?a.charAt(o):i:e?a.slice(o,o+2):r-56320+(i-55296<<10)+65536}},qn={},Yn={};A(Yn,F("iterator"),(function(){return this}));var Xn=function(e,t,n){e.prototype=be(Yn,{next:x(1,n)}),j(e,t+" Iterator")},Kn=F("iterator"),Qn=!([].keys&&"next"in[].keys()),Zn=function(){return this},Jn=function(e,t,n,i,r,a,o){Xn(n,t,i);var s,l,u,c=function(e){if(!Qn&&e in p)return p[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",d="values"==r,f=!1,p=e.prototype,m=p[Kn]||p["@@iterator"]||r&&p[r],g=m||c(r),v=r?d?c("entries"):g:void 0,y="Array"==t&&p.entries||m;if(y&&(u=ct(y.call(new e)))!==Object.prototype&&u.next&&(j(u,h,!0),"function"!=typeof u[Kn]&&A(u,Kn,Zn)),d&&m&&"values"!==m.name&&(f=!0,g=function(){return m.call(this)}),(Qn||f||!p[Kn])&&A(p,Kn,g),qn[t]=g,qn[h]=Zn,r)if(s={values:d?g:c("values"),keys:a?g:c("keys"),entries:v},o)for(l in s)l in p||P(p,l,s[l]);else N(N.P+N.F*(Qn||f),t,s);return s},$n=Wn(!0);Jn(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=$n(t,n),this._i+=e.length,{value:e,done:!1})}));var ei=Wn(!1);N(N.P,"String",{codePointAt:function(e){return ei(this,e)}});var ti=F("match"),ni=function(e){var t;return m(e)&&(void 0!==(t=e[ti])?!!t:"RegExp"==W(e))},ii=function(e,t,n){if(ni(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(Y(e))},ri=F("match"),ai=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[ri]=!1,!"/./"[e](t)}catch(e){}}return!0},oi="".endsWith;N(N.P+N.F*ai("endsWith"),"String",{endsWith:function(e){var t=ii(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=$(t.length),r=void 0===n?i:Math.min($(n),i),a=String(e);return oi?oi.call(t,a,r):t.slice(r-a.length,r)===a}});N(N.P+N.F*ai("includes"),"String",{includes:function(e){return!!~ii(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}}),N(N.P,"String",{repeat:cn});var si="".startsWith;N(N.P+N.F*ai("startsWith"),"String",{startsWith:function(e){var t=ii(this,e,"startsWith"),n=$(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return si?si.call(t,i,n):t.slice(n,n+i.length)===i}});var li=/"/g,ui=function(e,t,n,i){var r=String(Y(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+String(i).replace(li,"&quot;")+'"'),a+">"+r+"</"+t+">"},ci=function(e,t){var n={};n[e]=t(ui),N(N.P+N.F*d((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)};ci("anchor",(function(e){return function(t){return e(this,"a","name",t)}})),ci("big",(function(e){return function(){return e(this,"big","","")}})),ci("blink",(function(e){return function(){return e(this,"blink","","")}})),ci("bold",(function(e){return function(){return e(this,"b","","")}})),ci("fixed",(function(e){return function(){return e(this,"tt","","")}})),ci("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}})),ci("fontsize",(function(e){return function(t){return e(this,"font","size",t)}})),ci("italics",(function(e){return function(){return e(this,"i","","")}})),ci("link",(function(e){return function(t){return e(this,"a","href",t)}})),ci("small",(function(e){return function(){return e(this,"small","","")}})),ci("strike",(function(e){return function(){return e(this,"strike","","")}})),ci("sub",(function(e){return function(){return e(this,"sub","","")}})),ci("sup",(function(e){return function(){return e(this,"sup","","")}})),N(N.S,"Date",{now:function(){return(new Date).getTime()}}),N(N.P+N.F*d((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=st(this),n=E(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}});var hi=Date.prototype.getTime,di=Date.prototype.toISOString,fi=function(e){return e>9?e:"0"+e},pi=d((function(){return"0385-07-25T07:06:39.999Z"!=di.call(new Date(-50000000000001))}))||!d((function(){di.call(new Date(NaN))}))?function(){if(!isFinite(hi.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),i=t<0?"-":t>9999?"+":"";return i+("00000"+Math.abs(t)).slice(i?-6:-4)+"-"+fi(e.getUTCMonth()+1)+"-"+fi(e.getUTCDate())+"T"+fi(e.getUTCHours())+":"+fi(e.getUTCMinutes())+":"+fi(e.getUTCSeconds())+"."+(n>99?n:"0"+fi(n))+"Z"}:di;N(N.P+N.F*(Date.prototype.toISOString!==pi),"Date",{toISOString:pi});var mi=Date.prototype,gi=mi.toString,vi=mi.getTime;new Date(NaN)+""!="Invalid Date"&&P(mi,"toString",(function(){var e=vi.call(this);return e==e?gi.call(this):"Invalid Date"}));var yi=F("toPrimitive"),_i=Date.prototype;yi in _i||A(_i,yi,(function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return E(g(this),"number"!=e)})),N(N.S,"Array",{isArray:fe});var bi=function(e,t,n,i){try{return i?t(g(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&g(r.call(e)),t}},Ei=F("iterator"),Ti=Array.prototype,wi=function(e){return void 0!==e&&(qn.Array===e||Ti[Ei]===e)},xi=function(e,t,n){t in e?w.f(e,t,x(0,n)):e[t]=n},Ai=F("iterator"),Si=p.getIteratorMethod=function(e){if(null!=e)return e[Ai]||e["@@iterator"]||qn[Et(e)]},Mi=F("iterator"),Ci=!1;try{var Ri=[7][Mi]();Ri.return=function(){Ci=!0},Array.from(Ri,(function(){throw 2}))}catch(e){}var Ii=function(e,t){if(!t&&!Ci)return!1;var n=!1;try{var i=[7],r=i[Mi]();r.next=function(){return{done:n=!0}},i[Mi]=function(){return r},e(i)}catch(e){}return n};N(N.S+N.F*!Ii((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,r,a=st(e),o="function"==typeof this?this:Array,s=arguments.length,l=s>1?arguments[1]:void 0,u=void 0!==l,c=0,h=Si(a);if(u&&(l=D(l,s>2?arguments[2]:void 0,2)),null==h||o==Array&&wi(h))for(n=new o(t=$(a.length));t>c;c++)xi(n,c,u?l(a[c],c):a[c]);else for(r=h.call(a),n=new o;!(i=r.next()).done;c++)xi(n,c,u?bi(r,l,[i.value,c],!0):i.value);return n.length=c,n}}),N(N.S+N.F*d((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)xi(n,e,arguments[e++]);return n.length=t,n}});var Pi=function(e,t){return!!e&&d((function(){t?e.call(null,(function(){}),1):e.call(null)}))},Li=[].join;N(N.P+N.F*(q!=Object||!Pi(Li)),"Array",{join:function(e){return Li.call(X(this),void 0===e?",":e)}});var Di=[].slice;N(N.P+N.F*d((function(){ge&&Di.call(ge)})),"Array",{slice:function(e,t){var n=$(this.length),i=W(this);if(t=void 0===t?n:t,"Array"==i)return Di.call(this,e,t);for(var r=ne(e,n),a=ne(t,n),o=$(a-r),s=new Array(o),l=0;l<o;l++)s[l]="String"==i?this.charAt(r+l):this[r+l];return s}});var Oi=[].sort,Ni=[1,2,3];N(N.P+N.F*(d((function(){Ni.sort(void 0)}))||!d((function(){Ni.sort(null)}))||!Pi(Oi)),"Array",{sort:function(e){return void 0===e?Oi.call(st(this)):Oi.call(st(this),L(e))}});var ki=F("species"),Fi=function(e,t){return new(function(e){var t;return fe(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!fe(t.prototype)||(t=void 0),m(t)&&null===(t=t[ki])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Bi=function(e,t){var n=1==e,i=2==e,r=3==e,a=4==e,o=6==e,s=5==e||o,l=t||Fi;return function(t,u,c){for(var h,d,f=st(t),p=q(f),m=D(u,c,3),g=$(p.length),v=0,y=n?l(t,g):i?l(t,0):void 0;g>v;v++)if((s||v in p)&&(d=m(h=p[v],v,f),e))if(n)y[v]=d;else if(d)switch(e){case 3:return!0;case 5:return h;case 6:return v;case 2:y.push(h)}else if(a)return!1;return o?-1:r||a?a:y}},Ui=Bi(0),ji=Pi([].forEach,!0);N(N.P+N.F*!ji,"Array",{forEach:function(e){return Ui(this,e,arguments[1])}});var Gi=Bi(1);N(N.P+N.F*!Pi([].map,!0),"Array",{map:function(e){return Gi(this,e,arguments[1])}});var zi=Bi(2);N(N.P+N.F*!Pi([].filter,!0),"Array",{filter:function(e){return zi(this,e,arguments[1])}});var Hi=Bi(3);N(N.P+N.F*!Pi([].some,!0),"Array",{some:function(e){return Hi(this,e,arguments[1])}});var Vi=Bi(4);N(N.P+N.F*!Pi([].every,!0),"Array",{every:function(e){return Vi(this,e,arguments[1])}});var Wi=function(e,t,n,i,r){L(t);var a=st(e),o=q(a),s=$(a.length),l=r?s-1:0,u=r?-1:1;if(n<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,r?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;r?l>=0:s>l;l+=u)l in o&&(i=t(i,o[l],l,a));return i};N(N.P+N.F*!Pi([].reduce,!0),"Array",{reduce:function(e){return Wi(this,e,arguments.length,arguments[1],!1)}}),N(N.P+N.F*!Pi([].reduceRight,!0),"Array",{reduceRight:function(e){return Wi(this,e,arguments.length,arguments[1],!0)}});var qi=ie(!1),Yi=[].indexOf,Xi=!!Yi&&1/[1].indexOf(1,-0)<0;N(N.P+N.F*(Xi||!Pi(Yi)),"Array",{indexOf:function(e){return Xi?Yi.apply(this,arguments)||0:qi(this,e,arguments[1])}});var Ki=[].lastIndexOf,Qi=!!Ki&&1/[1].lastIndexOf(1,-0)<0;N(N.P+N.F*(Qi||!Pi(Ki)),"Array",{lastIndexOf:function(e){if(Qi)return Ki.apply(this,arguments)||0;var t=X(this),n=$(t.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,Z(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}});var Zi=[].copyWithin||function(e,t){var n=st(this),i=$(n.length),r=ne(e,i),a=ne(t,i),o=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===o?i:ne(o,i))-a,i-r),l=1;for(a<r&&r<a+s&&(l=-1,a+=s-1,r+=s-1);s-- >0;)a in n?n[r]=n[a]:delete n[r],r+=l,a+=l;return n},Ji=F("unscopables"),$i=Array.prototype;null==$i[Ji]&&A($i,Ji,{});var er=function(e){$i[Ji][e]=!0};N(N.P,"Array",{copyWithin:Zi}),er("copyWithin");var tr=function(e){for(var t=st(this),n=$(t.length),i=arguments.length,r=ne(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,o=void 0===a?n:ne(a,n);o>r;)t[r++]=e;return t};N(N.P,"Array",{fill:tr}),er("fill");var nr=Bi(5),ir=!0;"find"in[]&&Array(1).find((function(){ir=!1})),N(N.P+N.F*ir,"Array",{find:function(e){return nr(this,e,arguments.length>1?arguments[1]:void 0)}}),er("find");var rr=Bi(6),ar=!0;"findIndex"in[]&&Array(1).findIndex((function(){ar=!1})),N(N.P+N.F*ar,"Array",{findIndex:function(e){return rr(this,e,arguments.length>1?arguments[1]:void 0)}}),er("findIndex");var or=F("species"),sr=function(e){var t=u[e];f&&t&&!t[or]&&w.f(t,or,{configurable:!0,get:function(){return this}})};sr("Array");var lr=function(e,t){return{value:t,done:!!e}},ur=Jn(Array,"Array",(function(e,t){this._t=X(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,lr(1)):lr(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values");qn.Arguments=qn.Array,er("keys"),er("values"),er("entries");var cr=function(){var e=g(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},hr=w.f,dr=Te.f,fr=u.RegExp,pr=fr,mr=fr.prototype,gr=/a/g,vr=/a/g,yr=new fr(gr)!==gr;if(f&&(!yr||d((function(){return vr[F("match")]=!1,fr(gr)!=gr||fr(vr)==vr||"/a/i"!=fr(gr,"i")})))){fr=function(e,t){var n=this instanceof fr,i=ni(e),r=void 0===t;return!n&&i&&e.constructor===fr&&r?e:Xt(yr?new pr(i&&!r?e.source:e,t):pr((i=e instanceof fr)?e.source:e,i&&r?cr.call(e):t),n?this:mr,fr)};for(var _r=function(e){e in fr||hr(fr,e,{configurable:!0,get:function(){return pr[e]},set:function(t){pr[e]=t}})},br=dr(pr),Er=0;br.length>Er;)_r(br[Er++]);mr.constructor=fr,fr.prototype=mr,P(u,"RegExp",fr)}sr("RegExp");var Tr=RegExp.prototype.exec,wr=String.prototype.replace,xr=Tr,Ar=function(){var e=/a/,t=/b*/g;return Tr.call(e,"a"),Tr.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Sr=void 0!==/()??/.exec("")[1];(Ar||Sr)&&(xr=function(e){var t,n,i,r,a=this;return Sr&&(n=new RegExp("^"+a.source+"$(?!\\s)",cr.call(a))),Ar&&(t=a.lastIndex),i=Tr.call(a,e),Ar&&i&&(a.lastIndex=a.global?i.index+i[0].length:t),Sr&&i&&i.length>1&&wr.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i});var Mr=xr;N({target:"RegExp",proto:!0,forced:Mr!==/./.exec},{exec:Mr}),f&&"g"!=/./g.flags&&w.f(RegExp.prototype,"flags",{configurable:!0,get:cr});var Cr=/./.toString,Rr=function(e){P(RegExp.prototype,"toString",e,!0)};d((function(){return"/a/b"!=Cr.call({source:"a",flags:"b"})}))?Rr((function(){var e=g(this);return"/".concat(e.source,"/","flags"in e?e.flags:!f&&e instanceof RegExp?cr.call(e):void 0)})):"toString"!=Cr.name&&Rr((function(){return Cr.call(this)}));var Ir=Wn(!0),Pr=function(e,t,n){return t+(n?Ir(e,t).length:1)},Lr=RegExp.prototype.exec,Dr=function(e,t){var n=e.exec;if("function"==typeof n){var i=n.call(e,t);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==Et(e))throw new TypeError("RegExp#exec called on incompatible receiver");return Lr.call(e,t)},Or=F("species"),Nr=!d((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),kr=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),Fr=function(e,t,n){var i=F(e),r=!d((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=r?!d((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[Or]=function(){return n}),n[i](""),!t})):void 0;if(!r||!a||"replace"===e&&!Nr||"split"===e&&!kr){var o=/./[i],s=n(Y,i,""[e],(function(e,t,n,i,a){return t.exec===Mr?r&&!a?{done:!0,value:o.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),l=s[0],u=s[1];P(String.prototype,e,l),A(RegExp.prototype,i,2==t?function(e,t){return u.call(e,this,t)}:function(e){return u.call(e,this)})}};Fr("match",1,(function(e,t,n,i){return[function(n){var i=e(this),r=null==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))},function(e){var t=i(n,e,this);if(t.done)return t.value;var r=g(e),a=String(this);if(!r.global)return Dr(r,a);var o=r.unicode;r.lastIndex=0;for(var s,l=[],u=0;null!==(s=Dr(r,a));){var c=String(s[0]);l[u]=c,""===c&&(r.lastIndex=Pr(a,$(r.lastIndex),o)),u++}return 0===u?null:l}]}));var Br=Math.max,Ur=Math.min,jr=Math.floor,Gr=/\$([$&`']|\d\d?|<[^>]*>)/g,zr=/\$([$&`']|\d\d?)/g;Fr("replace",2,(function(e,t,n,i){return[function(i,r){var a=e(this),o=null==i?void 0:i[t];return void 0!==o?o.call(i,a,r):n.call(String(a),i,r)},function(e,t){var a=i(n,e,this,t);if(a.done)return a.value;var o=g(e),s=String(this),l="function"==typeof t;l||(t=String(t));var u=o.global;if(u){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=Dr(o,s);if(null===d)break;if(h.push(d),!u)break;""===String(d[0])&&(o.lastIndex=Pr(s,$(o.lastIndex),c))}for(var f,p="",m=0,v=0;v<h.length;v++){d=h[v];for(var y=String(d[0]),_=Br(Ur(Z(d.index),s.length),0),b=[],E=1;E<d.length;E++)b.push(void 0===(f=d[E])?f:String(f));var T=d.groups;if(l){var w=[y].concat(b,_,s);void 0!==T&&w.push(T);var x=String(t.apply(void 0,w))}else x=r(y,s,_,b,T,t);_>=m&&(p+=s.slice(m,_)+x,m=_+y.length)}return p+s.slice(m)}];function r(e,t,i,r,a,o){var s=i+e.length,l=r.length,u=zr;return void 0!==a&&(a=st(a),u=Gr),n.call(o,u,(function(n,o){var u;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(s);case"<":u=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return n;if(c>l){var h=jr(c/10);return 0===h?n:h<=l?void 0===r[h-1]?o.charAt(1):r[h-1]+o.charAt(1):n}u=r[c-1]}return void 0===u?"":u}))}})),Fr("search",1,(function(e,t,n,i){return[function(n){var i=e(this),r=null==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))},function(e){var t=i(n,e,this);if(t.done)return t.value;var r=g(e),a=String(this),o=r.lastIndex;gt(o,0)||(r.lastIndex=0);var s=Dr(r,a);return gt(r.lastIndex,o)||(r.lastIndex=o),null===s?-1:s.index}]}));var Hr=F("species"),Vr=function(e,t){var n,i=g(e).constructor;return void 0===i||null==(n=g(i)[Hr])?t:L(n)},Wr=Math.min,qr=[].push,Yr="length",Xr=!d((function(){RegExp(4294967295,"y")}));Fr("split",2,(function(e,t,n,i){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[Yr]||2!="ab".split(/(?:ab)*/)[Yr]||4!=".".split(/(.?)(.?)/)[Yr]||".".split(/()()/)[Yr]>1||"".split(/.?/)[Yr]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!ni(e))return n.call(i,e,t);for(var r,a,o,s=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,c=void 0===t?4294967295:t>>>0,h=new RegExp(e.source,l+"g");(r=Mr.call(h,i))&&!((a=h.lastIndex)>u&&(s.push(i.slice(u,r.index)),r[Yr]>1&&r.index<i[Yr]&&qr.apply(s,r.slice(1)),o=r[0][Yr],u=a,s[Yr]>=c));)h.lastIndex===r.index&&h.lastIndex++;return u===i[Yr]?!o&&h.test("")||s.push(""):s.push(i.slice(u)),s[Yr]>c?s.slice(0,c):s}:"0".split(void 0,0)[Yr]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,i){var a=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,a,i):r.call(String(a),n,i)},function(e,t){var a=i(r,e,this,t,r!==n);if(a.done)return a.value;var o=g(e),s=String(this),l=Vr(o,RegExp),u=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Xr?"y":"g"),h=new l(Xr?o:"^(?:"+o.source+")",c),d=void 0===t?4294967295:t>>>0;if(0===d)return[];if(0===s.length)return null===Dr(h,s)?[s]:[];for(var f=0,p=0,m=[];p<s.length;){h.lastIndex=Xr?p:0;var v,y=Dr(h,Xr?s:s.slice(p));if(null===y||(v=Wr($(h.lastIndex+(Xr?0:p)),s.length))===f)p=Pr(s,p,u);else{if(m.push(s.slice(f,p)),m.length===d)return m;for(var _=1;_<=y.length-1;_++)if(m.push(y[_]),m.length===d)return m;p=f=v}}return m.push(s.slice(f)),m}]}));var Kr,Qr,Zr,Jr=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e},$r=l((function(e){var t={},n={},i=e.exports=function(e,i,r,a,o){var s,l,u,c,h=o?function(){return e}:Si(e),d=D(r,a,i?2:1),f=0;if("function"!=typeof h)throw TypeError(e+" is not iterable!");if(wi(h)){for(s=$(e.length);s>f;f++)if((c=i?d(g(l=e[f])[0],l[1]):d(e[f]))===t||c===n)return c}else for(u=h.call(e);!(l=u.next()).done;)if((c=bi(u,d,l.value,i))===t||c===n)return c};i.BREAK=t,i.RETURN=n})),ea=u.process,ta=u.setImmediate,na=u.clearImmediate,ia=u.MessageChannel,ra=u.Dispatch,aa=0,oa={},sa=function(){var e=+this;if(oa.hasOwnProperty(e)){var t=oa[e];delete oa[e],t()}},la=function(e){sa.call(e.data)};ta&&na||(ta=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return oa[++aa]=function(){wt("function"==typeof e?e:Function(e),t)},Kr(aa),aa},na=function(e){delete oa[e]},"process"==W(ea)?Kr=function(e){ea.nextTick(D(sa,e,1))}:ra&&ra.now?Kr=function(e){ra.now(D(sa,e,1))}:ia?(Zr=(Qr=new ia).port2,Qr.port1.onmessage=la,Kr=D(Zr.postMessage,Zr,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(Kr=function(e){u.postMessage(e+"","*")},u.addEventListener("message",la,!1)):Kr="onreadystatechange"in _("script")?function(e){ge.appendChild(_("script")).onreadystatechange=function(){ge.removeChild(this),sa.call(e)}}:function(e){setTimeout(D(sa,e,1),0)});var ua={set:ta,clear:na},ca=ua.set,ha=u.MutationObserver||u.WebKitMutationObserver,da=u.process,fa=u.Promise,pa="process"==W(da),ma=function(){var e,t,n,i=function(){var i,r;for(pa&&(i=da.domain)&&i.exit();e;){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(pa)n=function(){da.nextTick(i)};else if(!ha||u.navigator&&u.navigator.standalone)if(fa&&fa.resolve){var r=fa.resolve(void 0);n=function(){r.then(i)}}else n=function(){ca.call(u,i)};else{var a=!0,o=document.createTextNode("");new ha(i).observe(o,{characterData:!0}),n=function(){o.data=a=!a}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}};function ga(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=L(t),this.reject=L(n)}var va,ya,_a,ba,Ea={f:function(e){return new ga(e)}},Ta=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},wa=u.navigator,xa=wa&&wa.userAgent||"",Aa=function(e,t){if(g(e),m(t)&&t.constructor===e)return t;var n=Ea.f(e);return(0,n.resolve)(t),n.promise},Sa=function(e,t,n){for(var i in t)P(e,i,t[i],n);return e},Ma=ua.set,Ca=ma(),Ra=u.TypeError,Ia=u.process,Pa=Ia&&Ia.versions,La=Pa&&Pa.v8||"",Da=u.Promise,Oa="process"==Et(Ia),Na=function(){},ka=ya=Ea.f,Fa=!!function(){try{var e=Da.resolve(1),t=(e.constructor={})[F("species")]=function(e){e(Na,Na)};return(Oa||"function"==typeof PromiseRejectionEvent)&&e.then(Na)instanceof t&&0!==La.indexOf("6.6")&&-1===xa.indexOf("Chrome/66")}catch(e){}}(),Ba=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Ua=function(e,t){if(!e._n){e._n=!0;var n=e._c;Ca((function(){for(var i=e._v,r=1==e._s,a=0,o=function(t){var n,a,o,s=r?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(r||(2==e._h&&za(e),e._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),o=!0)),n===t.promise?u(Ra("Promise-chain cycle")):(a=Ba(n))?a.call(n,l,u):l(n)):u(i)}catch(e){c&&!o&&c.exit(),u(e)}};n.length>a;)o(n[a++]);e._c=[],e._n=!1,t&&!e._h&&ja(e)}))}},ja=function(e){Ma.call(u,(function(){var t,n,i,r=e._v,a=Ga(e);if(a&&(t=Ta((function(){Oa?Ia.emit("unhandledRejection",r,e):(n=u.onunhandledrejection)?n({promise:e,reason:r}):(i=u.console)&&i.error&&i.error("Unhandled promise rejection",r)})),e._h=Oa||Ga(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},Ga=function(e){return 1!==e._h&&0===(e._a||e._c).length},za=function(e){Ma.call(u,(function(){var t;Oa?Ia.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},Ha=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Ua(t,!0))},Va=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Ra("Promise can't be resolved itself");(t=Ba(e))?Ca((function(){var i={_w:n,_d:!1};try{t.call(e,D(Va,i,1),D(Ha,i,1))}catch(e){Ha.call(i,e)}})):(n._v=e,n._s=1,Ua(n,!1))}catch(e){Ha.call({_w:n,_d:!1},e)}}};Fa||(Da=function(e){Jr(this,Da,"Promise","_h"),L(e),va.call(this);try{e(D(Va,this,1),D(Ha,this,1))}catch(e){Ha.call(this,e)}},(va=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Sa(Da.prototype,{then:function(e,t){var n=ka(Vr(this,Da));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=Oa?Ia.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Ua(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),_a=function(){var e=new va;this.promise=e,this.resolve=D(Va,e,1),this.reject=D(Ha,e,1)},Ea.f=ka=function(e){return e===Da||e===ba?new _a(e):ya(e)}),N(N.G+N.W+N.F*!Fa,{Promise:Da}),j(Da,"Promise"),sr("Promise"),ba=p.Promise,N(N.S+N.F*!Fa,"Promise",{reject:function(e){var t=ka(this);return(0,t.reject)(e),t.promise}}),N(N.S+N.F*!Fa,"Promise",{resolve:function(e){return Aa(this,e)}}),N(N.S+N.F*!(Fa&&Ii((function(e){Da.all(e).catch(Na)}))),"Promise",{all:function(e){var t=this,n=ka(t),i=n.resolve,r=n.reject,a=Ta((function(){var n=[],a=0,o=1;$r(e,!1,(function(e){var s=a++,l=!1;n.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,n[s]=e,--o||i(n))}),r)})),--o||i(n)}));return a.e&&r(a.v),n.promise},race:function(e){var t=this,n=ka(t),i=n.reject,r=Ta((function(){$r(e,!1,(function(e){t.resolve(e).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}});var Wa=function(e,t){if(!m(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},qa=w.f,Ya=k.fastKey,Xa=f?"_s":"size",Ka=function(e,t){var n,i=Ya(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n},Qa={getConstructor:function(e,t,n,i){var r=e((function(e,a){Jr(e,r,t,"_i"),e._t=t,e._i=be(null),e._f=void 0,e._l=void 0,e[Xa]=0,null!=a&&$r(a,n,e[i],e)}));return Sa(r.prototype,{clear:function(){for(var e=Wa(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[Xa]=0},delete:function(e){var n=Wa(this,t),i=Ka(n,e);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[Xa]--}return!!i},forEach:function(e){Wa(this,t);for(var n,i=D(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!Ka(Wa(this,t),e)}}),f&&qa(r.prototype,"size",{get:function(){return Wa(this,t)[Xa]}}),r},def:function(e,t,n){var i,r,a=Ka(e,t);return a?a.v=n:(e._l=a={i:r=Ya(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=a),i&&(i.n=a),e[Xa]++,"F"!==r&&(e._i[r]=a)),e},getEntry:Ka,setStrong:function(e,t,n){Jn(e,t,(function(e,n){this._t=Wa(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?lr(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,lr(1))}),n?"entries":"values",!n,!0),sr(t)}},Za=function(e,t,n,i,r,a){var o=u[e],s=o,l=r?"set":"add",c=s&&s.prototype,h={},f=function(e){var t=c[e];P(c,e,"delete"==e||"has"==e?function(e){return!(a&&!m(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return a&&!m(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof s&&(a||c.forEach&&!d((function(){(new s).entries().next()})))){var p=new s,g=p[l](a?{}:-0,1)!=p,v=d((function(){p.has(1)})),y=Ii((function(e){new s(e)})),_=!a&&d((function(){for(var e=new s,t=5;t--;)e[l](t,t);return!e.has(-0)}));y||((s=t((function(t,n){Jr(t,s,e);var i=Xt(new o,t,s);return null!=n&&$r(n,r,i[l],i),i}))).prototype=c,c.constructor=s),(v||_)&&(f("delete"),f("has"),r&&f("get")),(_||g)&&f(l),a&&c.clear&&delete c.clear}else s=i.getConstructor(t,e,r,l),Sa(s.prototype,n),k.NEED=!0;return j(s,e),h[e]=s,N(N.G+N.W+N.F*(s!=o),h),a||i.setStrong(s,e,r),s},Ja=Za("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=Qa.getEntry(Wa(this,"Map"),e);return t&&t.v},set:function(e,t){return Qa.def(Wa(this,"Map"),0===e?0:e,t)}},Qa,!0),$a=Za("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return Qa.def(Wa(this,"Set"),e=0===e?0:e,e)}},Qa),eo=k.getWeak,to=Bi(5),no=Bi(6),io=0,ro=function(e){return e._l||(e._l=new ao)},ao=function(){this.a=[]},oo=function(e,t){return to(e.a,(function(e){return e[0]===t}))};ao.prototype={get:function(e){var t=oo(this,e);if(t)return t[1]},has:function(e){return!!oo(this,e)},set:function(e,t){var n=oo(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=no(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}};var so={getConstructor:function(e,t,n,i){var r=e((function(e,a){Jr(e,r,t,"_i"),e._t=t,e._i=io++,e._l=void 0,null!=a&&$r(a,n,e[i],e)}));return Sa(r.prototype,{delete:function(e){if(!m(e))return!1;var n=eo(e);return!0===n?ro(Wa(this,t)).delete(e):n&&h(n,this._i)&&delete n[this._i]},has:function(e){if(!m(e))return!1;var n=eo(e);return!0===n?ro(Wa(this,t)).has(e):n&&h(n,this._i)}}),r},def:function(e,t,n){var i=eo(g(t),!0);return!0===i?ro(e).set(t,n):i[e._i]=n,e},ufstore:ro},lo=l((function(e){var t,n=Bi(0),i=Wa,r=!u.ActiveXObject&&"ActiveXObject"in u,a=k.getWeak,o=Object.isExtensible,s=so.ufstore,l=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},c={get:function(e){if(m(e)){var t=a(e);return!0===t?s(Wa(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return so.def(Wa(this,"WeakMap"),e,t)}},h=e.exports=Za("WeakMap",l,c,so,!0,!0);i&&r&&(t=so.getConstructor(l,"WeakMap"),mt(t.prototype,c),k.NEED=!0,n(["delete","has","get","set"],(function(e){var n=h.prototype,i=n[e];P(n,e,(function(n,r){if(m(n)&&!o(n)){this._f||(this._f=new t);var a=this._f[e](n,r);return"set"==e?this:a}return i.call(this,n,r)}))})))}));Za("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return so.def(Wa(this,"WeakSet"),e,!0)}},so,!1,!0);for(var uo,co=C("typed_array"),ho=C("view"),fo=!(!u.ArrayBuffer||!u.DataView),po=fo,mo=0,go="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");mo<9;)(uo=u[go[mo++]])?(A(uo.prototype,co,!0),A(uo.prototype,ho,!0)):po=!1;var vo={ABV:fo,CONSTR:po,TYPED:co,VIEW:ho},yo=function(e){if(void 0===e)return 0;var t=Z(e),n=$(t);if(t!==n)throw RangeError("Wrong length!");return n},_o=l((function(e,t){var n=Te.f,i=w.f,r=u.ArrayBuffer,a=u.DataView,o=u.Math,s=u.RangeError,l=u.Infinity,c=r,h=o.abs,p=o.pow,m=o.floor,g=o.log,v=o.LN2,y=f?"_b":"buffer",_=f?"_l":"byteLength",b=f?"_o":"byteOffset";function E(e,t,n){var i,r,a,o=new Array(n),s=8*n-t-1,u=(1<<s)-1,c=u>>1,d=23===t?p(2,-24)-p(2,-77):0,f=0,y=e<0||0===e&&1/e<0?1:0;for((e=h(e))!=e||e===l?(r=e!=e?1:0,i=u):(i=m(g(e)/v),e*(a=p(2,-i))<1&&(i--,a*=2),(e+=i+c>=1?d/a:d*p(2,1-c))*a>=2&&(i++,a/=2),i+c>=u?(r=0,i=u):i+c>=1?(r=(e*a-1)*p(2,t),i+=c):(r=e*p(2,c-1)*p(2,t),i=0));t>=8;o[f++]=255&r,r/=256,t-=8);for(i=i<<t|r,s+=t;s>0;o[f++]=255&i,i/=256,s-=8);return o[--f]|=128*y,o}function T(e,t,n){var i,r=8*n-t-1,a=(1<<r)-1,o=a>>1,s=r-7,u=n-1,c=e[u--],h=127&c;for(c>>=7;s>0;h=256*h+e[u],u--,s-=8);for(i=h&(1<<-s)-1,h>>=-s,s+=t;s>0;i=256*i+e[u],u--,s-=8);if(0===h)h=1-o;else{if(h===a)return i?NaN:c?-l:l;i+=p(2,t),h-=o}return(c?-1:1)*i*p(2,h-t)}function x(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function S(e){return[255&e]}function M(e){return[255&e,e>>8&255]}function C(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function R(e){return E(e,52,8)}function I(e){return E(e,23,4)}function P(e,t,n){i(e.prototype,t,{get:function(){return this[n]}})}function L(e,t,n,i){var r=yo(+n);if(r+t>e[_])throw s("Wrong index!");var a=e[y]._b,o=r+e[b],l=a.slice(o,o+t);return i?l:l.reverse()}function D(e,t,n,i,r,a){var o=yo(+n);if(o+t>e[_])throw s("Wrong index!");for(var l=e[y]._b,u=o+e[b],c=i(+r),h=0;h<t;h++)l[u+h]=c[a?h:t-h-1]}if(vo.ABV){if(!d((function(){r(1)}))||!d((function(){new r(-1)}))||d((function(){return new r,new r(1.5),new r(NaN),"ArrayBuffer"!=r.name}))){for(var O,N=(r=function(e){return Jr(this,r),new c(yo(e))}).prototype=c.prototype,k=n(c),F=0;k.length>F;)(O=k[F++])in r||A(r,O,c[O]);N.constructor=r}var B=new a(new r(2)),U=a.prototype.setInt8;B.setInt8(0,2147483648),B.setInt8(1,2147483649),!B.getInt8(0)&&B.getInt8(1)||Sa(a.prototype,{setInt8:function(e,t){U.call(this,e,t<<24>>24)},setUint8:function(e,t){U.call(this,e,t<<24>>24)}},!0)}else r=function(e){Jr(this,r,"ArrayBuffer");var t=yo(e);this._b=tr.call(new Array(t),0),this[_]=t},a=function(e,t,n){Jr(this,a,"DataView"),Jr(e,r,"DataView");var i=e[_],o=Z(t);if(o<0||o>i)throw s("Wrong offset!");if(o+(n=void 0===n?i-o:$(n))>i)throw s("Wrong length!");this[y]=e,this[b]=o,this[_]=n},f&&(P(r,"byteLength","_l"),P(a,"buffer","_b"),P(a,"byteLength","_l"),P(a,"byteOffset","_o")),Sa(a.prototype,{getInt8:function(e){return L(this,1,e)[0]<<24>>24},getUint8:function(e){return L(this,1,e)[0]},getInt16:function(e){var t=L(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=L(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return x(L(this,4,e,arguments[1]))},getUint32:function(e){return x(L(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return T(L(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return T(L(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){D(this,1,e,S,t)},setUint8:function(e,t){D(this,1,e,S,t)},setInt16:function(e,t){D(this,2,e,M,t,arguments[2])},setUint16:function(e,t){D(this,2,e,M,t,arguments[2])},setInt32:function(e,t){D(this,4,e,C,t,arguments[2])},setUint32:function(e,t){D(this,4,e,C,t,arguments[2])},setFloat32:function(e,t){D(this,4,e,I,t,arguments[2])},setFloat64:function(e,t){D(this,8,e,R,t,arguments[2])}});j(r,"ArrayBuffer"),j(a,"DataView"),A(a.prototype,vo.VIEW,!0),t.ArrayBuffer=r,t.DataView=a})),bo=u.ArrayBuffer,Eo=_o.ArrayBuffer,To=_o.DataView,wo=vo.ABV&&bo.isView,xo=Eo.prototype.slice,Ao=vo.VIEW;N(N.G+N.W+N.F*(bo!==Eo),{ArrayBuffer:Eo}),N(N.S+N.F*!vo.CONSTR,"ArrayBuffer",{isView:function(e){return wo&&wo(e)||m(e)&&Ao in e}}),N(N.P+N.U+N.F*d((function(){return!new Eo(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==xo&&void 0===t)return xo.call(g(this),e);for(var n=g(this).byteLength,i=ne(e,n),r=ne(void 0===t?n:t,n),a=new(Vr(this,Eo))($(r-i)),o=new To(this),s=new To(a),l=0;i<r;)s.setUint8(l++,o.getUint8(i++));return a}}),sr("ArrayBuffer"),N(N.G+N.W+N.F*!vo.ABV,{DataView:_o.DataView});var So=l((function(e){if(f){var t=u,n=d,i=N,r=vo,a=_o,o=D,s=Jr,l=x,c=A,p=Sa,g=Z,v=$,y=yo,_=ne,b=E,T=h,S=Et,M=m,R=st,I=wi,P=be,L=ct,O=Te.f,k=Si,B=C,U=F,j=Bi,G=ie,z=Vr,H=ur,V=qn,W=Ii,q=sr,Y=tr,X=Zi,K=w,Q=Ce,J=K.f,ee=Q.f,te=t.RangeError,re=t.TypeError,ae=t.Uint8Array,oe=Array.prototype,se=a.ArrayBuffer,le=a.DataView,ue=j(0),ce=j(2),he=j(3),de=j(4),fe=j(5),pe=j(6),me=G(!0),ge=G(!1),ve=H.values,ye=H.keys,_e=H.entries,Ee=oe.lastIndexOf,we=oe.reduce,xe=oe.reduceRight,Ae=oe.join,Se=oe.sort,Me=oe.slice,Re=oe.toString,Ie=oe.toLocaleString,Pe=U("iterator"),Le=U("toStringTag"),De=B("typed_constructor"),Oe=B("def_constructor"),Ne=r.CONSTR,ke=r.TYPED,Fe=r.VIEW,Be=j(1,(function(e,t){return He(z(e,e[Oe]),t)})),Ue=n((function(){return 1===new ae(new Uint16Array([1]).buffer)[0]})),je=!!ae&&!!ae.prototype.set&&n((function(){new ae(1).set({})})),Ge=function(e,t){var n=g(e);if(n<0||n%t)throw te("Wrong offset!");return n},ze=function(e){if(M(e)&&ke in e)return e;throw re(e+" is not a typed array!")},He=function(e,t){if(!M(e)||!(De in e))throw re("It is not a typed array constructor!");return new e(t)},Ve=function(e,t){return We(z(e,e[Oe]),t)},We=function(e,t){for(var n=0,i=t.length,r=He(e,i);i>n;)r[n]=t[n++];return r},qe=function(e,t,n){J(e,t,{get:function(){return this._d[n]}})},Ye=function(e){var t,n,i,r,a,s,l=R(e),u=arguments.length,c=u>1?arguments[1]:void 0,h=void 0!==c,d=k(l);if(null!=d&&!I(d)){for(s=d.call(l),i=[],t=0;!(a=s.next()).done;t++)i.push(a.value);l=i}for(h&&u>2&&(c=o(c,arguments[2],2)),t=0,n=v(l.length),r=He(this,n);n>t;t++)r[t]=h?c(l[t],t):l[t];return r},Xe=function(){for(var e=0,t=arguments.length,n=He(this,t);t>e;)n[e]=arguments[e++];return n},Ke=!!ae&&n((function(){Ie.call(new ae(1))})),Qe=function(){return Ie.apply(Ke?Me.call(ze(this)):ze(this),arguments)},Ze={copyWithin:function(e,t){return X.call(ze(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return de(ze(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return Y.apply(ze(this),arguments)},filter:function(e){return Ve(this,ce(ze(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return fe(ze(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return pe(ze(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){ue(ze(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ge(ze(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return me(ze(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return Ae.apply(ze(this),arguments)},lastIndexOf:function(e){return Ee.apply(ze(this),arguments)},map:function(e){return Be(ze(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return we.apply(ze(this),arguments)},reduceRight:function(e){return xe.apply(ze(this),arguments)},reverse:function(){for(var e,t=ze(this).length,n=Math.floor(t/2),i=0;i<n;)e=this[i],this[i++]=this[--t],this[t]=e;return this},some:function(e){return he(ze(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Se.call(ze(this),e)},subarray:function(e,t){var n=ze(this),i=n.length,r=_(e,i);return new(z(n,n[Oe]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,v((void 0===t?i:_(t,i))-r))}},Je=function(e,t){return Ve(this,Me.call(ze(this),e,t))},$e=function(e){ze(this);var t=Ge(arguments[1],1),n=this.length,i=R(e),r=v(i.length),a=0;if(r+t>n)throw te("Wrong length!");for(;a<r;)this[t+a]=i[a++]},et={entries:function(){return _e.call(ze(this))},keys:function(){return ye.call(ze(this))},values:function(){return ve.call(ze(this))}},tt=function(e,t){return M(e)&&e[ke]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},nt=function(e,t){return tt(e,t=b(t,!0))?l(2,e[t]):ee(e,t)},it=function(e,t,n){return!(tt(e,t=b(t,!0))&&M(n)&&T(n,"value"))||T(n,"get")||T(n,"set")||n.configurable||T(n,"writable")&&!n.writable||T(n,"enumerable")&&!n.enumerable?J(e,t,n):(e[t]=n.value,e)};Ne||(Q.f=nt,K.f=it),i(i.S+i.F*!Ne,"Object",{getOwnPropertyDescriptor:nt,defineProperty:it}),n((function(){Re.call({})}))&&(Re=Ie=function(){return Ae.call(this)});var rt=p({},Ze);p(rt,et),c(rt,Pe,et.values),p(rt,{slice:Je,set:$e,constructor:function(){},toString:Re,toLocaleString:Qe}),qe(rt,"buffer","b"),qe(rt,"byteOffset","o"),qe(rt,"byteLength","l"),qe(rt,"length","e"),J(rt,Le,{get:function(){return this[ke]}}),e.exports=function(e,a,o,l){var u=e+((l=!!l)?"Clamped":"")+"Array",h="get"+e,d="set"+e,f=t[u],p=f||{},m=f&&L(f),g=!f||!r.ABV,_={},b=f&&f.prototype,E=function(e,t){J(e,t,{get:function(){return function(e,t){var n=e._d;return n.v[h](t*a+n.o,Ue)}(this,t)},set:function(e){return function(e,t,n){var i=e._d;l&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[d](t*a+i.o,n,Ue)}(this,t,e)},enumerable:!0})};g?(f=o((function(e,t,n,i){s(e,f,u,"_d");var r,o,l,h,d=0,p=0;if(M(t)){if(!(t instanceof se||"ArrayBuffer"==(h=S(t))||"SharedArrayBuffer"==h))return ke in t?We(f,t):Ye.call(f,t);r=t,p=Ge(n,a);var m=t.byteLength;if(void 0===i){if(m%a)throw te("Wrong length!");if((o=m-p)<0)throw te("Wrong length!")}else if((o=v(i)*a)+p>m)throw te("Wrong length!");l=o/a}else l=y(t),r=new se(o=l*a);for(c(e,"_d",{b:r,o:p,l:o,e:l,v:new le(r)});d<l;)E(e,d++)})),b=f.prototype=P(rt),c(b,"constructor",f)):n((function(){f(1)}))&&n((function(){new f(-1)}))&&W((function(e){new f,new f(null),new f(1.5),new f(e)}),!0)||(f=o((function(e,t,n,i){var r;return s(e,f,u),M(t)?t instanceof se||"ArrayBuffer"==(r=S(t))||"SharedArrayBuffer"==r?void 0!==i?new p(t,Ge(n,a),i):void 0!==n?new p(t,Ge(n,a)):new p(t):ke in t?We(f,t):Ye.call(f,t):new p(y(t))})),ue(m!==Function.prototype?O(p).concat(O(m)):O(p),(function(e){e in f||c(f,e,p[e])})),f.prototype=b,b.constructor=f);var T=b[Pe],w=!!T&&("values"==T.name||null==T.name),x=et.values;c(f,De,!0),c(b,ke,u),c(b,Fe,!0),c(b,Oe,f),(l?new f(1)[Le]==u:Le in b)||J(b,Le,{get:function(){return u}}),_[u]=f,i(i.G+i.W+i.F*(f!=p),_),i(i.S,u,{BYTES_PER_ELEMENT:a}),i(i.S+i.F*n((function(){p.of.call(f,1)})),u,{from:Ye,of:Xe}),"BYTES_PER_ELEMENT"in b||c(b,"BYTES_PER_ELEMENT",a),i(i.P,u,Ze),q(u),i(i.P+i.F*je,u,{set:$e}),i(i.P+i.F*!w,u,et),b.toString!=Re&&(b.toString=Re),i(i.P+i.F*n((function(){new f(1).slice()})),u,{slice:Je}),i(i.P+i.F*(n((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!n((function(){b.toLocaleString.call([1,2])}))),u,{toLocaleString:Qe}),V[u]=w?T:x,w||c(b,Pe,x)}}else e.exports=function(){}}));So("Int8",1,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Uint8",1,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Uint8",1,(function(e){return function(t,n,i){return e(this,t,n,i)}}),!0),So("Int16",2,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Uint16",2,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Int32",4,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Uint32",4,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Float32",4,(function(e){return function(t,n,i){return e(this,t,n,i)}})),So("Float64",8,(function(e){return function(t,n,i){return e(this,t,n,i)}}));var Mo=(u.Reflect||{}).apply,Co=Function.apply;N(N.S+N.F*!d((function(){Mo((function(){}))})),"Reflect",{apply:function(e,t,n){var i=L(e),r=g(n);return Mo?Mo(i,t,r):Co.call(i,t,r)}});var Ro=(u.Reflect||{}).construct,Io=d((function(){function e(){}return!(Ro((function(){}),[],e)instanceof e)})),Po=!d((function(){Ro((function(){}))}));N(N.S+N.F*(Io||Po),"Reflect",{construct:function(e,t){L(e),g(t);var n=arguments.length<3?e:L(arguments[2]);if(Po&&!Io)return Ro(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return i.push.apply(i,t),new(Mt.apply(e,i))}var r=n.prototype,a=be(m(r)?r:Object.prototype),o=Function.apply.call(e,a,t);return m(o)?o:a}}),N(N.S+N.F*d((function(){Reflect.defineProperty(w.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){g(e),t=E(t,!0),g(n);try{return w.f(e,t,n),!0}catch(e){return!1}}});var Lo=Ce.f;N(N.S,"Reflect",{deleteProperty:function(e,t){var n=Lo(g(e),t);return!(n&&!n.configurable)&&delete e[t]}});var Do=function(e){this._t=g(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};Xn(Do,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),N(N.S,"Reflect",{enumerate:function(e){return new Do(e)}}),N(N.S,"Reflect",{get:function e(t,n){var i,r,a=arguments.length<3?t:arguments[2];return g(t)===a?t[n]:(i=Ce.f(t,n))?h(i,"value")?i.value:void 0!==i.get?i.get.call(a):void 0:m(r=ct(t))?e(r,n,a):void 0}}),N(N.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Ce.f(g(e),t)}}),N(N.S,"Reflect",{getPrototypeOf:function(e){return ct(g(e))}}),N(N.S,"Reflect",{has:function(e,t){return t in e}});var Oo=Object.isExtensible;N(N.S,"Reflect",{isExtensible:function(e){return g(e),!Oo||Oo(e)}});var No=u.Reflect,ko=No&&No.ownKeys||function(e){var t=Te.f(g(e)),n=he.f;return n?t.concat(n(e)):t};N(N.S,"Reflect",{ownKeys:ko});var Fo=Object.preventExtensions;N(N.S,"Reflect",{preventExtensions:function(e){g(e);try{return Fo&&Fo(e),!0}catch(e){return!1}}}),N(N.S,"Reflect",{set:function e(t,n,i){var r,a,o=arguments.length<4?t:arguments[3],s=Ce.f(g(t),n);if(!s){if(m(a=ct(t)))return e(a,n,i,o);s=x(0)}if(h(s,"value")){if(!1===s.writable||!m(o))return!1;if(r=Ce.f(o,n)){if(r.get||r.set||!1===r.writable)return!1;r.value=i,w.f(o,n,r)}else w.f(o,n,x(0,i));return!0}return void 0!==s.set&&(s.set.call(o,i),!0)}}),yt&&N(N.S,"Reflect",{setPrototypeOf:function(e,t){yt.check(e,t);try{return yt.set(e,t),!0}catch(e){return!1}}});var Bo=ie(!0);N(N.P,"Array",{includes:function(e){return Bo(this,e,arguments.length>1?arguments[1]:void 0)}}),er("includes");var Uo=F("isConcatSpreadable");var jo=function e(t,n,i,r,a,o,s,l){for(var u,c,h=a,d=0,f=!!s&&D(s,l,3);d<r;){if(d in i){if(u=f?f(i[d],d,n):i[d],c=!1,m(u)&&(c=void 0!==(c=u[Uo])?!!c:fe(u)),c&&o>0)h=e(t,n,u,$(u.length),h,o-1)-1;else{if(h>=9007199254740991)throw TypeError();t[h]=u}h++}d++}return h};N(N.P,"Array",{flatMap:function(e){var t,n,i=st(this);return L(e),t=$(i.length),n=Fi(i,0),jo(n,i,i,t,0,1,e,arguments[1]),n}}),er("flatMap"),N(N.P,"Array",{flatten:function(){var e=arguments[0],t=st(this),n=$(t.length),i=Fi(t,0);return jo(i,t,t,n,0,void 0===e?1:Z(e)),i}}),er("flatten");var Go=Wn(!0);N(N.P,"String",{at:function(e){return Go(this,e)}});var zo=function(e,t,n,i){var r=String(Y(e)),a=r.length,o=void 0===n?" ":String(n),s=$(t);if(s<=a||""==o)return r;var l=s-a,u=cn.call(o,Math.ceil(l/o.length));return u.length>l&&(u=u.slice(0,l)),i?u+r:r+u},Ho=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(xa);N(N.P+N.F*Ho,"String",{padStart:function(e){return zo(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var Vo=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(xa);N(N.P+N.F*Vo,"String",{padEnd:function(e){return zo(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),Ut("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart"),Ut("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd");var Wo=RegExp.prototype,qo=function(e,t){this._r=e,this._s=t};Xn(qo,"RegExp String",(function(){var e=this._r.exec(this._s);return{value:e,done:null===e}})),N(N.P,"String",{matchAll:function(e){if(Y(this),!ni(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in Wo?String(e.flags):cr.call(e),i=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return i.lastIndex=$(e.lastIndex),new qo(i,t)}}),H("asyncIterator"),H("observable"),N(N.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,i=X(e),r=Ce.f,a=ko(i),o={},s=0;a.length>s;)void 0!==(n=r(i,t=a[s++]))&&xi(o,t,n);return o}});var Yo=de.f,Xo=function(e){return function(t){for(var n,i=X(t),r=ce(i),a=r.length,o=0,s=[];a>o;)Yo.call(i,n=r[o++])&&s.push(e?[n,i[n]]:i[n]);return s}},Ko=Xo(!1);N(N.S,"Object",{values:function(e){return Ko(e)}});var Qo=Xo(!0);N(N.S,"Object",{entries:function(e){return Qo(e)}});var Zo=!d((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete u[e]}));f&&N(N.P+Zo,"Object",{__defineGetter__:function(e,t){w.f(st(this),e,{get:L(t),enumerable:!0,configurable:!0})}}),f&&N(N.P+Zo,"Object",{__defineSetter__:function(e,t){w.f(st(this),e,{set:L(t),enumerable:!0,configurable:!0})}});var Jo=Ce.f;f&&N(N.P+Zo,"Object",{__lookupGetter__:function(e){var t,n=st(this),i=E(e,!0);do{if(t=Jo(n,i))return t.get}while(n=ct(n))}});var $o=Ce.f;f&&N(N.P+Zo,"Object",{__lookupSetter__:function(e){var t,n=st(this),i=E(e,!0);do{if(t=$o(n,i))return t.set}while(n=ct(n))}});var es=function(e,t){var n=[];return $r(e,!1,n.push,n,t),n},ts=function(e){return function(){if(Et(this)!=e)throw TypeError(e+"#toJSON isn't generic");return es(this)}};N(N.P+N.R,"Map",{toJSON:ts("Map")}),N(N.P+N.R,"Set",{toJSON:ts("Set")});var ns=function(e){N(N.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};ns("Map"),ns("Set"),ns("WeakMap"),ns("WeakSet");var is=function(e){N(N.S,e,{from:function(e){var t,n,i,r,a=arguments[1];return L(this),(t=void 0!==a)&&L(a),null==e?new this:(n=[],t?(i=0,r=D(a,arguments[2],2),$r(e,!1,(function(e){n.push(r(e,i++))}))):$r(e,!1,n.push,n),new this(n))}})};is("Map"),is("Set"),is("WeakMap"),is("WeakSet"),N(N.G,{global:u}),N(N.S,"System",{global:u}),N(N.S,"Error",{isError:function(e){return"Error"===W(e)}}),N(N.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}}),N(N.S,"Math",{DEG_PER_RAD:Math.PI/180});var rs=180/Math.PI;N(N.S,"Math",{degrees:function(e){return e*rs}});var as=Math.scale||function(e,t,n,i,r){return 0===arguments.length||e!=e||t!=t||n!=n||i!=i||r!=r?NaN:e===1/0||e===-1/0?e:(e-t)*(r-i)/(n-t)+i};N(N.S,"Math",{fscale:function(e,t,n,i,r){return Bn(as(e,t,n,i,r))}}),N(N.S,"Math",{iaddh:function(e,t,n,i){var r=e>>>0,a=n>>>0;return(t>>>0)+(i>>>0)+((r&a|(r|a)&~(r+a>>>0))>>>31)|0}}),N(N.S,"Math",{isubh:function(e,t,n,i){var r=e>>>0,a=n>>>0;return(t>>>0)-(i>>>0)-((~r&a|~(r^a)&r-a>>>0)>>>31)|0}}),N(N.S,"Math",{imulh:function(e,t){var n=+e,i=+t,r=65535&n,a=65535&i,o=n>>16,s=i>>16,l=(o*a>>>0)+(r*a>>>16);return o*s+(l>>16)+((r*s>>>0)+(65535&l)>>16)}}),N(N.S,"Math",{RAD_PER_DEG:180/Math.PI});var os=Math.PI/180;N(N.S,"Math",{radians:function(e){return e*os}}),N(N.S,"Math",{scale:as}),N(N.S,"Math",{umulh:function(e,t){var n=+e,i=+t,r=65535&n,a=65535&i,o=n>>>16,s=i>>>16,l=(o*a>>>0)+(r*a>>>16);return o*s+(l>>>16)+((r*s>>>0)+(65535&l)>>>16)}}),N(N.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),N(N.P+N.R,"Promise",{finally:function(e){var t=Vr(this,p.Promise||u.Promise),n="function"==typeof e;return this.then(n?function(n){return Aa(t,e()).then((function(){return n}))}:e,n?function(n){return Aa(t,e()).then((function(){throw n}))}:e)}}),N(N.S,"Promise",{try:function(e){var t=Ea.f(this),n=Ta(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var ss=R("metadata"),ls=ss.store||(ss.store=new lo),us=function(e,t,n){var i=ls.get(e);if(!i){if(!n)return;ls.set(e,i=new Ja)}var r=i.get(t);if(!r){if(!n)return;i.set(t,r=new Ja)}return r},cs={store:ls,map:us,has:function(e,t,n){var i=us(t,n,!1);return void 0!==i&&i.has(e)},get:function(e,t,n){var i=us(t,n,!1);return void 0===i?void 0:i.get(e)},set:function(e,t,n,i){us(n,i,!0).set(e,t)},keys:function(e,t){var n=us(e,t,!1),i=[];return n&&n.forEach((function(e,t){i.push(t)})),i},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){N(N.S,"Reflect",e)}},hs=cs.key,ds=cs.set;cs.exp({defineMetadata:function(e,t,n,i){ds(e,t,g(n),hs(i))}});var fs=cs.key,ps=cs.map,ms=cs.store;cs.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:fs(arguments[2]),i=ps(g(t),n,!1);if(void 0===i||!i.delete(e))return!1;if(i.size)return!0;var r=ms.get(t);return r.delete(n),!!r.size||ms.delete(t)}});var gs=cs.has,vs=cs.get,ys=cs.key,_s=function(e,t,n){if(gs(e,t,n))return vs(e,t,n);var i=ct(t);return null!==i?_s(e,i,n):void 0};cs.exp({getMetadata:function(e,t){return _s(e,g(t),arguments.length<3?void 0:ys(arguments[2]))}});var bs=cs.keys,Es=cs.key,Ts=function(e,t){var n=bs(e,t),i=ct(e);if(null===i)return n;var r=Ts(i,t);return r.length?n.length?es(new $a(n.concat(r))):r:n};cs.exp({getMetadataKeys:function(e){return Ts(g(e),arguments.length<2?void 0:Es(arguments[1]))}});var ws=cs.get,xs=cs.key;cs.exp({getOwnMetadata:function(e,t){return ws(e,g(t),arguments.length<3?void 0:xs(arguments[2]))}});var As=cs.keys,Ss=cs.key;cs.exp({getOwnMetadataKeys:function(e){return As(g(e),arguments.length<2?void 0:Ss(arguments[1]))}});var Ms=cs.has,Cs=cs.key,Rs=function(e,t,n){if(Ms(e,t,n))return!0;var i=ct(t);return null!==i&&Rs(e,i,n)};cs.exp({hasMetadata:function(e,t){return Rs(e,g(t),arguments.length<3?void 0:Cs(arguments[2]))}});var Is=cs.has,Ps=cs.key;cs.exp({hasOwnMetadata:function(e,t){return Is(e,g(t),arguments.length<3?void 0:Ps(arguments[2]))}});var Ls=cs.key,Ds=cs.set;cs.exp({metadata:function(e,t){return function(n,i){Ds(e,t,(void 0!==i?g:L)(n),Ls(i))}}});var Os=ma(),Ns=u.process,ks="process"==W(Ns);N(N.G,{asap:function(e){var t=ks&&Ns.domain;Os(t?t.bind(e):e)}});var Fs=ma(),Bs=F("observable"),Us=$r.RETURN,js=function(e){return null==e?void 0:L(e)},Gs=function(e){var t=e._c;t&&(e._c=void 0,t())},zs=function(e){return void 0===e._o},Hs=function(e){zs(e)||(e._o=void 0,Gs(e))},Vs=function(e,t){g(e),this._c=void 0,this._o=e,e=new Ws(this);try{var n=t(e),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:L(n),this._c=n)}catch(t){return void e.error(t)}zs(this)&&Gs(this)};Vs.prototype=Sa({},{unsubscribe:function(){Hs(this)}});var Ws=function(e){this._s=e};Ws.prototype=Sa({},{next:function(e){var t=this._s;if(!zs(t)){var n=t._o;try{var i=js(n.next);if(i)return i.call(n,e)}catch(e){try{Hs(t)}finally{throw e}}}},error:function(e){var t=this._s;if(zs(t))throw e;var n=t._o;t._o=void 0;try{var i=js(n.error);if(!i)throw e;e=i.call(n,e)}catch(e){try{Gs(t)}finally{throw e}}return Gs(t),e},complete:function(e){var t=this._s;if(!zs(t)){var n=t._o;t._o=void 0;try{var i=js(n.complete);e=i?i.call(n,e):void 0}catch(e){try{Gs(t)}finally{throw e}}return Gs(t),e}}});var qs=function(e){Jr(this,qs,"Observable","_f")._f=L(e)};Sa(qs.prototype,{subscribe:function(e){return new Vs(e,this._f)},forEach:function(e){var t=this;return new(p.Promise||u.Promise)((function(n,i){L(e);var r=t.subscribe({next:function(t){try{return e(t)}catch(e){i(e),r.unsubscribe()}},error:i,complete:n})}))}}),Sa(qs,{from:function(e){var t="function"==typeof this?this:qs,n=js(g(e)[Bs]);if(n){var i=g(n.call(e));return i.constructor===t?i:new t((function(e){return i.subscribe(e)}))}return new t((function(t){var n=!1;return Fs((function(){if(!n){try{if($r(e,!1,(function(e){if(t.next(e),n)return Us}))===Us)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}})),function(){n=!0}}))},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:qs)((function(e){var t=!1;return Fs((function(){if(!t){for(var i=0;i<n.length;++i)if(e.next(n[i]),t)return;e.complete()}})),function(){t=!0}}))}}),A(qs.prototype,Bs,(function(){return this})),N(N.G,{Observable:qs}),sr("Observable");var Ys=[].slice,Xs=/MSIE .\./.test(xa),Ks=function(e){return function(t,n){var i=arguments.length>2,r=!!i&&Ys.call(arguments,2);return e(i?function(){("function"==typeof t?t:Function(t)).apply(this,r)}:t,n)}};N(N.G+N.B+N.F*Xs,{setTimeout:Ks(u.setTimeout),setInterval:Ks(u.setInterval)}),N(N.G+N.B,{setImmediate:ua.set,clearImmediate:ua.clear});for(var Qs=F("iterator"),Zs=F("toStringTag"),Js=qn.Array,$s={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},el=ce($s),tl=0;tl<el.length;tl++){var nl,il=el[tl],rl=$s[il],al=u[il],ol=al&&al.prototype;if(ol&&(ol[Qs]||A(ol,Qs,Js),ol[Zs]||A(ol,Zs,il),qn[il]=Js,rl))for(nl in ur)ol[nl]||P(ol,nl,ur[nl],!0)}l((function(e){!function(t){var n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag",l=t.regeneratorRuntime;if(l)e.exports=l;else{(l=t.regeneratorRuntime=e.exports).wrap=p;var u={},c={};c[a]=function(){return this};var h=Object.getPrototypeOf,d=h&&h(h(A([])));d&&d!==n&&i.call(d,a)&&(c=d);var f=y.prototype=g.prototype=Object.create(c);v.prototype=f.constructor=y,y.constructor=v,y[s]=v.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(f),e},l.awrap=function(e){return{__await:e}},_(b.prototype),b.prototype[o]=function(){return this},l.AsyncIterator=b,l.async=function(e,t,n,i){var r=new b(p(e,t,n,i));return l.isGeneratorFunction(t)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},_(f),f[s]="Generator",f[a]=function(){return this},f.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},l.values=A,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;w(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function p(e,t,n,i){var r=t&&t.prototype instanceof g?t:g,a=Object.create(r.prototype),o=new x(i||[]);return a._invoke=function(e,t,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return S()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=m(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function g(){}function v(){}function y(){}function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e){function n(t,r,a,o){var s=m(e[t],e,r);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)})):Promise.resolve(u).then((function(e){l.value=e,a(l)}),o)}o(s.arg)}var r;"object"==typeof t.process&&t.process.domain&&(n=t.process.domain.bind(n)),this._invoke=function(e,t){function i(){return new Promise((function(i,r){n(e,t,i,r)}))}return r=r?r.then(i,i):i()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=m(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}}("object"==typeof s?s:"object"==typeof window?window:"object"==typeof self?self:s)}));var sl,ll,ul,cl=(sl=/[\\^$*+?.()|[\]{}]/g,ul=(ll="\\$&")===Object(ll)?function(e){return ll[e]}:ll,function(e){return String(e).replace(sl,ul)});N(N.S,"RegExp",{escape:function(e){return cl(e)}});p.RegExp.escape;if(s._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");s._babelPolyfill=!0;function hl(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}hl(String.prototype,"padLeft","".padStart),hl(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(e){[][e]&&hl(Array,e,Function.call.bind([][e]))}));
/**
 * @license
 * webxr-polyfill
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
const dl=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},fl=Symbol("@@webxr-polyfill/EventTarget");class pl{constructor(){this[fl]={listeners:new Map}}addEventListener(e,t){if("string"!=typeof e)throw new Error("`type` must be a string");if("function"!=typeof t)throw new Error("`listener` must be a function");const n=this[fl].listeners.get(e)||[];n.push(t),this[fl].listeners.set(e,n)}removeEventListener(e,t){if("string"!=typeof e)throw new Error("`type` must be a string");if("function"!=typeof t)throw new Error("`listener` must be a function");const n=this[fl].listeners.get(e)||[];for(let e=n.length;e>=0;e--)n[e]===t&&n.pop()}dispatchEvent(e,t){const n=this[fl].listeners.get(e)||[],i=[];for(let e=0;e<n.length;e++)i[e]=n[e];for(let e of i)e(t);"function"==typeof this["on"+e]&&this["on"+e](t)}}let ml="undefined"!=typeof Float32Array?Float32Array:Array;function gl(){let e=new ml(16);return ml!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function vl(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yl(e,t){let n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=n*s-i*o,_=n*l-r*o,b=n*u-a*o,E=i*l-r*s,T=i*u-a*s,w=r*u-a*l,x=c*m-h*p,A=c*g-d*p,S=c*v-f*p,M=h*g-d*m,C=h*v-f*m,R=d*v-f*g,I=y*R-_*C+b*M+E*S-T*A+w*x;return I?(I=1/I,e[0]=(s*R-l*C+u*M)*I,e[1]=(r*C-i*R-a*M)*I,e[2]=(m*w-g*T+v*E)*I,e[3]=(d*T-h*w-f*E)*I,e[4]=(l*S-o*R-u*A)*I,e[5]=(n*R-r*S+a*A)*I,e[6]=(g*b-p*w-v*_)*I,e[7]=(c*w-d*b+f*_)*I,e[8]=(o*C-s*S+u*x)*I,e[9]=(i*S-n*C-a*x)*I,e[10]=(p*T-m*b+v*y)*I,e[11]=(h*b-c*T-f*y)*I,e[12]=(s*A-o*M-l*x)*I,e[13]=(n*M-i*A+r*x)*I,e[14]=(m*_-p*E-g*y)*I,e[15]=(c*E-h*_+d*y)*I,e):null}function _l(e,t,n){let i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],v=t[14],y=t[15],_=n[0],b=n[1],E=n[2],T=n[3];return e[0]=_*i+b*s+E*h+T*m,e[1]=_*r+b*l+E*d+T*g,e[2]=_*a+b*u+E*f+T*v,e[3]=_*o+b*c+E*p+T*y,_=n[4],b=n[5],E=n[6],T=n[7],e[4]=_*i+b*s+E*h+T*m,e[5]=_*r+b*l+E*d+T*g,e[6]=_*a+b*u+E*f+T*v,e[7]=_*o+b*c+E*p+T*y,_=n[8],b=n[9],E=n[10],T=n[11],e[8]=_*i+b*s+E*h+T*m,e[9]=_*r+b*l+E*d+T*g,e[10]=_*a+b*u+E*f+T*v,e[11]=_*o+b*c+E*p+T*y,_=n[12],b=n[13],E=n[14],T=n[15],e[12]=_*i+b*s+E*h+T*m,e[13]=_*r+b*l+E*d+T*g,e[14]=_*a+b*u+E*f+T*v,e[15]=_*o+b*c+E*p+T*y,e}function bl(e,t,n){let i=t[0],r=t[1],a=t[2],o=t[3],s=i+i,l=r+r,u=a+a,c=i*s,h=i*l,d=i*u,f=r*l,p=r*u,m=a*u,g=o*s,v=o*l,y=o*u;return e[0]=1-(f+m),e[1]=h+y,e[2]=d-v,e[3]=0,e[4]=h-y,e[5]=1-(c+m),e[6]=p+g,e[7]=0,e[8]=d+v,e[9]=p-g,e[10]=1-(c+f),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function El(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Tl(e,t){let n=t[0]+t[5]+t[10],i=0;return n>0?(i=2*Math.sqrt(n+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e}function wl(e,t,n,i,r){let a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(a=1/(i-r),e[10]=(r+i)*a,e[14]=2*r*i*a):(e[10]=-1,e[14]=-2*i),e}function xl(){let e=new ml(3);return ml!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Al(e){var t=new ml(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Sl(e,t,n){let i=new ml(3);return i[0]=e,i[1]=t,i[2]=n,i}function Ml(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Cl(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Rl(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Il(e,t){let n=t[0],i=t[1],r=t[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function Pl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ll(e,t,n){let i=t[0],r=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=r*l-a*s,e[1]=a*o-i*l,e[2]=i*s-r*o,e}function Dl(e,t,n){let i=n[0],r=n[1],a=n[2],o=n[3],s=t[0],l=t[1],u=t[2],c=r*u-a*l,h=a*s-i*u,d=i*l-r*s,f=r*d-a*h,p=a*c-i*d,m=i*h-r*c,g=2*o;return c*=g,h*=g,d*=g,f*=2,p*=2,m*=2,e[0]=s+c+f,e[1]=l+h+p,e[2]=u+d+m,e}const Ol=function(e){let t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)};!function(){let e=xl()}();!function(){let e=function(){let e=new ml(4);return ml!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function Nl(){let e=new ml(4);return ml!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function kl(e,t,n){let i=t[0],r=t[1],a=t[2],o=t[3],s=n[0],l=n[1],u=n[2],c=n[3];return e[0]=i*c+o*s+r*u-a*l,e[1]=r*c+o*l+a*s-i*u,e[2]=a*c+o*u+i*l-r*s,e[3]=o*c-i*s-r*l-a*u,e}function Fl(e,t,n,i){let r,a,o,s,l,u=t[0],c=t[1],h=t[2],d=t[3],f=n[0],p=n[1],m=n[2],g=n[3];return a=u*f+c*p+h*m+d*g,a<0&&(a=-a,f=-f,p=-p,m=-m,g=-g),1-a>1e-6?(r=Math.acos(a),o=Math.sin(r),s=Math.sin((1-i)*r)/o,l=Math.sin(i*r)/o):(s=1-i,l=i),e[0]=s*u+l*f,e[1]=s*c+l*p,e[2]=s*h+l*m,e[3]=s*d+l*g,e}function Bl(e,t){let n=t[0],i=t[1],r=t[2],a=t[3],o=n*n+i*i+r*r+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-i*s,e[2]=-r*s,e[3]=a*s,e}const Ul=function(e){let t=new ml(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},jl=function(e,t,n,i){let r=new ml(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},Gl=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},zl=function(e,t){let n=t[0],i=t[1],r=t[2],a=t[3],o=n*n+i*i+r*r+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=n*o,e[1]=i*o,e[2]=r*o,e[3]=a*o),e},Hl=(function(){let e=xl(),t=Sl(1,0,0),n=Sl(0,1,0)}(),function(){let e=Nl(),t=Nl()}(),function(){let e=function(){let e=new ml(9);return ml!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}(),Symbol("@@webxr-polyfill/XRRigidTransform"));class Vl{constructor(){if(this[Hl]={matrix:null,position:null,orientation:null,inverse:null},0===arguments.length)this[Hl].matrix=vl(new Float32Array(16));else if(1===arguments.length)arguments[0]instanceof Float32Array?this[Hl].matrix=arguments[0]:(this[Hl].position=this._getPoint(arguments[0]),this[Hl].orientation=DOMPointReadOnly.fromPoint({x:0,y:0,z:0,w:1}));else{if(2!==arguments.length)throw new Error("Too many arguments!");this[Hl].position=this._getPoint(arguments[0]),this[Hl].orientation=this._getPoint(arguments[1])}if(this[Hl].matrix){let e=xl();El(e,this[Hl].matrix),this[Hl].position=DOMPointReadOnly.fromPoint({x:e[0],y:e[1],z:e[2]});let t=Nl();Tl(t,this[Hl].matrix),this[Hl].orientation=DOMPointReadOnly.fromPoint({x:t[0],y:t[1],z:t[2],w:t[3]})}else this[Hl].matrix=vl(new Float32Array(16)),bl(this[Hl].matrix,jl(this[Hl].orientation.x,this[Hl].orientation.y,this[Hl].orientation.z,this[Hl].orientation.w),Sl(this[Hl].position.x,this[Hl].position.y,this[Hl].position.z))}_getPoint(e){return e instanceof DOMPointReadOnly?e:DOMPointReadOnly.fromPoint(e)}get matrix(){return this[Hl].matrix}get position(){return this[Hl].position}get orientation(){return this[Hl].orientation}get inverse(){if(null===this[Hl].inverse){let e=vl(new Float32Array(16));yl(e,this[Hl].matrix),this[Hl].inverse=new Vl(e),this[Hl].inverse[Hl].inverse=this}return this[Hl].inverse}}const Wl=Symbol("@@webxr-polyfill/XRSpace");class ql{constructor(e=null,t=null){this[Wl]={specialType:e,inputSource:t,baseMatrix:null,inverseBaseMatrix:null,lastFrameId:-1}}get _specialType(){return this[Wl].specialType}get _inputSource(){return this[Wl].inputSource}_ensurePoseUpdated(e,t){t!=this[Wl].lastFrameId&&(this[Wl].lastFrameId=t,this._onPoseUpdate(e))}_onPoseUpdate(e){"viewer"==this[Wl].specialType&&(this._baseMatrix=e.getBasePoseMatrix())}set _baseMatrix(e){this[Wl].baseMatrix=e,this[Wl].inverseBaseMatrix=null}get _baseMatrix(){return this[Wl].baseMatrix||this[Wl].inverseBaseMatrix&&(this[Wl].baseMatrix=new Float32Array(16),yl(this[Wl].baseMatrix,this[Wl].inverseBaseMatrix)),this[Wl].baseMatrix}set _inverseBaseMatrix(e){this[Wl].inverseBaseMatrix=e,this[Wl].baseMatrix=null}get _inverseBaseMatrix(){return this[Wl].inverseBaseMatrix||this[Wl].baseMatrix&&(this[Wl].inverseBaseMatrix=new Float32Array(16),yl(this[Wl].inverseBaseMatrix,this[Wl].baseMatrix)),this[Wl].inverseBaseMatrix}_getSpaceRelativeTransform(e){if(!this._inverseBaseMatrix||!e._baseMatrix)return null;let t=new Float32Array(16);return _l(t,this._inverseBaseMatrix,e._baseMatrix),new Vl(t)}}const Yl=Symbol("@@webxr-polyfill/XRReferenceSpace"),Xl=["viewer","local","local-floor","bounded-floor","unbounded"];class Kl extends ql{constructor(e,t=null){if(!Xl.includes(e))throw new Error("XRReferenceSpaceType must be one of "+Xl);if(super(e),"bounded-floor"===e&&!t)throw new Error("XRReferenceSpace cannot use 'bounded-floor' type if the platform does not provide the floor level");(function(e){return"bounded-floor"===e||"local-floor"===e})(e)&&!t&&((t=vl(new Float32Array(16)))[13]=1.6),this._inverseBaseMatrix=t||vl(new Float32Array(16)),this[Yl]={type:e,transform:t,originOffset:vl(new Float32Array(16))}}_transformBasePoseMatrix(e,t){_l(e,this._inverseBaseMatrix,t)}_originOffsetMatrix(){return this[Yl].originOffset}_adjustForOriginOffset(e){let t=new Float32Array(16);yl(t,this[Yl].originOffset),_l(e,t,e)}_getSpaceRelativeTransform(e){let t=super._getSpaceRelativeTransform(e);return this._adjustForOriginOffset(t.matrix),new XRRigidTransform(t.matrix)}getOffsetReferenceSpace(e){let t=new Kl(this[Yl].type,this[Yl].transform,this[Yl].bounds);return _l(t[Yl].originOffset,this[Yl].originOffset,e.matrix),t}}const Ql=Symbol("@@webxr-polyfill/XR"),Zl=["inline","immersive-vr","immersive-ar"],Jl={inline:{requiredFeatures:["viewer"],optionalFeatures:[]},"immersive-vr":{requiredFeatures:["viewer","local"],optionalFeatures:[]},"immersive-ar":{requiredFeatures:["viewer","local"],optionalFeatures:[]}};let $l;if("performance"in dl==!1){let e=Date.now();$l=()=>Date.now()-e}else $l=()=>performance.now();var eu=$l;const tu=Symbol("@@webxr-polyfill/XRPose");class nu{constructor(e,t){this[tu]={transform:e,emulatedPosition:t}}get transform(){return this[tu].transform}get emulatedPosition(){return this[tu].emulatedPosition}}const iu=Symbol("@@webxr-polyfill/XRViewerPose");class ru extends nu{constructor(e,t,n=!1){super(e,n),this[iu]={views:t}}get views(){return this[iu].views}}const au=Symbol("@@webxr-polyfill/XRViewport");class ou{constructor(e){this[au]={target:e}}get x(){return this[au].target.x}get y(){return this[au].target.y}get width(){return this[au].target.width}get height(){return this[au].target.height}}const su=["left","right","none"],lu=Symbol("@@webxr-polyfill/XRView");class uu{constructor(e,t,n,i){if(!su.includes(n))throw new Error("XREye must be one of: "+su);const r=Object.create(null),a=new ou(r);this[lu]={device:e,eye:n,viewport:a,temp:r,sessionId:i,transform:t}}get eye(){return this[lu].eye}get projectionMatrix(){return this[lu].device.getProjectionMatrix(this.eye)}get transform(){return this[lu].transform}_getViewport(e){if(this[lu].device.getViewport(this[lu].sessionId,this.eye,e,this[lu].temp))return this[lu].viewport}}const cu=Symbol("@@webxr-polyfill/XRFrame"),hu="XRFrame access outside the callback that produced it is invalid.";let du=0;class fu{constructor(e,t,n){this[cu]={id:++du,active:!1,animationFrame:!1,device:e,session:t,sessionId:n}}get session(){return this[cu].session}getViewerPose(e){if(!this[cu].animationFrame)throw new DOMException("getViewerPose can only be called on XRFrame objects passed to XRSession.requestAnimationFrame callbacks.","InvalidStateError");if(!this[cu].active)throw new DOMException(hu,"InvalidStateError");const t=this[cu].device,n=this[cu].session;n[Mu].viewerSpace._ensurePoseUpdated(t,this[cu].id),e._ensurePoseUpdated(t,this[cu].id);let i=e._getSpaceRelativeTransform(n[Mu].viewerSpace);const r=[];for(let i of n[Mu].viewSpaces){i._ensurePoseUpdated(t,this[cu].id);let n=e._getSpaceRelativeTransform(i),a=new uu(t,n,i.eye,this[cu].sessionId);r.push(a)}return new ru(i,r,!1)}getPose(e,t){if(!this[cu].active)throw new DOMException(hu,"InvalidStateError");const n=this[cu].device;if("target-ray"===e._specialType||"grip"===e._specialType)return n.getInputPose(e._inputSource,t,e._specialType);{e._ensurePoseUpdated(n,this[cu].id),t._ensurePoseUpdated(n,this[cu].id);let i=t._getSpaceRelativeTransform(e);return i?new XRPose(i,!1):null}}}const pu=Symbol("@@webxr-polyfill/XRRenderState"),mu=Object.freeze({depthNear:.1,depthFar:1e3,inlineVerticalFieldOfView:null,baseLayer:null});class gu{constructor(e={}){const t=Object.assign({},mu,e);this[pu]={config:t}}get depthNear(){return this[pu].config.depthNear}get depthFar(){return this[pu].config.depthFar}get inlineVerticalFieldOfView(){return this[pu].config.inlineVerticalFieldOfView}get baseLayer(){return this[pu].config.baseLayer}}const vu=Symbol("@@webxr-polyfill/polyfilled-xr-compatible"),yu=Symbol("@@webxr-polyfill/xr-compatible"),_u=Symbol("@@webxr-polyfill/XRWebGLLayer"),bu=Object.freeze({antialias:!0,depth:!1,stencil:!1,alpha:!0,multiview:!1,ignoreDepthValues:!1,framebufferScaleFactor:1});const Eu=Symbol("@@webxr-polyfill/XRInputSourceEvent");class Tu extends Event{constructor(e,t){super(e,t),this[Eu]={frame:t.frame,inputSource:t.inputSource},Object.setPrototypeOf(this,Tu.prototype)}get frame(){return this[Eu].frame}get inputSource(){return this[Eu].inputSource}}const wu=Symbol("@@webxr-polyfill/XRSessionEvent");class xu extends Event{constructor(e,t){super(e,t),this[wu]={session:t.session},Object.setPrototypeOf(this,xu.prototype)}get session(){return this[wu].session}}const Au=Symbol("@@webxr-polyfill/XRInputSourcesChangeEvent");class Su extends Event{constructor(e,t){super(e,t),this[Au]={session:t.session,added:t.added,removed:t.removed},Object.setPrototypeOf(this,Su.prototype)}get session(){return this[Au].session}get added(){return this[Au].added}get removed(){return this[Au].removed}}const Mu=Symbol("@@webxr-polyfill/XRSession");class Cu extends ql{constructor(e){super(e)}get eye(){return this._specialType}_onPoseUpdate(e){this._inverseBaseMatrix=e.getBaseViewMatrix(this._specialType)}}class Ru extends pl{constructor(e,t,n){super();let i="inline"!=t,r=new gu({inlineVerticalFieldOfView:i?null:.5*Math.PI});this[Mu]={device:e,mode:t,immersive:i,ended:!1,suspended:!1,frameCallbacks:[],currentFrameCallbacks:null,frameHandle:0,deviceFrameHandle:null,id:n,activeRenderState:r,pendingRenderState:null,viewerSpace:new Kl("viewer"),viewSpaces:[],currentInputSources:[]},i?this[Mu].viewSpaces.push(new Cu("left"),new Cu("right")):this[Mu].viewSpaces.push(new Cu("none")),this[Mu].onDeviceFrame=()=>{if(this[Mu].ended||this[Mu].suspended)return;if(this[Mu].deviceFrameHandle=null,this[Mu].startDeviceFrameLoop(),null!==this[Mu].pendingRenderState&&(this[Mu].activeRenderState=new gu(this[Mu].pendingRenderState),this[Mu].pendingRenderState=null,this[Mu].activeRenderState.baseLayer&&this[Mu].device.onBaseLayerSet(this[Mu].id,this[Mu].activeRenderState.baseLayer)),null===this[Mu].activeRenderState.baseLayer)return;const t=new fu(e,this,this[Mu].id),n=this[Mu].currentFrameCallbacks=this[Mu].frameCallbacks;this[Mu].frameCallbacks=[],t[cu].active=!0,t[cu].animationFrame=!0,this[Mu].device.onFrameStart(this[Mu].id,this[Mu].activeRenderState),this._checkInputSourcesChange();const i=eu();for(let e=0;e<n.length;e++)try{n[e].cancelled||"function"!=typeof n[e].callback||n[e].callback(i,t)}catch(e){console.error(e)}this[Mu].currentFrameCallbacks=null,t[cu].active=!1,this[Mu].device.onFrameEnd(this[Mu].id)},this[Mu].startDeviceFrameLoop=()=>{null===this[Mu].deviceFrameHandle&&(this[Mu].deviceFrameHandle=this[Mu].device.requestAnimationFrame(this[Mu].onDeviceFrame))},this[Mu].stopDeviceFrameLoop=()=>{const e=this[Mu].deviceFrameHandle;null!==e&&(this[Mu].device.cancelAnimationFrame(e),this[Mu].deviceFrameHandle=null)},this[Mu].onPresentationEnd=t=>{if(t!==this[Mu].id)return this[Mu].suspended=!1,this[Mu].startDeviceFrameLoop(),void this.dispatchEvent("focus",{session:this});this[Mu].ended=!0,this[Mu].stopDeviceFrameLoop(),e.removeEventListener("@webvr-polyfill/vr-present-end",this[Mu].onPresentationEnd),e.removeEventListener("@webvr-polyfill/vr-present-start",this[Mu].onPresentationStart),e.removeEventListener("@@webvr-polyfill/input-select-start",this[Mu].onSelectStart),e.removeEventListener("@@webvr-polyfill/input-select-end",this[Mu].onSelectEnd),this.dispatchEvent("end",new xu("end",{session:this}))},e.addEventListener("@@webxr-polyfill/vr-present-end",this[Mu].onPresentationEnd),this[Mu].onPresentationStart=e=>{e!==this[Mu].id&&(this[Mu].suspended=!0,this[Mu].stopDeviceFrameLoop(),this.dispatchEvent("blur",{session:this}))},e.addEventListener("@@webxr-polyfill/vr-present-start",this[Mu].onPresentationStart),this[Mu].onSelectStart=e=>{e.sessionId===this[Mu].id&&this[Mu].dispatchInputSourceEvent("selectstart",e.inputSource)},e.addEventListener("@@webxr-polyfill/input-select-start",this[Mu].onSelectStart),this[Mu].onSelectEnd=e=>{e.sessionId===this[Mu].id&&(this[Mu].dispatchInputSourceEvent("selectend",e.inputSource),this[Mu].dispatchInputSourceEvent("select",e.inputSource))},e.addEventListener("@@webxr-polyfill/input-select-end",this[Mu].onSelectEnd),this[Mu].onSqueezeStart=e=>{e.sessionId===this[Mu].id&&this[Mu].dispatchInputSourceEvent("squeezestart",e.inputSource)},e.addEventListener("@@webxr-polyfill/input-squeeze-start",this[Mu].onSqueezeStart),this[Mu].onSqueezeEnd=e=>{e.sessionId===this[Mu].id&&(this[Mu].dispatchInputSourceEvent("squeezeend",e.inputSource),this[Mu].dispatchInputSourceEvent("squeeze",e.inputSource))},e.addEventListener("@@webxr-polyfill/input-squeeze-end",this[Mu].onSqueezeEnd),this[Mu].dispatchInputSourceEvent=(t,n)=>{const i=new fu(e,this,this[Mu].id),r=new Tu(t,{frame:i,inputSource:n});i[cu].active=!0,this.dispatchEvent(t,r),i[cu].active=!1},this[Mu].startDeviceFrameLoop(),this.onblur=void 0,this.onfocus=void 0,this.onresetpose=void 0,this.onend=void 0,this.onselect=void 0,this.onselectstart=void 0,this.onselectend=void 0}get renderState(){return this[Mu].activeRenderState}get environmentBlendMode(){return this[Mu].device.environmentBlendMode||"opaque"}async requestReferenceSpace(e){if(this[Mu].ended)return;if(!Xl.includes(e))throw new TypeError("XRReferenceSpaceType must be one of "+Xl);if(!this[Mu].device.doesSessionSupportReferenceSpace(this[Mu].id,e))throw new DOMException(`The ${e} reference space is not supported by this session.`,"NotSupportedError");if("viewer"===e)return this[Mu].viewerSpace;let t=await this[Mu].device.requestFrameOfReferenceTransform(e);if("bounded-floor"===e){if(!t)throw new DOMException(e+" XRReferenceSpace not supported by this device.","NotSupportedError");if(!this[Mu].device.requestStageBounds())throw new DOMException(e+" XRReferenceSpace not supported by this device.","NotSupportedError");throw new DOMException(`The WebXR polyfill does not support the ${e} reference space yet.`,"NotSupportedError")}return new Kl(e,t)}requestAnimationFrame(e){if(this[Mu].ended)return;const t=++this[Mu].frameHandle;return this[Mu].frameCallbacks.push({handle:t,callback:e,cancelled:!1}),t}cancelAnimationFrame(e){let t=this[Mu].frameCallbacks,n=t.findIndex(t=>t&&t.handle===e);n>-1&&(t[n].cancelled=!0,t.splice(n,1)),t=this[Mu].currentFrameCallbacks,t&&(n=t.findIndex(t=>t&&t.handle===e),n>-1&&(t[n].cancelled=!0))}get inputSources(){return this[Mu].device.getInputSources()}async end(){if(!this[Mu].ended)return this[Mu].immersive&&(this[Mu].ended=!0,this[Mu].device.removeEventListener("@@webvr-polyfill/vr-present-start",this[Mu].onPresentationStart),this[Mu].device.removeEventListener("@@webvr-polyfill/vr-present-end",this[Mu].onPresentationEnd),this[Mu].device.removeEventListener("@@webvr-polyfill/input-select-start",this[Mu].onSelectStart),this[Mu].device.removeEventListener("@@webvr-polyfill/input-select-end",this[Mu].onSelectEnd),this.dispatchEvent("end",new xu("end",{session:this}))),this[Mu].stopDeviceFrameLoop(),this[Mu].device.endSession(this[Mu].id)}updateRenderState(e){if(this[Mu].ended){throw new Error("Can't call updateRenderState on an XRSession that has already ended.")}if(e.baseLayer&&e.baseLayer._session!==this){throw new Error("Called updateRenderState with a base layer that was created by a different session.")}if(null!==e.inlineVerticalFieldOfView&&void 0!==e.inlineVerticalFieldOfView){if(this[Mu].immersive){throw new Error("inlineVerticalFieldOfView must not be set for an XRRenderState passed to updateRenderState for an immersive session.")}e.inlineVerticalFieldOfView=Math.min(3.13,Math.max(.01,e.inlineVerticalFieldOfView))}if(null===this[Mu].pendingRenderState){const e=this[Mu].activeRenderState;this[Mu].pendingRenderState={depthNear:e.depthNear,depthFar:e.depthFar,inlineVerticalFieldOfView:e.inlineVerticalFieldOfView,baseLayer:e.baseLayer}}Object.assign(this[Mu].pendingRenderState,e)}_checkInputSourcesChange(){const e=[],t=[],n=this.inputSources,i=this[Mu].currentInputSources;for(const t of n)i.includes(t)||e.push(t);for(const e of i)n.includes(e)||t.push(e);(e.length>0||t.length>0)&&this.dispatchEvent("inputsourceschange",new Su("inputsourceschange",{session:this,added:e,removed:t})),this[Mu].currentInputSources.length=0;for(const e of n)this[Mu].currentInputSources.push(e)}}const Iu=Symbol("@@webxr-polyfill/XRInputSource");class Pu{constructor(e){this[Iu]={impl:e,gripSpace:new ql("grip",this),targetRaySpace:new ql("target-ray",this)}}get handedness(){return this[Iu].impl.handedness}get targetRayMode(){return this[Iu].impl.targetRayMode}get gripSpace(){let e=this[Iu].impl.targetRayMode;return"gaze"===e||"screen"===e?null:this[Iu].gripSpace}get targetRaySpace(){return this[Iu].targetRaySpace}get profiles(){return this[Iu].impl.profiles}get gamepad(){return this[Iu].impl.gamepad}}const Lu=Symbol("@@webxr-polyfill/XRReferenceSpaceEvent");class Du extends Event{constructor(e,t){super(e,t),this[Lu]={referenceSpace:t.referenceSpace,transform:t.transform||null},Object.setPrototypeOf(this,Du.prototype)}get referenceSpace(){return this[Lu].referenceSpace}get transform(){return this[Lu].transform}}var Ou={XR:class extends pl{constructor(e){super(),this[Ql]={device:null,devicePromise:e,immersiveSession:null,inlineSessions:new Set},e.then(e=>{this[Ql].device=e})}async isSessionSupported(e){return this[Ql].device||await this[Ql].devicePromise,"inline"!=e?Promise.resolve(this[Ql].device.isSessionSupported(e)):Promise.resolve(!0)}async requestSession(e,t){if(!this[Ql].device){if("inline"!=e)throw new Error("Polyfill Error: Must call navigator.xr.isSessionSupported() with any XRSessionMode\nor navigator.xr.requestSession('inline') prior to requesting an immersive\nsession. This is a limitation specific to the WebXR Polyfill and does not apply\nto native implementations of the API.");await this[Ql].devicePromise}if(!Zl.includes(e))throw new TypeError(`The provided value '${e}' is not a valid enum value of type XRSessionMode`);const n=Jl[e],i=n.requiredFeatures.concat(t&&t.requiredFeatures?t.requiredFeatures:[]),r=n.optionalFeatures.concat(t&&t.optionalFeatures?t.optionalFeatures:[]),a=new Set;let o=!1;for(let e of i)this[Ql].device.isFeatureSupported(e)?a.add(e):(console.error(`The required feature '${e}' is not supported`),o=!0);if(o)throw new DOMException("Session does not support some required features","NotSupportedError");for(let e of r)this[Ql].device.isFeatureSupported(e)?a.add(e):console.log(`The optional feature '${e}' is not supported`);const s=await this[Ql].device.requestSession(e,a),l=new XRSession(this[Ql].device,e,s);"inline"==e?this[Ql].inlineSessions.add(l):this[Ql].immersiveSession=l;const u=()=>{"inline"==e?this[Ql].inlineSessions.delete(l):this[Ql].immersiveSession=null,l.removeEventListener("end",u)};return l.addEventListener("end",u),l}},XRSession:Ru,XRSessionEvent:xu,XRFrame:fu,XRView:uu,XRViewport:ou,XRViewerPose:ru,XRWebGLLayer:class{constructor(e,t,n={}){const i=Object.assign({},bu,n);if(!(e instanceof Ru))throw new Error("session must be a XRSession");if(e.ended)throw new Error("InvalidStateError");if(t[vu]&&!0!==t[yu])throw new Error("InvalidStateError");const r=t.getParameter(t.FRAMEBUFFER_BINDING);this[_u]={context:t,config:i,framebuffer:r,session:e}}get context(){return this[_u].context}get antialias(){return this[_u].config.antialias}get ignoreDepthValues(){return!0}get framebuffer(){return this[_u].framebuffer}get framebufferWidth(){return this[_u].context.drawingBufferWidth}get framebufferHeight(){return this[_u].context.drawingBufferHeight}get _session(){return this[_u].session}getViewport(e){return e._getViewport(this)}static getNativeFramebufferScaleFactor(e){if(!e)throw new TypeError("getNativeFramebufferScaleFactor must be passed a session.");return e[Mu].ended?0:1}},XRSpace:ql,XRReferenceSpace:Kl,XRReferenceSpaceEvent:Du,XRInputSource:Pu,XRInputSourceEvent:Tu,XRInputSourcesChangeEvent:Su,XRRenderState:gu,XRRigidTransform:Vl,XRPose:nu};const Nu=e=>"function"!=typeof e.prototype.makeXRCompatible&&(e.prototype.makeXRCompatible=function(){return this[yu]=!0,Promise.resolve()},!0),ku=e=>{const t=e.prototype.getContext;e.prototype.getContext=function(e,n){const i=t.call(this,e,n);return i&&(i[vu]=!0,n&&"xrCompatible"in n&&(i[yu]=n.xrCompatible)),i}};var Fu="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};var Bu,Uu=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){e.exports=function(){var e,t,n,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(e,t,n){return e+(t-e)*n},o=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),s=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}(),l=(/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}()),u=(t=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),n=t?parseInt(t[1],10):null,function(){return n}),c=function(){var e=!1;if(65===u()){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var n=t[1].split("."),i=r(n,4),a=(i[0],i[1],i[2]),o=i[3];e=3325===parseInt(a,10)&&parseInt(o,10)<148}}return function(){return e}}(),h=function(){var e=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return e}}(),d=function(){var e=90==window.orientation||-90==window.orientation;return h()?!e:e},f=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},p=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},m=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},g=function(e,t,n,i){var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t),e.compileShader(r);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a);var o=e.createProgram();for(var s in e.attachShader(o,r),e.attachShader(o,a),i)e.bindAttribLocation(o,i[s],s);return e.linkProgram(o),e.deleteShader(r),e.deleteShader(a),o},v=function(e,t){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r="",a=0;a<i;a++)n[r=e.getActiveUniform(t,a).name.replace("[0]","")]=e.getUniformLocation(t,r);return n},y=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},_=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},b=function(e){if(o()){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(n)+"px",setTimeout((function(){e.style.width=t,e.style.height=n}),100)}window.canvas=e},E=function(){var e=Math.PI/180,t=.25*Math.PI,n=new Float32Array([0,0,0,1]),i=new Float32Array([0,0,0]);function r(r,a,o,s,l,u){!function(n,i,r,a){var o=Math.tan(i?i.upDegrees*e:t),s=Math.tan(i?i.downDegrees*e:t),l=Math.tan(i?i.leftDegrees*e:t),u=Math.tan(i?i.rightDegrees*e:t),c=2/(l+u),h=2/(o+s);n[0]=c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=-(l-u)*c*.5,n[9]=(o-s)*h*.5,n[10]=a/(r-a),n[11]=-1,n[12]=0,n[13]=0,n[14]=a*r/(r-a),n[15]=0}(r,s||null,u.depthNear,u.depthFar);var c,h,d,f,p,m,g,v,y,_,b,E,T,w,x,A,S,M,C,R=o.orientation||n,I=o.position||i;c=a,d=I,f=(h=R)[0],p=h[1],m=h[2],g=h[3],b=f*(v=f+f),E=f*(y=p+p),T=f*(_=m+m),w=p*y,x=p*_,A=m*_,S=g*v,M=g*y,C=g*_,c[0]=1-(w+A),c[1]=E+C,c[2]=T-M,c[3]=0,c[4]=E-C,c[5]=1-(b+A),c[6]=x+S,c[7]=0,c[8]=T+M,c[9]=x-S,c[10]=1-(b+w),c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,l&&function(e,t,n){var i,r,a,o,s,l,u,c,h,d,f,p,m=n[0],g=n[1],v=n[2];t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=i*m+s*g+h*v+t[12],e[13]=r*m+l*g+d*v+t[13],e[14]=a*m+u*g+f*v+t[14],e[15]=o*m+c*g+p*v+t[15])}(a,a,l),function(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=n*s-i*o,_=n*l-r*o,b=n*u-a*o,E=i*l-r*s,T=i*u-a*s,w=r*u-a*l,x=c*m-h*p,A=c*g-d*p,S=c*v-f*p,M=h*g-d*m,C=h*v-f*m,R=d*v-f*g,I=y*R-_*C+b*M+E*S-T*A+w*x;I&&(I=1/I,e[0]=(s*R-l*C+u*M)*I,e[1]=(r*C-i*R-a*M)*I,e[2]=(m*w-g*T+v*E)*I,e[3]=(d*T-h*w-f*E)*I,e[4]=(l*S-o*R-u*A)*I,e[5]=(n*R-r*S+a*A)*I,e[6]=(g*b-p*w-v*_)*I,e[7]=(c*w-d*b+f*_)*I,e[8]=(o*C-s*S+u*x)*I,e[9]=(i*S-n*C-a*x)*I,e[10]=(p*T-m*b+v*y)*I,e[11]=(h*b-c*T-f*y)*I,e[12]=(s*A-o*M-l*x)*I,e[13]=(n*M-i*A+r*x)*I,e[14]=(m*_-p*E-g*y)*I,e[15]=(c*E-h*_+d*y)*I)}(a,a)}return function(e,t,n){return!(!e||!t||(e.pose=t,e.timestamp=t.timestamp,r(e.leftProjectionMatrix,e.leftViewMatrix,t,n._getFieldOfView("left"),n._getEyeOffset("left"),n),r(e.rightProjectionMatrix,e.rightViewMatrix,t,n._getFieldOfView("right"),n._getEyeOffset("right"),n),0))}}(),T=function(e){var t,n=e.indexOf("://");t=-1!==n?n+3:0;var i=e.indexOf("/",t);return-1===i&&(i=e.length),e.substring(0,i)},w=(e={},function(t,n){void 0===e[t]&&(console.warn("webvr-polyfill: "+n),e[t]=!0)}),x=function(e,t){w(e,e+" has been deprecated. This may not work on native WebVR displays. "+(t?"Please use "+t+" instead.":""))},A=function(e,t,n){if(t){for(var i=[],r=null,a=0;a<t.length;++a)switch(o=t[a]){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),i.push(null,null);break}r||(r=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(l),i.push(e.getParameter(o),null);break;case e.ACTIVE_TEXTURE:r=e.getParameter(e.ACTIVE_TEXTURE),i.push(null);break;default:i.push(e.getParameter(o))}for(n(e),a=0;a<t.length;++a){var o=t[a],s=i[a];switch(o){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,s);break;case e.COLOR_CLEAR_VALUE:e.clearColor(s[0],s[1],s[2],s[3]);break;case e.COLOR_WRITEMASK:e.colorMask(s[0],s[1],s[2],s[3]);break;case e.CURRENT_PROGRAM:e.useProgram(s);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,s);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,s);break;case e.TEXTURE_BINDING_2D:if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_2D,s);break;case e.TEXTURE_BINDING_CUBE_MAP:var l;if((l=t[++a])<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_CUBE_MAP,s);break;case e.VIEWPORT:e.viewport(s[0],s[1],s[2],s[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:s?e.enable(o):e.disable(o);break;default:console.log("No GL restore behavior for 0x"+o.toString(16))}r&&e.activeTexture(r)}}else n(e)},S=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),M=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function C(e,t,n,i){this.gl=e,this.cardboardUI=t,this.bufferScale=n,this.dirtySubmitFrameBindings=i,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,o()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=g(e,S,M,this.attribs),this.uniforms=v(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize()}C.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},C.prototype.onResize=function(){var e=this.gl,t=this,n=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];A(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)})),this.cardboardUI&&this.cardboardUI.onResize()},C.prototype.patch=function(){if(!this.isPatched){var e=this,t=this.gl.canvas,n=this.gl;o()||(t.width=f()*this.bufferScale,t.height=p()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(n){e.bufferWidth=n,e.realCanvasWidth.set.call(t,n),e.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(n){e.bufferHeight=n,e.realCanvasHeight.set.call(t,n),e.onResize()}})),this.lastBoundFramebuffer=n.getParameter(n.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(t,i){e.lastBoundFramebuffer=i||e.framebuffer,e.realBindFramebuffer.call(n,t,e.lastBoundFramebuffer)},this.cullFace=n.getParameter(n.CULL_FACE),this.depthTest=n.getParameter(n.DEPTH_TEST),this.blend=n.getParameter(n.BLEND),this.scissorTest=n.getParameter(n.SCISSOR_TEST),this.stencilTest=n.getParameter(n.STENCIL_TEST),n.enable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!0;break;case n.DEPTH_TEST:e.depthTest=!0;break;case n.BLEND:e.blend=!0;break;case n.SCISSOR_TEST:e.scissorTest=!0;break;case n.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(n,t)},n.disable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!1;break;case n.DEPTH_TEST:e.depthTest=!1;break;case n.BLEND:e.blend=!1;break;case n.SCISSOR_TEST:e.scissorTest=!1;break;case n.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(n,t)},this.colorMask=n.getParameter(n.COLOR_WRITEMASK),n.colorMask=function(t,i,r,a){e.colorMask[0]=t,e.colorMask[1]=i,e.colorMask[2]=r,e.colorMask[3]=a,e.realColorMask.call(n,t,i,r,a)},this.clearColor=n.getParameter(n.COLOR_CLEAR_VALUE),n.clearColor=function(t,i,r,a){e.clearColor[0]=t,e.clearColor[1]=i,e.clearColor[2]=r,e.clearColor[3]=a,e.realClearColor.call(n,t,i,r,a)},this.viewport=n.getParameter(n.VIEWPORT),n.viewport=function(t,i,r,a){e.viewport[0]=t,e.viewport[1]=i,e.viewport[2]=r,e.viewport[3]=a,e.realViewport.call(n,t,i,r,a)},this.isPatched=!0,b(t)}},C.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;o()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout((function(){b(t)}),1)}},C.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]),t||(t=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},C.prototype.submitFrame=function(){var e=this.gl,t=this,n=[];if(this.dirtySubmitFrameBindings||n.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),A(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||o())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),t.dirtySubmitFrameBindings||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)})),o()){var i=e.canvas;i.width==t.bufferWidth&&i.height==t.bufferHeight||(t.bufferWidth=i.width,t.bufferHeight=i.height,t.onResize())}},C.prototype.updateDeviceInfo=function(e){var t=this.gl,n=this,i=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];A(t,i,(function(t){var i=n.computeMeshVertices_(n.meshWidth,n.meshHeight,e);if(t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),!n.indexCount){var r=n.computeMeshIndices_(n.meshWidth,n.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW),n.indexCount=r.length}}))},C.prototype.computeMeshVertices_=function(e,t,n){for(var i=new Float32Array(2*e*t*5),r=n.getLeftEyeVisibleTanAngles(),o=n.getLeftEyeNoLensTanAngles(),s=n.getLeftEyeVisibleScreenRect(o),l=0,u=0;u<2;u++){for(var c=0;c<t;c++)for(var h=0;h<e;h++,l++){var d=h/(e-1),f=c/(t-1),p=d,m=f,g=a(r[0],r[2],d),v=a(r[3],r[1],f),y=Math.sqrt(g*g+v*v),_=n.distortion.distortInverse(y),b=v*_/y;d=(g*_/y-o[0])/(o[2]-o[0]),f=(b-o[3])/(o[1]-o[3]),d=2*(s.x+d*s.width-.5),f=2*(s.y+f*s.height-.5),i[5*l+0]=d,i[5*l+1]=f,i[5*l+2]=p,i[5*l+3]=m,i[5*l+4]=u}var E=r[2]-r[0];r[0]=-(E+r[0]),r[2]=E-r[2],E=o[2]-o[0],o[0]=-(E+o[0]),o[2]=E-o[2],s.x=1-(s.x+s.width)}return i},C.prototype.computeMeshIndices_=function(e,t){for(var n=new Uint16Array(2*(e-1)*(t-1)*6),i=e/2,r=t/2,a=0,o=0,s=0;s<2;s++)for(var l=0;l<t;l++)for(var u=0;u<e;u++,a++)0!=u&&0!=l&&(u<=i==l<=r?(n[o++]=a,n[o++]=a-e-1,n[o++]=a-e,n[o++]=a-e-1,n[o++]=a,n[o++]=a-1):(n[o++]=a-1,n[o++]=a-e,n[o++]=a,n[o++]=a-e,n[o++]=a-1,n[o++]=a-e-1));return n},C.prototype.getOwnPropertyDescriptor_=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return void 0!==n.get&&void 0!==n.set||(n.configurable=!0,n.enumerable=!0,n.get=function(){return this.getAttribute(t)},n.set=function(e){this.setAttribute(t,e)}),n};var R=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),I=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),P=Math.PI/180;function L(e){this.gl=e,this.attribs={position:0},this.program=g(e,R,I,this.attribs),this.uniforms=v(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function D(e){this.coefficients=e}L.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},L.prototype.listen=function(e,t){var n=this.gl.canvas;this.listener=function(i){var r=n.clientWidth/2;i.clientX>r-42&&i.clientX<r+42&&i.clientY>n.clientHeight-42?e(i):i.clientX<42&&i.clientY<42&&t(i)},n.addEventListener("click",this.listener,!1)},L.prototype.onResize=function(){var e=this.gl,t=this,n=[e.ARRAY_BUFFER_BINDING];A(e,n,(function(e){var n=[],i=e.drawingBufferWidth/2,r=Math.max(screen.width,screen.height)*window.devicePixelRatio,a=e.drawingBufferWidth/r*window.devicePixelRatio,o=4*a/2,s=42*a,l=28*a/2,u=14*a;function c(e,t){var r=(90-e)*P,a=Math.cos(r),o=Math.sin(r);n.push(.3125*a*l+i,.3125*o*l+l),n.push(t*a*l+i,t*o*l+l)}n.push(i-o,s),n.push(i-o,e.drawingBufferHeight),n.push(i+o,s),n.push(i+o,e.drawingBufferHeight),t.gearOffset=n.length/2;for(var h=0;h<=6;h++){var d=60*h;c(d,1),c(d+12,1),c(d+20,.75),c(d+40,.75),c(d+48,1)}function f(t,i){n.push(u+t,e.drawingBufferHeight-u-i)}t.gearVertexCount=n.length/2-t.gearOffset,t.arrowOffset=n.length/2;var p=o/Math.sin(45*P);f(0,l),f(l,0),f(l+p,p),f(p,l+p),f(p,l-p),f(0,l),f(l,2*l),f(l+p,2*l-p),f(p,l-p),f(0,l),f(p,l-o),f(28*a,l-o),f(p,l+o),f(28*a,l+o),t.arrowVertexCount=n.length/2-t.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)}))},L.prototype.render=function(){var e=this.gl,t=this,n=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];A(e,n,(function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()}))},L.prototype.renderNoState=function(){var e,t,n,i,r,a,o,s,l,u,c=this.gl;c.useProgram(this.program),c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer),c.enableVertexAttribArray(this.attribs.position),c.vertexAttribPointer(this.attribs.position,2,c.FLOAT,!1,8,0),c.uniform4f(this.uniforms.color,1,1,1,1),e=this.projMat,t=0,n=c.drawingBufferWidth,i=0,r=c.drawingBufferHeight,s=1/(t-n),l=1/(i-r),u=1/((a=.1)-(o=1024)),e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(o+a)*u,e[15]=1,c.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),c.drawArrays(c.TRIANGLE_STRIP,0,4),c.drawArrays(c.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),c.drawArrays(c.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},D.prototype.distortInverse=function(e){for(var t=0,n=1,i=e-this.distort(t);Math.abs(n-t)>1e-4;){var r=e-this.distort(n),a=n-r*((n-t)/(r-i));t=n,n=a,i=r}return n},D.prototype.distort=function(e){for(var t=e*e,n=0,i=0;i<this.coefficients.length;i++)n=t*(n+this.coefficients[i]);return(n+1)*e};var O=Math.PI/180,N=180/Math.PI,k=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};k.prototype={constructor:k,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*n,u=s*n+o*t-r*i,c=s*i+r*n-a*t,h=-r*t-a*n-o*i;return this.x=l*s+h*-r+u*-o-c*-a,this.y=u*s+h*-a+c*-r-l*-o,this.z=c*s+h*-o+l*-a-u*-r,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this}};var F,B,U=function(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1};function j(e){this.width=e.width||f(),this.height=e.height||p(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}U.prototype={constructor:U,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var i=Math.cos(e/2),r=Math.cos(t/2),a=Math.cos(n/2),o=Math.sin(e/2),s=Math.sin(t/2),l=Math.sin(n/2);return this.x=o*r*a+i*s*l,this.y=i*s*a-o*r*l,this.z=i*r*l+o*s*a,this.w=i*r*a-o*s*l,this},setFromEulerYXZ:function(e,t,n){var i=Math.cos(e/2),r=Math.cos(t/2),a=Math.cos(n/2),o=Math.sin(e/2),s=Math.sin(t/2),l=Math.sin(n/2);return this.x=o*r*a+i*s*l,this.y=i*s*a-o*r*l,this.z=i*r*l-o*s*a,this.w=i*r*a+o*s*l,this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,i=e.y,r=e.z,a=e.w,o=t.x,s=t.y,l=t.z,u=t.w;return this.x=n*u+a*o+i*l-r*s,this.y=i*u+a*s+r*o-n*l,this.z=r*u+a*l+n*s-i*o,this.w=a*u-n*o-i*s-r*l,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,i=this.y,r=this.z,a=this.w,o=a*e.w+n*e.x+i*e.y+r*e.z;if(o<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,o=-o):this.copy(e),o>=1)return this.w=a,this.x=n,this.y=i,this.z=r,this;var s=Math.acos(o),l=Math.sqrt(1-o*o);if(Math.abs(l)<.001)return this.w=.5*(a+this.w),this.x=.5*(n+this.x),this.y=.5*(i+this.y),this.z=.5*(r+this.z),this;var u=Math.sin((1-t)*s)/l,c=Math.sin(t*s)/l;return this.w=a*u+this.w*c,this.x=n*u+this.x*c,this.y=i*u+this.y*c,this.z=r*u+this.z*c,this},setFromUnitVectors:function(e,t){return void 0===F&&(F=new k),(B=e.dot(t)+1)<1e-6?(B=0,Math.abs(e.x)>Math.abs(e.z)?F.set(-e.y,e.x,0):F.set(0,-e.z,e.y)):F.crossVectors(e,t),this.x=F.x,this.y=F.y,this.z=F.z,this.w=B,this.normalize(),this}};var G=new j({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),z=new j({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),H={CardboardV1:new W({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new W({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function V(e,t){this.viewer=H.CardboardV2,this.updateDeviceParams(e),this.distortion=new D(this.viewer.distortionCoefficients);for(var n=0;n<t.length;n++){var i=t[n];H[i.id]=new W(i)}}function W(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}V.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},V.prototype.getDevice=function(){return this.device},V.prototype.setViewer=function(e){this.viewer=e,this.distortion=new D(this.viewer.distortionCoefficients)},V.prototype.determineDevice_=function(e){if(!e)return o()?(console.warn("Using fallback iOS device measurements."),z):(console.warn("Using fallback Android device measurements."),G);var t=.0254/e.xdpi,n=.0254/e.ydpi;return new j({widthMeters:t*f(),heightMeters:n*p(),bevelMeters:.001*e.bevelMm})},V.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,n=this.distortion,i=e.screenLensDistance,r=(t.widthMeters-e.interLensDistance)/2,a=e.interLensDistance/2,o=e.baselineLensDistance-t.bevelMeters,s=t.heightMeters-o,l=N*Math.atan(n.distort(r/i)),u=N*Math.atan(n.distort(a/i)),c=N*Math.atan(n.distort(o/i)),h=N*Math.atan(n.distort(s/i));return{leftDegrees:Math.min(l,e.fov),rightDegrees:Math.min(u,e.fov),downDegrees:Math.min(c,e.fov),upDegrees:Math.min(h,e.fov)}},V.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,i=Math.tan(-O*e.fov),r=Math.tan(O*e.fov),a=Math.tan(O*e.fov),o=Math.tan(-O*e.fov),s=t.widthMeters/4,l=t.heightMeters/2,u=e.baselineLensDistance-t.bevelMeters-l,c=e.interLensDistance/2-s,h=-u,d=e.screenLensDistance,f=n.distort((c-s)/d),p=n.distort((h+l)/d),m=n.distort((c+s)/d),g=n.distort((h-l)/d),v=new Float32Array(4);return v[0]=Math.max(i,f),v[1]=Math.min(r,p),v[2]=Math.min(a,m),v[3]=Math.max(o,g),v},V.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,i=new Float32Array(4),r=n.distortInverse(Math.tan(-O*e.fov)),a=n.distortInverse(Math.tan(O*e.fov)),o=n.distortInverse(Math.tan(O*e.fov)),s=n.distortInverse(Math.tan(-O*e.fov)),l=t.widthMeters/4,u=t.heightMeters/2,c=e.baselineLensDistance-t.bevelMeters-u,h=e.interLensDistance/2-l,d=-c,f=e.screenLensDistance,p=(h-l)/f,m=(d+u)/f,g=(h+l)/f,v=(d-u)/f;return i[0]=Math.max(r,p),i[1]=Math.min(a,m),i[2]=Math.min(o,g),i[3]=Math.max(s,v),i},V.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,n=this.device,i=t.screenLensDistance,r=(n.widthMeters-t.interLensDistance)/2,a=t.baselineLensDistance-n.bevelMeters,o=(e[0]*i+r)/n.widthMeters,s=(e[1]*i+a)/n.heightMeters,l=(e[2]*i+r)/n.widthMeters,u=(e[3]*i+a)/n.heightMeters;return{x:o,y:u,width:l-o,height:s-u}},V.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},V.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},V.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:N*Math.atan(e.outerDist),rightDegrees:N*Math.atan(e.innerDist),downDegrees:N*Math.atan(e.bottomDist),upDegrees:N*Math.atan(e.topDist)}},V.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,n=this.device,i=t.screenLensDistance,r=n.widthMeters/i,a=n.heightMeters/i,o=n.width/r,s=n.height/a,l=Math.round((e.eyePosX-e.outerDist)*o),u=Math.round((e.eyePosY-e.bottomDist)*s);return{x:l,y:u,width:Math.round((e.eyePosX+e.innerDist)*o)-l,height:Math.round((e.eyePosY+e.topDist)*s)-u}},V.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,n=this.distortion,i=e.screenLensDistance,r=e.interLensDistance/2/i,a=t.widthMeters/i,o=t.heightMeters/i,s=a/2-r,l=(e.baselineLensDistance-t.bevelMeters)/i,u=e.fov,c=n.distortInverse(Math.tan(O*u)),h=Math.min(s,c),d=Math.min(r,c),f=Math.min(l,c);return{outerDist:h,innerDist:d,topDist:Math.min(o-l,c),bottomDist:f,eyePosX:s,eyePosY:l}},V.Viewers=H;var q={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};function Y(e,t){if(this.dpdb=q,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var n=new XMLHttpRequest,i=this;n.open("GET",e,!0),n.addEventListener("load",(function(){i.loading=!1,n.status>=200&&n.status<=299?(i.dpdb=JSON.parse(n.response),i.recalculateDeviceParams_()):console.error("Error loading online DPDB!")})),n.send()}}function X(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}function K(e,t){this.set(e,t)}function Q(e,t){this.kFilter=e,this.isDebug=t,this.currentAccelMeasurement=new K,this.currentGyroMeasurement=new K,this.previousGyroMeasurement=new K,o()?this.filterQ=new U(-1,0,0,1):this.filterQ=new U(1,0,0,1),this.previousFilterQ=new U,this.previousFilterQ.copy(this.filterQ),this.accelQ=new U,this.isOrientationInitialized=!1,this.estimatedGravity=new k,this.measuredGravity=new k,this.gyroIntegralQ=new U}function Z(e,t){this.predictionTimeS=e,this.isDebug=t,this.previousQ=new U,this.previousTimestampS=null,this.deltaQ=new U,this.outQ=new U}function J(e,t,n,i){this.yawOnly=n,this.accelerometer=new k,this.gyroscope=new k,this.filter=new Q(e,i),this.posePredictor=new Z(t,i),this.isFirefoxAndroid=l(),this.isIOS=o();var r=u();this.isDeviceMotionInRadians=!this.isIOS&&r&&r<66,this.isWithoutDeviceMotion=c(),this.filterToWorldQ=new U,o()?this.filterToWorldQ.setFromAxisAngle(new k(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new k(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new U,this.worldToScreenQ=new U,this.originalPoseAdjustQ=new U,this.originalPoseAdjustQ.setFromAxisAngle(new k(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),d()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new U,this.orientationOut_=new Float32Array(4),this.start()}Y.prototype.getDeviceParams=function(){return this.deviceParams},Y.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Y.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,n=f(),i=p();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var r=0;r<e.devices.length;r++){var a=e.devices[r];if(a.rules)if("ios"==a.type||"android"==a.type){if(o()==("ios"==a.type)){for(var s=!1,l=0;l<a.rules.length;l++){var u=a.rules[l];if(this.ruleMatches_(u,t,n,i)){s=!0;break}}if(s)return new X({xdpi:a.dpi[0]||a.dpi,ydpi:a.dpi[1]||a.dpi,bevelMm:a.bw})}}else console.warn("Device["+r+"] has invalid type.");else console.warn("Device["+r+"] has no rules section.")}return console.warn("No DPDB device match."),null},Y.prototype.ruleMatches_=function(e,t,n,i){if(!e.ua&&!e.res)return!1;if(e.ua&&"SM"===e.ua.substring(0,2)&&(e.ua=e.ua.substring(0,7)),e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var r=e.res[0],a=e.res[1];if(Math.min(n,i)!=Math.min(r,a)||Math.max(n,i)!=Math.max(r,a))return!1}return!0},K.prototype.set=function(e,t){this.sample=e,this.timestampS=t},K.prototype.copy=function(e){this.set(e.sample,e.timestampS)},Q.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},Q.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n,i=t-this.previousGyroMeasurement.timestampS;n=i,isNaN(n)||n<=.001||n>1||this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},Q.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new U;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i,r=new U;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",N*((i=r).w>1?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(i.w)),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var a=new U;a.copy(this.filterQ),a.multiply(r),this.filterQ.slerp(a,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},Q.prototype.getOrientation=function(){return this.filterQ},Q.prototype.accelToQuaternion_=function(e){var t=new k;t.copy(e),t.normalize();var n=new U;return n.setFromUnitVectors(new k(0,0,-1),t),n.inverse(),n},Q.prototype.gyroToQuaternionDelta_=function(e,t){var n=new U,i=new k;return i.copy(e),i.normalize(),n.setFromAxisAngle(i,e.length()*t),n},Z.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var i=new k;i.copy(t),i.normalize();var r=t.length();if(r<20*O)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(N*r).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var a=r*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(i,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},J.prototype.getPosition=function(){return null},J.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ)return this.deviceOrientationFixQ=this.deviceOrientationFixQ||(n=(new U).setFromAxisAngle(new k(0,0,-1),0),i=new U,-90===window.orientation?i.setFromAxisAngle(new k(0,1,0),Math.PI/-2):i.setFromAxisAngle(new k(0,1,0),Math.PI/2),n.multiply(i)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||((t=new U).setFromAxisAngle(new k(1,0,0),-Math.PI/2),t),e=this._deviceOrientationQ,(r=new U).copy(e),r.multiply(this.deviceOrientationFilterToWorldQ),r.multiply(this.resetQ),r.multiply(this.worldToScreenQ),r.multiplyQuaternions(this.deviceOrientationFixQ,r),this.yawOnly&&(r.x=0,r.z=0,r.normalize()),this.orientationOut_[0]=r.x,this.orientationOut_[1]=r.y,this.orientationOut_[2]=r.z,this.orientationOut_[3]=r.w,this.orientationOut_;var t,n,i,r,a=this.filter.getOrientation();return e=this.posePredictor.getPrediction(a,this.gyroscope,this.previousTimestampS),(r=new U).copy(this.filterToWorldQ),r.multiply(this.resetQ),r.multiply(e),r.multiply(this.worldToScreenQ),this.yawOnly&&(r.x=0,r.z=0,r.normalize()),this.orientationOut_[0]=r.x,this.orientationOut_[1]=r.y,this.orientationOut_[2]=r.z,this.orientationOut_[3]=r.w,this.orientationOut_},J.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),d()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},J.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new U;var t=e.alpha,n=e.beta,i=e.gamma;t=(t||0)*Math.PI/180,n=(n||0)*Math.PI/180,i=(i||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(n,t,-i)},J.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)},J.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,n=e.rotationRate,i=e.timeStamp/1e3,r=i-this.previousTimestampS;return r<0?(w("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),void(this.previousTimestampS=i)):r<=.001||r>1?(w("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),void(this.previousTimestampS=i)):(this.accelerometer.set(-t.x,-t.y,-t.z),h()?this.gyroscope.set(-n.beta,n.alpha,n.gamma):this.gyroscope.set(n.alpha,n.beta,n.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,i),this.filter.addGyroMeasurement(this.gyroscope,i),void(this.previousTimestampS=i))},J.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},J.prototype.onMessage_=function(e){var t=e.data;t&&t.type&&"devicemotion"===t.type.toLowerCase()&&this.updateDeviceMotion_(t.deviceMotionEvent)},J.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new k(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new k(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},J.prototype.start=function(){var e,t,n;this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),o()&&(e=window.self!==window.top,t=T(document.referrer),n=T(window.location.href),e&&t!==n)&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},J.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var $=new k(1,0,0),ee=new k(0,0,1),te=new U;te.setFromAxisAngle($,-Math.PI/2),te.multiply((new U).setFromAxisAngle(ee,Math.PI/2));var ne=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new U,this._outQ=new U,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return i(e,[{key:"init",value:function(){var e=null;try{(e=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e),"SecurityError"===e.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===e.name?this.useDeviceMotion():console.error(e)}e&&(this.api="sensor",this.sensor=e,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new J(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var e=this.sensor.quaternion;this._sensorQ.set(e[0],e[1],e[2],e[3]);var t=this._outQ;return t.copy(te),t.multiply(this._sensorQ),this.config.YAW_ONLY&&(t.x=t.z=0,t.normalize()),this._out[0]=t.x,this._out[1]=t.y,this._out[2]=t.z,this._out[3]=t.w,this._out}},{key:"_onSensorError",value:function(e){this.errors.push(e.error),"NotAllowedError"===e.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===e.error.name?console.error("Sensor could not be read"):console.error(e.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),e}();function ie(){this.loadIcon_();var e=document.createElement("div");(a=e.style).position="fixed",a.top=0,a.right=0,a.bottom=0,a.left=0,a.backgroundColor="gray",a.fontFamily="sans-serif",a.zIndex=1e6;var t=document.createElement("img");t.src=this.icon,(a=t.style).marginLeft="25%",a.marginTop="25%",a.width="50%",e.appendChild(t);var n=document.createElement("div");(a=n.style).textAlign="center",a.fontSize="16px",a.lineHeight="24px",a.margin="24px 25%",a.width="50%",n.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(n);var i=document.createElement("div");(a=i.style).backgroundColor="#CFD8DC",a.position="fixed",a.bottom=0,a.width="100%",a.height="48px",a.padding="14px 24px",a.boxSizing="border-box",a.color="#656A6B",e.appendChild(i);var r=document.createElement("div");r.style.float="left",r.innerHTML="No Cardboard viewer?";var a,o=document.createElement("a");o.href="https://www.google.com/get/cardboard/get-cardboard/",o.innerHTML="get one",o.target="_blank",(a=o.style).float="right",a.fontWeight=600,a.textTransform="uppercase",a.borderLeft="1px solid gray",a.paddingLeft="24px",a.textDecoration="none",a.color="#656A6B",i.appendChild(r),i.appendChild(o),this.overlay=e,this.text=n,this.hide()}function re(e){try{this.selectedKey=localStorage.getItem("WEBVR_CARDBOARD_VIEWER")}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=e||"CardboardV1"),this.dialog=this.createDialog_(V.Viewers),this.root=null,this.onChangeCallbacks_=[]}ie.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img").style;d()?(t.width="20%",t.marginLeft="40%",t.marginTop="3%"):(t.width="50%",t.marginLeft="25%",t.marginTop="25%")},ie.prototype.hide=function(){this.overlay.style.display="none"},ie.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},ie.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},ie.prototype.update=function(){this.disableShowTemporarily(),!d()&&y()?this.show():this.hide()},ie.prototype.loadIcon_=function(){this.icon="data:image/svg+xml,"+encodeURIComponent("<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>")},re.prototype.show=function(e){this.root=e,e.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},re.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},re.prototype.getCurrentViewer=function(){return V.Viewers[this.selectedKey]},re.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},re.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},re.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},re.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&V.Viewers[this.selectedKey]){this.fireOnChange_(V.Viewers[this.selectedKey]);try{localStorage.setItem("WEBVR_CARDBOARD_VIEWER",this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},re.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add("webvr-polyfill-viewer-selector"),t.style.display="none";var n=document.createElement("div");(r=n.style).position="fixed",r.left=0,r.top=0,r.width="100%",r.height="100%",r.background="rgba(0, 0, 0, 0.3)",n.addEventListener("click",this.hide.bind(this));var i=document.createElement("div"),r=i.style;for(var a in r.boxSizing="border-box",r.position="fixed",r.top="24px",r.left="50%",r.marginLeft="-140px",r.width="280px",r.padding="24px",r.overflow="hidden",r.background="#fafafa",r.fontFamily="'Roboto', sans-serif",r.boxShadow="0px 5px 20px #666",i.appendChild(this.createH1_("Select your viewer")),e)i.appendChild(this.createChoice_(a,e[a].label));return i.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(n),t.appendChild(i),t},re.prototype.createH1_=function(e){var t=document.createElement("h1"),n=t.style;return n.color="black",n.fontSize="20px",n.fontWeight="bold",n.marginTop=0,n.marginBottom="24px",t.innerHTML=e,t},re.prototype.createChoice_=function(e,t){var n=document.createElement("div");n.style.marginTop="8px",n.style.color="black";var i=document.createElement("input");i.style.fontSize="30px",i.setAttribute("id",e),i.setAttribute("type","radio"),i.setAttribute("value",e),i.setAttribute("name","field");var r=document.createElement("label");return r.style.marginLeft="4px",r.setAttribute("for",e),r.innerHTML=t,n.appendChild(i),n.appendChild(r),n},re.prototype.createButton_=function(e,t){var n=document.createElement("button");n.innerHTML=e;var i=n.style;return i.float="right",i.textTransform="uppercase",i.color="#1094f7",i.fontSize="14px",i.letterSpacing=0,i.border=0,i.background="none",i.marginTop="16px",n.addEventListener("click",t),n},"undefined"!=typeof window?window:void 0!==Fu||"undefined"!=typeof self&&self;var ae,oe=(ae=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){!function(t,n){e.exports=n()}(0,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),a="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",r),this.noSleepVideo.addEventListener("timeupdate",function(e){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return i(e,[{key:"enable",value:function(){a?(this.disable(),this.noSleepTimer=window.setInterval((function(){window.location.href="/",window.setTimeout(window.stop,0)}),15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){a?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),e}();e.exports=o},function(e,t,n){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])}))})))&&ae.__esModule&&Object.prototype.hasOwnProperty.call(ae,"default")?ae.default:ae,se=1e3,le=[0,0,.5,1],ue=[.5,0,.5,1],ce=window.requestAnimationFrame,he=window.cancelAnimationFrame;function de(e){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:e.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:e.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:e.canPresent},maxLayers:{writable:!1,enumerable:!0,value:e.maxLayers},hasOrientation:{enumerable:!0,get:function(){return x("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),e.hasOrientation}}})}function fe(e){var t=!("wakelock"in(e=e||{}))||e.wakelock;this.isPolyfilled=!0,this.displayId=se++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return x("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new de({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,t&&y()&&(this.wakelock_=new oe)}fe.prototype.getFrameData=function(e){return E(e,this._getPose(),this)},fe.prototype.getPose=function(){return x("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},fe.prototype.resetPose=function(){return x("VRDisplay.prototype.resetPose"),this._resetPose()},fe.prototype.getImmediatePose=function(){return x("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},fe.prototype.requestAnimationFrame=function(e){return ce(e)},fe.prototype.cancelAnimationFrame=function(e){return he(e)},fe.prototype.wrapForFullscreen=function(e){if(o())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=e,this.originalParent_=e.parentElement,this.originalParent_||document.body.appendChild(e),!this.fullscreenWrapper_.parentElement){var n=this.fullscreenElement_.parentElement;n.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),n.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var i=this;return function(){if(i.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];i.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}(),this.fullscreenWrapper_},fe.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),this.originalParent_===t?t.insertBefore(e,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(e),t.removeChild(this.fullscreenWrapper_),e}},fe.prototype.requestPresent=function(e){var t=this.isPresenting,n=this;return e instanceof Array||(x("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),e=[e]),new Promise((function(i,r){if(n.capabilities.canPresent)if(0==e.length||e.length>n.capabilities.maxLayers)r(new Error("Invalid number of layers."));else{var a=e[0];if(a.source){var l=a.leftBounds||le,u=a.rightBounds||ue;if(t){var c=n.layer_;c.source!==a.source&&(c.source=a.source);for(var h=0;h<4;h++)c.leftBounds[h]=l[h],c.rightBounds[h]=u[h];return n.wrapForFullscreen(n.layer_.source),n.updatePresent_(),void i()}if(n.layer_={predistorted:a.predistorted,source:a.source,leftBounds:l.slice(0),rightBounds:u.slice(0)},n.waitingForPresent_=!1,n.layer_&&n.layer_.source){var d=n.wrapForFullscreen(n.layer_.source);n.addFullscreenListeners_(d,(function(){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n.isPresenting=d===e,n.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch((function(e){console.error("screen.orientation.lock() failed due to",e.message)})),n.waitingForPresent_=!1,n.beginPresent_(),i()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),n.removeFullscreenWrapper(),n.disableWakeLock(),n.endPresent_(),n.removeFullscreenListeners_()),n.fireVRDisplayPresentChange_()}),(function(){n.waitingForPresent_&&(n.removeFullscreenWrapper(),n.removeFullscreenListeners_(),n.disableWakeLock(),n.waitingForPresent_=!1,n.isPresenting=!1,r(new Error("Unable to present.")))})),function(e){if(s())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0}(d)?(n.enableWakeLock(),n.waitingForPresent_=!0):(o()||s())&&(n.enableWakeLock(),n.isPresenting=!0,n.beginPresent_(),n.fireVRDisplayPresentChange_(),i())}n.waitingForPresent_||o()||(m(),r(new Error("Unable to present.")))}else i()}else r(new Error("VRDisplay is not capable of presenting."))}))},fe.prototype.exitPresent=function(){var e=this.isPresenting,t=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise((function(n,i){e?(!m()&&o()&&(t.endPresent_(),t.fireVRDisplayPresentChange_()),s()&&(t.removeFullscreenWrapper(),t.removeFullscreenListeners_(),t.endPresent_(),t.fireVRDisplayPresentChange_()),n()):i(new Error("Was not presenting to VRDisplay."))}))},fe.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},fe.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},fe.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},fe.prototype.addFullscreenListeners_=function(e,t,n){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=n,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),n&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",n,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",n,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",n,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",n,!1))},fe.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var n=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",n,!1),e.removeEventListener("webkitfullscreenerror",n,!1),document.removeEventListener("mozfullscreenerror",n,!1),e.removeEventListener("msfullscreenerror",n,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},fe.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},fe.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},fe.prototype.beginPresent_=function(){},fe.prototype.endPresent_=function(){},fe.prototype.submitFrame=function(e){},fe.prototype.getEyeParameters=function(e){return null};var pe={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},me="left",ge="right";function ve(e){var t=_({},pe);e=_(t,e||{}),fe.call(this,{wakelock:e.MOBILE_WAKE_LOCK}),this.config=e,this.displayName="Cardboard VRDisplay",this.capabilities=new de({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new ne(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Y(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new V(this.dpdb_.getDeviceParams(),e.ADDITIONAL_VIEWERS),this.viewerSelector_=new re(e.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new ie),o()&&window.addEventListener("resize",this.onResize_.bind(this))}return ve.prototype=Object.create(fe.prototype),ve.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},ve.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},ve.prototype._getFieldOfView=function(e){var t;if(e==me)t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=ge)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return t},ve.prototype._getEyeOffset=function(e){var t;if(e==me)t=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(e!=ge)return console.error("Invalid eye provided: %s",e),null;t=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return t},ve.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e),n=this._getFieldOfView(e),i={offset:t,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(i,"fieldOfView",{enumerable:!0,get:function(){return x("VRFieldOfView","VRFrameData's projection matrices"),n}}),i},ve.prototype.onDeviceParamsUpdated_=function(e){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},ve.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},ve.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(e.canvas.width=f()*this.bufferScale_,e.canvas.height=p()*this.bufferScale_,this.cardboardUI_=new L(e)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new L(e)),this.distorter_=new C(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(d()&&y()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},ve.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},ve.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},ve.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2"));var n=t.canvas;n.width==this.lastWidth&&n.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=n.width,this.lastHeight=n.height,this.cardboardUI_.render()}},ve.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},ve.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2")),t.canvas.setAttribute("style",["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"].join("; ")+";"),b(t.canvas)}},ve.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},ve.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},ve.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},ve.VRDisplay=fe,ve}()})),ju=(Bu=Uu)&&Bu.__esModule&&Object.prototype.hasOwnProperty.call(Bu,"default")?Bu.default:Bu;class Gu extends pl{constructor(e){super(),this.global=e,this.onWindowResize=this.onWindowResize.bind(this),this.global.window.addEventListener("resize",this.onWindowResize),this.environmentBlendMode="opaque"}onBaseLayerSet(e,t){throw new Error("Not implemented")}isSessionSupported(e){throw new Error("Not implemented")}isFeatureSupported(e){throw new Error("Not implemented")}async requestSession(e,t){throw new Error("Not implemented")}requestAnimationFrame(e){throw new Error("Not implemented")}onFrameStart(e){throw new Error("Not implemented")}onFrameEnd(e){throw new Error("Not implemented")}doesSessionSupportReferenceSpace(e,t){throw new Error("Not implemented")}requestStageBounds(){throw new Error("Not implemented")}async requestFrameOfReferenceTransform(e,t){}cancelAnimationFrame(e){throw new Error("Not implemented")}endSession(e){throw new Error("Not implemented")}getViewport(e,t,n,i){throw new Error("Not implemented")}getProjectionMatrix(e){throw new Error("Not implemented")}getBasePoseMatrix(){throw new Error("Not implemented")}getBaseViewMatrix(e){throw new Error("Not implemented")}getInputSources(){throw new Error("Not implemented")}getInputPose(e,t,n){throw new Error("Not implemented")}onWindowResize(){this.onWindowResize()}}let zu={mapping:"xr-standard",profiles:["oculus-go","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0},gripTransform:{orientation:[.11*Math.PI,0,0,1]}},Hu={mapping:"xr-standard",displayProfiles:{"Oculus Quest":["oculus-touch-v2","oculus-touch","generic-trigger-squeeze-thumbstick"]},profiles:["oculus-touch","generic-trigger-squeeze-thumbstick"],axes:{length:4,0:null,1:null,2:0,3:1},buttons:{length:7,0:1,1:2,2:null,3:0,4:3,5:4,6:null},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},Vu={mapping:"xr-standard",profiles:["htc-vive","generic-trigger-squeeze-touchpad"],displayProfiles:{"HTC Vive":["htc-vive","generic-trigger-squeeze-touchpad"],"HTC Vive DVT":["htc-vive","generic-trigger-squeeze-touchpad"],"Valve Index":["valve-index","generic-trigger-squeeze-touchpad-thumbstick"]},buttons:{length:3,0:1,1:2,2:0},gripTransform:{position:[0,0,.05,1]},targetRayTransform:{orientation:[-.08*Math.PI,0,0,1]},userAgentOverrides:{Firefox:{axes:{invert:[1,3]}}}},Wu={mapping:"xr-standard",profiles:["samsung-gearvr","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0},gripTransform:{orientation:[.11*Math.PI,0,0,1]}},qu={mapping:"xr-standard",profiles:["samsung-odyssey","microsoft-mixed-reality","generic-trigger-squeeze-touchpad-thumbstick"],buttons:{length:4,0:1,1:0,2:2,3:4},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},Yu={mapping:"xr-standard",profiles:["microsoft-mixed-reality","generic-trigger-squeeze-touchpad-thumbstick"],buttons:{length:4,0:1,1:0,2:2,3:4},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},Xu={"Daydream Controller":{mapping:"",profiles:["google-daydream","generic-trigger-touchpad"],buttons:{length:3,0:null,1:null,2:0}},"Gear VR Controller":Wu,"HTC Vive Focus Controller":{mapping:"xr-standard",profiles:["htc-vive-focus","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0}},"Oculus Go Controller":zu,"Oculus Touch (Right)":Hu,"Oculus Touch (Left)":Hu,"OpenVR Gamepad":Vu,"Spatial Controller (Spatial Interaction Source) 045E-065A":Yu,"Spatial Controller (Spatial Interaction Source) 045E-065D":qu,"Windows Mixed Reality (Right)":Yu,"Windows Mixed Reality (Left)":Yu};const Ku=Sl(.155,-.465,-.15),Qu=Sl(-.155,-.465,-.15),Zu=Sl(0,0,-.25),Ju=Sl(0,0,.05),$u=Sl(-.08,.14,.08),ec=180/Math.PI;class tc{constructor(){this.hand="right",this.headElbowOffset=Ku,this.controllerQ=Nl(),this.lastControllerQ=Nl(),this.headQ=Nl(),this.headPos=xl(),this.elbowPos=xl(),this.wristPos=xl(),this.time=null,this.lastTime=null,this.rootQ=Nl(),this.position=xl()}setHandedness(e){this.hand!=e&&(this.hand=e,"left"==this.hand?this.headElbowOffset=Qu:this.headElbowOffset=Ku)}update(e,t){this.time=eu(),e&&(Gl(this.lastControllerQ,this.controllerQ),Gl(this.controllerQ,e)),t&&(El(this.headPos,t),Tl(this.headQ,t));let n=this.getHeadYawOrientation_(),i=this.quatAngle_(this.lastControllerQ,this.controllerQ);i/((this.time-this.lastTime)/1e3)>.61?Fl(this.rootQ,this.rootQ,n,Math.min(i/.175,1)):Gl(this.rootQ,n);let r=Sl(0,0,-1);Dl(r,r,this.controllerQ);let a=Pl(r,[0,1,0]),o=this.clamp_((a-.12)/.87,0,1),s=Ul(this.rootQ);Bl(s,s),kl(s,s,this.controllerQ);let l=this.elbowPos;Ml(l,this.headPos),Cl(l,l,this.headElbowOffset);let u=Al($u);Rl(u,u,o),Cl(l,l,u);let c=this.quatAngle_(s,Nl())*ec,h=(1-Math.pow(c/180,4))*(.4+.6*o*.4),d=Nl();Fl(d,d,s,h);let f=Bl(Nl(),d),p=Ul(s);kl(p,p,f);let m=this.wristPos;Ml(m,Ju),Dl(m,m,d),Cl(m,m,Zu),Dl(m,m,p),Cl(m,m,l);let g=Al($u);Rl(g,g,o),Cl(this.position,this.wristPos,g),Dl(this.position,this.position,this.rootQ),this.lastTime=this.time}getPosition(){return this.position}getHeadYawOrientation_(){let e=xl();return function(e,t,n){function i(e,t,n){return e<t?t:e>n?n:e}var r=t[0]*t[0],a=t[1]*t[1],o=t[2]*t[2],s=t[3]*t[3];if("XYZ"===n)e[0]=Math.atan2(2*(t[0]*t[3]-t[1]*t[2]),s-r-a+o),e[1]=Math.asin(i(2*(t[0]*t[2]+t[1]*t[3]),-1,1)),e[2]=Math.atan2(2*(t[2]*t[3]-t[0]*t[1]),s+r-a-o);else if("YXZ"===n)e[0]=Math.asin(i(2*(t[0]*t[3]-t[1]*t[2]),-1,1)),e[1]=Math.atan2(2*(t[0]*t[2]+t[1]*t[3]),s-r-a+o),e[2]=Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),s-r+a-o);else if("ZXY"===n)e[0]=Math.asin(i(2*(t[0]*t[3]+t[1]*t[2]),-1,1)),e[1]=Math.atan2(2*(t[1]*t[3]-t[2]*t[0]),s-r-a+o),e[2]=Math.atan2(2*(t[2]*t[3]-t[0]*t[1]),s-r+a-o);else if("ZYX"===n)e[0]=Math.atan2(2*(t[0]*t[3]+t[2]*t[1]),s-r-a+o),e[1]=Math.asin(i(2*(t[1]*t[3]-t[0]*t[2]),-1,1)),e[2]=Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),s+r-a-o);else if("YZX"===n)e[0]=Math.atan2(2*(t[0]*t[3]-t[2]*t[1]),s-r+a-o),e[1]=Math.atan2(2*(t[1]*t[3]-t[0]*t[2]),s+r-a-o),e[2]=Math.asin(i(2*(t[0]*t[1]+t[2]*t[3]),-1,1));else{if("XZY"!==n)return void console.log("No order given for quaternion to euler conversion.");e[0]=Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),s-r+a-o),e[1]=Math.atan2(2*(t[0]*t[2]+t[1]*t[3]),s+r-a-o),e[2]=Math.asin(i(2*(t[2]*t[3]-t[0]*t[1]),-1,1))}}(e,this.headQ,"YXZ"),function(e,t,n,i){let r=.5*Math.PI/180;t*=r,n*=r,i*=r;let a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return e[0]=a*l*c-o*s*u,e[1]=o*s*c+a*l*u,e[2]=o*l*u-a*s*c,e[3]=o*l*c+a*s*u,e}(Nl(),0,e[1]*ec,0)}clamp_(e,t,n){return Math.min(Math.max(e,t),n)}quatAngle_(e,t){let n=[0,0,-1],i=[0,0,-1];return Dl(n,n,e),Dl(i,i,t),function(e,t){let n=Sl(e[0],e[1],e[2]),i=Sl(t[0],t[1],t[2]);Il(n,n),Il(i,i);let r=Pl(n,i);return r>1?0:r<-1?Math.PI:Math.acos(r)}(n,i)}}const nc=Symbol("@@webxr-polyfill/XRRemappedGamepad"),ic={pressed:!1,touched:!1,value:0};Object.freeze(ic);class rc{constructor(e,t,n){if(n||(n={}),n.userAgentOverrides)for(let e in n.userAgentOverrides)if(navigator.userAgent.includes(e)){let t=n.userAgentOverrides[e];for(let e in t)e in n?Object.assign(n[e],t[e]):n[e]=t[e];break}let i=new Array(n.axes&&n.axes.length?n.axes.length:e.axes.length),r=new Array(n.buttons&&n.buttons.length?n.buttons.length:e.buttons.length),a=null;if(n.gripTransform){let e=n.gripTransform.orientation||[0,0,0,1];a=gl(),bl(a,zl(e,e),n.gripTransform.position||[0,0,0])}let o=null;if(n.targetRayTransform){let e=n.targetRayTransform.orientation||[0,0,0,1];o=gl(),bl(o,zl(e,e),n.targetRayTransform.position||[0,0,0])}let s=n.profiles;n.displayProfiles&&t.displayName in n.displayProfiles&&(s=n.displayProfiles[t.displayName]),this[nc]={gamepad:e,map:n,profiles:s||[e.id],mapping:n.mapping||e.mapping,axes:i,buttons:r,gripTransform:a,targetRayTransform:o},this._update()}_update(){let e=this[nc].gamepad,t=this[nc].map,n=this[nc].axes;for(let i=0;i<n.length;++i)t.axes&&i in t.axes?null===t.axes[i]?n[i]=0:n[i]=e.axes[t.axes[i]]:n[i]=e.axes[i];if(t.axes&&t.axes.invert)for(let e of t.axes.invert)e<n.length&&(n[e]*=-1);let i=this[nc].buttons;for(let n=0;n<i.length;++n)t.buttons&&n in t.buttons?null===t.buttons[n]?i[n]=ic:i[n]=e.buttons[t.buttons[n]]:i[n]=e.buttons[n]}get id(){return""}get _profiles(){return this[nc].profiles}get index(){return-1}get connected(){return this[nc].gamepad.connected}get timestamp(){return this[nc].gamepad.timestamp}get mapping(){return this[nc].mapping}get axes(){return this[nc].axes}get buttons(){return this[nc].buttons}get hapticActuators(){return this[nc].gamepad.hapticActuators}}class ac{constructor(e,t,n=0,i=-1){this.polyfill=e,this.display=t,this.nativeGamepad=null,this.gamepad=null,this.inputSource=new Pu(this),this.lastPosition=xl(),this.emulatedPosition=!1,this.basePoseMatrix=gl(),this.outputMatrix=gl(),this.primaryButtonIndex=n,this.primaryActionPressed=!1,this.primarySqueezeButtonIndex=i,this.primarySqueezeActionPressed=!1,this.handedness="",this.targetRayMode="gaze",this.armModel=null}get profiles(){return this.gamepad?this.gamepad._profiles:[]}updateFromGamepad(e){this.nativeGamepad!==e&&(this.nativeGamepad=e,this.gamepad=e?new rc(e,this.display,Xu[e.id]):null),this.handedness=""===e.hand?"none":e.hand,this.gamepad&&this.gamepad._update(),e.pose?(this.targetRayMode="tracked-pointer",this.emulatedPosition=!e.pose.hasPosition):""===e.hand&&(this.targetRayMode="gaze",this.emulatedPosition=!1)}updateBasePoseMatrix(){if(this.nativeGamepad&&this.nativeGamepad.pose){let e=this.nativeGamepad.pose,t=e.position,n=e.orientation;if(!t&&!n)return;t?(this.lastPosition[0]=t[0],this.lastPosition[1]=t[1],this.lastPosition[2]=t[2]):e.hasPosition?t=this.lastPosition:(this.armModel||(this.armModel=new tc),this.armModel.setHandedness(this.nativeGamepad.hand),this.armModel.update(n,this.polyfill.getBasePoseMatrix()),t=this.armModel.getPosition()),bl(this.basePoseMatrix,n,t)}else!function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}(this.basePoseMatrix,this.polyfill.getBasePoseMatrix());return this.basePoseMatrix}getXRPose(e,t){switch(this.updateBasePoseMatrix(),t){case"target-ray":e._transformBasePoseMatrix(this.outputMatrix,this.basePoseMatrix),this.gamepad&&this.gamepad[nc].targetRayTransform&&_l(this.outputMatrix,this.outputMatrix,this.gamepad[nc].targetRayTransform);break;case"grip":if(!this.nativeGamepad||!this.nativeGamepad.pose)return null;e._transformBasePoseMatrix(this.outputMatrix,this.basePoseMatrix),this.gamepad&&this.gamepad[nc].gripTransform&&_l(this.outputMatrix,this.outputMatrix,this.gamepad[nc].gripTransform);break;default:return null}return e._adjustForOriginOffset(this.outputMatrix),new XRPose(new XRRigidTransform(this.outputMatrix),this.emulatedPosition)}}const oc={highRefreshRate:!0},sc={oculus:1,openvr:1,"spatial controller (spatial interaction source)":1};let lc=0;class uc{constructor(e,t,n={}){if(this.mode=e,this.enabledFeatures=t,this.outputContext=null,this.immersive="immersive-vr"==e||"immersive-ar"==e,this.ended=null,this.baseLayer=null,this.id=++lc,this.modifiedCanvasLayer=!1,this.outputContext){const e=n.renderContextType||"2d";this.renderContext=this.outputContext.canvas.getContext(e)}}}class cc extends Gu{constructor(e,t){const{canPresent:n}=t.capabilities;super(e),this.display=t,this.frame=new e.VRFrameData,this.sessions=new Map,this.immersiveSession=null,this.canPresent=n,this.baseModelMatrix=gl(),this.gamepadInputSources={},this.tempVec3=new Float32Array(3),this.onVRDisplayPresentChange=this.onVRDisplayPresentChange.bind(this),e.window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange),this.CAN_USE_GAMEPAD=e.navigator&&"getGamepads"in e.navigator,this.HAS_BITMAP_SUPPORT=(e=>!(!e.ImageBitmapRenderingContext||!e.createImageBitmap))(e)}get depthNear(){return this.display.depthNear}set depthNear(e){this.display.depthNear=e}get depthFar(){return this.display.depthFar}set depthFar(e){this.display.depthFar=e}onBaseLayerSet(e,t){const n=this.sessions.get(e),i=t.context.canvas;if(n.immersive){const e=this.display.getEyeParameters("left"),r=this.display.getEyeParameters("right");i.width=2*Math.max(e.renderWidth,r.renderWidth),i.height=Math.max(e.renderHeight,r.renderHeight),this.display.requestPresent([{source:i,attributes:oc}]).then(()=>{this.global.document.body.contains(i)||(n.modifiedCanvasLayer=!0,this.global.document.body.appendChild(i),(e=>{e.style.display="block",e.style.position="absolute",e.style.width=e.style.height="1px",e.style.top=e.style.left="0px"})(i)),n.baseLayer=t})}else n.baseLayer=t}isSessionSupported(e){return"immersive-ar"!=e&&("immersive-vr"!=e||!1!==this.canPresent)}isFeatureSupported(e){switch(e){case"viewer":case"local":case"local-floor":return!0;case"bounded":case"unbounded":default:return!1}}async requestSession(e,t){if(!this.isSessionSupported(e))return Promise.reject();let n="immersive-vr"==e;if(n){const e=this.global.document.createElement("canvas");e.getContext("webgl");await this.display.requestPresent([{source:e,attributes:oc}])}const i=new uc(e,t,{renderContextType:this.HAS_BITMAP_SUPPORT?"bitmaprenderer":"2d"});return this.sessions.set(i.id,i),n&&(this.immersiveSession=i,this.dispatchEvent("@@webxr-polyfill/vr-present-start",i.id)),Promise.resolve(i.id)}requestAnimationFrame(e){return this.display.requestAnimationFrame(e)}getPrimaryButtonIndex(e){let t=0,n=e.id.toLowerCase();for(let e in sc)if(n.includes(e)){t=sc[e];break}return Math.min(t,e.buttons.length-1)}onFrameStart(e,t){this.display.depthNear=t.depthNear,this.display.depthFar=t.depthFar,this.display.getFrameData(this.frame);const n=this.sessions.get(e);if(n.immersive&&this.CAN_USE_GAMEPAD){let e=this.gamepadInputSources;this.gamepadInputSources={};let t=this.global.navigator.getGamepads();for(let i=0;i<t.length;++i){let r=t[i];if(r&&r.displayId>0){let t=e[i];if(t||(t=new ac(this,this.display,this.getPrimaryButtonIndex(r))),t.updateFromGamepad(r),this.gamepadInputSources[i]=t,-1!=t.primaryButtonIndex){let e=r.buttons[t.primaryButtonIndex].pressed;e&&!t.primaryActionPressed?this.dispatchEvent("@@webxr-polyfill/input-select-start",{sessionId:n.id,inputSource:t.inputSource}):!e&&t.primaryActionPressed&&this.dispatchEvent("@@webxr-polyfill/input-select-end",{sessionId:n.id,inputSource:t.inputSource}),t.primaryActionPressed=e}if(-1!=t.primarySqueezeButtonIndex){let e=r.buttons[t.primarySqueezeButtonIndex].pressed;e&&!t.primarySqueezeActionPressed?this.dispatchEvent("@@webxr-polyfill/input-squeeze-start",{sessionId:n.id,inputSource:t.inputSource}):!e&&t.primarySqueezeActionPressed&&this.dispatchEvent("@@webxr-polyfill/input-squeeze-end",{sessionId:n.id,inputSource:t.inputSource}),t.primarySqueezeActionPressed=e}}}}if(!n.immersive&&n.baseLayer){const e=n.baseLayer.context.canvas;wl(this.frame.leftProjectionMatrix,t.inlineVerticalFieldOfView,e.width/e.height,t.depthNear,t.depthFar)}}onFrameEnd(e){const t=this.sessions.get(e);if(!t.ended&&t.baseLayer){if(t.outputContext&&(!t.immersive||this.display.capabilities.hasExternalDisplay)){const e=t.immersive&&this.display.capabilities.hasExternalDisplay,n=t.baseLayer.context.canvas,i=e?n.width/2:n.width,r=n.height;{const e=t.outputContext.canvas,a=e.width,o=e.height,s=t.renderContext;this.HAS_BITMAP_SUPPORT?n.transferToImageBitmap?s.transferFromImageBitmap(n.transferToImageBitmap()):this.global.createImageBitmap(n,0,0,i,r,{resizeWidth:a,resizeHeight:o}).then(e=>s.transferFromImageBitmap(e)):s.drawImage(n,0,0,i,r,0,0,a,o)}}t.immersive&&t.baseLayer&&this.display.submitFrame()}}cancelAnimationFrame(e){this.display.cancelAnimationFrame(e)}async endSession(e){const t=this.sessions.get(e);if(!t.ended)return t.immersive?this.display.exitPresent():void(t.ended=!0)}doesSessionSupportReferenceSpace(e,t){const n=this.sessions.get(e);return!n.ended&&n.enabledFeatures.has(t)}requestStageBounds(){if(this.display.stageParameters){const e=this.display.stageParameters.sizeX,t=this.display.stageParameters.sizeZ,n=[];return n.push(-e/2),n.push(-t/2),n.push(e/2),n.push(-t/2),n.push(e/2),n.push(t/2),n.push(-e/2),n.push(t/2),n}return null}async requestFrameOfReferenceTransform(e,t){return("local-floor"===e||"bounded-floor"===e)&&this.display.stageParameters&&this.display.stageParameters.sittingToStandingTransform?this.display.stageParameters.sittingToStandingTransform:null}getProjectionMatrix(e){if("left"===e)return this.frame.leftProjectionMatrix;if("right"===e)return this.frame.rightProjectionMatrix;if("none"===e)return this.frame.leftProjectionMatrix;throw new Error("eye must be of type 'left' or 'right'")}getViewport(e,t,n,i){const r=this.sessions.get(e),{width:a,height:o}=n.context.canvas;if(!r.immersive)return i.x=i.y=0,i.width=a,i.height=o,!0;if("left"===t||"none"===t)i.x=0;else{if("right"!==t)return!1;i.x=a/2}return i.y=0,i.width=a/2,i.height=o,!0}getBasePoseMatrix(){let{position:e,orientation:t}=this.frame.pose;return e||t?(e||(e=this.tempVec3,e[0]=e[1]=e[2]=0),bl(this.baseModelMatrix,t,e),this.baseModelMatrix):this.baseModelMatrix}getBaseViewMatrix(e){if("left"===e||"none"===e)return this.frame.leftViewMatrix;if("right"===e)return this.frame.rightViewMatrix;throw new Error("eye must be of type 'left' or 'right'")}getInputSources(){let e=[];for(let t in this.gamepadInputSources)e.push(this.gamepadInputSources[t].inputSource);return e}getInputPose(e,t,n){if(!t)return null;for(let i in this.gamepadInputSources){let r=this.gamepadInputSources[i];if(r.inputSource===e)return r.getXRPose(t,n)}return null}onWindowResize(){}onVRDisplayPresentChange(e){this.display.isPresenting||this.sessions.forEach(e=>{if(e.immersive&&!e.ended){if(e.modifiedCanvasLayer){const t=e.baseLayer.context.canvas;document.body.removeChild(t),t.setAttribute("style","")}this.immersiveSession===e&&(this.immersiveSession=null),this.dispatchEvent("@@webxr-polyfill/vr-present-end",e.id)}})}}class hc extends cc{constructor(e,t){const n=new ju(t||{});super(e,n),this.display=n,this.frame={rightViewMatrix:new Float32Array(16),leftViewMatrix:new Float32Array(16),rightProjectionMatrix:new Float32Array(16),leftProjectionMatrix:new Float32Array(16),pose:null,timestamp:null}}}let dc=0;class fc{constructor(e,t){this.mode=e,this.enabledFeatures=t,this.ended=null,this.baseLayer=null,this.id=++dc}}class pc extends Gu{constructor(e){super(e),this.sessions=new Map,this.projectionMatrix=gl(),this.identityMatrix=gl()}onBaseLayerSet(e,t){this.sessions.get(e).baseLayer=t}isSessionSupported(e){return"inline"==e}isFeatureSupported(e){switch(e){case"viewer":return!0;default:return!1}}async requestSession(e,t){if(!this.isSessionSupported(e))return Promise.reject();const n=new fc(e,t);return this.sessions.set(n.id,n),Promise.resolve(n.id)}requestAnimationFrame(e){return window.requestAnimationFrame(e)}cancelAnimationFrame(e){window.cancelAnimationFrame(e)}onFrameStart(e,t){const n=this.sessions.get(e);if(n.baseLayer){const e=n.baseLayer.context.canvas;wl(this.projectionMatrix,t.inlineVerticalFieldOfView,e.width/e.height,t.depthNear,t.depthFar)}}onFrameEnd(e){}async endSession(e){this.sessions.get(e).ended=!0}doesSessionSupportReferenceSpace(e,t){const n=this.sessions.get(e);return!n.ended&&n.enabledFeatures.has(t)}requestStageBounds(){return null}async requestFrameOfReferenceTransform(e,t){return null}getProjectionMatrix(e){return this.projectionMatrix}getViewport(e,t,n,i){this.sessions.get(e);const{width:r,height:a}=n.context.canvas;return i.x=i.y=0,i.width=r,i.height=a,!0}getBasePoseMatrix(){return this.identityMatrix}getBaseViewMatrix(e){return this.identityMatrix}getInputSources(){return[]}getInputPose(e,t,n){return null}onWindowResize(){}}const mc=async function(e,t){if(t.webvr){let t=await async function(e){let t=null;if("getVRDisplays"in e.navigator)try{const n=await e.navigator.getVRDisplays();n&&n.length&&(t=new cc(e,n[0]))}catch(e){}return t}(e);if(t)return t}let n=(e=>{var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(e.navigator.userAgent||e.navigator.vendor||e.opera),t})(e);return n&&t.cardboard||!n&&t.allowCardboardOnDesktop?(e.VRFrameData||(e.VRFrameData=function(){this.rightViewMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.leftProjectionMatrix=new Float32Array(16),this.pose=null}),new hc(e,t.cardboardConfig)):new pc(e)},gc={global:dl,webvr:!0,cardboard:!0,cardboardConfig:null,allowCardboardOnDesktop:!1},vc=["navigator","HTMLCanvasElement","WebGLRenderingContext"];class yc{constructor(e={}){this.config=Object.freeze(Object.assign({},gc,e)),this.global=this.config.global,this.nativeWebXR="xr"in this.global.navigator,this.injected=!1,this.nativeWebXR?this._injectCompatibilityShims(this.global):this._injectPolyfill(this.global)}_injectPolyfill(e){if(!vc.every(t=>!!e[t]))throw new Error("Global must have the following attributes : "+vc);for(const t of Object.keys(Ou))void 0!==e[t]?console.warn(t+" already defined on global."):e[t]=Ou[t];Nu(e.WebGLRenderingContext)&&(ku(e.HTMLCanvasElement),e.OffscreenCanvas&&ku(e.OffscreenCanvas),e.WebGL2RenderingContext&&Nu(e.WebGL2RenderingContext),window.isSecureContext||console.warn("WebXR Polyfill Warning:\nThis page is not running in a secure context (https:// or localhost)!\nThis means that although the page may be able to use the WebXR Polyfill it will\nnot be able to use native WebXR implementations, and as such will not be able to\naccess dedicated VR or AR hardware, and will not be able to take advantage of\nany performance improvements a native WebXR implementation may offer. Please\nhost this content on a secure origin for the best user experience.\n"));this.injected=!0,this._patchNavigatorXR()}_patchNavigatorXR(){let e=mc(this.global,this.config);this.xr=new Ou.XR(e),Object.defineProperty(this.global.navigator,"xr",{value:this.xr,configurable:!0})}_injectCompatibilityShims(e){if(!vc.every(t=>!!e[t]))throw new Error("Global must have the following attributes : "+vc);if(e.navigator.xr&&"supportsSession"in e.navigator.xr&&!("isSessionSupported"in e.navigator.xr)){let t=e.navigator.xr.supportsSession;e.navigator.xr.isSessionSupported=function(e){return t.call(this,e).then(()=>!0).catch(()=>!1)},e.navigator.xr.supportsSession=function(e){return console.warn("navigator.xr.supportsSession() is deprecated. Please call navigator.xr.isSessionSupported() instead and check the boolean value returned when the promise resolves."),t.call(this,e)}}}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t});var _c=0,bc=1,Ec=2,Tc=0,wc=1,xc=2,Ac=3;function Sc(){}Object.assign(Sc.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,e)}}}});for(var Mc=[],Cc=0;Cc<256;Cc++)Mc[Cc]=(Cc<16?"0":"")+Cc.toString(16);var Rc,Ic={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Mc[255&e]+Mc[e>>8&255]+Mc[e>>16&255]+Mc[e>>24&255]+"-"+Mc[255&t]+Mc[t>>8&255]+"-"+Mc[t>>16&15|64]+Mc[t>>24&255]+"-"+Mc[63&n|128]+Mc[n>>8&255]+"-"+Mc[n>>16&255]+Mc[n>>24&255]+Mc[255&i]+Mc[i>>8&255]+Mc[i>>16&255]+Mc[i>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ic.DEG2RAD},radToDeg:function(e){return e*Ic.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+i)/2),c=o((t+i)/2),h=a((t-i)/2),d=o((t-i)/2),f=a((i-t)/2),p=o((i-t)/2);"XYX"===r?e.set(s*c,l*h,l*d,s*u):"YZY"===r?e.set(l*d,s*c,l*h,s*u):"ZXZ"===r?e.set(l*h,l*d,s*c,s*u):"XZX"===r?e.set(s*c,l*p,l*f,s*u):"YXY"===r?e.set(l*f,s*c,l*p,s*u):"ZYZ"===r?e.set(l*p,l*f,s*c,s*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Pc(e,t){this.x=e||0,this.y=t||0}function Lc(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Pc.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Pc.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*n-a*i+e.x,this.y=r*i+a*n+e.y,this}}),Object.assign(Lc.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=r,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},extractBasis:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],E=i[5],T=i[8];return r[0]=a*p+o*v+s*b,r[3]=a*m+o*y+s*E,r[6]=a*g+o*_+s*T,r[1]=l*p+u*v+c*b,r[4]=l*m+u*y+c*E,r[7]=l*g+u*_+c*T,r[2]=h*p+d*v+f*b,r[5]=h*m+d*y+f*E,r[8]=h*g+d*_+f*T,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*r*u+n*o*s+i*r*l-i*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=d*l-u*h,p=u*c-d*s,m=h*s-l*c,g=r*f+a*p+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return i[0]=f*y,i[1]=(o*h-d*a)*y,i[2]=(u*a-o*l)*y,i[3]=p*y,i[4]=(d*r-o*c)*y,i[5]=(o*s-u*r)*y,i[6]=m*y,i[7]=(a*c-h*r)*y,i[8]=(l*r-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,a,o){var s=Math.cos(r),l=Math.sin(r);this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-i*l,i*s,-i*(-l*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],u=i[7];return i[0]=t*r+n*s,i[3]=t*a+n*l,i[6]=t*o+n*u,i[1]=-n*r+t*s,i[4]=-n*a+t*l,i[7]=-n*o+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Dc={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Rc&&(Rc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Rc.width=e.width,Rc.height=e.height;var n=Rc.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Rc}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Oc=0;function Nc(e,t,n,i,r,a,o,s,l,u){Object.defineProperty(this,"id",{value:Oc++}),this.uuid=Ic.generateUUID(),this.name="",this.image=void 0!==e?e:Nc.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Nc.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==i?i:1001,this.magFilter=void 0!==r?r:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:1023,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new Pc(0,0),this.repeat=new Pc(1,1),this.center=new Pc(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Lc,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function kc(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1}function Fc(e,t,n){this.width=e,this.height=t,this.scissor=new kc(0,0,e,t),this.scissorTest=!1,this.viewport=new kc(0,0,e,t),n=n||{},this.texture=new Nc(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Bc(e,t,n){Fc.call(this,e,t,n),this.samples=4}function Uc(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==i?i:1}Nc.DEFAULT_IMAGE=void 0,Nc.DEFAULT_MAPPING=300,Nc.prototype=Object.assign(Object.create(Sc.prototype),{constructor:Nc,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var i=this.image;if(void 0===i.uuid&&(i.uuid=Ic.generateUUID()),!t&&void 0===e.images[i.uuid]){var r;if(Array.isArray(i)){r=[];for(var a=0,o=i.length;a<o;a++)r.push(Dc.getDataURL(i[a]))}else r=Dc.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Nc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(kc.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(kc.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,a=e.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],f=a[6],p=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(c+1)/2,v=(p+1)/2,y=(s+u)/4,_=(l+d)/4,b=(h+f)/4;return m>g&&m>v?m<.01?(n=0,i=.707106781,r=.707106781):(i=y/(n=Math.sqrt(m)),r=_/n):g>v?g<.01?(n=.707106781,i=0,r=.707106781):(n=y/(i=Math.sqrt(g)),r=b/i):v<.01?(n=.707106781,i=.707106781,r=0):(n=_/(r=Math.sqrt(v)),i=b/r),this.set(n,i,r,t),this}var E=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(E)<.001&&(E=1),this.x=(f-h)/E,this.y=(l-d)/E,this.z=(u-s)/E,this.w=Math.acos((o+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Fc.prototype=Object.assign(Object.create(Sc.prototype),{constructor:Fc,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Bc.prototype=Object.assign(Object.create(Fc.prototype),{constructor:Bc,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Fc.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Uc,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,a,o){var s=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3],h=r[a+0],d=r[a+1],f=r[a+2],p=r[a+3];if(c!==p||s!==h||l!==d||u!==f){var m=1-o,g=s*h+l*d+u*f+c*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,o=Math.sin(o*b)/_}var E=o*v;if(s=s*m+h*E,l=l*m+d*E,u=u*m+f*E,c=c*m+p*E,m===1-o){var T=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=T,l*=T,u*=T,c*=T}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(Uc.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Uc.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z,a=e.order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(i/2),c=o(r/2),h=s(n/2),d=s(i/2),f=s(r/2);return"XYZ"===a?(this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f):"YXZ"===a?(this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f):"ZXY"===a?(this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f):"ZYX"===a?(this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f):"YZX"===a?(this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f):"XZY"===a&&(this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],r=n[4],a=n[8],o=n[1],s=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=i+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-l)*t,this._y=(a-u)*t,this._z=(o-r)*t):i>s&&i>h?(t=2*Math.sqrt(1+i-s-h),this._w=(c-l)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(a+u)/t):s>h?(t=2*Math.sqrt(1+s-i-h),this._w=(a-u)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+h-i-s),this._w=(o-r)/t,this._x=(a+u)/t,this._y=(l+c)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Ic.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var i=Math.min(1,t/n);return this.slerp(e,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+i*l-r*s,this._y=i*u+a*s+r*o-n*l,this._z=r*u+a*l+n*s-i*o,this._w=a*u-n*o-i*s-r*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,i=this._y,r=this._z,a=this._w,o=a*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*i+t*this._y,this._z=l*r+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=i*h+this._y*d,this._z=r*h+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var jc=new zc,Gc=new Uc;function zc(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(zc.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Gc.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Gc.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,a=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*n,u=s*n+o*t-r*i,c=s*i+r*n-a*t,h=-r*t-a*n-o*i;return this.x=l*s+h*-r+u*-o-c*-a,this.y=u*s+h*-a+c*-r-l*-o,this.z=c*s+h*-o+l*-a-u*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this},projectOnVector:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return jc.copy(this).projectOnVector(e),this.sub(jc)},reflect:function(e){return this.sub(jc.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Ic.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var Hc=new zc,Vc=new Qc,Wc=new zc(0,0,0),qc=new zc(1,1,1),Yc=new zc,Xc=new zc,Kc=new zc;function Qc(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Qc.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Qc).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,i=1/Hc.setFromMatrixColumn(e,0).length(),r=1/Hc.setFromMatrixColumn(e,1).length(),a=1/Hc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===e.order){var h=a*u,d=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-o*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m-y*o,t[4]=-a*c,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*u,t[9]=y-m*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){h=a*u,d=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=f*l-d,t[8]=h*l+p,t[1]=s*c,t[5]=p*l+h,t[9]=d*l-f,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var _=a*s,b=a*l,E=o*s,T=o*l;t[0]=s*u,t[4]=T-_*c,t[8]=E*c+b,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=b*c+E,t[10]=_-T*c}else if("XZY"===e.order){_=a*s,b=a*l,E=o*s,T=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=_*c+T,t[5]=a*u,t[9]=b*c-E,t[2]=E*c-b,t[6]=o*u,t[10]=T*c+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(Wc,e,qc)},lookAt:function(e,t,n){var i=this.elements;return Kc.subVectors(e,t),0===Kc.lengthSq()&&(Kc.z=1),Kc.normalize(),Yc.crossVectors(n,Kc),0===Yc.lengthSq()&&(1===Math.abs(n.z)?Kc.x+=1e-4:Kc.z+=1e-4,Kc.normalize(),Yc.crossVectors(n,Kc)),Yc.normalize(),Xc.crossVectors(Kc,Yc),i[0]=Yc.x,i[4]=Xc.x,i[8]=Kc.x,i[1]=Yc.y,i[5]=Xc.y,i[9]=Kc.y,i[2]=Yc.z,i[6]=Xc.z,i[10]=Kc.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],E=i[0],T=i[4],w=i[8],x=i[12],A=i[1],S=i[5],M=i[9],C=i[13],R=i[2],I=i[6],P=i[10],L=i[14],D=i[3],O=i[7],N=i[11],k=i[15];return r[0]=a*E+o*A+s*R+l*D,r[4]=a*T+o*S+s*I+l*O,r[8]=a*w+o*M+s*P+l*N,r[12]=a*x+o*C+s*L+l*k,r[1]=u*E+c*A+h*R+d*D,r[5]=u*T+c*S+h*I+d*O,r[9]=u*w+c*M+h*P+d*N,r[13]=u*x+c*C+h*L+d*k,r[2]=f*E+p*A+m*R+g*D,r[6]=f*T+p*S+m*I+g*O,r[10]=f*w+p*M+m*P+g*N,r[14]=f*x+p*C+m*L+g*k,r[3]=v*E+y*A+_*R+b*D,r[7]=v*T+y*S+_*I+b*O,r[11]=v*w+y*M+_*P+b*N,r[15]=v*x+y*C+_*L+b*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+r*s*c-i*l*c-r*o*h+n*l*h+i*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*a*h-i*a*d+i*l*u-r*s*u)+e[11]*(+t*l*c-t*o*d-r*a*c+n*a*d+r*o*u-n*l*u)+e[15]*(-i*o*u-t*s*c+t*o*h+i*a*c-n*a*h+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],u=i[5],c=i[6],h=i[7],d=i[8],f=i[9],p=i[10],m=i[11],g=i[12],v=i[13],y=i[14],_=i[15],b=f*y*h-v*p*h+v*c*m-u*y*m-f*c*_+u*p*_,E=g*p*h-d*y*h-g*c*m+l*y*m+d*c*_-l*p*_,T=d*v*h-g*f*h+g*u*m-l*v*m-d*u*_+l*f*_,w=g*f*c-d*v*c-g*u*p+l*v*p+d*u*y-l*f*y,x=r*b+a*E+o*T+s*w;if(0===x){var A="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var S=1/x;return n[0]=b*S,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*_-a*p*_)*S,n[2]=(u*y*s-v*c*s+v*o*h-a*y*h-u*o*_+a*c*_)*S,n[3]=(f*c*s-u*p*s-f*o*h+a*p*h+u*o*m-a*c*m)*S,n[4]=E*S,n[5]=(d*y*s-g*p*s+g*o*m-r*y*m-d*o*_+r*p*_)*S,n[6]=(g*c*s-l*y*s-g*o*h+r*y*h+l*o*_-r*c*_)*S,n[7]=(l*p*s-d*c*s+d*o*h-r*p*h-l*o*m+r*c*m)*S,n[8]=T*S,n[9]=(g*f*s-d*v*s-g*a*m+r*v*m+d*a*_-r*f*_)*S,n[10]=(l*v*s-g*u*s+g*a*h-r*v*h-l*a*_+r*u*_)*S,n[11]=(d*u*s-l*f*s-d*a*h+r*f*h+l*a*m-r*u*m)*S,n[12]=w*S,n[13]=(d*v*o-g*f*o+g*a*p-r*v*p-d*a*y+r*f*y)*S,n[14]=(g*u*o-l*v*o-g*a*c+r*v*c+l*a*y-r*u*y)*S,n[15]=(l*f*o-d*u*o+d*a*c-r*f*c-l*a*p+r*u*p)*S,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,a=e.x,o=e.y,s=e.z,l=r*a,u=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,u*o+n,u*s-i*a,0,l*s-i*o,u*s+i*a,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var i=this.elements,r=t._x,a=t._y,o=t._z,s=t._w,l=r+r,u=a+a,c=o+o,h=r*l,d=r*u,f=r*c,p=a*u,m=a*c,g=o*c,v=s*l,y=s*u,_=s*c,b=n.x,E=n.y,T=n.z;return i[0]=(1-(p+g))*b,i[1]=(d+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(d-_)*E,i[5]=(1-(h+g))*E,i[6]=(m+v)*E,i[7]=0,i[8]=(f+y)*T,i[9]=(m-v)*T,i[10]=(1-(h+p))*T,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:function(e,t,n){var i=this.elements,r=Hc.set(i[0],i[1],i[2]).length(),a=Hc.set(i[4],i[5],i[6]).length(),o=Hc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Vc.copy(this);var s=1/r,l=1/a,u=1/o;return Vc.elements[0]*=s,Vc.elements[1]*=s,Vc.elements[2]*=s,Vc.elements[4]*=l,Vc.elements[5]*=l,Vc.elements[6]*=l,Vc.elements[8]*=u,Vc.elements[9]*=u,Vc.elements[10]*=u,t.setFromRotationMatrix(Vc),n.x=r,n.y=a,n.z=o,this},makePerspective:function(e,t,n,i,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,i,r,a){var o=this.elements,s=1/(t-e),l=1/(n-i),u=1/(a-r),c=(t+e)*s,h=(n+i)*l,d=(a+r)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var Zc=new Qc,Jc=new Uc;function $c(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||$c.DefaultOrder}function eh(){this.mask=1}$c.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],$c.DefaultOrder="XYZ",Object.defineProperties($c.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign($c.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=Ic.clamp,r=e.elements,a=r[0],o=r[4],s=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],f=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u))):"YZX"===t?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return Zc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Zc,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Jc.setFromEuler(this),this.setFromQuaternion(Jc,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new zc(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(eh.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});var th=0,nh=new zc,ih=new Uc,rh=new Qc,ah=new zc,oh=new zc,sh=new zc,lh=new Uc,uh=new zc(1,0,0),ch=new zc(0,1,0),hh=new zc(0,0,1),dh={type:"added"},fh={type:"removed"};function ph(){Object.defineProperty(this,"id",{value:th++}),this.uuid=Ic.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ph.DefaultUp.clone();var e=new zc,t=new $c,n=new Uc,i=new zc(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Qc},normalMatrix:{value:new Lc}}),this.matrix=new Qc,this.matrixWorld=new Qc,this.matrixAutoUpdate=ph.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new eh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function mh(){ph.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ph.DefaultUp=new zc(0,1,0),ph.DefaultMatrixAutoUpdate=!0,ph.prototype=Object.assign(Object.create(Sc.prototype),{constructor:ph,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.multiply(ih),this},rotateOnWorldAxis:function(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.premultiply(ih),this},rotateX:function(e){return this.rotateOnAxis(uh,e)},rotateY:function(e){return this.rotateOnAxis(ch,e)},rotateZ:function(e){return this.rotateOnAxis(hh,e)},translateOnAxis:function(e,t){return nh.copy(e).applyQuaternion(this.quaternion),this.position.add(nh.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(uh,e)},translateY:function(e){return this.translateOnAxis(ch,e)},translateZ:function(e){return this.translateOnAxis(hh,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(rh.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?ah.copy(e):ah.set(e,t,n);var i=this.parent;this.updateWorldMatrix(!0,!1),oh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rh.lookAt(oh,ah,this.up):rh.lookAt(ah,oh,this.up),this.quaternion.setFromRotationMatrix(rh),i&&(rh.extractRotation(i.matrixWorld),ih.setFromRotationMatrix(rh),this.quaternion.premultiply(ih.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(dh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(fh)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),rh.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),rh.multiply(e.parent.matrixWorld)),e.applyMatrix4(rh),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new zc),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Uc),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oh,e,sh),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new zc),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oh,lh,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new zc),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var i=this.children,r=0,a=i.length;r<a;r++)i[r].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];r(e.shapes,u)}else r(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(r(e.materials,this.material[s]));i.material=c}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),d=m(e.materials),f=m(e.textures),p=m(e.images);o=m(e.shapes);h.length>0&&(n.geometries=h),d.length>0&&(n.materials=d),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=i,n;function m(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}}),mh.prototype=Object.assign(Object.create(ph.prototype),{constructor:mh,isScene:!0,copy:function(e,t){return ph.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=ph.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var gh=[new zc,new zc,new zc,new zc,new zc,new zc,new zc,new zc],vh=new zc,yh=new Rh,_h=new zc,bh=new zc,Eh=new zc,Th=new zc,wh=new zc,xh=new zc,Ah=new zc,Sh=new zc,Mh=new zc,Ch=new zc;function Rh(e,t){this.min=void 0!==e?e:new zc(1/0,1/0,1/0),this.max=void 0!==t?t:new zc(-1/0,-1/0,-1/0)}function Ih(e,t,n,i,r){var a,o;for(a=0,o=e.length-3;a<=o;a+=3){Ch.fromArray(e,a);var s=r.x*Math.abs(Ch.x)+r.y*Math.abs(Ch.y)+r.z*Math.abs(Ch.z),l=t.dot(Ch),u=n.dot(Ch),c=i.dot(Ch);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}Object.assign(Rh.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<n&&(n=c),h<i&&(i=h),u>r&&(r=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=vh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new zc),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new zc),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),yh.copy(t.boundingBox),yh.applyMatrix4(e.matrixWorld),this.union(yh));for(var n=e.children,i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new zc),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,vh),vh.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Ah),Sh.subVectors(this.max,Ah),_h.subVectors(e.a,Ah),bh.subVectors(e.b,Ah),Eh.subVectors(e.c,Ah),Th.subVectors(bh,_h),wh.subVectors(Eh,bh),xh.subVectors(_h,Eh);var t=[0,-Th.z,Th.y,0,-wh.z,wh.y,0,-xh.z,xh.y,Th.z,0,-Th.x,wh.z,0,-wh.x,xh.z,0,-xh.x,-Th.y,Th.x,0,-wh.y,wh.x,0,-xh.y,xh.x,0];return!!Ih(t,_h,bh,Eh,Sh)&&(!!Ih(t=[1,0,0,0,1,0,0,0,1],_h,bh,Eh,Sh)&&(Mh.crossVectors(Th,wh),Ih(t=[Mh.x,Mh.y,Mh.z],_h,bh,Eh,Sh)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new zc),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return vh.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(vh).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(gh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gh)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Ph=new Rh;function Lh(e,t){this.center=void 0!==e?e:new zc,this.radius=void 0!==t?t:0}Object.assign(Lh.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;void 0!==t?n.copy(t):Ph.setFromPoints(e).getCenter(n);for(var i=0,r=0,a=e.length;r<a;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new zc),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Rh),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Dh=new zc,Oh=new zc,Nh=new zc,kh=new zc,Fh=new zc,Bh=new zc,Uh=new zc;function jh(e,t){this.origin=void 0!==e?e:new zc,this.direction=void 0!==t?t:new zc(0,0,-1)}Object.assign(jh.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new zc),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Dh)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new zc),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=Dh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Dh.copy(this.direction).multiplyScalar(t).add(this.origin),Dh.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,i){Oh.copy(e).add(t).multiplyScalar(.5),Nh.copy(t).sub(e).normalize(),kh.copy(this.origin).sub(Oh);var r,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(Nh),c=kh.dot(this.direction),h=-kh.dot(Nh),d=kh.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*c-h,s=l*f,(r=u*h-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(r*=p)*(r+u*(a*=p)+2*c)+a*(u*r+a+2*h)+d}else a=l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;else a=-l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;else a<=-s?o=-(r=Math.max(0,-(-u*l+c)))*r+(a=r>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(r=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(r=Math.max(0,-(u*l+c)))*r+(a=r>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(r=Math.max(0,-(u*a+c)))*r+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(Nh).multiplyScalar(a).add(Oh),o},intersectSphere:function(e,t){Dh.subVectors(e.center,this.origin);var n=Dh.dot(this.direction),i=Dh.dot(Dh)-n*n,r=e.radius*e.radius;if(i>r)return null;var a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,i,r,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),u>=0?(r=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(r=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||r>i?null:((r>n||n!=n)&&(n=r),(a<i||i!=i)&&(i=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>i?null:((o>n||n!=n)&&(n=o),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Dh)},intersectTriangle:function(e,t,n,i,r){Fh.subVectors(t,e),Bh.subVectors(n,e),Uh.crossVectors(Fh,Bh);var a,o=this.direction.dot(Uh);if(o>0){if(i)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}kh.subVectors(this.origin,e);var s=a*this.direction.dot(Bh.crossVectors(kh,Bh));if(s<0)return null;var l=a*this.direction.dot(Fh.cross(kh));if(l<0)return null;if(s+l>o)return null;var u=-a*kh.dot(Uh);return u<0?null:this.at(u/o,r)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Gh=new zc,zh=new zc,Hh=new Lc;function Vh(e,t){this.normal=void 0!==e?e:new zc(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Vh.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){var i=Gh.subVectors(n,t).cross(zh.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new zc),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new zc);var n=e.delta(Gh),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?void 0:t.copy(n).multiplyScalar(r).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new zc),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var n=t||Hh.getNormalMatrix(e),i=this.coplanarPoint(Gh).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var Wh=new zc,qh=new zc,Yh=new zc,Xh=new zc,Kh=new zc,Qh=new zc,Zh=new zc,Jh=new zc,$h=new zc,ed=new zc;function td(e,t,n){this.a=void 0!==e?e:new zc,this.b=void 0!==t?t:new zc,this.c=void 0!==n?n:new zc}Object.assign(td,{getNormal:function(e,t,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new zc),i.subVectors(n,t),Wh.subVectors(e,t),i.cross(Wh);var r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)},getBarycoord:function(e,t,n,i,r){Wh.subVectors(i,t),qh.subVectors(n,t),Yh.subVectors(e,t);var a=Wh.dot(Wh),o=Wh.dot(qh),s=Wh.dot(Yh),l=qh.dot(qh),u=qh.dot(Yh),c=a*l-o*o;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new zc),0===c)return r.set(-2,-1,-1);var h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return r.set(1-d-f,f,d)},containsPoint:function(e,t,n,i){return td.getBarycoord(e,t,n,i,Xh),Xh.x>=0&&Xh.y>=0&&Xh.x+Xh.y<=1},getUV:function(e,t,n,i,r,a,o,s){return this.getBarycoord(e,t,n,i,Xh),s.set(0,0),s.addScaledVector(r,Xh.x),s.addScaledVector(a,Xh.y),s.addScaledVector(o,Xh.z),s},isFrontFacing:function(e,t,n,i){return Wh.subVectors(n,t),qh.subVectors(e,t),Wh.cross(qh).dot(i)<0}}),Object.assign(td.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return Wh.subVectors(this.c,this.b),qh.subVectors(this.a,this.b),.5*Wh.cross(qh).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new zc),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return td.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Vh),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return td.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,i,r){return td.getUV(e,this.a,this.b,this.c,t,n,i,r)},containsPoint:function(e){return td.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return td.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new zc);var n,i,r=this.a,a=this.b,o=this.c;Kh.subVectors(a,r),Qh.subVectors(o,r),Jh.subVectors(e,r);var s=Kh.dot(Jh),l=Qh.dot(Jh);if(s<=0&&l<=0)return t.copy(r);$h.subVectors(e,a);var u=Kh.dot($h),c=Qh.dot($h);if(u>=0&&c<=u)return t.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(r).addScaledVector(Kh,n);ed.subVectors(e,o);var d=Kh.dot(ed),f=Qh.dot(ed);if(f>=0&&d<=f)return t.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return i=l/(l-f),t.copy(r).addScaledVector(Qh,i);var m=u*f-d*c;if(m<=0&&c-u>=0&&d-f>=0)return Zh.subVectors(o,a),i=(c-u)/(c-u+(d-f)),t.copy(a).addScaledVector(Zh,i);var g=1/(m+p+h);return n=p*g,i=h*g,t.copy(r).addScaledVector(Kh,n).addScaledVector(Qh,i)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var nd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},id={h:0,s:0,l:0},rd={h:0,s:0,l:0};function ad(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function od(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function sd(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ld(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function ud(e,t,n,i,r,a){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new zc,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new ad,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Object.assign(ad.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Ic.euclideanModulo(e,1),t=Ic.clamp(t,0,1),n=Ic.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=od(r,i,e+1/3),this.g=od(r,i,e),this.b=od(r,i,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,r=n[1],a=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=nd[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=sd(e.r),this.g=sd(e.g),this.b=sd(e.b),this},copyLinearToSRGB:function(e){return this.r=ld(e.r),this.g=ld(e.g),this.b=ld(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,i=this.r,r=this.g,a=this.b,o=Math.max(i,r,a),s=Math.min(i,r,a),l=(s+o)/2;if(s===o)t=0,n=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case i:t=(r-a)/u+(r<a?6:0);break;case r:t=(a-i)/u+2;break;case a:t=(i-r)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(id),id.h+=e,id.s+=t,id.l+=n,this.setHSL(id.h,id.s,id.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(id),e.getHSL(rd);var n=Ic.lerp(id.h,rd.h,t),i=Ic.lerp(id.s,rd.s,t),r=Ic.lerp(id.l,rd.l,t);return this.setHSL(n,i,r),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),ad.NAMES=nd,Object.assign(ud.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var cd=0;function hd(){Object.defineProperty(this,"id",{value:cd++}),this.uuid=Ic.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function dd(e){hd.call(this),this.type="MeshBasicMaterial",this.color=new ad(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}hd.prototype=Object.assign(Object.create(Sc.prototype),{constructor:hd,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var r=i(e.textures),a=i(e.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var i=t.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(hd.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),dd.prototype=Object.create(hd.prototype),dd.prototype.constructor=dd,dd.prototype.isMeshBasicMaterial=!0,dd.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var fd=new zc;function pd(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function md(e,t,n){pd.call(this,new Int8Array(e),t,n)}function gd(e,t,n){pd.call(this,new Uint8Array(e),t,n)}function vd(e,t,n){pd.call(this,new Uint8ClampedArray(e),t,n)}function yd(e,t,n){pd.call(this,new Int16Array(e),t,n)}function _d(e,t,n){pd.call(this,new Uint16Array(e),t,n)}function bd(e,t,n){pd.call(this,new Int32Array(e),t,n)}function Ed(e,t,n){pd.call(this,new Uint32Array(e),t,n)}function Td(e,t,n){pd.call(this,new Float32Array(e),t,n)}function wd(e,t,n){pd.call(this,new Float64Array(e),t,n)}function xd(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ad(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(pd.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pd.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new ad),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new Pc),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new zc),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new kc),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)fd.x=this.getX(t),fd.y=this.getY(t),fd.z=this.getZ(t),fd.applyMatrix3(e),this.setXYZ(t,fd.x,fd.y,fd.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)fd.x=this.getX(t),fd.y=this.getY(t),fd.z=this.getZ(t),fd.applyMatrix4(e),this.setXYZ(t,fd.x,fd.y,fd.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)fd.x=this.getX(t),fd.y=this.getY(t),fd.z=this.getZ(t),fd.applyNormalMatrix(e),this.setXYZ(t,fd.x,fd.y,fd.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)fd.x=this.getX(t),fd.y=this.getY(t),fd.z=this.getZ(t),fd.transformDirection(e),this.setXYZ(t,fd.x,fd.y,fd.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),md.prototype=Object.create(pd.prototype),md.prototype.constructor=md,gd.prototype=Object.create(pd.prototype),gd.prototype.constructor=gd,vd.prototype=Object.create(pd.prototype),vd.prototype.constructor=vd,yd.prototype=Object.create(pd.prototype),yd.prototype.constructor=yd,_d.prototype=Object.create(pd.prototype),_d.prototype.constructor=_d,bd.prototype=Object.create(pd.prototype),bd.prototype.constructor=bd,Ed.prototype=Object.create(pd.prototype),Ed.prototype.constructor=Ed,Td.prototype=Object.create(pd.prototype),Td.prototype.constructor=Td,wd.prototype=Object.create(pd.prototype),wd.prototype.constructor=wd,Object.assign(xd.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,r=e.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==i&&(i=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:i})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var u=0;u<l;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var c,h=e.morphNormals,d=h.length;if(d>0){c=[];for(u=0;u<d;u++)c[u]={name:h[u].name,data:[]};this.morphTargets.normal=c}var f=e.skinIndices,p=e.skinWeights,m=f.length===i.length,g=p.length===i.length;i.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b,E=v.vertexColors;if(3===E.length)this.colors.push(E[0],E[1],E[2]);else{var T=v.color;this.colors.push(T,T,T)}if(!0===a)void 0!==(b=r[0][u])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Pc,new Pc,new Pc));if(!0===o)void 0!==(b=r[1][u])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Pc,new Pc,new Pc));for(var w=0;w<l;w++){var x=s[w].vertices;t[w].data.push(x[v.a],x[v.b],x[v.c])}for(w=0;w<d;w++){var A=h[w].vertexNormals[u];c[w].data.push(A.a,A.b,A.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var Sd=1,Md=new Qc,Cd=new ph,Rd=new zc,Id=new Rh,Pd=new Rh,Ld=new zc;function Dd(){Object.defineProperty(this,"id",{value:Sd+=2}),this.uuid=Ic.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Dd.prototype=Object.assign(Object.create(Sc.prototype),{constructor:Dd,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Ad(e)>65535?Ed:_d)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new Lc).getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}var r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Md.makeRotationX(e),this.applyMatrix4(Md),this},rotateY:function(e){return Md.makeRotationY(e),this.applyMatrix4(Md),this},rotateZ:function(e){return Md.makeRotationZ(e),this.applyMatrix4(Md),this},translate:function(e,t,n){return Md.makeTranslation(e,t,n),this.applyMatrix4(Md),this},scale:function(e,t,n){return Md.makeScale(e,t,n),this.applyMatrix4(Md),this},lookAt:function(e){return Cd.lookAt(e),Cd.updateMatrix(),this.applyMatrix4(Cd.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rd).negate(),this.translate(Rd.x,Rd.y,Rd.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new Td(3*t.vertices.length,3),i=new Td(3*t.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new Td(t.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Td(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new xd).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new pd(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.setAttribute("normal",new pd(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(3*e.colors.length);this.setAttribute("color",new pd(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new pd(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new pd(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[o],u=0,c=l.length;u<c;u++){var h=l[u],d=new Td(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var f=new Td(4*e.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new Td(4*e.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Rh);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,i=t.length;n<i;n++){var r=t[n];Id.setFromBufferAttribute(r),this.morphTargetsRelative?(Ld.addVectors(this.boundingBox.min,Id.min),this.boundingBox.expandByPoint(Ld),Ld.addVectors(this.boundingBox.max,Id.max),this.boundingBox.expandByPoint(Ld)):(this.boundingBox.expandByPoint(Id.min),this.boundingBox.expandByPoint(Id.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Lh);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(Id.setFromBufferAttribute(e),t)for(var i=0,r=t.length;i<r;i++){var a=t[i];Pd.setFromBufferAttribute(a),this.morphTargetsRelative?(Ld.addVectors(Id.min,Pd.min),Id.expandByPoint(Ld),Ld.addVectors(Id.max,Pd.max),Id.expandByPoint(Ld)):(Id.expandByPoint(Pd.min),Id.expandByPoint(Pd.max))}Id.getCenter(n);var o=0;for(i=0,r=e.count;i<r;i++)Ld.fromBufferAttribute(e,i),o=Math.max(o,n.distanceToSquared(Ld));if(t)for(i=0,r=t.length;i<r;i++){a=t[i];for(var s=this.morphTargetsRelative,l=0,u=a.count;l<u;l++)Ld.fromBufferAttribute(a,l),s&&(Rd.fromBufferAttribute(e,l),Ld.add(Rd)),o=Math.max(o,n.distanceToSquared(Ld))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.setAttribute("normal",new pd(new Float32Array(n.length),3));else for(var i=t.normal.array,r=0,a=i.length;r<a;r++)i[r]=0;var o,s,l,u=t.normal.array,c=new zc,h=new zc,d=new zc,f=new zc,p=new zc;if(e){var m=e.array;for(r=0,a=e.count;r<a;r+=3)o=3*m[r+0],s=3*m[r+1],l=3*m[r+2],c.fromArray(n,o),h.fromArray(n,s),d.fromArray(n,l),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[o]+=f.x,u[o+1]+=f.y,u[o+2]+=f.z,u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z}else for(r=0,a=n.length;r<a;r+=9)c.fromArray(n,r),h.fromArray(n,r+3),d.fromArray(n,r+6),f.subVectors(d,h),p.subVectors(c,h),f.cross(p),u[r]=f.x,u[r+1]=f.y,u[r+2]=f.z,u[r+3]=f.x,u[r+4]=f.y,u[r+5]=f.z,u[r+6]=f.x,u[r+7]=f.y,u[r+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var r=n[i].array,a=e.attributes[i],o=a.array,s=a.itemSize*t,l=Math.min(o.length,r.length-s),u=0,c=s;u<l;u++,c++)r[c]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Ld.x=e.getX(t),Ld.y=e.getY(t),Ld.z=e.getZ(t),Ld.normalize(),e.setXYZ(t,Ld.x,Ld.y,Ld.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,i=e.itemSize,r=new n.constructor(t.length*i),a=0,o=0,s=0,l=t.length;s<l;s++){a=t[s]*i;for(var u=0;u<i;u++)r[o++]=n[a++]}return new pd(r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Dd,n=this.index.array,i=this.attributes;for(var r in i){var a=e(i[r],n);t.setAttribute(r,a)}var o=this.morphAttributes;for(r in o){for(var s=[],l=o[r],u=0,c=l.length;u<c;u++){a=e(l[u],n);s.push(a)}t.morphAttributes[r]=s}t.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,d=(u=0,h.length);u<d;u++){var f=h[u];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;null!==i&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var r=this.attributes;for(var n in r){var a=(d=r[n]).toJSON();""!==d.name&&(a.name=d.name),e.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var l=this.morphAttributes[n],u=[],c=0,h=l.length;c<h;c++){var d;a=(d=l[c]).toJSON();""!==d.name&&(a.name=d.name),u.push(a)}u.length>0&&(o[n]=u,s=!0)}s&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(e.data.groups=JSON.parse(JSON.stringify(f)));var p=this.boundingSphere;return null!==p&&(e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),e},clone:function(){return(new Dd).copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var a=e.attributes;for(t in a){var o=a[t];this.setAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(n=0,i=u.length;n<i;n++)l.push(u[n].clone());this.morphAttributes[t]=l}this.morphTargetsRelative=e.morphTargetsRelative;var c=e.groups;for(n=0,i=c.length;n<i;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Od=new Qc,Nd=new jh,kd=new Lh,Fd=new zc,Bd=new zc,Ud=new zc,jd=new zc,Gd=new zc,zd=new zc,Hd=new zc,Vd=new zc,Wd=new zc,qd=new Pc,Yd=new Pc,Xd=new Pc,Kd=new zc,Qd=new zc;function Zd(e,t){ph.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Dd,this.material=void 0!==t?t:new dd,this.updateMorphTargets()}function Jd(e,t,n,i,r,a,o,s){if(null===(1===t.side?i.intersectTriangle(o,a,r,!0,s):i.intersectTriangle(r,a,o,2!==t.side,s)))return null;Qd.copy(s),Qd.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(Qd);return l<n.near||l>n.far?null:{distance:l,point:Qd.clone(),object:e}}function $d(e,t,n,i,r,a,o,s,l,u,c,h){Fd.fromBufferAttribute(r,u),Bd.fromBufferAttribute(r,c),Ud.fromBufferAttribute(r,h);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){Hd.set(0,0,0),Vd.set(0,0,0),Wd.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var m=d[f],g=a[f];0!==m&&(jd.fromBufferAttribute(g,u),Gd.fromBufferAttribute(g,c),zd.fromBufferAttribute(g,h),o?(Hd.addScaledVector(jd,m),Vd.addScaledVector(Gd,m),Wd.addScaledVector(zd,m)):(Hd.addScaledVector(jd.sub(Fd),m),Vd.addScaledVector(Gd.sub(Bd),m),Wd.addScaledVector(zd.sub(Ud),m)))}Fd.add(Hd),Bd.add(Vd),Ud.add(Wd)}var v=Jd(e,t,n,i,Fd,Bd,Ud,Kd);if(v){s&&(qd.fromBufferAttribute(s,u),Yd.fromBufferAttribute(s,c),Xd.fromBufferAttribute(s,h),v.uv=td.getUV(Kd,Fd,Bd,Ud,qd,Yd,Xd,new Pc)),l&&(qd.fromBufferAttribute(l,u),Yd.fromBufferAttribute(l,c),Xd.fromBufferAttribute(l,h),v.uv2=td.getUV(Kd,Fd,Bd,Ud,qd,Yd,Xd,new Pc));var y=new ud(u,c,h);td.getNormal(Fd,Bd,Ud,y.normal),v.face=y}return v}Zd.prototype=Object.assign(Object.create(ph.prototype),{constructor:Zd,isMesh:!0,copy:function(e){return ph.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=i.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,i=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r&&(null===i.boundingSphere&&i.computeBoundingSphere(),kd.copy(i.boundingSphere),kd.applyMatrix4(a),!1!==e.ray.intersectsSphere(kd)&&(Od.getInverse(a),Nd.copy(e.ray).applyMatrix4(Od),null===i.boundingBox||!1!==Nd.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var o,s,l,u,c,h,d,f,p,m=i.index,g=i.attributes.position,v=i.morphAttributes.position,y=i.morphTargetsRelative,_=i.attributes.uv,b=i.attributes.uv2,E=i.groups,T=i.drawRange;if(null!==m)if(Array.isArray(r))for(u=0,h=E.length;u<h;u++)for(p=r[(f=E[u]).materialIndex],c=Math.max(f.start,T.start),d=Math.min(f.start+f.count,T.start+T.count);c<d;c+=3)o=m.getX(c),s=m.getX(c+1),l=m.getX(c+2),(n=$d(this,p,e,Nd,g,v,y,_,b,o,s,l))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,t.push(n));else for(u=Math.max(0,T.start),h=Math.min(m.count,T.start+T.count);u<h;u+=3)o=m.getX(u),s=m.getX(u+1),l=m.getX(u+2),(n=$d(this,r,e,Nd,g,v,y,_,b,o,s,l))&&(n.faceIndex=Math.floor(u/3),t.push(n));else if(void 0!==g)if(Array.isArray(r))for(u=0,h=E.length;u<h;u++)for(p=r[(f=E[u]).materialIndex],c=Math.max(f.start,T.start),d=Math.min(f.start+f.count,T.start+T.count);c<d;c+=3)(n=$d(this,p,e,Nd,g,v,y,_,b,o=c,s=c+1,l=c+2))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,t.push(n));else for(u=Math.max(0,T.start),h=Math.min(g.count,T.start+T.count);u<h;u+=3)(n=$d(this,r,e,Nd,g,v,y,_,b,o=u,s=u+1,l=u+2))&&(n.faceIndex=Math.floor(u/3),t.push(n))}else if(i.isGeometry){var w,x,A,S,M=Array.isArray(r),C=i.vertices,R=i.faces,I=i.faceVertexUvs[0];I.length>0&&(S=I);for(var P=0,L=R.length;P<L;P++){var D=R[P],O=M?r[D.materialIndex]:r;if(void 0!==O&&(w=C[D.a],x=C[D.b],A=C[D.c],n=Jd(this,O,e,Nd,w,x,A,Kd))){if(S&&S[P]){var N=S[P];qd.copy(N[0]),Yd.copy(N[1]),Xd.copy(N[2]),n.uv=td.getUV(Kd,w,x,A,qd,Yd,Xd,new Pc)}n.face=D,n.faceIndex=P,t.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ef=0,tf=new Qc,nf=new ph,rf=new zc;function af(){Object.defineProperty(this,"id",{value:ef+=2}),this.uuid=Ic.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}af.prototype=Object.assign(Object.create(Sc.prototype),{constructor:af,isGeometry:!0,applyMatrix4:function(e){for(var t=(new Lc).getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(e)}for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(t).normalize();for(var a=0,o=r.vertexNormals.length;a<o;a++)r.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return tf.makeRotationX(e),this.applyMatrix4(tf),this},rotateY:function(e){return tf.makeRotationY(e),this.applyMatrix4(tf),this},rotateZ:function(e){return tf.makeRotationZ(e),this.applyMatrix4(tf),this},translate:function(e,t,n){return tf.makeTranslation(e,t,n),this.applyMatrix4(tf),this},scale:function(e,t,n){return tf.makeScale(e,t,n),this.applyMatrix4(tf),this},lookAt:function(e){return nf.lookAt(e),nf.updateMatrix(),this.applyMatrix4(nf.matrix),this},fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,i=e.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=i.position.array,a=void 0!==i.normal?i.normal.array:void 0,o=void 0!==i.color?i.color.array:void 0,s=void 0!==i.uv?i.uv.array:void 0,l=void 0!==i.uv2?i.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0;u<r.length;u+=3)t.vertices.push((new zc).fromArray(r,u)),void 0!==o&&t.colors.push((new ad).fromArray(o,u));function c(e,n,i,r){var u=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],c=new ud(e,n,i,void 0===a?[]:[(new zc).fromArray(a,3*e),(new zc).fromArray(a,3*n),(new zc).fromArray(a,3*i)],u,r);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new Pc).fromArray(s,2*e),(new Pc).fromArray(s,2*n),(new Pc).fromArray(s,2*i)]),void 0!==l&&t.faceVertexUvs[1].push([(new Pc).fromArray(l,2*e),(new Pc).fromArray(l,2*n),(new Pc).fromArray(l,2*i)])}var h=e.groups;if(h.length>0)for(u=0;u<h.length;u++)for(var d=h[u],f=d.start,p=f,m=f+d.count;p<m;p+=3)void 0!==n?c(n[p],n[p+1],n[p+2],d.materialIndex):c(p,p+1,p+2,d.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)c(n[u],n[u+1],n[u+2]);else for(u=0;u<r.length/3;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(rf).negate(),this.translate(rf.x,rf.y,rf.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new Qc;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var e=new zc,t=new zc,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,r,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new zc;if(e){var s,l,u,c=new zc,h=new zc;for(i=0,r=this.faces.length;i<r;i++)a=this.faces[i],s=this.vertices[a.a],l=this.vertices[a.b],u=this.vertices[a.c],c.subVectors(u,l),h.subVectors(s,l),c.cross(h),o[a.a].add(c),o[a.b].add(c),o[a.c].add(c)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)o[(a=this.faces[i]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(i=0,r=this.faces.length;i<r;i++){var d=(a=this.faces[i]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var i=(n=this.faces[e]).vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var a=new af;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)l=new zc,u={a:new zc,b:new zc,c:new zc},o.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(r.normal),u.a.copy(r.vertexNormals[0]),u.b.copy(r.vertexNormals[1]),u.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Rh),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Lh),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,r=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,u=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(i=(new Lc).getNormalMatrix(t));for(var h=0,d=o.length;h<d;h++){var f=o[h].clone();void 0!==t&&f.applyMatrix4(t),a.push(f)}for(h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(h=0,d=l.length;h<d;h++){var p,m,g,v=l[h],y=v.vertexNormals,_=v.vertexColors;(p=new ud(v.a+r,v.b+r,v.c+r)).normal.copy(v.normal),void 0!==i&&p.normal.applyMatrix3(i).normalize();for(var b=0,E=y.length;b<E;b++)m=y[b].clone(),void 0!==i&&m.applyMatrix3(i).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(b=0,E=_.length;b<E;b++)g=_[b],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(h=0,d=e.faceVertexUvs.length;h<d;h++){var T=e.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(b=0,E=T.length;b<E;b++){for(var w=T[b],x=[],A=0,S=w.length;A<S;A++)x.push(w[A].clone());this.faceVertexUvs[h].push(x)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,r,a,o,s,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[t]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=c[r.a],r.b=c[r.b],r.c=c[r.c],a=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new zc(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var i,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(i=[]),o&&o.length===t&&(r=[]);for(n=0;n<t;n++){var s=e[n]._id;i&&i.push(a[s]),r&&r.push(o[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];i.push(a.x,a.y,a.z)}var o=[],s=[],l={},u=[],c={},h=[],d={};for(r=0;r<this.faces.length;r++){var f=this.faces[r],p=void 0!==this.faceVertexUvs[0][r],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,_=0;if(_=w(_,0,0),_=w(_,1,!0),_=w(_,2,!1),_=w(_,3,p),_=w(_,4,m),_=w(_,5,g),_=w(_,6,v),_=w(_,7,y),o.push(_),o.push(f.a,f.b,f.c),o.push(f.materialIndex),p){var b=this.faceVertexUvs[0][r];o.push(S(b[0]),S(b[1]),S(b[2]))}if(m&&o.push(x(f.normal)),g){var E=f.vertexNormals;o.push(x(E[0]),x(E[1]),x(E[2]))}if(v&&o.push(A(f.color)),y){var T=f.vertexColors;o.push(A(T[0]),A(T[1]),A(T[2]))}}function w(e,t,n){return n?e|1<<t:e&~(1<<t)}function x(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function A(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function S(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=i,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return(new af).copy(this)},copy:function(e){var t,n,i,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),i=0,r=c.length;i<r;i++){var h=c[i],d=[];for(a=0,o=h.length;a<o;a++){var f=h[a];d.push(f.clone())}this.faceVertexUvs[t].push(d)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],i=0,r=p[t].vertices.length;i<r;i++)m.vertices.push(p[t].vertices[i].clone());if(void 0!==p[t].normals)for(m.normals=[],i=0,r=p[t].normals.length;i<r;i++)m.normals.push(p[t].normals[i].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],i=0,r=g[t].vertexNormals.length;i<r;i++){var y=g[t].vertexNormals[i],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],i=0,r=g[t].faceNormals.length;i<r;i++)v.faceNormals.push(g[t].faceNormals[i].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var E=e.skinIndices;for(t=0,n=E.length;t<n;t++)this.skinIndices.push(E[t].clone());var T=e.lineDistances;for(t=0,n=T.length;t<n;t++)this.lineDistances.push(T[t]);var w=e.boundingBox;null!==w&&(this.boundingBox=w.clone());var x=e.boundingSphere;return null!==x&&(this.boundingSphere=x.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class of extends Dd{constructor(e,t,n,i,r,a){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};var o=this;e=e||1,t=t||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var s=[],l=[],u=[],c=[],h=0,d=0;function f(e,t,n,i,r,a,f,p,m,g,v){var y,_,b=a/m,E=f/g,T=a/2,w=f/2,x=p/2,A=m+1,S=g+1,M=0,C=0,R=new zc;for(_=0;_<S;_++){var I=_*E-w;for(y=0;y<A;y++){var P=y*b-T;R[e]=P*i,R[t]=I*r,R[n]=x,l.push(R.x,R.y,R.z),R[e]=0,R[t]=0,R[n]=p>0?1:-1,u.push(R.x,R.y,R.z),c.push(y/m),c.push(1-_/g),M+=1}}for(_=0;_<g;_++)for(y=0;y<m;y++){var L=h+y+A*_,D=h+y+A*(_+1),O=h+(y+1)+A*(_+1),N=h+(y+1)+A*_;s.push(L,D,N),s.push(D,O,N),C+=6}o.addGroup(d,C,v),d+=C,h+=M}f("z","y","x",-1,-1,n,t,e,a,r,0),f("z","y","x",1,-1,n,t,-e,a,r,1),f("x","z","y",1,1,e,n,t,i,a,2),f("x","z","y",1,-1,e,n,-t,i,a,3),f("x","y","z",1,-1,e,t,n,i,r,4),f("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new Td(l,3)),this.setAttribute("normal",new Td(u,3)),this.setAttribute("uv",new Td(c,2))}}function sf(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}return t}function lf(e){for(var t={},n=0;n<e.length;n++){var i=sf(e[n]);for(var r in i)t[r]=i[r]}return t}var uf={clone:sf,merge:lf};function cf(e){hd.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function hf(){ph.call(this),this.type="Camera",this.matrixWorldInverse=new Qc,this.projectionMatrix=new Qc,this.projectionMatrixInverse=new Qc}function df(e,t,n,i){hf.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}cf.prototype=Object.create(hd.prototype),cf.prototype.constructor=cf,cf.prototype.isShaderMaterial=!0,cf.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sf(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},cf.prototype.toJSON=function(e){var t=hd.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var r={};for(var a in this.extensions)!0===this.extensions[a]&&(r[a]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},hf.prototype=Object.assign(Object.create(ph.prototype),{constructor:hf,isCamera:!0,copy:function(e,t){return ph.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new zc),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){ph.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){ph.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),df.prototype=Object.assign(Object.create(hf.prototype),{constructor:df,isPerspectiveCamera:!0,copy:function(e,t){return hf.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Ic.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ic.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ic.RAD2DEG*Math.atan(Math.tan(.5*Ic.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Ic.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*i/o,t-=a.offsetY*n/s,i*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=ph.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});function ff(e,t,n,i){ph.call(this),this.type="CubeCamera";var r=new df(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new zc(1,0,0)),this.add(r);var a=new df(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new zc(-1,0,0)),this.add(a);var o=new df(90,1,e,t);o.up.set(0,0,1),o.lookAt(new zc(0,1,0)),this.add(o);var s=new df(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new zc(0,-1,0)),this.add(s);var l=new df(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new zc(0,0,1)),this.add(l);var u=new df(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new zc(0,0,-1)),this.add(u),i=i||{format:1022,magFilter:1006,minFilter:1006},this.renderTarget=new pf(n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),i=this.renderTarget,c=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,a),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,s),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=c,e.setRenderTarget(i,5),e.render(t,u),e.setRenderTarget(n)},this.clear=function(e,t,n,i){for(var r=e.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)e.setRenderTarget(a,o),e.clear(t,n,i);e.setRenderTarget(r)}}function pf(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),Fc.call(this,e,e,t)}function mf(e,t,n,i,r,a,o,s,l,u,c,h){Nc.call(this,null,a,o,s,l,u,i,r,c,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==u?u:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}ff.prototype=Object.create(ph.prototype),ff.prototype.constructor=ff,pf.prototype=Object.create(Fc.prototype),pf.prototype.constructor=pf,pf.prototype.isWebGLCubeRenderTarget=!0,pf.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new mh,i={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},r=new cf({type:"CubemapFromEquirect",uniforms:sf(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;var a=new Zd(new of(5,5,5),r);n.add(a);var o=new ff(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(e,n),a.geometry.dispose(),a.material.dispose(),this},mf.prototype=Object.create(Nc.prototype),mf.prototype.constructor=mf,mf.prototype.isDataTexture=!0;var gf=new Lh,vf=new zc;function yf(e,t,n,i,r,a){this.planes=[void 0!==e?e:new Vh,void 0!==t?t:new Vh,void 0!==n?n:new Vh,void 0!==i?i:new Vh,void 0!==r?r:new Vh,void 0!==a?a:new Vh]}Object.assign(yf.prototype,{set:function(e,t,n,i,r,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-i,c-s,p-h,y-m).normalize(),t[1].setComponents(o+i,c+s,p+h,y+m).normalize(),t[2].setComponents(o+r,c+l,p+d,y+g).normalize(),t[3].setComponents(o-r,c-l,p-d,y-g).normalize(),t[4].setComponents(o-a,c-u,p-f,y-v).normalize(),t[5].setComponents(o+a,c+u,p+f,y+v).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),gf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(gf)},intersectsSprite:function(e){return gf.center.set(0,0,0),gf.radius=.7071067811865476,gf.applyMatrix4(e.matrixWorld),this.intersectsSphere(gf)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];if(vf.x=i.normal.x>0?e.max.x:e.min.x,vf.y=i.normal.y>0?e.max.y:e.min.y,vf.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(vf)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var _f={common:{diffuse:{value:new ad(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Lc},uv2Transform:{value:new Lc},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Pc(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ad(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ad(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Lc}},sprite:{diffuse:{value:new ad(15658734)},opacity:{value:1},center:{value:new Pc(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Lc}}};function bf(){var e=null,t=!1,n=null;function i(r,a){!1!==t&&(n(r,a),e.requestAnimationFrame(i))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(i),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Ef(e,t){var n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){t.isInterleavedBufferAttribute&&(t=t.data);var a=i.get(t);void 0===a?i.set(t,function(t,n){var i=t.array,r=t.usage,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,i,r),t.onUploadCallback();var o=5126;return i instanceof Float32Array?o=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?o=5123:i instanceof Int16Array?o=5122:i instanceof Uint32Array?o=5125:i instanceof Int32Array?o=5124:i instanceof Int8Array?o=5120:i instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,r)):a.version<t.version&&(!function(t,i,r){var a=i.array,o=i.updateRange;e.bindBuffer(r,t),-1===o.count?e.bufferSubData(r,0,a):(n?e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,t,r),a.version=t.version)}}}function Tf(e,t,n,i){af.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new wf(e,t,n,i)),this.mergeVertices()}function wf(e,t,n,i){Dd.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};var r,a,o=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(n)||1,u=Math.floor(i)||1,c=l+1,h=u+1,d=e/l,f=t/u,p=[],m=[],g=[],v=[];for(a=0;a<h;a++){var y=a*f-s;for(r=0;r<c;r++){var _=r*d-o;m.push(_,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-a/u)}}for(a=0;a<u;a++)for(r=0;r<l;r++){var b=r+c*a,E=r+c*(a+1),T=r+1+c*(a+1),w=r+1+c*a;p.push(b,E,w),p.push(E,T,w)}this.setIndex(p),this.setAttribute("position",new Td(m,3)),this.setAttribute("normal",new Td(g,3)),this.setAttribute("uv",new Td(v,2))}Tf.prototype=Object.create(af.prototype),Tf.prototype.constructor=Tf,wf.prototype=Object.create(Dd.prototype),wf.prototype.constructor=wf;var xf={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Af={basic:{uniforms:lf([_f.common,_f.specularmap,_f.envmap,_f.aomap,_f.lightmap,_f.fog]),vertexShader:xf.meshbasic_vert,fragmentShader:xf.meshbasic_frag},lambert:{uniforms:lf([_f.common,_f.specularmap,_f.envmap,_f.aomap,_f.lightmap,_f.emissivemap,_f.fog,_f.lights,{emissive:{value:new ad(0)}}]),vertexShader:xf.meshlambert_vert,fragmentShader:xf.meshlambert_frag},phong:{uniforms:lf([_f.common,_f.specularmap,_f.envmap,_f.aomap,_f.lightmap,_f.emissivemap,_f.bumpmap,_f.normalmap,_f.displacementmap,_f.fog,_f.lights,{emissive:{value:new ad(0)},specular:{value:new ad(1118481)},shininess:{value:30}}]),vertexShader:xf.meshphong_vert,fragmentShader:xf.meshphong_frag},standard:{uniforms:lf([_f.common,_f.envmap,_f.aomap,_f.lightmap,_f.emissivemap,_f.bumpmap,_f.normalmap,_f.displacementmap,_f.roughnessmap,_f.metalnessmap,_f.fog,_f.lights,{emissive:{value:new ad(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:xf.meshphysical_vert,fragmentShader:xf.meshphysical_frag},toon:{uniforms:lf([_f.common,_f.specularmap,_f.aomap,_f.lightmap,_f.emissivemap,_f.bumpmap,_f.normalmap,_f.displacementmap,_f.gradientmap,_f.fog,_f.lights,{emissive:{value:new ad(0)},specular:{value:new ad(1118481)},shininess:{value:30}}]),vertexShader:xf.meshtoon_vert,fragmentShader:xf.meshtoon_frag},matcap:{uniforms:lf([_f.common,_f.bumpmap,_f.normalmap,_f.displacementmap,_f.fog,{matcap:{value:null}}]),vertexShader:xf.meshmatcap_vert,fragmentShader:xf.meshmatcap_frag},points:{uniforms:lf([_f.points,_f.fog]),vertexShader:xf.points_vert,fragmentShader:xf.points_frag},dashed:{uniforms:lf([_f.common,_f.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xf.linedashed_vert,fragmentShader:xf.linedashed_frag},depth:{uniforms:lf([_f.common,_f.displacementmap]),vertexShader:xf.depth_vert,fragmentShader:xf.depth_frag},normal:{uniforms:lf([_f.common,_f.bumpmap,_f.normalmap,_f.displacementmap,{opacity:{value:1}}]),vertexShader:xf.normal_vert,fragmentShader:xf.normal_frag},sprite:{uniforms:lf([_f.sprite,_f.fog]),vertexShader:xf.sprite_vert,fragmentShader:xf.sprite_frag},background:{uniforms:{uvTransform:{value:new Lc},t2D:{value:null}},vertexShader:xf.background_vert,fragmentShader:xf.background_frag},cube:{uniforms:lf([_f.envmap,{opacity:{value:1}}]),vertexShader:xf.cube_vert,fragmentShader:xf.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xf.equirect_vert,fragmentShader:xf.equirect_frag},distanceRGBA:{uniforms:lf([_f.common,_f.displacementmap,{referencePosition:{value:new zc},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xf.distanceRGBA_vert,fragmentShader:xf.distanceRGBA_frag},shadow:{uniforms:lf([_f.lights,_f.fog,{color:{value:new ad(0)},opacity:{value:1}}]),vertexShader:xf.shadow_vert,fragmentShader:xf.shadow_frag}};function Sf(e,t,n,i){var r,a,o=new ad(0),s=0,l=null,u=0,c=null;function h(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,i)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),h(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){h(o,s=e)},render:function(t,i,d,f){var p=i.background,m=e.xr,g=m.getSession&&m.getSession();if(g&&"additive"===g.environmentBlendMode&&(p=null),null===p?h(o,s):p&&p.isColor&&(h(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||306===p.mapping)){void 0===a&&((a=new Zd(new of(1,1,1),new cf({type:"BackgroundCubeMaterial",uniforms:sf(Af.cube.uniforms),vertexShader:Af.cube.vertexShader,fragmentShader:Af.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));var v=p.isWebGLCubeRenderTarget?p.texture:p;a.material.uniforms.envMap.value=v,a.material.uniforms.flipEnvMap.value=v.isCubeTexture?-1:1,l===p&&u===v.version&&c===e.toneMapping||(a.material.needsUpdate=!0,l=p,u=v.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===r&&((r=new Zd(new wf(2,2),new cf({type:"BackgroundMaterial",uniforms:sf(Af.background.uniforms),vertexShader:Af.background.vertexShader,fragmentShader:Af.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(r.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(r)),r.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),r.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&u===p.version&&c===e.toneMapping||(r.material.needsUpdate=!0,l=p,u=p.version,c=e.toneMapping),t.unshift(r,r.geometry,r.material,0,0,null))}}}function Mf(e,t,n,i){var r,a=i.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r)},this.renderInstances=function(i,o,s,l){if(0!==l){var u,c;if(a)u=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](r,o,s,l),n.update(s,r,l)}}}function Cf(e,t,n){var i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),c=e.getParameter(35660),h=e.getParameter(3379),d=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=c>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var n=t.get("EXT_texture_filter_anisotropic");return i=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function Rf(){var e=this,t=null,n=0,i=!1,r=!1,a=new Vh,o=new Lc,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,i,r){var l=null!==t?t.length:0,u=null;if(0!==l){if(u=s.value,!0!==r||null===u){var c=i+4*l,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,f=i;d!==l;++d,f+=4)a.copy(t[d]).applyMatrix4(h,o),a.normal.toArray(u,f),u[f+3]=a.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=l,e.numIntersection=0,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,a){var o=0!==e.length||r||0!==n||i;return i=r,t=u(e,a,0),n=e.length,o},this.beginShadows=function(){r=!0,u(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,a,o,c,h,d){if(!i||null===e||0===e.length||r&&!o)r?u(null):l();else{var f=r?0:n,p=4*f,m=h.clippingState||null;s.value=m,m=u(e,c,p,d);for(var g=0;g!==p;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=f}}}function If(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i,i}}}function Pf(e,t,n){var i=new WeakMap,r=new WeakMap;function a(e){var o=e.target,s=i.get(o);for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);o.removeEventListener("dispose",a),i.delete(o);var u=r.get(s);u&&(t.remove(u),r.delete(s)),n.memory.geometries--}function o(e){var n=[],i=e.index,a=e.attributes.position,o=0;if(null!==i){var s=i.array;o=i.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{s=a.array;o=a.version;for(l=0,u=s.length/3-1;l<u;l+=3){c=l+0,h=l+1,d=l+2;n.push(c,h,h,d,d,c)}}var f=new(Ad(n)>65535?Ed:_d)(n,1);f.version=o,t.update(f,34963);var p=r.get(e);p&&t.remove(p),r.set(e,f)}return{get:function(e,t){var r=i.get(t);return r||(t.addEventListener("dispose",a),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Dd).setFromObject(e)),r=t._bufferGeometry),i.set(t,r),n.memory.geometries++,r)},update:function(e){var n=e.index,i=e.attributes;for(var r in null!==n&&t.update(n,34963),i)t.update(i[r],34962);var a=e.morphAttributes;for(var r in a)for(var o=a[r],s=0,l=o.length;s<l;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=r.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return r.get(e)}}}function Lf(e,t,n,i){var r,a,o,s=i.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,i){e.drawElements(r,i,a,t*o),n.update(i,r)},this.renderInstances=function(i,l,u,c){if(0!==c){var h,d;if(s)h=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(h=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[d](r,u,a,l*o,c),n.update(u,r,c)}}}function Df(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(i=i||1,t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Of(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Nf(e){var t={},n=new Float32Array(8);return{update:function(i,r,a,o){var s=i.morphTargetInfluences,l=void 0===s?0:s.length,u=t[r.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];t[r.id]=u}var h=a.morphTargets&&r.morphAttributes.position,d=a.morphNormals&&r.morphAttributes.normal;for(c=0;c<l;c++){0!==(p=u[c])[1]&&(h&&r.deleteAttribute("morphTarget"+c),d&&r.deleteAttribute("morphNormal"+c))}for(c=0;c<l;c++){(p=u[c])[0]=c,p[1]=s[c]}u.sort(Of);var f=0;for(c=0;c<8;c++){var p;if(p=u[c]){var m=p[0],g=p[1];if(g){h&&r.setAttribute("morphTarget"+c,h[m]),d&&r.setAttribute("morphNormal"+c,d[m]),n[c]=g,f+=g;continue}}n[c]=0}var v=r.morphTargetsRelative?1:1-f;o.getUniforms().setValue(e,"morphTargetBaseInfluence",v),o.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function kf(e,t,n,i){var r=new WeakMap;return{update:function(e){var a=i.render.frame,o=e.geometry,s=t.get(e,o);return r.get(s)!==a&&(o.isGeometry&&s.updateFromObject(e),t.update(s),r.set(s,a)),e.isInstancedMesh&&n.update(e.instanceMatrix,34962),s},dispose:function(){r=new WeakMap}}}function Ff(e,t,n,i,r,a,o,s,l,u){e=void 0!==e?e:[],t=void 0!==t?t:301,o=void 0!==o?o:1022,Nc.call(this,e,t,n,i,r,a,o,s,l,u),this.flipY=!1}function Bf(e,t,n,i){Nc.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Uf(e,t,n,i){Nc.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Af.physical={uniforms:lf([Af.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ad(0)},clearcoatNormalScale:{value:new Pc(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:xf.meshphysical_vert,fragmentShader:xf.meshphysical_frag},Ff.prototype=Object.create(Nc.prototype),Ff.prototype.constructor=Ff,Ff.prototype.isCubeTexture=!0,Object.defineProperty(Ff.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Bf.prototype=Object.create(Nc.prototype),Bf.prototype.constructor=Bf,Bf.prototype.isDataTexture2DArray=!0,Uf.prototype=Object.create(Nc.prototype),Uf.prototype.constructor=Uf,Uf.prototype.isDataTexture3D=!0;var jf=new Nc,Gf=new Bf,zf=new Uf,Hf=new Ff,Vf=[],Wf=[],qf=new Float32Array(16),Yf=new Float32Array(9),Xf=new Float32Array(4);function Kf(e,t,n){var i=e[0];if(i<=0||i>0)return e;var r=t*n,a=Vf[r];if(void 0===a&&(a=new Float32Array(r),Vf[r]=a),0!==t){i.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Qf(e,t){if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Zf(e,t){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}function Jf(e,t){var n=Wf[t];void 0===n&&(n=new Int32Array(t),Wf[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function $f(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ep(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Qf(n,t))return;e.uniform2fv(this.addr,t),Zf(n,t)}}function tp(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Qf(n,t))return;e.uniform3fv(this.addr,t),Zf(n,t)}}function np(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Qf(n,t))return;e.uniform4fv(this.addr,t),Zf(n,t)}}function ip(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(Qf(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Zf(n,t)}else{if(Qf(n,i))return;Xf.set(i),e.uniformMatrix2fv(this.addr,!1,Xf),Zf(n,i)}}function rp(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(Qf(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Zf(n,t)}else{if(Qf(n,i))return;Yf.set(i),e.uniformMatrix3fv(this.addr,!1,Yf),Zf(n,i)}}function ap(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(Qf(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Zf(n,t)}else{if(Qf(n,i))return;qf.set(i),e.uniformMatrix4fv(this.addr,!1,qf),Zf(n,i)}}function op(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(t||jf,r)}function sp(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Gf,r)}function lp(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||zf,r)}function up(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(t||Hf,r)}function cp(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function hp(e,t){var n=this.cache;Qf(n,t)||(e.uniform2iv(this.addr,t),Zf(n,t))}function dp(e,t){var n=this.cache;Qf(n,t)||(e.uniform3iv(this.addr,t),Zf(n,t))}function fp(e,t){var n=this.cache;Qf(n,t)||(e.uniform4iv(this.addr,t),Zf(n,t))}function pp(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function mp(e,t){e.uniform1fv(this.addr,t)}function gp(e,t){e.uniform1iv(this.addr,t)}function vp(e,t){e.uniform2iv(this.addr,t)}function yp(e,t){e.uniform3iv(this.addr,t)}function _p(e,t){e.uniform4iv(this.addr,t)}function bp(e,t){var n=Kf(t,this.size,2);e.uniform2fv(this.addr,n)}function Ep(e,t){var n=Kf(t,this.size,3);e.uniform3fv(this.addr,n)}function Tp(e,t){var n=Kf(t,this.size,4);e.uniform4fv(this.addr,n)}function wp(e,t){var n=Kf(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function xp(e,t){var n=Kf(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Ap(e,t){var n=Kf(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Sp(e,t,n){var i=t.length,r=Jf(n,i);e.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTexture2D(t[a]||jf,r[a])}function Mp(e,t,n){var i=t.length,r=Jf(n,i);e.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTextureCube(t[a]||Hf,r[a])}function Cp(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return $f;case 35664:return ep;case 35665:return tp;case 35666:return np;case 35674:return ip;case 35675:return rp;case 35676:return ap;case 5124:case 35670:return cp;case 35667:case 35671:return hp;case 35668:case 35672:return dp;case 35669:case 35673:return fp;case 5125:return pp;case 35678:case 36198:case 36298:case 36306:case 35682:return op;case 35679:case 36299:case 36307:return lp;case 35680:case 36300:case 36308:case 36293:return up;case 36289:case 36303:case 36311:case 36292:return sp}}(t.type)}function Rp(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return mp;case 35664:return bp;case 35665:return Ep;case 35666:return Tp;case 35674:return wp;case 35675:return xp;case 35676:return Ap;case 5124:case 35670:return gp;case 35667:case 35671:return vp;case 35668:case 35672:return yp;case 35669:case 35673:return _p;case 35678:case 36198:case 36298:case 36306:case 35682:return Sp;case 35680:case 36300:case 36308:case 36293:return Mp}}(t.type)}function Ip(e){this.id=e,this.seq=[],this.map={}}Rp.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Zf(t,e)},Ip.prototype.setValue=function(e,t,n){for(var i=this.seq,r=0,a=i.length;r!==a;++r){var o=i[r];o.setValue(e,t[o.id],n)}};var Pp=/([\w\d_]+)(\])?(\[|\.)?/g;function Lp(e,t){e.seq.push(t),e.map[t.id]=t}function Dp(e,t,n){var i=e.name,r=i.length;for(Pp.lastIndex=0;;){var a=Pp.exec(i),o=Pp.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===r){Lp(n,void 0===u?new Cp(s,e,t):new Rp(s,e,t));break}var c=n.map[s];void 0===c&&Lp(n,c=new Ip(s)),n=c}}function Op(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),i=0;i<n;++i){var r=e.getActiveUniform(t,i);Dp(r,e.getUniformLocation(t,r.name),this)}}function Np(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}Op.prototype.setValue=function(e,t,n,i){var r=this.map[t];void 0!==r&&r.setValue(e,n,i)},Op.prototype.setOptional=function(e,t,n){var i=t[n];void 0!==i&&this.setValue(e,n,i)},Op.upload=function(e,t,n,i){for(var r=0,a=t.length;r!==a;++r){var o=t[r],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,i)}},Op.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var a=e[i];a.id in t&&n.push(a)}return n};var kp=0;function Fp(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function Bp(e,t,n){var i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();return i&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+r+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Up(e,t){var n=Fp(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function jp(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Gp(e){return""!==e}function zp(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Hp(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Vp=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wp(e){return e.replace(Vp,qp)}function qp(e,t){var n=xf[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Wp(n)}var Yp=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Xp(e){return e.replace(Yp,Kp)}function Kp(e,t,n,i){for(var r="",a=parseInt(t);a<parseInt(n);a++)r+=i.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Qp(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Zp(e,t,n){var i,r,a,o,s,l=e.getContext(),u=n.defines,c=n.vertexShader,h=n.fragmentShader,d=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),f=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}return t}(n),p=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:t="ENVMAP_MODE_REFRACTION"}return t}(n),m=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),g=e.gammaFactor>0?e.gammaFactor:1,v=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Gp).join("\n")}(n),y=function(e){var t=[];for(var n in e){var i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(u),_=l.createProgram();if(n.isRawShaderMaterial?((i=[y].filter(Gp).join("\n")).length>0&&(i+="\n"),(r=[v,y].filter(Gp).join("\n")).length>0&&(r+="\n")):(i=[Qp(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Gp).join("\n"),r=[v,Qp(n),"#define SHADER_NAME "+n.shaderName,y,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?xf.tonemapping_pars_fragment:"",0!==n.toneMapping?jp("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?xf.encodings_pars_fragment:"",n.mapEncoding?Up("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Up("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Up("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Up("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Up("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(a="linearToOutputTexel",o=n.outputEncoding,s=Fp(o),"vec4 "+a+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Gp).join("\n")),c=Hp(c=zp(c=Wp(c),n),n),h=Hp(h=zp(h=Wp(h),n),n),c=Xp(c),h=Xp(h),n.isWebGL2&&!n.isRawShaderMaterial){var b=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==c.match(E)&&null!==h.match(E)&&(b=!0,c=c.replace(E,""),h=h.replace(E,"")),i=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,r=["#version 300 es\n","#define varying in",b?"":"out highp vec4 pc_fragColor;",b?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+r}var T,w,x=r+h,A=Np(l,35633,i+c),S=Np(l,35632,x);if(l.attachShader(_,A),l.attachShader(_,S),void 0!==n.index0AttributeName?l.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&l.bindAttribLocation(_,0,"position"),l.linkProgram(_),e.debug.checkShaderErrors){var M=l.getProgramInfoLog(_).trim(),C=l.getShaderInfoLog(A).trim(),R=l.getShaderInfoLog(S).trim(),I=!0,P=!0;if(!1===l.getProgramParameter(_,35714)){I=!1;var L=Bp(l,A,"vertex"),D=Bp(l,S,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(_,35715),"gl.getProgramInfoLog",M,L,D)}else""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==C&&""!==R||(P=!1);P&&(this.diagnostics={runnable:I,programLog:M,vertexShader:{log:C,prefix:i},fragmentShader:{log:R,prefix:r}})}return l.detachShader(_,A),l.detachShader(_,S),l.deleteShader(A),l.deleteShader(S),this.getUniforms=function(){return void 0===T&&(T=new Op(l,_)),T},this.getAttributes=function(){return void 0===w&&(w=function(e,t){for(var n={},i=e.getProgramParameter(t,35721),r=0;r<i;r++){var a=e.getActiveAttrib(t,r).name;n[a]=e.getAttribLocation(t,a)}return n}(l,_)),w},this.destroy=function(){l.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=kp++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=A,this.fragmentShader=S,this}function Jp(e,t,n){var i=[],r=n.isWebGL2,a=n.logarithmicDepthBuffer,o=n.floatVertexTextures,s=n.precision,l=n.maxVertexUniforms,u=n.vertexTextures,c={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function d(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=3e3,t}this.getParameters=function(i,h,f,p,m,g,v){var y=p.fog,_=i.isMeshStandardMaterial?p.environment:null,b=i.envMap||_,E=c[i.type],T=v.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(o)return 1024;var n=l,i=Math.floor((n-20)/4),r=Math.min(i,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(v):0;null!==i.precision&&(s=n.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",s,"instead.");var w=function(e,t){var n;if(t){var i=Af[t];n={name:e.type,uniforms:uf.clone(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}}else n={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return n}(i,E);i.onBeforeCompile(w,e);var x=e.getRenderTarget();return{isWebGL2:r,shaderID:E,shaderName:w.name,uniforms:w.uniforms,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,defines:i.defines,isRawShaderMaterial:i.isRawShaderMaterial,isShaderMaterial:i.isShaderMaterial,precision:s,instancing:!0===v.isInstancedMesh,supportsVertexTextures:u,outputEncoding:null!==x?d(x.texture):e.outputEncoding,map:!!i.map,mapEncoding:d(i.map),matcap:!!i.matcap,matcapEncoding:d(i.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:d(b),envMapCubeUV:!!b&&(306===b.mapping||307===b.mapping),lightMap:!!i.lightMap,lightMapEncoding:d(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:d(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.displacementMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||!i.displacementMap),fog:!!y,useFog:i.fog,fogExp2:y&&y.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:a,skinning:i.skinning&&T>0,maxBones:T,useVertexTexture:o,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&f.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawbuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:r||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:r||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:r||null!==t.get("EXT_shader_texture_lod"),onBeforeCompile:i.onBeforeCompile}},this.getProgramCacheKey=function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);if(void 0===t.isRawShaderMaterial){for(var r=0;r<h.length;r++)n.push(t[h[r]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(t,n){for(var r,a=0,o=i.length;a<o;a++){var s=i[a];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new Zp(e,n,t),i.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function $p(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function em(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function tm(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function nm(){var e=[],t=0,n=[],i=[],r={id:-1};function a(n,i,a,o,s,l){var u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:i,material:a,program:a.program||r,groupOrder:o,renderOrder:n.renderOrder,z:s,group:l},e[t]=u):(u.id=n.id,u.object=n,u.geometry=i,u.material=a,u.program=a.program||r,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=s,u.group=l),t++,u}return{opaque:n,transparent:i,init:function(){t=0,n.length=0,i.length=0},push:function(e,t,r,o,s,l){var u=a(e,t,r,o,s,l);(!0===r.transparent?i:n).push(u)},unshift:function(e,t,r,o,s,l){var u=a(e,t,r,o,s,l);(!0===r.transparent?i:n).unshift(u)},finish:function(){for(var n=t,i=e.length;n<i;n++){var r=e[n];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.program=null,r.group=null}},sort:function(e,t){n.length>1&&n.sort(e||em),i.length>1&&i.sort(t||tm)}}}function im(){var e=new WeakMap;function t(n){var i=n.target;i.removeEventListener("dispose",t),e.delete(i)}return{get:function(n,i){var r,a=e.get(n);return void 0===a?(r=new nm,e.set(n,new WeakMap),e.get(n).set(i,r),n.addEventListener("dispose",t)):void 0===(r=a.get(i))&&(r=new nm,a.set(i,r)),r},dispose:function(){e=new WeakMap}}}function rm(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new zc,color:new ad};break;case"SpotLight":n={position:new zc,direction:new zc,color:new ad,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new zc,color:new ad,distance:0,decay:0};break;case"HemisphereLight":n={direction:new zc,skyColor:new ad,groundColor:new ad};break;case"RectAreaLight":n={color:new ad,position:new zc,halfWidth:new zc,halfHeight:new zc}}return e[t.id]=n,n}}}var am=0;function om(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function sm(){for(var e,t=new rm,n=(e={},{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Pc};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Pc,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;r<9;r++)i.probe.push(new zc);var a=new zc,o=new Qc,s=new Qc;return{setup:function(e,r,l){for(var u=0,c=0,h=0,d=0;d<9;d++)i.probe[d].set(0,0,0);var f=0,p=0,m=0,g=0,v=0,y=0,_=0,b=0,E=l.matrixWorldInverse;e.sort(om),d=0;for(var T=e.length;d<T;d++){var w=e[d],x=w.color,A=w.intensity,S=w.distance,M=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)u+=x.r*A,c+=x.g*A,h+=x.b*A;else if(w.isLightProbe)for(var C=0;C<9;C++)i.probe[C].addScaledVector(w.sh.coefficients[C],A);else if(w.isDirectionalLight){if((P=t.get(w)).color.copy(w.color).multiplyScalar(w.intensity),P.direction.setFromMatrixPosition(w.matrixWorld),a.setFromMatrixPosition(w.target.matrixWorld),P.direction.sub(a),P.direction.transformDirection(E),w.castShadow){var R=w.shadow;(I=n.get(w)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,i.directionalShadow[f]=I,i.directionalShadowMap[f]=M,i.directionalShadowMatrix[f]=w.shadow.matrix,y++}i.directional[f]=P,f++}else if(w.isSpotLight){if((P=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(E),P.color.copy(x).multiplyScalar(A),P.distance=S,P.direction.setFromMatrixPosition(w.matrixWorld),a.setFromMatrixPosition(w.target.matrixWorld),P.direction.sub(a),P.direction.transformDirection(E),P.coneCos=Math.cos(w.angle),P.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),P.decay=w.decay,w.castShadow){R=w.shadow;(I=n.get(w)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,i.spotShadow[m]=I,i.spotShadowMap[m]=M,i.spotShadowMatrix[m]=w.shadow.matrix,b++}i.spot[m]=P,m++}else if(w.isRectAreaLight){(P=t.get(w)).color.copy(x).multiplyScalar(A),P.position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(E),s.identity(),o.copy(w.matrixWorld),o.premultiply(E),s.extractRotation(o),P.halfWidth.set(.5*w.width,0,0),P.halfHeight.set(0,.5*w.height,0),P.halfWidth.applyMatrix4(s),P.halfHeight.applyMatrix4(s),i.rectArea[g]=P,g++}else if(w.isPointLight){if((P=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),P.position.applyMatrix4(E),P.color.copy(w.color).multiplyScalar(w.intensity),P.distance=w.distance,P.decay=w.decay,w.castShadow){var I;R=w.shadow;(I=n.get(w)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,I.shadowCameraNear=R.camera.near,I.shadowCameraFar=R.camera.far,i.pointShadow[p]=I,i.pointShadowMap[p]=M,i.pointShadowMatrix[p]=w.shadow.matrix,_++}i.point[p]=P,p++}else if(w.isHemisphereLight){var P;(P=t.get(w)).direction.setFromMatrixPosition(w.matrixWorld),P.direction.transformDirection(E),P.direction.normalize(),P.skyColor.copy(w.color).multiplyScalar(A),P.groundColor.copy(w.groundColor).multiplyScalar(A),i.hemi[v]=P,v++}}i.ambient[0]=u,i.ambient[1]=c,i.ambient[2]=h;var L=i.hash;L.directionalLength===f&&L.pointLength===p&&L.spotLength===m&&L.rectAreaLength===g&&L.hemiLength===v&&L.numDirectionalShadows===y&&L.numPointShadows===_&&L.numSpotShadows===b||(i.directional.length=f,i.spot.length=m,i.rectArea.length=g,i.point.length=p,i.hemi.length=v,i.directionalShadow.length=y,i.directionalShadowMap.length=y,i.pointShadow.length=_,i.pointShadowMap.length=_,i.spotShadow.length=b,i.spotShadowMap.length=b,i.directionalShadowMatrix.length=y,i.pointShadowMatrix.length=_,i.spotShadowMatrix.length=b,L.directionalLength=f,L.pointLength=p,L.spotLength=m,L.rectAreaLength=g,L.hemiLength=v,L.numDirectionalShadows=y,L.numPointShadows=_,L.numSpotShadows=b,i.version=am++)},state:i}}function lm(){var e=new sm,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(i){e.setup(t,n,i)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function um(){var e=new WeakMap;function t(n){var i=n.target;i.removeEventListener("dispose",t),e.delete(i)}return{get:function(n,i){var r;return!1===e.has(n)?(r=new lm,e.set(n,new WeakMap),e.get(n).set(i,r),n.addEventListener("dispose",t)):!1===e.get(n).has(i)?(r=new lm,e.get(n).set(i,r)):r=e.get(n).get(i),r},dispose:function(){e=new WeakMap}}}function cm(e){hd.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function hm(e){hd.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new zc,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}cm.prototype=Object.create(hd.prototype),cm.prototype.constructor=cm,cm.prototype.isMeshDepthMaterial=!0,cm.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},hm.prototype=Object.create(hd.prototype),hm.prototype.constructor=hm,hm.prototype.isMeshDistanceMaterial=!0,hm.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function dm(e,t,n){var i=new yf,r=new Pc,a=new Pc,o=new kc,s=[],l=[],u={},c={0:1,1:0,2:2},h=new cf({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Pc},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONAL_PASS=1;var f=new Dd;f.setAttribute("position",new pd(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new Zd(f,h),m=this;function g(n,i){var r=t.update(p);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,r,h,p,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,r,d,p,null)}function v(e,t,n){var i=e<<0|t<<1|n<<2,r=s[i];return void 0===r&&(r=new cm({depthPacking:3201,morphTargets:e,skinning:t}),s[i]=r),r}function y(e,t,n){var i=e<<0|t<<1|n<<2,r=l[i];return void 0===r&&(r=new hm({morphTargets:e,skinning:t}),l[i]=r),r}function _(t,n,i,r,a,o){var s=t.geometry,l=null,h=v,d=t.customDepthMaterial;if(!0===i.isPointLight&&(h=y,d=t.customDistanceMaterial),void 0===d){var f=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?f=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(f=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===t.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=h(f,p,!0===t.isInstancedMesh)}else l=d;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=l.uuid,g=n.uuid,_=u[m];void 0===_&&(_={},u[m]=_);var b=_[g];void 0===b&&(b=l.clone(),_[g]=b),l=b}return l.visible=n.visible,l.wireframe=n.wireframe,l.side=3===o?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:c[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=r,l.farDistance=a),l}function b(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=t.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var f=c[h],p=u[f.materialIndex];if(p&&p.visible){var m=_(n,p,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,m,n,f)}}else if(u.visible){m=_(n,u,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)b(g[v],r,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,l){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var v=t[f],y=v.shadow;if(void 0!==y){r.copy(y.mapSize);var _=y.getFrameExtents();if(r.multiply(_),a.copy(y.mapSize),(r.x>n||r.y>n)&&(console.warn("THREE.WebGLShadowMap:",v,"has shadow exceeding max texture size, reducing"),r.x>n&&(a.x=Math.floor(n/_.x),r.x=a.x*_.x,y.mapSize.x=a.x),r.y>n&&(a.y=Math.floor(n/_.y),r.y=a.y*_.y,y.mapSize.y=a.y)),null===y.map&&!y.isPointLightShadow&&3===this.type){var E={minFilter:1006,magFilter:1006,format:1023};y.map=new Fc(r.x,r.y,E),y.map.texture.name=v.name+".shadowMap",y.mapPass=new Fc(r.x,r.y,E),y.camera.updateProjectionMatrix()}if(null===y.map){E={minFilter:1003,magFilter:1003,format:1023};y.map=new Fc(r.x,r.y,E),y.map.texture.name=v.name+".shadowMap",y.camera.updateProjectionMatrix()}e.setRenderTarget(y.map),e.clear();for(var T=y.getViewportCount(),w=0;w<T;w++){var x=y.getViewport(w);o.set(a.x*x.x,a.y*x.y,a.x*x.z,a.y*x.w),d.viewport(o),y.updateMatrices(v,w),i=y.getFrustum(),b(s,l,y.camera,v,this.type)}y.isPointLightShadow||3!==this.type||g(y,l)}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(u,c,h)}}}function fm(e,t,n){var i=n.isWebGL2;var r=new function(){var t=!1,n=new kc,i=null,r=new kc(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,a,o,s){!0===s&&(t*=o,i*=o,a*=o),n.set(t,i,a,o),!1===r.equals(n)&&(e.clearColor(t,i,a,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},a=new function(){var t=!1,n=null,i=null,r=null;return{setTest:function(e){e?B(2929):U(2929)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},o=new function(){var t=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(e){t||(e?B(2960):U(2960))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&r===n&&a===o||(e.stencilFunc(t,n,o),i=t,r=n,a=o)},setOp:function(t,n,i){o===t&&s===n&&l===i||(e.stencilOp(t,n,i),o=t,s=n,l=i)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null}}},s=e.getParameter(34921),l=new Uint8Array(s),u=new Uint8Array(s),c=new Uint8Array(s),h={},d=null,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=null,E=!1,T=null,w=null,x=null,A=null,S=null,M=e.getParameter(35661),C=!1,R=0,I=e.getParameter(7938);-1!==I.indexOf("WebGL")?(R=parseFloat(/^WebGL\ ([0-9])/.exec(I)[1]),C=R>=1):-1!==I.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(I)[1]),C=R>=2);var P=null,L={},D=new kc,O=new kc;function N(t,n,i){var r=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<i;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,r);return a}var k={};function F(n,r){(l[n]=1,0===u[n]&&(e.enableVertexAttribArray(n),u[n]=1),c[n]!==r)&&((i?e:t.get("ANGLE_instanced_arrays"))[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),c[n]=r)}function B(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function U(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}k[3553]=N(3553,3553,1),k[34067]=N(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),B(2929),a.setFunc(3),V(!1),W(1),B(2884),H(0);var j={100:32774,101:32778,102:32779};if(i)j[103]=32775,j[104]=32776;else{var G=t.get("EXT_blend_minmax");null!==G&&(j[103]=G.MIN_EXT,j[104]=G.MAX_EXT)}var z={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function H(t,n,i,r,a,o,s,l){if(0!==t){if(f||(B(3042),f=!0),5===t)a=a||n,o=o||i,s=s||r,n===m&&a===y||(e.blendEquationSeparate(j[n],j[a]),m=n,y=a),i===g&&r===v&&o===_&&s===b||(e.blendFuncSeparate(z[i],z[r],z[o],z[s]),g=i,v=r,_=o,b=s),p=t,E=null;else if(t!==p||l!==E){if(100===m&&100===y||(e.blendEquation(32774),m=100,y=100),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,_=null,b=null,p=t,E=l}}else f&&(U(3042),f=!1)}function V(t){T!==t&&(t?e.frontFace(2304):e.frontFace(2305),T=t)}function W(t){0!==t?(B(2884),t!==w&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):U(2884),w=t}function q(t,n,i){t?(B(32823),A===n&&S===i||(e.polygonOffset(n,i),A=n,S=i)):U(32823)}function Y(t){void 0===t&&(t=33984+M-1),P!==t&&(e.activeTexture(t),P=t)}return{buffers:{color:r,depth:a,stencil:o},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){F(e,0)},enableAttributeAndDivisor:F,disableUnusedAttributes:function(){for(var t=0,n=u.length;t!==n;++t)u[t]!==l[t]&&(e.disableVertexAttribArray(t),u[t]=0)},enable:B,disable:U,useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:H,setMaterial:function(e,t){2===e.side?U(2884):B(2884);var n=1===e.side;t&&(n=!n),V(n),1===e.blending&&!1===e.transparent?H(0):H(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),r.setMask(e.colorWrite);var i=e.stencilWrite;o.setTest(i),i&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),q(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:V,setCullFace:W,setLineWidth:function(t){t!==x&&(C&&e.lineWidth(t),x=t)},setPolygonOffset:q,setScissorTest:function(e){e?B(3089):U(3089)},activeTexture:Y,bindTexture:function(t,n){null===P&&Y();var i=L[P];void 0===i&&(i={type:void 0,texture:void 0},L[P]=i),i.type===t&&i.texture===n||(e.bindTexture(t,n||k[t]),i.type=t,i.texture=n)},unbindTexture:function(){var t=L[P];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===O.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),O.copy(t))},reset:function(){for(var t=0;t<u.length;t++)1===u[t]&&(e.disableVertexAttribArray(t),u[t]=0);h={},P=null,L={},d=null,p=null,T=null,w=null,r.reset(),a.reset(),o.reset()}}}function pm(e,t,n,i,r,a,o){var s,l=r.isWebGL2,u=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,d=r.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return p?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,n,i){var r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Ic.floorPowerOfTwo:Math.floor,o=a(r*e.width),l=a(r*e.height);void 0===s&&(s=m(o,l));var u=n?m(o,l):s;return u.width=o,u.height=l,u.getContext("2d").drawImage(e,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+l+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return Ic.isPowerOfTwo(e.width)&&Ic.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function _(t,n,r,a){e.generateMipmap(t),i.get(n).__maxMipLevel=Math.log(Math.max(r,a))*Math.LOG2E}function b(n,i,r){if(!1===l)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===i&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=32856)),33325===a||33326===a||34842===a||34836===a?t.get("EXT_color_buffer_float"):34843!==a&&34837!==a||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),a}function E(e){return 1003===e||1004===e||1005===e?9728:9729}function T(t){var n=t.target;n.removeEventListener("dispose",T),function(t){var n=i.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),i.remove(t)}(n),n.isVideoTexture&&f.delete(n),o.memory.textures--}function w(t){var n=t.target;n.removeEventListener("dispose",w),function(t){var n=i.get(t),r=i.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[a]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);i.remove(t.texture),i.remove(t)}(n),o.memory.textures--}var x=0;function A(e,t){var r=i.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),e.version>0&&r.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void L(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,r.__webglTexture)}function S(t,r){if(6===t.image.length){var o=i.get(t);if(t.version>0&&o.__version!==t.version){P(o,t),n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture),e.pixelStorei(37440,t.flipY);for(var s=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),u=t.image[0]&&t.image[0].isDataTexture,h=[],d=0;d<6;d++)h[d]=s||u?u?t.image[d].image:t.image[d]:g(t.image[d],!1,!0,c);var f,p=h[0],m=v(p)||l,E=a.convert(t.format),T=a.convert(t.type),w=b(t.internalFormat,E,T);if(I(34067,t,m),s){for(d=0;d<6;d++){f=h[d].mipmaps;for(var x=0;x<f.length;x++){var A=f[x];1023!==t.format&&1022!==t.format?null!==E?n.compressedTexImage2D(34069+d,x,w,A.width,A.height,0,A.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+d,x,w,A.width,A.height,0,E,T,A.data)}}o.__maxMipLevel=f.length-1}else{f=t.mipmaps;for(d=0;d<6;d++)if(u){n.texImage2D(34069+d,0,w,h[d].width,h[d].height,0,E,T,h[d].data);for(x=0;x<f.length;x++){var S=(A=f[x]).image[d].image;n.texImage2D(34069+d,x+1,w,S.width,S.height,0,E,T,S.data)}}else{n.texImage2D(34069+d,0,w,E,T,h[d]);for(x=0;x<f.length;x++){A=f[x];n.texImage2D(34069+d,x+1,w,E,T,A.image[d])}}o.__maxMipLevel=f.length}y(t,m)&&_(34067,t,p.width,p.height),o.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture)}}function M(e,t){n.activeTexture(33984+t),n.bindTexture(34067,i.get(e).__webglTexture)}var C={1e3:10497,1001:33071,1002:33648},R={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function I(n,a,o){o?(e.texParameteri(n,10242,C[a.wrapS]),e.texParameteri(n,10243,C[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[a.wrapR]),e.texParameteri(n,10240,R[a.magFilter]),e.texParameteri(n,10241,R[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(a.magFilter)),e.texParameteri(n,10241,E(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=t.get("EXT_texture_filter_anisotropic");if(s){if(1015===a.type&&null===t.get("OES_texture_float_linear"))return;if(1016===a.type&&null===(l||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function P(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",T),t.__webglTexture=e.createTexture(),o.memory.textures++)}function L(t,i,r){var o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),P(t,i),n.activeTexture(33984+r),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment);var s=function(e){return!l&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)}(i)&&!1===v(i.image),u=g(i.image,s,!1,h),c=v(u)||l,d=a.convert(i.format),f=a.convert(i.type),p=b(i.internalFormat,d,f);I(o,i,c);var m,E=i.mipmaps;if(i.isDepthTexture){if(p=6402,1015===i.type){if(!1===l)throw new Error("Float Depth Texture only supported in WebGL2.0");p=36012}else l&&(p=33189);1026===i.format&&6402===p&&1012!==i.type&&1014!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=1012,f=a.convert(i.type)),1027===i.format&&(p=34041,1020!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=1020,f=a.convert(i.type))),n.texImage2D(3553,0,p,u.width,u.height,0,d,f,null)}else if(i.isDataTexture)if(E.length>0&&c){for(var T=0,w=E.length;T<w;T++)m=E[T],n.texImage2D(3553,T,p,m.width,m.height,0,d,f,m.data);i.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,p,u.width,u.height,0,d,f,u.data),t.__maxMipLevel=0;else if(i.isCompressedTexture){for(T=0,w=E.length;T<w;T++)m=E[T],1023!==i.format&&1022!==i.format?null!==d?n.compressedTexImage2D(3553,T,p,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,T,p,m.width,m.height,0,d,f,m.data);t.__maxMipLevel=E.length-1}else if(i.isDataTexture2DArray)n.texImage3D(35866,0,p,u.width,u.height,u.depth,0,d,f,u.data),t.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(32879,0,p,u.width,u.height,u.depth,0,d,f,u.data),t.__maxMipLevel=0;else if(E.length>0&&c){for(T=0,w=E.length;T<w;T++)m=E[T],n.texImage2D(3553,T,p,d,f,m);i.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,p,d,f,u),t.__maxMipLevel=0;y(i,c)&&_(o,i,u.width,u.height),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}function D(t,r,o,s){var l=a.convert(r.texture.format),u=a.convert(r.texture.type),c=b(r.texture.internalFormat,l,u);n.texImage2D(s,0,c,r.width,r.height,0,l,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,i.get(r.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function O(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){if(i){var r=k(n);e.renderbufferStorageMultisample(36161,r,33189,n.width,n.height)}else e.renderbufferStorage(36161,33189,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(i){r=k(n);e.renderbufferStorageMultisample(36161,r,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=a.convert(n.texture.format),s=a.convert(n.texture.type),l=b(n.texture.internalFormat,o,s);if(i){r=k(n);e.renderbufferStorageMultisample(36161,r,l,n.width,n.height)}else e.renderbufferStorage(36161,l,n.width,n.height)}e.bindRenderbuffer(36161,null)}function N(t){var n=i.get(t),r=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),A(n.depthTexture,0);var r=i.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)e.framebufferTexture2D(36160,36096,3553,r,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,r,0)}}(n.__webglFramebuffer,t)}else if(r){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),O(n.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),O(n.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function k(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(d,e.samples):0}var F=!1,B=!1;this.allocateTextureUnit=function(){var e=x;return e>=u&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+u),x+=1,e},this.resetTextureUnits=function(){x=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){var r=i.get(e);e.version>0&&r.__version!==e.version?L(r,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(e,t){var r=i.get(e);e.version>0&&r.__version!==e.version?L(r,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=S,this.setTextureCubeDynamic=M,this.setupRenderTarget=function(t){var r=i.get(t),s=i.get(t.texture);t.addEventListener("dispose",w),s.__webglTexture=e.createTexture(),o.memory.textures++;var u=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,h=v(t)||l;if(u){r.__webglFramebuffer=[];for(var d=0;d<6;d++)r.__webglFramebuffer[d]=e.createFramebuffer()}else if(r.__webglFramebuffer=e.createFramebuffer(),c)if(l){r.__webglMultisampledFramebuffer=e.createFramebuffer(),r.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,r.__webglColorRenderbuffer);var f=a.convert(t.texture.format),p=a.convert(t.texture.type),m=b(t.texture.internalFormat,f,p),g=k(t);e.renderbufferStorageMultisample(36161,g,m,t.width,t.height),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(r.__webglDepthRenderbuffer=e.createRenderbuffer(),O(r.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,s.__webglTexture),I(34067,t.texture,h);for(d=0;d<6;d++)D(r.__webglFramebuffer[d],t,36064,34069+d);y(t.texture,h)&&_(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),I(3553,t.texture,h),D(r.__webglFramebuffer,t,36064,3553),y(t.texture,h)&&_(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(y(t,v(e)||l)){var r=e.isWebGLCubeRenderTarget?34067:3553,a=i.get(t).__webglTexture;n.bindTexture(r,a),_(r,t,e.width,e.height),n.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(l){var n=i.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var r=t.width,a=t.height,o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,r,a,0,0,r,a,o,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?S(e,t):M(e,t)}}function mm(e,t,n){var i=n.isWebGL2;return{convert:function(e){var n;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(1015===e)return 5126;if(1016===e)return i?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(1022===e)return 6407;if(1023===e)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(1026===e)return 6402;if(1027===e)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(33776===e||33777===e||33778===e||33779===e){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===e)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===e)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===e||37496===e)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(37492===e)return n.COMPRESSED_RGB8_ETC2;if(37496===e)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:1020===e?i?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function gm(e){df.call(this),this.cameras=e||[]}function vm(){ph.call(this),this.type="Group"}function ym(e,t){var n=this,i=null,r=1,a=null,o="local-floor",s=null,l=[],u=new Map,c=new df;c.layers.enable(1),c.viewport=new kc;var h=new df;h.layers.enable(2),h.viewport=new kc;var d=new gm([c,h]);d.layers.enable(1),d.layers.enable(2);var f=null,p=null;function m(e){var t=u.get(e.inputSource);t&&(t.targetRay&&t.targetRay.dispatchEvent({type:e.type}),t.grip&&t.grip.dispatchEvent({type:e.type}))}function g(){u.forEach((function(e,t){e.targetRay&&(e.targetRay.dispatchEvent({type:"disconnected",data:t}),e.targetRay.visible=!1),e.grip&&(e.grip.dispatchEvent({type:"disconnected",data:t}),e.grip.visible=!1)})),u.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),w.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(e){a=e,w.setContext(i),w.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(e){for(var t=i.inputSources,n=0;n<l.length;n++)u.set(t[n],l[n]);for(n=0;n<e.removed.length;n++){var r=e.removed[n];(a=u.get(r))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"disconnected",data:r}),a.grip&&a.grip.dispatchEvent({type:"disconnected",data:r}),u.delete(r))}for(n=0;n<e.added.length;n++){var a;r=e.added[n];(a=u.get(r))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"connected",data:r}),a.grip&&a.grip.dispatchEvent({type:"connected",data:r}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=l[e];return void 0===t&&(t={},l[e]=t),void 0===t.targetRay&&(t.targetRay=new vm,t.targetRay.matrixAutoUpdate=!1,t.targetRay.visible=!1),t.targetRay},this.getControllerGrip=function(e){var t=l[e];return void 0===t&&(t={},l[e]=t),void 0===t.grip&&(t.grip=new vm,t.grip.matrixAutoUpdate=!1,t.grip.visible=!1),t.grip},this.setFramebufferScaleFactor=function(e){r=e,1==n.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(e){o=e},this.getReferenceSpace=function(){return a},this.getSession=function(){return i},this.setSession=function(e){if(null!==(i=e)){i.addEventListener("select",m),i.addEventListener("selectstart",m),i.addEventListener("selectend",m),i.addEventListener("squeeze",m),i.addEventListener("squeezestart",m),i.addEventListener("squeezeend",m),i.addEventListener("end",g);var n=t.getContextAttributes(),a={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:r},s=new XRWebGLLayer(i,t,a);i.updateRenderState({baseLayer:s}),i.requestReferenceSpace(o).then(v),i.addEventListener("inputsourceschange",y)}};var _=new zc,b=new zc;function E(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){d.near=h.near=c.near=e.near,d.far=h.far=c.far=e.far,f===d.near&&p===d.far||(i.updateRenderState({depthNear:d.near,depthFar:d.far}),f=d.near,p=d.far);var t=e.parent,n=d.cameras;E(d,t);for(var r=0;r<n.length;r++)E(n[r],t);e.matrixWorld.copy(d.matrixWorld);for(var a=e.children,o=(r=0,a.length);r<o;r++)a[r].updateMatrixWorld(!0);return function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var i=_.distanceTo(b),r=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],c=(r[8]-1)/r[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=i/(-c+h),m=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=o+p,v=s+p,y=d-m,E=f+(i-m),T=l*s/v*g,w=u*s/v*g;e.projectionMatrix.makePerspective(y,E,T,w,g,v)}(d,c,h),d};var T=null;var w=new bf;w.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(a))){var r=s.views,o=i.renderState.baseLayer;e.setFramebuffer(o.framebuffer);for(var u=0;u<r.length;u++){var c=r[u],h=o.getViewport(c),f=d.cameras[u];f.matrix.fromArray(c.transform.matrix),f.projectionMatrix.fromArray(c.projectionMatrix),f.viewport.set(h.x,h.y,h.width,h.height),0===u&&d.matrix.copy(f.matrix)}}var p=i.inputSources;for(u=0;u<l.length;u++){var m=l[u],g=p[u],v=null,y=null;g&&(m.targetRay&&null!==(v=n.getPose(g.targetRaySpace,a))&&(m.targetRay.matrix.fromArray(v.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&g.gripSpace&&null!==(y=n.getPose(g.gripSpace,a))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==v),m.grip&&(m.grip.visible=null!==y)}T&&T(t,n)})),this.setAnimationLoop=function(e){T=e},this.dispose=function(){}}function _m(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,d=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,p,m,g,v,y,_,b,E,T,w,x,A,S,M,C,R,I,P=this,L=!1,D=null,O=0,N=0,k=null,F=null,B=-1,U={geometry:null,program:null,wireframe:!1},j=null,G=null,z=new kc,H=new kc,V=null,W=t.width,q=t.height,Y=1,X=null,K=null,Q=new kc(0,0,W,q),Z=new kc(0,0,W,q),J=!1,$=new yf,ee=new Rf,te=!1,ne=!1,ie=new Qc,re=new zc;function ae(){return null===k?Y:1}try{var oe={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(t.addEventListener("webglcontextlost",ce,!1),t.addEventListener("webglcontextrestored",he,!1),null===(f=n||t.getContext("webgl",oe)||t.getContext("experimental-webgl",oe)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function se(){p=new If(f),!1===(m=new Cf(f,p,e)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),I=new mm(f,p,m),(g=new fm(f,p,m)).scissor(H.copy(Z).multiplyScalar(Y).floor()),g.viewport(z.copy(Q).multiplyScalar(Y).floor()),v=new Df(f),y=new $p,_=new pm(f,p,g,y,m,I,v),b=new Ef(f,m),E=new Pf(f,b,v),T=new kf(f,E,b,v),M=new Nf(f),w=new Jp(P,p,m),x=new im,A=new um,S=new Sf(P,g,T,s),C=new Mf(f,p,v,m),R=new Lf(f,p,v,m),v.programs=w.programs,P.capabilities=m,P.extensions=p,P.properties=y,P.renderLists=x,P.state=g,P.info=v}se();var le=new ym(P,f);this.xr=le;var ue=new dm(P,T,m.maxTextureSize);function ce(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),L=!0}function he(){console.log("THREE.WebGLRenderer: Context Restored."),L=!1,se()}function de(e){var t=e.target;t.removeEventListener("dispose",de),function(e){fe(e),y.remove(e)}(t)}function fe(e){var t=y.get(e).program;e.program=void 0,void 0!==t&&w.releaseProgram(t)}this.shadowMap=ue,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var e=p.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=p.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(e){void 0!==e&&(Y=e,this.setSize(W,q,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Pc),e.set(W,q)},this.setSize=function(e,n,i){le.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=e,q=n,t.width=Math.floor(e*Y),t.height=Math.floor(n*Y),!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Pc),e.set(W*Y,q*Y).floor()},this.setDrawingBufferSize=function(e,n,i){W=e,q=n,Y=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new kc),e.copy(z)},this.getViewport=function(e){return e.copy(Q)},this.setViewport=function(e,t,n,i){e.isVector4?Q.set(e.x,e.y,e.z,e.w):Q.set(e,t,n,i),g.viewport(z.copy(Q).multiplyScalar(Y).floor())},this.getScissor=function(e){return e.copy(Z)},this.setScissor=function(e,t,n,i){e.isVector4?Z.set(e.x,e.y,e.z,e.w):Z.set(e,t,n,i),g.scissor(H.copy(Z).multiplyScalar(Y).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(e){g.setScissorTest(J=e)},this.setOpaqueSort=function(e){X=e},this.setTransparentSort=function(e){K=e},this.getClearColor=function(){return S.getClearColor()},this.setClearColor=function(){S.setClearColor.apply(S,arguments)},this.getClearAlpha=function(){return S.getClearAlpha()},this.setClearAlpha=function(){S.setClearAlpha.apply(S,arguments)},this.clear=function(e,t,n){var i=0;(void 0===e||e)&&(i|=16384),(void 0===t||t)&&(i|=256),(void 0===n||n)&&(i|=1024),f.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ce,!1),t.removeEventListener("webglcontextrestored",he,!1),x.dispose(),A.dispose(),y.dispose(),T.dispose(),le.dispose(),ge.stop()},this.renderBufferImmediate=function(e,t){g.initAttributes();var n=y.get(e);e.hasPositions&&!n.position&&(n.position=f.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),e.hasColors&&!n.color&&(n.color=f.createBuffer());var i=t.getAttributes();e.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,e.positionArray,35048),g.enableAttribute(i.position),f.vertexAttribPointer(i.position,3,5126,!1,0,0)),e.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,e.normalArray,35048),g.enableAttribute(i.normal),f.vertexAttribPointer(i.normal,3,5126,!1,0,0)),e.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,e.uvArray,35048),g.enableAttribute(i.uv),f.vertexAttribPointer(i.uv,2,5126,!1,0,0)),e.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,e.colorArray,35048),g.enableAttribute(i.color),f.vertexAttribPointer(i.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,e.count),e.count=0};var pe=new mh;this.renderBufferDirect=function(e,t,n,i,r,a){null===t&&(t=pe);var o=r.isMesh&&r.matrixWorld.determinant()<0,s=Ee(e,t,i,r);g.setMaterial(i,o);var l=!1;U.geometry===n.id&&U.program===s.id&&U.wireframe===(!0===i.wireframe)||(U.geometry=n.id,U.program=s.id,U.wireframe=!0===i.wireframe,l=!0),(i.morphTargets||i.morphNormals)&&(M.update(r,n,i,s),l=!0);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var h,d=1;!0===i.wireframe&&(u=E.getWireframeAttribute(n),d=2);var v=C;null!==u&&(h=b.get(u),(v=R).setIndex(h)),l&&(!function(e,t,n,i){if(!1===m.isWebGL2&&(e.isInstancedMesh||t.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;g.initAttributes();var r=t.attributes,a=i.getAttributes(),o=n.defaultAttributeValues;for(var s in a){var l=a[s];if(l>=0){var u=r[s];if(void 0!==u){var c=u.normalized,h=u.itemSize;if(void 0===(w=b.get(u)))continue;var d=w.buffer,v=w.type,y=w.bytesPerElement;if(u.isInterleavedBufferAttribute){var _=u.data,E=_.stride,T=u.offset;_&&_.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(l,_.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=_.meshPerAttribute*_.count)):g.enableAttribute(l),f.bindBuffer(34962,d),f.vertexAttribPointer(l,h,v,c,E*y,T*y)}else u.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=u.meshPerAttribute*u.count)):g.enableAttribute(l),f.bindBuffer(34962,d),f.vertexAttribPointer(l,h,v,c,0,0)}else if("instanceMatrix"===s){var w;if(void 0===(w=b.get(e.instanceMatrix)))continue;d=w.buffer,v=w.type;g.enableAttributeAndDivisor(l+0,1),g.enableAttributeAndDivisor(l+1,1),g.enableAttributeAndDivisor(l+2,1),g.enableAttributeAndDivisor(l+3,1),f.bindBuffer(34962,d),f.vertexAttribPointer(l+0,4,v,!1,64,0),f.vertexAttribPointer(l+1,4,v,!1,64,16),f.vertexAttribPointer(l+2,4,v,!1,64,32),f.vertexAttribPointer(l+3,4,v,!1,64,48)}else if(void 0!==o){var x=o[s];if(void 0!==x)switch(x.length){case 2:f.vertexAttrib2fv(l,x);break;case 3:f.vertexAttrib3fv(l,x);break;case 4:f.vertexAttrib4fv(l,x);break;default:f.vertexAttrib1fv(l,x)}}}}g.disableUnusedAttributes()}(r,n,i,s),null!==u&&f.bindBuffer(34963,h.buffer));var y=null!==u?u.count:c.count,_=n.drawRange.start*d,T=n.drawRange.count*d,w=null!==a?a.start*d:0,x=null!==a?a.count*d:1/0,A=Math.max(_,w),S=Math.min(y,_+T,w+x)-1,I=Math.max(0,S-A+1);if(0!==I){if(r.isMesh)!0===i.wireframe?(g.setLineWidth(i.wireframeLinewidth*ae()),v.setMode(1)):v.setMode(4);else if(r.isLine){var P=i.linewidth;void 0===P&&(P=1),g.setLineWidth(P*ae()),r.isLineSegments?v.setMode(1):r.isLineLoop?v.setMode(2):v.setMode(3)}else r.isPoints?v.setMode(0):r.isSprite&&v.setMode(4);r.isInstancedMesh?v.renderInstances(n,A,I,r.count):n.isInstancedBufferGeometry?v.renderInstances(n,A,I,n.maxInstancedCount):v.render(A,I)}},this.compile=function(e,t){(d=A.get(e,t)).init(),e.traverse((function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t);var n={};e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var i=0;i<t.material.length;i++)t.material[i].uuid in n==!1&&(be(t.material[i],e,t),n[t.material[i].uuid]=!0);else t.material.uuid in n==!1&&(be(t.material,e,t),n[t.material.uuid]=!0)}))};var me=null;var ge=new bf;function ve(e,t,n,i){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||$.intersectsSprite(e)){i&&re.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie);var r=T.update(e);(a=e.material).visible&&h.push(e,r,a,n,re.z,null)}}else if(e.isImmediateRenderObject)i&&re.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie),h.push(e,null,e.material,n,re.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==v.render.frame&&(e.skeleton.update(),e.skeleton.frame=v.render.frame),!e.frustumCulled||$.intersectsObject(e))){i&&re.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie);r=T.update(e);var a=e.material;if(Array.isArray(a))for(var o=r.groups,s=0,l=o.length;s<l;s++){var u=o[s],c=a[u.materialIndex];c&&c.visible&&h.push(e,r,c,n,re.z,u)}else a.visible&&h.push(e,r,a,n,re.z,null)}var f=e.children;for(s=0,l=f.length;s<l;s++)ve(f[s],t,n,i)}}function ye(e,t,n,i){for(var r=0,a=e.length;r<a;r++){var o=e[r],s=o.object,l=o.geometry,u=void 0===i?o.material:i,c=o.group;if(n.isArrayCamera){G=n;for(var h=n.cameras,f=0,p=h.length;f<p;f++){var m=h[f];s.layers.test(m.layers)&&(g.viewport(z.copy(m.viewport)),d.setupLights(m),_e(s,t,m,l,u,c))}}else G=null,_e(s,t,n,l,u,c)}}function _e(e,t,n,i,r,a){if(e.onBeforeRender(P,t,n,i,r,a),d=A.get(t,G||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=Ee(n,t,r,e);g.setMaterial(r),U.geometry=null,U.program=null,U.wireframe=!1,function(e,t){e.render((function(e){P.renderBufferImmediate(e,t)}))}(e,o)}else P.renderBufferDirect(n,t,i,r,e,a);e.onAfterRender(P,t,n,i,r,a),d=A.get(t,G||n)}function be(e,t,n){var i=y.get(e),r=d.state.lights,a=d.state.shadowsArray,o=r.state.version,s=w.getParameters(e,r.state,a,t,ee.numPlanes,ee.numIntersection,n),l=w.getProgramCacheKey(s),u=i.program,c=!0;if(void 0===u)e.addEventListener("dispose",de);else if(u.cacheKey!==l)fe(e);else if(i.lightsStateVersion!==o)i.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(u=w.acquireProgram(s,l),i.program=u,i.uniforms=s.uniforms,i.environment=e.isMeshStandardMaterial?t.environment:null,i.outputEncoding=P.outputEncoding,e.program=u);var h=u.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var f=0;f<P.maxMorphTargets;f++)h["morphTarget"+f]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(f=0;f<P.maxMorphNormals;f++)h["morphNormal"+f]>=0&&e.numSupportedMorphNormals++}var p=i.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=ee.numPlanes,i.numIntersection=ee.numIntersection,p.clippingPlanes=ee.uniform),i.fog=t.fog,i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(p.ambientLightColor.value=r.state.ambient,p.lightProbe.value=r.state.probe,p.directionalLights.value=r.state.directional,p.directionalLightShadows.value=r.state.directionalShadow,p.spotLights.value=r.state.spot,p.spotLightShadows.value=r.state.spotShadow,p.rectAreaLights.value=r.state.rectArea,p.pointLights.value=r.state.point,p.pointLightShadows.value=r.state.pointShadow,p.hemisphereLights.value=r.state.hemi,p.directionalShadowMap.value=r.state.directionalShadowMap,p.directionalShadowMatrix.value=r.state.directionalShadowMatrix,p.spotShadowMap.value=r.state.spotShadowMap,p.spotShadowMatrix.value=r.state.spotShadowMatrix,p.pointShadowMap.value=r.state.pointShadowMap,p.pointShadowMatrix.value=r.state.pointShadowMatrix);var m=i.program.getUniforms(),g=Op.seqWithValue(m.seq,p);i.uniformsList=g}function Ee(e,t,n,i){_.resetTextureUnits();var r=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=y.get(n),s=d.state.lights;if(te&&(ne||e!==j)){var l=e===j&&n.id===B;ee.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,o,l)}n.version===o.__version?void 0===o.program||n.fog&&o.fog!==r||o.environment!==a||o.needsLights&&o.lightsStateVersion!==s.state.version?be(n,t,i):void 0===o.numClippingPlanes||o.numClippingPlanes===ee.numPlanes&&o.numIntersection===ee.numIntersection?o.outputEncoding!==P.outputEncoding&&be(n,t,i):be(n,t,i):(be(n,t,i),o.__version=n.version);var u,c,h=!1,p=!1,v=!1,b=o.program,E=b.getUniforms(),T=o.uniforms;if(g.useProgram(b.program)&&(h=!0,p=!0,v=!0),n.id!==B&&(B=n.id,p=!0),h||j!==e){if(E.setValue(f,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&E.setValue(f,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),j!==e&&(j=e,p=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var w=E.map.cameraPosition;void 0!==w&&w.setValue(f,re.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&E.setValue(f,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&E.setValue(f,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){E.setOptional(f,i,"bindMatrix"),E.setOptional(f,i,"bindMatrixInverse");var x=i.skeleton;if(x){var A=x.bones;if(m.floatVertexTextures){if(void 0===x.boneTexture){var S=Math.sqrt(4*A.length);S=Ic.ceilPowerOfTwo(S),S=Math.max(S,4);var M=new Float32Array(S*S*4);M.set(x.boneMatrices);var C=new mf(M,S,S,1023,1015);x.boneMatrices=M,x.boneTexture=C,x.boneTextureSize=S}E.setValue(f,"boneTexture",x.boneTexture,_),E.setValue(f,"boneTextureSize",x.boneTextureSize)}else E.setOptional(f,x,"boneMatrices")}}return(p||o.receiveShadow!==i.receiveShadow)&&(o.receiveShadow=i.receiveShadow,E.setValue(f,"receiveShadow",i.receiveShadow)),p&&(E.setValue(f,"toneMappingExposure",P.toneMappingExposure),E.setValue(f,"toneMappingWhitePoint",P.toneMappingWhitePoint),o.needsLights&&(c=v,(u=T).ambientLightColor.needsUpdate=c,u.lightProbe.needsUpdate=c,u.directionalLights.needsUpdate=c,u.directionalLightShadows.needsUpdate=c,u.pointLights.needsUpdate=c,u.pointLightShadows.needsUpdate=c,u.spotLights.needsUpdate=c,u.spotLightShadows.needsUpdate=c,u.rectAreaLights.needsUpdate=c,u.hemisphereLights.needsUpdate=c),r&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(T,r),n.isMeshBasicMaterial?Te(T,n):n.isMeshLambertMaterial?(Te(T,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(T,n)):n.isMeshToonMaterial?(Te(T,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshPhongMaterial?(Te(T,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshStandardMaterial?(Te(T,n,a),n.isMeshPhysicalMaterial?function(e,t,n){we(e,t,n),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transparency.value=t.transparency}(T,n,a):we(T,n,a)):n.isMeshMatcapMaterial?(Te(T,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshDepthMaterial?(Te(T,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshDistanceMaterial?(Te(T,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(T,n)):n.isMeshNormalMaterial?(Te(T,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(T,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(T,n)):n.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*Y,e.scale.value=.5*q,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(T,n):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(T,n):n.isShadowMaterial&&(T.color.value.copy(n.color),T.opacity.value=n.opacity),void 0!==T.ltc_1&&(T.ltc_1.value=_f.LTC_1),void 0!==T.ltc_2&&(T.ltc_2.value=_f.LTC_2),Op.upload(f,o.uniformsList,T,_),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Op.upload(f,o.uniformsList,T,_),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&E.setValue(f,"center",i.center),E.setValue(f,"modelViewMatrix",i.modelViewMatrix),E.setValue(f,"normalMatrix",i.normalMatrix),E.setValue(f,"modelMatrix",i.matrixWorld),b}function Te(e,t,n){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap);var i,r,a=t.envMap||n;a&&(e.envMap.value=a,e.flipEnvMap.value=a.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=y.get(a).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix)),t.aoMap?r=t.aoMap:t.lightMap&&(r=t.lightMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uv2Transform.value.copy(r.matrix))}function we(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}ge.setAnimationLoop((function(e){le.isPresenting||me&&me(e)})),"undefined"!=typeof window&&ge.setContext(window),this.setAnimationLoop=function(e){me=e,le.setAnimationLoop(e),ge.start()},this.render=function(e,t){var n,i;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),t&&t.isCamera){if(!L){U.geometry=null,U.program=null,U.wireframe=!1,B=-1,j=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),le.enabled&&le.isPresenting&&(t=le.getCamera(t)),(d=A.get(e,t)).init(),e.onBeforeRender(P,e,t,n||k),ie.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromProjectionMatrix(ie),ne=this.localClippingEnabled,te=ee.init(this.clippingPlanes,ne,t),(h=x.get(e,t)).init(),ve(e,t,0,P.sortObjects),h.finish(),!0===P.sortObjects&&h.sort(X,K),te&&ee.beginShadows();var r=d.state.shadowsArray;ue.render(r,e,t),d.setupLights(t),te&&ee.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),S.render(h,e,t,i);var a=h.opaque,o=h.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&ye(a,e,t,s),o.length&&ye(o,e,t,s)}else a.length&&ye(a,e,t),o.length&&ye(o,e,t);e.onAfterRender(P,e,t),null!==k&&(_.updateRenderTargetMipmap(k),_.updateMultisampleRenderTarget(k)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){D!==e&&null===k&&f.bindFramebuffer(36160,e),D=e},this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return k},this.setRenderTarget=function(e,t,n){k=e,O=t,N=n,e&&void 0===y.get(e).__webglFramebuffer&&_.setupRenderTarget(e);var i=D,r=!1;if(e){var a=y.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=a[t||0],r=!0):i=e.isWebGLMultisampleRenderTarget?y.get(e).__webglMultisampledFramebuffer:a,z.copy(e.viewport),H.copy(e.scissor),V=e.scissorTest}else z.copy(Q).multiplyScalar(Y).floor(),H.copy(Z).multiplyScalar(Y).floor(),V=J;if(F!==i&&(f.bindFramebuffer(36160,i),F=i),g.viewport(z),g.scissor(H),g.setScissorTest(V),r){var o=y.get(e.texture);f.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,i,r,a,o){if(e&&e.isWebGLRenderTarget){var s=y.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){var l=!1;s!==F&&(f.bindFramebuffer(36160,s),l=!0);try{var u=e.texture,c=u.format,h=u.type;if(1023!==c&&I.convert(c)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===h||I.convert(h)===f.getParameter(35738)||1015===h&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||1016===h&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&f.readPixels(t,n,i,r,I.convert(c),I.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&f.bindFramebuffer(36160,F)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var i=Math.pow(2,-n),r=Math.floor(t.image.width*i),a=Math.floor(t.image.height*i),o=I.convert(t.format);_.setTexture2D(t,0),f.copyTexImage2D(3553,n,o,e.x,e.y,r,a,0),g.unbindTexture()},this.copyTextureToTexture=function(e,t,n,i){var r=t.image.width,a=t.image.height,o=I.convert(n.format),s=I.convert(n.type);_.setTexture2D(n,0),t.isDataTexture?f.texSubImage2D(3553,i||0,e.x,e.y,r,a,o,s,t.image.data):f.texSubImage2D(3553,i||0,e.x,e.y,o,s,t.image),g.unbindTexture()},this.initTexture=function(e){_.setTexture2D(e,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function bm(e,t){this.name="",this.color=new ad(e),this.density=void 0!==t?t:25e-5}function Em(e,t,n){this.name="",this.color=new ad(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Tm(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}gm.prototype=Object.assign(Object.create(df.prototype),{constructor:gm,isArrayCamera:!0}),vm.prototype=Object.assign(Object.create(ph.prototype),{constructor:vm,isGroup:!0}),Object.assign(ym.prototype,Sc.prototype),Object.assign(bm.prototype,{isFogExp2:!0,clone:function(){return new bm(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Em.prototype,{isFog:!0,clone:function(){return new Em(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Tm.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Tm.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var wm,xm=new zc;function Am(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}function Sm(e){hd.call(this),this.type="SpriteMaterial",this.color=new ad(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(Am.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Am.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)xm.x=this.getX(t),xm.y=this.getY(t),xm.z=this.getZ(t),xm.applyMatrix4(e),this.setXYZ(t,xm.x,xm.y,xm.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}}),Sm.prototype=Object.create(hd.prototype),Sm.prototype.constructor=Sm,Sm.prototype.isSpriteMaterial=!0,Sm.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Mm=new zc,Cm=new zc,Rm=new zc,Im=new Pc,Pm=new Pc,Lm=new Qc,Dm=new zc,Om=new zc,Nm=new zc,km=new Pc,Fm=new Pc,Bm=new Pc;function Um(e){if(ph.call(this),this.type="Sprite",void 0===wm){wm=new Dd;var t=new Tm(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);wm.setIndex([0,1,2,0,2,3]),wm.setAttribute("position",new Am(t,3,0,!1)),wm.setAttribute("uv",new Am(t,2,3,!1))}this.geometry=wm,this.material=void 0!==e?e:new Sm,this.center=new Pc(.5,.5)}function jm(e,t,n,i,r,a){Im.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(Pm.x=a*Im.x-r*Im.y,Pm.y=r*Im.x+a*Im.y):Pm.copy(Im),e.copy(t),e.x+=Pm.x,e.y+=Pm.y,e.applyMatrix4(Lm)}Um.prototype=Object.assign(Object.create(ph.prototype),{constructor:Um,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Cm.setFromMatrixScale(this.matrixWorld),Lm.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Rm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Cm.multiplyScalar(-Rm.z);var n,i,r=this.material.rotation;0!==r&&(i=Math.cos(r),n=Math.sin(r));var a=this.center;jm(Dm.set(-.5,-.5,0),Rm,a,Cm,n,i),jm(Om.set(.5,-.5,0),Rm,a,Cm,n,i),jm(Nm.set(.5,.5,0),Rm,a,Cm,n,i),km.set(0,0),Fm.set(1,0),Bm.set(1,1);var o=e.ray.intersectTriangle(Dm,Om,Nm,!1,Mm);if(null!==o||(jm(Om.set(-.5,.5,0),Rm,a,Cm,n,i),Fm.set(0,1),null!==(o=e.ray.intersectTriangle(Dm,Nm,Om,!1,Mm)))){var s=e.ray.origin.distanceTo(Mm);s<e.near||s>e.far||t.push({distance:s,point:Mm.clone(),uv:td.getUV(Mm,Dm,Om,Nm,km,Fm,Bm,new Pc),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return ph.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Gm=new zc,zm=new zc;function Hm(){ph.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Vm(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Zd.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Qc,this.bindMatrixInverse=new Qc}Hm.prototype=Object.assign(Object.create(ph.prototype),{constructor:Hm,isLOD:!0,copy:function(e){ph.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var r=t[n];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){for(var n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){Gm.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Gm);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){Gm.setFromMatrixPosition(e.matrixWorld),zm.setFromMatrixPosition(this.matrixWorld);var n=Gm.distanceTo(zm)/e.zoom;t[0].object.visible=!0;for(var i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}},toJSON:function(e){var t=ph.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var a=n[i];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),Vm.prototype=Object.assign(Object.create(Zd.prototype),{constructor:Vm,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new kc,t=this.geometry.attributes.skinWeight,n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Zd.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Wm=new Qc,qm=new Qc;function Ym(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Qc)}}function Xm(){ph.call(this),this.type="Bone"}Object.assign(Ym.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Qc;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,a=e.length;r<a;r++){var o=e[r]?e[r].matrixWorld:qm;Wm.multiplyMatrices(o,t[r]),Wm.toArray(n,16*r)}void 0!==i&&(i.needsUpdate=!0)},clone:function(){return new Ym(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),Xm.prototype=Object.assign(Object.create(ph.prototype),{constructor:Xm,isBone:!0});var Km=new Qc,Qm=new Qc,Zm=[],Jm=new Zd;function $m(e,t,n){Zd.call(this,e,t),this.instanceMatrix=new pd(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function eg(e){hd.call(this),this.type="LineBasicMaterial",this.color=new ad(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}$m.prototype=Object.assign(Object.create(Zd.prototype),{constructor:$m,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,i=this.count;if(Jm.geometry=this.geometry,Jm.material=this.material,void 0!==Jm.material)for(var r=0;r<i;r++)this.getMatrixAt(r,Km),Qm.multiplyMatrices(n,Km),Jm.matrixWorld=Qm,Jm.raycast(e,Zm),Zm.length>0&&(Zm[0].instanceId=r,Zm[0].object=this,t.push(Zm[0]),Zm.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),eg.prototype=Object.create(hd.prototype),eg.prototype.constructor=eg,eg.prototype.isLineBasicMaterial=!0,eg.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var tg=new zc,ng=new zc,ig=new Qc,rg=new jh,ag=new Lh;function og(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),ph.call(this),this.type="Line",this.geometry=void 0!==e?e:new Dd,this.material=void 0!==t?t:new eg}og.prototype=Object.assign(Object.create(ph.prototype),{constructor:og,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],i=1,r=t.count;i<r;i++)tg.fromBufferAttribute(t,i-1),ng.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=tg.distanceTo(ng);e.setAttribute("lineDistance",new Td(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;(n=e.lineDistances)[0]=0;for(i=1,r=a.length;i<r;i++)n[i]=n[i-1],n[i]+=a[i-1].distanceTo(a[i])}return this},raycast:function(e,t){var n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ag.copy(n.boundingSphere),ag.applyMatrix4(i),ag.radius+=r,!1!==e.ray.intersectsSphere(ag)){ig.getInverse(i),rg.copy(e.ray).applyMatrix4(ig);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new zc,l=new zc,u=new zc,c=new zc,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,f=n.attributes.position.array;if(null!==d)for(var p=d.array,m=0,g=p.length-1;m<g;m+=h){var v=p[m],y=p[m+1];if(s.fromArray(f,3*v),l.fromArray(f,3*y),!(rg.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=f.length/3-1;m<g;m+=h){if(s.fromArray(f,3*m),l.fromArray(f,3*m+3),!(rg.distanceSqToSegment(s,l,c,u)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var _=n.vertices,b=_.length;for(m=0;m<b-1;m+=h){var E;if(!(rg.distanceSqToSegment(_[m],_[m+1],c,u)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var sg=new zc,lg=new zc;function ug(e,t){og.call(this,e,t),this.type="LineSegments"}function cg(e,t){og.call(this,e,t),this.type="LineLoop"}function hg(e){hd.call(this),this.type="PointsMaterial",this.color=new ad(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}ug.prototype=Object.assign(Object.create(og.prototype),{constructor:ug,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],i=0,r=t.count;i<r;i+=2)sg.fromBufferAttribute(t,i),lg.fromBufferAttribute(t,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+sg.distanceTo(lg);e.setAttribute("lineDistance",new Td(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for(n=e.lineDistances,i=0,r=a.length;i<r;i+=2)sg.copy(a[i]),lg.copy(a[i+1]),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+sg.distanceTo(lg)}return this}}),cg.prototype=Object.assign(Object.create(og.prototype),{constructor:cg,isLineLoop:!0}),hg.prototype=Object.create(hd.prototype),hg.prototype.constructor=hg,hg.prototype.isPointsMaterial=!0,hg.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var dg=new Qc,fg=new jh,pg=new Lh,mg=new zc;function gg(e,t){ph.call(this),this.type="Points",this.geometry=void 0!==e?e:new Dd,this.material=void 0!==t?t:new hg,this.updateMorphTargets()}function vg(e,t,n,i,r,a,o){var s=fg.distanceSqToPoint(e);if(s<n){var l=new zc;fg.closestPointToPoint(e,l),l.applyMatrix4(i);var u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}function yg(e,t,n,i,r,a,o,s,l){Nc.call(this,e,t,n,i,r,a,o,s,l),this.format=void 0!==o?o:1022,this.minFilter=void 0!==a?a:1006,this.magFilter=void 0!==r?r:1006,this.generateMipmaps=!1}function _g(e,t,n,i,r,a,o,s,l,u,c,h){Nc.call(this,null,a,o,s,l,u,i,r,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function bg(e,t,n,i,r,a,o,s,l){Nc.call(this,e,t,n,i,r,a,o,s,l),this.needsUpdate=!0}function Eg(e,t,n,i,r,a,o,s,l,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===u&&(n=1012),void 0===n&&1027===u&&(n=1020),Nc.call(this,null,i,r,a,o,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function Tg(e){Dd.call(this),this.type="WireframeGeometry";var t,n,i,r,a,o,s,l,u,c,h=[],d=[0,0],f={},p=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,i=m.length;t<i;t++){var g=m[t];for(n=0;n<3;n++)s=g[p[n]],l=g[p[(n+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]})}for(u in f)o=f[u],c=e.vertices[o.index1],h.push(c.x,c.y,c.z),c=e.vertices[o.index2],h.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,_,b,E,T,w;if(c=new zc,null!==e.index){for(v=e.attributes.position,y=e.index,0===(_=e.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),r=0,a=_.length;r<a;++r)for(t=E=(b=_[r]).start,i=E+b.count;t<i;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),l=y.getX(t+(n+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===f[u=d[0]+","+d[1]]&&(f[u]={index1:d[0],index2:d[1]});for(u in f)o=f[u],c.fromBufferAttribute(v,o.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,o.index2),h.push(c.x,c.y,c.z)}else for(t=0,i=(v=e.attributes.position).count/3;t<i;t++)for(n=0;n<3;n++)T=3*t+n,c.fromBufferAttribute(v,T),h.push(c.x,c.y,c.z),w=3*t+(n+1)%3,c.fromBufferAttribute(v,w),h.push(c.x,c.y,c.z)}this.setAttribute("position",new Td(h,3))}function wg(e,t,n){af.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new xg(e,t,n)),this.mergeVertices()}function xg(e,t,n){Dd.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i,r,a=[],o=[],s=[],l=[],u=1e-5,c=new zc,h=new zc,d=new zc,f=new zc,p=new zc;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(i=0;i<=n;i++){var g=i/n;for(r=0;r<=t;r++){var v=r/t;e(v,g,h),o.push(h.x,h.y,h.z),v-u>=0?(e(v-u,g,d),f.subVectors(h,d)):(e(v+u,g,d),f.subVectors(d,h)),g-u>=0?(e(v,g-u,d),p.subVectors(h,d)):(e(v,g+u,d),p.subVectors(d,h)),c.crossVectors(f,p).normalize(),s.push(c.x,c.y,c.z),l.push(v,g)}}for(i=0;i<n;i++)for(r=0;r<t;r++){var y=i*m+r,_=i*m+r+1,b=(i+1)*m+r+1,E=(i+1)*m+r;a.push(y,_,E),a.push(_,b,E)}this.setIndex(a),this.setAttribute("position",new Td(o,3)),this.setAttribute("normal",new Td(s,3)),this.setAttribute("uv",new Td(l,2))}function Ag(e,t,n,i){af.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new Sg(e,t,n,i)),this.mergeVertices()}function Sg(e,t,n,i){Dd.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1;var r=[],a=[];function o(e,t,n,i){var r,a,o=Math.pow(2,i),l=[];for(r=0;r<=o;r++){l[r]=[];var u=e.clone().lerp(n,r/o),c=t.clone().lerp(n,r/o),h=o-r;for(a=0;a<=h;a++)l[r][a]=0===a&&r===o?u:u.clone().lerp(c,a/h)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var d=Math.floor(a/2);a%2==0?(s(l[r][d+1]),s(l[r+1][d]),s(l[r][d])):(s(l[r][d+1]),s(l[r+1][d+1]),s(l[r+1][d]))}}function s(e){r.push(e.x,e.y,e.z)}function l(t,n){var i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function u(e,t,n,i){i<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=i/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){for(var n=new zc,i=new zc,r=new zc,a=0;a<t.length;a+=3)l(t[a+0],n),l(t[a+1],i),l(t[a+2],r),o(n,i,r,e)}(i=i||0),function(e){for(var t=new zc,n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){for(var e=new zc,t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];var n=c(e)/2/Math.PI+.5,i=(o=e,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(n,1-i)}var o;(function(){for(var e=new zc,t=new zc,n=new zc,i=new zc,o=new Pc,s=new Pc,l=new Pc,h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),i.copy(e).add(t).add(n).divideScalar(3);var f=c(i);u(o,d+0,e,f),u(s,d+2,t,f),u(l,d+4,n,f)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],n=a[e+2],i=a[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);r>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),i<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new Td(r,3)),this.setAttribute("normal",new Td(r.slice(),3)),this.setAttribute("uv",new Td(a,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function Mg(e,t){af.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Cg(e,t)),this.mergeVertices()}function Cg(e,t){Sg.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Rg(e,t){af.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ig(e,t)),this.mergeVertices()}function Ig(e,t){Sg.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Pg(e,t){af.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Lg(e,t)),this.mergeVertices()}function Lg(e,t){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Sg.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Dg(e,t){af.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Og(e,t)),this.mergeVertices()}function Og(e,t){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];Sg.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ng(e,t,n,i,r,a){af.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new kg(e,t,n,i,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function kg(e,t,n,i,r){Dd.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1;var a=e.computeFrenetFrames(t,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,l=new zc,u=new zc,c=new Pc,h=new zc,d=[],f=[],p=[],m=[];function g(r){h=e.getPointAt(r/t,h);var o=a.normals[r],c=a.binormals[r];for(s=0;s<=i;s++){var p=s/i*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);u.x=g*o.x+m*c.x,u.y=g*o.y+m*c.y,u.z=g*o.z+m*c.z,u.normalize(),f.push(u.x,u.y,u.z),l.x=h.x+n*u.x,l.y=h.y+n*u.y,l.z=h.z+n*u.z,d.push(l.x,l.y,l.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===r?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=i;s++)c.x=o/t,c.y=s/i,p.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=i;o++){var e=(i+1)*(s-1)+(o-1),n=(i+1)*s+(o-1),r=(i+1)*s+o,a=(i+1)*(s-1)+o;m.push(e,n,a),m.push(n,r,a)}}()}(),this.setIndex(m),this.setAttribute("position",new Td(d,3)),this.setAttribute("normal",new Td(f,3)),this.setAttribute("uv",new Td(p,2))}function Fg(e,t,n,i,r,a,o){af.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Bg(e,t,n,i,r,a)),this.mergeVertices()}function Bg(e,t,n,i,r,a){Dd.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,a=a||3;var o,s,l=[],u=[],c=[],h=[],d=new zc,f=new zc,p=new zc,m=new zc,g=new zc,v=new zc,y=new zc;for(o=0;o<=n;++o){var _=o/n*r*Math.PI*2;for(M(_,r,a,e,p),M(_+.01,r,a,e,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=i;++s){var b=s/i*Math.PI*2,E=-t*Math.cos(b),T=t*Math.sin(b);d.x=p.x+(E*y.x+T*g.x),d.y=p.y+(E*y.y+T*g.y),d.z=p.z+(E*y.z+T*g.z),u.push(d.x,d.y,d.z),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(o/n),h.push(s/i)}}for(s=1;s<=n;s++)for(o=1;o<=i;o++){var w=(i+1)*(s-1)+(o-1),x=(i+1)*s+(o-1),A=(i+1)*s+o,S=(i+1)*(s-1)+o;l.push(w,x,S),l.push(x,A,S)}function M(e,t,n,i,r){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);r.x=i*(2+l)*.5*a,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(s)*.5}this.setIndex(l),this.setAttribute("position",new Td(u,3)),this.setAttribute("normal",new Td(c,3)),this.setAttribute("uv",new Td(h,2))}function Ug(e,t,n,i,r){af.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new jg(e,t,n,i,r)),this.mergeVertices()}function jg(e,t,n,i,r){Dd.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var a,o,s=[],l=[],u=[],c=[],h=new zc,d=new zc,f=new zc;for(a=0;a<=n;a++)for(o=0;o<=i;o++){var p=o/i*r,m=a/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),l.push(d.x,d.y,d.z),h.x=e*Math.cos(p),h.y=e*Math.sin(p),f.subVectors(d,h).normalize(),u.push(f.x,f.y,f.z),c.push(o/i),c.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=i;o++){var g=(i+1)*a+o-1,v=(i+1)*(a-1)+o-1,y=(i+1)*(a-1)+o,_=(i+1)*a+o;s.push(g,v,_),s.push(v,y,_)}this.setIndex(s),this.setAttribute("position",new Td(l,3)),this.setAttribute("normal",new Td(u,3)),this.setAttribute("uv",new Td(c,2))}gg.prototype=Object.assign(Object.create(ph.prototype),{constructor:gg,isPoints:!0,raycast:function(e,t){var n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),pg.copy(n.boundingSphere),pg.applyMatrix4(i),pg.radius+=r,!1!==e.ray.intersectsSphere(pg)){dg.getInverse(i),fg.copy(e.ray).applyMatrix4(dg);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,l=n.attributes.position.array;if(null!==s)for(var u=s.array,c=0,h=u.length;c<h;c++){var d=u[c];mg.fromArray(l,3*d),vg(mg,d,o,i,e,t,this)}else{c=0;for(var f=l.length/3;c<f;c++)mg.fromArray(l,3*c),vg(mg,c,o,i,e,t,this)}}else{var p=n.vertices;for(c=0,f=p.length;c<f;c++)vg(p[c],c,o,i,e,t,this)}}},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=i.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),yg.prototype=Object.assign(Object.create(Nc.prototype),{constructor:yg,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),_g.prototype=Object.create(Nc.prototype),_g.prototype.constructor=_g,_g.prototype.isCompressedTexture=!0,bg.prototype=Object.create(Nc.prototype),bg.prototype.constructor=bg,bg.prototype.isCanvasTexture=!0,Eg.prototype=Object.create(Nc.prototype),Eg.prototype.constructor=Eg,Eg.prototype.isDepthTexture=!0,Tg.prototype=Object.create(Dd.prototype),Tg.prototype.constructor=Tg,wg.prototype=Object.create(af.prototype),wg.prototype.constructor=wg,xg.prototype=Object.create(Dd.prototype),xg.prototype.constructor=xg,Ag.prototype=Object.create(af.prototype),Ag.prototype.constructor=Ag,Sg.prototype=Object.create(Dd.prototype),Sg.prototype.constructor=Sg,Mg.prototype=Object.create(af.prototype),Mg.prototype.constructor=Mg,Cg.prototype=Object.create(Sg.prototype),Cg.prototype.constructor=Cg,Rg.prototype=Object.create(af.prototype),Rg.prototype.constructor=Rg,Ig.prototype=Object.create(Sg.prototype),Ig.prototype.constructor=Ig,Pg.prototype=Object.create(af.prototype),Pg.prototype.constructor=Pg,Lg.prototype=Object.create(Sg.prototype),Lg.prototype.constructor=Lg,Dg.prototype=Object.create(af.prototype),Dg.prototype.constructor=Dg,Og.prototype=Object.create(Sg.prototype),Og.prototype.constructor=Og,Ng.prototype=Object.create(af.prototype),Ng.prototype.constructor=Ng,kg.prototype=Object.create(Dd.prototype),kg.prototype.constructor=kg,kg.prototype.toJSON=function(){var e=Dd.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Fg.prototype=Object.create(af.prototype),Fg.prototype.constructor=Fg,Bg.prototype=Object.create(Dd.prototype),Bg.prototype.constructor=Bg,Ug.prototype=Object.create(af.prototype),Ug.prototype.constructor=Ug,jg.prototype=Object.create(Dd.prototype),jg.prototype.constructor=jg;var Gg=function(e,t,n){n=n||2;var i,r,a,o,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=zg(e,0,h,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(e,t,n,i){var r,a,o,s,l,u=[];for(r=0,a=t.length;r<a;r++)o=t[r]*i,s=r<a-1?t[r+1]*i:e.length,(l=zg(e,o,s,i,!1))===l.next&&(l.steiner=!0),u.push(Jg(l));for(u.sort(Kg),r=0;r<u.length;r++)Qg(u[r],n),n=Hg(n,n.next);return n}(e,t,d,n)),e.length>80*n){i=a=e[0],r=o=e[1];for(var p=n;p<h;p+=n)(s=e[p])<i&&(i=s),(l=e[p+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-i,o-r))?1/u:0}return Vg(d,f,n,i,r,u),f};function zg(e,t,n,i,r){var a,o;if(r===function(e,t,n,i){for(var r=0,a=t,o=n-i;a<n;a+=i)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}(e,t,n,i)>0)for(a=t;a<n;a+=i)o=ov(a,e[a],e[a+1],o);else for(a=n-i;a>=t;a-=i)o=ov(a,e[a],e[a+1],o);return o&&nv(o,o.next)&&(sv(o),o=o.next),o}function Hg(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!nv(i,i.next)&&0!==tv(i.prev,i,i.next))i=i.next;else{if(sv(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function Vg(e,t,n,i,r,a,o){if(e){!o&&a&&function(e,t,n,i){var r=e;do{null===r.z&&(r.z=Zg(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,i=n,s=0,t=0;t<u&&(s++,i=i.nextZ);t++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(e,i,r,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?qg(e,i,r,a):Wg(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),sv(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Vg(e=Yg(e,t,n),t,n,i,r,a,2):2===o&&Xg(e,t,n,i,r,a):Vg(Hg(e),t,n,i,r,a,1);break}}}function Wg(e){var t=e.prev,n=e,i=e.next;if(tv(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if($g(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&tv(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function qg(e,t,n,i){var r=e.prev,a=e,o=e.next;if(tv(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,u=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,c=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=Zg(s,l,t,n,i),d=Zg(u,c,t,n,i),f=e.prevZ,p=e.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&$g(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&tv(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&$g(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&tv(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&$g(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&tv(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&$g(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&tv(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Yg(e,t,n){var i=e;do{var r=i.prev,a=i.next.next;!nv(r,a)&&iv(r,i,i.next,a)&&rv(r,a)&&rv(a,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(a.i/n),sv(i),sv(i.next),i=e=a),i=i.next}while(i!==e);return i}function Xg(e,t,n,i,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&ev(o,s)){var l=av(o,s);return o=Hg(o,o.next),l=Hg(l,l.next),Vg(o,t,n,i,r,a),void Vg(l,t,n,i,r,a)}s=s.next}o=o.next}while(o!==e)}function Kg(e,t){return e.x-t.x}function Qg(e,t){if(t=function(e,t){var n,i=t,r=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===o)return n.prev;var l,u=n,c=n.x,h=n.y,d=1/0;i=n.next;for(;i!==u;)r>=i.x&&i.x>=c&&r!==i.x&&$g(a<h?r:o,a,c,h,a<h?o:r,a,i.x,i.y)&&((l=Math.abs(a-i.y)/(r-i.x))<d||l===d&&i.x>n.x)&&rv(i,e)&&(n=i,d=l),i=i.next;return n}(e,t)){var n=av(t,e);Hg(n,n.next)}}function Zg(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Jg(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function $g(e,t,n,i,r,a,o,s){return(r-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function ev(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&iv(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&rv(e,t)&&rv(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)}function tv(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function nv(e,t){return e.x===t.x&&e.y===t.y}function iv(e,t,n,i){return!!(nv(e,n)&&nv(t,i)||nv(e,i)&&nv(n,t))||tv(e,t,n)>0!=tv(e,t,i)>0&&tv(n,i,e)>0!=tv(n,i,t)>0}function rv(e,t){return tv(e.prev,e,e.next)<0?tv(e,t,e.next)>=0&&tv(e,e.prev,t)>=0:tv(e,t,e.prev)<0||tv(e,e.next,t)<0}function av(e,t){var n=new lv(e.i,e.x,e.y),i=new lv(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function ov(e,t,n,i){var r=new lv(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function sv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function lv(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var uv={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},isClockWise:function(e){return uv.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],r=[];cv(e),hv(n,e);var a=e.length;t.forEach(cv);for(var o=0;o<t.length;o++)i.push(a),a+=t[o].length,hv(n,t[o]);var s=Gg(n,i);for(o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function cv(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function hv(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function dv(e,t){af.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new fv(e,t)),this.mergeVertices()}function fv(e,t){Dd.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,i=[],r=[],a=0,o=e.length;a<o;a++){s(e[a])}function s(e){var a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:c-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3,p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:pv;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);var g,v,y,_,b,E,T,w,x=!1;p&&(g=p.getSpacedPoints(s),x=!0,u=!1,v=p.computeFrenetFrames(s,!1),y=new zc,_=new zc,b=new zc),u||(f=0,c=0,h=0,d=0);var A=e.extractPoints(o),S=A.shape,M=A.holes;if(!uv.isClockWise(S))for(S=S.reverse(),T=0,w=M.length;T<w;T++)E=M[T],uv.isClockWise(E)&&(M[T]=E.reverse());var C=uv.triangulateShape(S,M),R=S;for(T=0,w=M.length;T<w;T++)E=M[T],S=S.concat(E);function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var P,L,D,O,N,k,F=S.length,B=C.length;function U(e,t,n){var i,r,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=t.x-s/d,m=t.y+o/d,g=((n.x-u/f-p)*u-(n.y+l/f-m)*l)/(o*u-s*l),v=(i=p+o*g-e.x)*i+(r=m+s*g-e.y)*r;if(v<=2)return new Pc(i,r);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(i=-s,r=o,a=Math.sqrt(c)):(i=o,r=s,a=Math.sqrt(c/2))}return new Pc(i/a,r/a)}for(var j=[],G=0,z=R.length,H=z-1,V=G+1;G<z;G++,H++,V++)H===z&&(H=0),V===z&&(V=0),j[G]=U(R[G],R[H],R[V]);var W,q,Y=[],X=j.concat();for(T=0,w=M.length;T<w;T++){for(E=M[T],W=[],G=0,H=(z=E.length)-1,V=G+1;G<z;G++,H++,V++)H===z&&(H=0),V===z&&(V=0),W[G]=U(E[G],E[H],E[V]);Y.push(W),X=X.concat(W)}for(P=0;P<f;P++){for(D=P/f,O=c*Math.cos(D*Math.PI/2),L=h*Math.sin(D*Math.PI/2)+d,G=0,z=R.length;G<z;G++)Q((N=I(R[G],j[G],L)).x,N.y,-O);for(T=0,w=M.length;T<w;T++)for(E=M[T],W=Y[T],G=0,z=E.length;G<z;G++)Q((N=I(E[G],W[G],L)).x,N.y,-O)}for(L=h+d,G=0;G<F;G++)N=u?I(S[G],X[G],L):S[G],x?(_.copy(v.normals[0]).multiplyScalar(N.x),y.copy(v.binormals[0]).multiplyScalar(N.y),b.copy(g[0]).add(_).add(y),Q(b.x,b.y,b.z)):Q(N.x,N.y,0);for(q=1;q<=s;q++)for(G=0;G<F;G++)N=u?I(S[G],X[G],L):S[G],x?(_.copy(v.normals[q]).multiplyScalar(N.x),y.copy(v.binormals[q]).multiplyScalar(N.y),b.copy(g[q]).add(_).add(y),Q(b.x,b.y,b.z)):Q(N.x,N.y,l/s*q);for(P=f-1;P>=0;P--){for(D=P/f,O=c*Math.cos(D*Math.PI/2),L=h*Math.sin(D*Math.PI/2)+d,G=0,z=R.length;G<z;G++)Q((N=I(R[G],j[G],L)).x,N.y,l+O);for(T=0,w=M.length;T<w;T++)for(E=M[T],W=Y[T],G=0,z=E.length;G<z;G++)N=I(E[G],W[G],L),x?Q(N.x,N.y+g[s-1].y,g[s-1].x+O):Q(N.x,N.y,l+O)}function K(e,t){var n,i;for(G=e.length;--G>=0;){n=G,(i=G-1)<0&&(i=e.length-1);var r=0,a=s+2*f;for(r=0;r<a;r++){var o=F*r,l=F*(r+1);J(t+n+o,t+i+o,t+i+l,t+n+l)}}}function Q(e,t,n){a.push(e),a.push(t),a.push(n)}function Z(e,t,r){$(e),$(t),$(r);var a=i.length/3,o=m.generateTopUV(n,i,a-3,a-2,a-1);ee(o[0]),ee(o[1]),ee(o[2])}function J(e,t,r,a){$(e),$(t),$(a),$(t),$(r),$(a);var o=i.length/3,s=m.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);ee(s[0]),ee(s[1]),ee(s[3]),ee(s[1]),ee(s[2]),ee(s[3])}function $(e){i.push(a[3*e+0]),i.push(a[3*e+1]),i.push(a[3*e+2])}function ee(e){r.push(e.x),r.push(e.y)}!function(){var e=i.length/3;if(u){var t=0,r=F*t;for(G=0;G<B;G++)Z((k=C[G])[2]+r,k[1]+r,k[0]+r);for(r=F*(t=s+2*f),G=0;G<B;G++)Z((k=C[G])[0]+r,k[1]+r,k[2]+r)}else{for(G=0;G<B;G++)Z((k=C[G])[2],k[1],k[0]);for(G=0;G<B;G++)Z((k=C[G])[0]+F*s,k[1]+F*s,k[2]+F*s)}n.addGroup(e,i.length/3-e,0)}(),function(){var e=i.length/3,t=0;for(K(R,t),t+=R.length,T=0,w=M.length;T<w;T++)K(E=M[T],t),t+=E.length;n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new Td(i,3)),this.setAttribute("uv",new Td(r,2)),this.computeVertexNormals()}dv.prototype=Object.create(af.prototype),dv.prototype.constructor=dv,dv.prototype.toJSON=function(){var e=af.prototype.toJSON.call(this);return mv(this.parameters.shapes,this.parameters.options,e)},fv.prototype=Object.create(Dd.prototype),fv.prototype.constructor=fv,fv.prototype.toJSON=function(){var e=Dd.prototype.toJSON.call(this);return mv(this.parameters.shapes,this.parameters.options,e)};var pv={generateTopUV:function(e,t,n,i,r){var a=t[3*n],o=t[3*n+1],s=t[3*i],l=t[3*i+1],u=t[3*r],c=t[3*r+1];return[new Pc(a,o),new Pc(s,l),new Pc(u,c)]},generateSideWallUV:function(e,t,n,i,r,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*i],c=t[3*i+1],h=t[3*i+2],d=t[3*r],f=t[3*r+1],p=t[3*r+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-c)<.01?[new Pc(o,1-l),new Pc(u,1-h),new Pc(d,1-p),new Pc(m,1-v)]:[new Pc(s,1-l),new Pc(c,1-h),new Pc(f,1-p),new Pc(g,1-v)]}};function mv(e,t,n){if(n.shapes=[],Array.isArray(e))for(var i=0,r=e.length;i<r;i++){var a=e[i];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function gv(e,t){af.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new vv(e,t)),this.mergeVertices()}function vv(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new af;var i=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),fv.call(this,i,t),this.type="TextBufferGeometry"}function yv(e,t,n,i,r,a,o){af.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new _v(e,t,n,i,r,a,o)),this.mergeVertices()}function _v(e,t,n,i,r,a,o){Dd.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,l,u=Math.min(a+o,Math.PI),c=0,h=[],d=new zc,f=new zc,p=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],_=l/n,b=0;for(0==l&&0==a?b=.5/t:l==n&&u==Math.PI&&(b=-.5/t),s=0;s<=t;s++){var E=s/t;d.x=-e*Math.cos(i+E*r)*Math.sin(a+_*o),d.y=e*Math.cos(a+_*o),d.z=e*Math.sin(i+E*r)*Math.sin(a+_*o),m.push(d.x,d.y,d.z),f.copy(d).normalize(),g.push(f.x,f.y,f.z),v.push(E+b,1-_),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(s=0;s<t;s++){var T=h[l][s+1],w=h[l][s],x=h[l+1][s],A=h[l+1][s+1];(0!==l||a>0)&&p.push(T,w,A),(l!==n-1||u<Math.PI)&&p.push(w,x,A)}this.setIndex(p),this.setAttribute("position",new Td(m,3)),this.setAttribute("normal",new Td(g,3)),this.setAttribute("uv",new Td(v,2))}function bv(e,t,n,i,r,a){af.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Ev(e,t,n,i,r,a)),this.mergeVertices()}function Ev(e,t,n,i,r,a){Dd.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},e=e||.5,t=t||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,l,u=[],c=[],h=[],d=[],f=e,p=(t-e)/(i=void 0!==i?Math.max(1,i):1),m=new zc,g=new Pc;for(s=0;s<=i;s++){for(l=0;l<=n;l++)o=r+l/n*a,m.x=f*Math.cos(o),m.y=f*Math.sin(o),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);f+=p}for(s=0;s<i;s++){var v=s*(n+1);for(l=0;l<n;l++){var y=o=l+v,_=o+n+1,b=o+n+2,E=o+1;u.push(y,_,E),u.push(_,b,E)}}this.setIndex(u),this.setAttribute("position",new Td(c,3)),this.setAttribute("normal",new Td(h,3)),this.setAttribute("uv",new Td(d,2))}function Tv(e,t,n,i){af.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new wv(e,t,n,i)),this.mergeVertices()}function wv(e,t,n,i){Dd.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=Ic.clamp(i,0,2*Math.PI);var r,a,o,s=[],l=[],u=[],c=1/t,h=new zc,d=new Pc;for(a=0;a<=t;a++){var f=n+a*c*i,p=Math.sin(f),m=Math.cos(f);for(o=0;o<=e.length-1;o++)h.x=e[o].x*p,h.y=e[o].y,h.z=e[o].x*m,l.push(h.x,h.y,h.z),d.x=a/t,d.y=o/(e.length-1),u.push(d.x,d.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=r=o+a*e.length,v=r+e.length,y=r+e.length+1,_=r+1;s.push(g,v,_),s.push(v,y,_)}if(this.setIndex(s),this.setAttribute("position",new Td(l,3)),this.setAttribute("uv",new Td(u,2)),this.computeVertexNormals(),i===2*Math.PI){var b=this.attributes.normal.array,E=new zc,T=new zc,w=new zc;for(r=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)E.x=b[o+0],E.y=b[o+1],E.z=b[o+2],T.x=b[r+o+0],T.y=b[r+o+1],T.z=b[r+o+2],w.addVectors(E,T).normalize(),b[o+0]=b[r+o+0]=w.x,b[o+1]=b[r+o+1]=w.y,b[o+2]=b[r+o+2]=w.z}}function xv(e,t){af.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Av(e,t)),this.mergeVertices()}function Av(e,t){Dd.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],r=[],a=[],o=0,s=0;if(!1===Array.isArray(e))u(e);else for(var l=0;l<e.length;l++)u(e[l]),this.addGroup(o,s,l),o+=s,s=0;function u(e){var o,l,u,c=i.length/3,h=e.extractPoints(t),d=h.shape,f=h.holes;for(!1===uv.isClockWise(d)&&(d=d.reverse()),o=0,l=f.length;o<l;o++)u=f[o],!0===uv.isClockWise(u)&&(f[o]=u.reverse());var p=uv.triangulateShape(d,f);for(o=0,l=f.length;o<l;o++)u=f[o],d=d.concat(u);for(o=0,l=d.length;o<l;o++){var m=d[o];i.push(m.x,m.y,0),r.push(0,0,1),a.push(m.x,m.y)}for(o=0,l=p.length;o<l;o++){var g=p[o],v=g[0]+c,y=g[1]+c,_=g[2]+c;n.push(v,y,_),s+=3}}this.setIndex(n),this.setAttribute("position",new Td(i,3)),this.setAttribute("normal",new Td(r,3)),this.setAttribute("uv",new Td(a,2))}function Sv(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function Mv(e,t){Dd.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,i,r,a,o=[],s=Math.cos(Ic.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(a=new af).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,d=a.faces,f=0,p=d.length;f<p;f++)for(var m=d[f],g=0;g<3;g++)n=m[c[g]],i=m[c[(g+1)%3]],l[0]=Math.min(n,i),l[1]=Math.max(n,i),void 0===u[r=l[0]+","+l[1]]?u[r]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[r].face2=f;for(r in u){var v=u[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.setAttribute("position",new Td(o,3))}function Cv(e,t,n,i,r,a,o,s){af.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Rv(e,t,n,i,r,a,o,s)),this.mergeVertices()}function Rv(e,t,n,i,r,a,o,s){Dd.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var u=[],c=[],h=[],d=[],f=0,p=[],m=n/2,g=0;function v(n){var r,a,p,v=new Pc,y=new zc,_=0,b=!0===n?e:t,E=!0===n?1:-1;for(a=f,r=1;r<=i;r++)c.push(0,m*E,0),h.push(0,E,0),d.push(.5,.5),f++;for(p=f,r=0;r<=i;r++){var T=r/i*s+o,w=Math.cos(T),x=Math.sin(T);y.x=b*x,y.y=m*E,y.z=b*w,c.push(y.x,y.y,y.z),h.push(0,E,0),v.x=.5*w+.5,v.y=.5*x*E+.5,d.push(v.x,v.y),f++}for(r=0;r<i;r++){var A=a+r,S=p+r;!0===n?u.push(S,S+1,A):u.push(S+1,S,A),_+=3}l.addGroup(g,_,!0===n?1:2),g+=_}!function(){var a,v,y=new zc,_=new zc,b=0,E=(t-e)/n;for(v=0;v<=r;v++){var T=[],w=v/r,x=w*(t-e)+e;for(a=0;a<=i;a++){var A=a/i,S=A*s+o,M=Math.sin(S),C=Math.cos(S);_.x=x*M,_.y=-w*n+m,_.z=x*C,c.push(_.x,_.y,_.z),y.set(M,E,C).normalize(),h.push(y.x,y.y,y.z),d.push(A,1-w),T.push(f++)}p.push(T)}for(a=0;a<i;a++)for(v=0;v<r;v++){var R=p[v][a],I=p[v+1][a],P=p[v+1][a+1],L=p[v][a+1];u.push(R,I,L),u.push(I,P,L),b+=6}l.addGroup(g,b,0),g+=b}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new Td(c,3)),this.setAttribute("normal",new Td(h,3)),this.setAttribute("uv",new Td(d,2))}function Iv(e,t,n,i,r,a,o){Cv.call(this,0,e,t,n,i,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function Pv(e,t,n,i,r,a,o){Rv.call(this,0,e,t,n,i,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function Lv(e,t,n,i){af.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Dv(e,t,n,i)),this.mergeVertices()}function Dv(e,t,n,i){Dd.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,a,o=[],s=[],l=[],u=[],c=new zc,h=new Pc;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),a=0,r=3;a<=t;a++,r+=3){var d=n+a/t*i;c.x=e*Math.cos(d),c.y=e*Math.sin(d),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[r]/e+1)/2,h.y=(s[r+1]/e+1)/2,u.push(h.x,h.y)}for(r=1;r<=t;r++)o.push(r,r+1,0);this.setIndex(o),this.setAttribute("position",new Td(s,3)),this.setAttribute("normal",new Td(l,3)),this.setAttribute("uv",new Td(u,2))}gv.prototype=Object.create(af.prototype),gv.prototype.constructor=gv,vv.prototype=Object.create(fv.prototype),vv.prototype.constructor=vv,yv.prototype=Object.create(af.prototype),yv.prototype.constructor=yv,_v.prototype=Object.create(Dd.prototype),_v.prototype.constructor=_v,bv.prototype=Object.create(af.prototype),bv.prototype.constructor=bv,Ev.prototype=Object.create(Dd.prototype),Ev.prototype.constructor=Ev,Tv.prototype=Object.create(af.prototype),Tv.prototype.constructor=Tv,wv.prototype=Object.create(Dd.prototype),wv.prototype.constructor=wv,xv.prototype=Object.create(af.prototype),xv.prototype.constructor=xv,xv.prototype.toJSON=function(){var e=af.prototype.toJSON.call(this);return Sv(this.parameters.shapes,e)},Av.prototype=Object.create(Dd.prototype),Av.prototype.constructor=Av,Av.prototype.toJSON=function(){var e=Dd.prototype.toJSON.call(this);return Sv(this.parameters.shapes,e)},Mv.prototype=Object.create(Dd.prototype),Mv.prototype.constructor=Mv,Cv.prototype=Object.create(af.prototype),Cv.prototype.constructor=Cv,Rv.prototype=Object.create(Dd.prototype),Rv.prototype.constructor=Rv,Iv.prototype=Object.create(Cv.prototype),Iv.prototype.constructor=Iv,Pv.prototype=Object.create(Rv.prototype),Pv.prototype.constructor=Pv,Lv.prototype=Object.create(af.prototype),Lv.prototype.constructor=Lv,Dv.prototype=Object.create(Dd.prototype),Dv.prototype.constructor=Dv;var Ov=Object.freeze({__proto__:null,WireframeGeometry:Tg,ParametricGeometry:wg,ParametricBufferGeometry:xg,TetrahedronGeometry:Mg,TetrahedronBufferGeometry:Cg,OctahedronGeometry:Rg,OctahedronBufferGeometry:Ig,IcosahedronGeometry:Pg,IcosahedronBufferGeometry:Lg,DodecahedronGeometry:Dg,DodecahedronBufferGeometry:Og,PolyhedronGeometry:Ag,PolyhedronBufferGeometry:Sg,TubeGeometry:Ng,TubeBufferGeometry:kg,TorusKnotGeometry:Fg,TorusKnotBufferGeometry:Bg,TorusGeometry:Ug,TorusBufferGeometry:jg,TextGeometry:gv,TextBufferGeometry:vv,SphereGeometry:yv,SphereBufferGeometry:_v,RingGeometry:bv,RingBufferGeometry:Ev,PlaneGeometry:Tf,PlaneBufferGeometry:wf,LatheGeometry:Tv,LatheBufferGeometry:wv,ShapeGeometry:xv,ShapeBufferGeometry:Av,ExtrudeGeometry:dv,ExtrudeBufferGeometry:fv,EdgesGeometry:Mv,ConeGeometry:Iv,ConeBufferGeometry:Pv,CylinderGeometry:Cv,CylinderBufferGeometry:Rv,CircleGeometry:Lv,CircleBufferGeometry:Dv,BoxGeometry:class extends af{constructor(e,t,n,i,r,a){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new of(e,t,n,i,r,a)),this.mergeVertices()}},BoxBufferGeometry:of});function Nv(e){hd.call(this),this.type="ShadowMaterial",this.color=new ad(0),this.transparent=!0,this.setValues(e)}function kv(e){cf.call(this,e),this.type="RawShaderMaterial"}function Fv(e){hd.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ad(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Bv(e){Fv.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new Pc(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}function Uv(e){hd.call(this),this.type="MeshPhongMaterial",this.color=new ad(16777215),this.specular=new ad(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function jv(e){hd.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ad(16777215),this.specular=new ad(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Gv(e){hd.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function zv(e){hd.call(this),this.type="MeshLambertMaterial",this.color=new ad(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Hv(e){hd.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ad(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pc(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Vv(e){eg.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Nv.prototype=Object.create(hd.prototype),Nv.prototype.constructor=Nv,Nv.prototype.isShadowMaterial=!0,Nv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this},kv.prototype=Object.create(cf.prototype),kv.prototype.constructor=kv,kv.prototype.isRawShaderMaterial=!0,Fv.prototype=Object.create(hd.prototype),Fv.prototype.constructor=Fv,Fv.prototype.isMeshStandardMaterial=!0,Fv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Bv.prototype=Object.create(Fv.prototype),Bv.prototype.constructor=Bv,Bv.prototype.isMeshPhysicalMaterial=!0,Bv.prototype.copy=function(e){return Fv.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new ad).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this},Uv.prototype=Object.create(hd.prototype),Uv.prototype.constructor=Uv,Uv.prototype.isMeshPhongMaterial=!0,Uv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},jv.prototype=Object.create(hd.prototype),jv.prototype.constructor=jv,jv.prototype.isMeshToonMaterial=!0,jv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Gv.prototype=Object.create(hd.prototype),Gv.prototype.constructor=Gv,Gv.prototype.isMeshNormalMaterial=!0,Gv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},zv.prototype=Object.create(hd.prototype),zv.prototype.constructor=zv,zv.prototype.isMeshLambertMaterial=!0,zv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Hv.prototype=Object.create(hd.prototype),Hv.prototype.constructor=Hv,Hv.prototype.isMeshMatcapMaterial=!0,Hv.prototype.copy=function(e){return hd.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Vv.prototype=Object.create(eg.prototype),Vv.prototype.constructor=Vv,Vv.prototype.isLineDashedMaterial=!0,Vv.prototype.copy=function(e){return eg.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Wv=Object.freeze({__proto__:null,ShadowMaterial:Nv,SpriteMaterial:Sm,RawShaderMaterial:kv,ShaderMaterial:cf,PointsMaterial:hg,MeshPhysicalMaterial:Bv,MeshStandardMaterial:Fv,MeshPhongMaterial:Uv,MeshToonMaterial:jv,MeshNormalMaterial:Gv,MeshLambertMaterial:zv,MeshDepthMaterial:cm,MeshDistanceMaterial:hm,MeshBasicMaterial:dd,MeshMatcapMaterial:Hv,LineDashedMaterial:Vv,LineBasicMaterial:eg,Material:hd}),qv={arraySlice:function(e,t,n){return qv.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),a=0,o=0;o!==i;++a)for(var s=n[a]*t,l=0;l!==t;++l)r[o++]=e[s+l];return r},flattenJSON:function(e,t,n,i){for(var r=1,a=e[0];void 0!==a&&void 0===a[i];)a=e[r++];if(void 0!==a){var o=a[i];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[i])&&(t.push(a.time),n.push.apply(n,o)),a=e[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[i])&&(t.push(a.time),o.toArray(n,n.length)),a=e[r++]}while(void 0!==a);else do{void 0!==(o=a[i])&&(t.push(a.time),n.push(o)),a=e[r++]}while(void 0!==a)}},subclip:function(e,t,n,i,r){r=r||30;var a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var f=l.times[d]*r;if(!(f<n||f>=i)){c.push(l.times[d]);for(var p=0;p<u;++p)h.push(l.values[d*u+p])}}0!==c.length&&(l.times=qv.convertArray(c,l.times.constructor),l.values=qv.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function Yv(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Xv(e,t,n,i){Yv.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Kv(e,t,n,i){Yv.call(this,e,t,n,i)}function Qv(e,t,n,i){Yv.call(this,e,t,n,i)}function Zv(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qv.convertArray(t,this.TimeBufferType),this.values=qv.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function Jv(e,t,n){Zv.call(this,e,t,n)}function $v(e,t,n,i){Zv.call(this,e,t,n,i)}function ey(e,t,n,i){Zv.call(this,e,t,n,i)}function ty(e,t,n,i){Yv.call(this,e,t,n,i)}function ny(e,t,n,i){Zv.call(this,e,t,n,i)}function iy(e,t,n,i){Zv.call(this,e,t,n,i)}function ry(e,t,n,i){Zv.call(this,e,t,n,i)}function ay(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Ic.generateUUID(),this.duration<0&&this.resetDuration()}function oy(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ey;case"vector":case"vector2":case"vector3":case"vector4":return ry;case"color":return $v;case"quaternion":return ny;case"bool":case"boolean":return Jv;case"string":return iy}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],i=[];qv.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Yv.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{var a;n:{i:if(!(e<i)){for(var o=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===o)break;if(r=i,e<(i=t[++n]))break t}a=t.length;break n}if(e>=r)break e;var s=t[1];e<s&&(n=2,r=s);for(o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===o)break;if(i=r,e>=(r=t[--n-1]))break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(i=t[n],void 0===(r=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i,a=0;a!==i;++a)t[a]=n[r+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Yv.prototype,{beforeStart_:Yv.prototype.copySampleValue_,afterEnd_:Yv.prototype.copySampleValue_}),Xv.prototype=Object.assign(Object.create(Yv.prototype),{constructor:Xv,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,a=e+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=e,o=2*t-n;break;case 2402:o=t+i[r=i.length-2]-i[r+1];break;default:r=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=e,s=2*n-t;break;case 2402:a=1,s=n+i[1]-i[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=r*u,this._offsetNext=a*u},interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(i-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p,b=0;b!==o;++b)r[b]=g*a[u+b]+v*a[l+b]+y*a[s+b]+_*a[c+b];return r}}),Kv.prototype=Object.assign(Object.create(Yv.prototype),{constructor:Kv,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(i-t),c=1-u,h=0;h!==o;++h)r[h]=a[l+h]*c+a[s+h]*u;return r}}),Qv.prototype=Object.assign(Object.create(Yv.prototype),{constructor:Qv,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Zv,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:qv.convertArray(e.times,Array),values:qv.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t}}),Object.assign(Zv.prototype,{constructor:Zv,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Qv(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Kv(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Xv(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,r=0,a=i-1;r!==i&&n[r]<e;)++r;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==r||a!==i){r>=a&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=qv.arraySlice(n,r,a),this.values=qv.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==r;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==i&&qv.isTypedArray(i)){o=0;for(var l=i.length;o!==l;++o){var u=i[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),e=!1;break}}}return e},optimize:function(){for(var e=qv.arraySlice(this.times),t=qv.arraySlice(this.values),n=this.getValueSize(),i=2302===this.getInterpolation(),r=1,a=e.length-1,o=1;o<a;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==l[0]))if(i)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var f=t[u+d];if(f!==t[c+d]||f!==t[h+d]){s=!0;break}}if(s){if(o!==r){e[r]=e[o];var p=o*n,m=r*n;for(d=0;d!==n;++d)t[m+d]=t[p+d]}++r}}if(a>0){e[r]=e[a];for(p=a*n,m=r*n,d=0;d!==n;++d)t[m+d]=t[p+d];++r}return r!==e.length?(this.times=qv.arraySlice(e,0,r),this.values=qv.arraySlice(t,0,r*n)):(this.times=e,this.values=t),this},clone:function(){var e=qv.arraySlice(this.times,0),t=qv.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Jv.prototype=Object.assign(Object.create(Zv.prototype),{constructor:Jv,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),$v.prototype=Object.assign(Object.create(Zv.prototype),{constructor:$v,ValueTypeName:"color"}),ey.prototype=Object.assign(Object.create(Zv.prototype),{constructor:ey,ValueTypeName:"number"}),ty.prototype=Object.assign(Object.create(Yv.prototype),{constructor:ty,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=(n-t)/(i-t),u=s+o;s!==u;s+=4)Uc.slerpFlat(r,0,a,s-o,a,s,l);return r}}),ny.prototype=Object.assign(Object.create(Zv.prototype),{constructor:ny,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new ty(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),iy.prototype=Object.assign(Object.create(Zv.prototype),{constructor:iy,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ry.prototype=Object.assign(Object.create(Zv.prototype),{constructor:ry,ValueTypeName:"vector"}),Object.assign(ay,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,a=n.length;r!==a;++r)t.push(oy(n[r]).scale(i));return new ay(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},r=0,a=n.length;r!==a;++r)t.push(Zv.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var u=qv.getKeyframeOrder(s);s=qv.sortedArray(s,1,u),l=qv.sortedArray(l,1,u),i||0!==s[0]||(s.push(r),l.push(l[0])),a.push(new ey(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new ay(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var i=e;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(r);if(l&&l.length>1){var u=i[h=l[1]];u||(i[h]=u=[]),u.push(s)}}var c=[];for(var h in i)c.push(ay.CreateFromMorphTargetSequence(h,i[h],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,i,r){if(0!==n.length){var a=[],o=[];qv.flattenJSON(n,a,o,i),0!==a.length&&r.push(new e(t,a,o))}},i=[],r=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)c[u[h].morphTargets[d]]=-1;for(var f in c){var p=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var g=u[h];p.push(g.time),m.push(g.morphTarget===f?1:0)}i.push(new ey(".morphTargetInfluence["+f+"]",p,m))}a=c.length*(o||1)}else{var v=".bones["+t[l].name+"]";n(ry,v+".position",u,"pos",i),n(ny,v+".quaternion",u,"rot",i),n(ry,v+".scale",u,"scl",i)}}return 0===i.length?null:new ay(r,a,i)}}),Object.assign(ay.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new ay(this.name,this.duration,e)}});var sy={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function ly(e,t,n){var i=this,r=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===r&&void 0!==i.onStart&&i.onStart(e,a,o),r=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){var t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=l.length;t<n;t+=2){var i=l[t],r=l[t+1];if(i.global&&(i.lastIndex=0),i.test(e))return r}return null}}var uy=new ly;function cy(e){this.manager=void 0!==e?e:uy,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(cy.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var hy={};function dy(e){cy.call(this,e)}function fy(e){cy.call(this,e)}function py(e){cy.call(this,e)}function my(e){cy.call(this,e)}function gy(e){cy.call(this,e)}function vy(e){cy.call(this,e)}function yy(e){cy.call(this,e)}function _y(){this.type="Curve",this.arcLengthDivisions=200}function by(e,t,n,i,r,a,o,s){_y.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Ey(e,t,n,i,r,a){by.call(this,e,t,n,n,i,r,a),this.type="ArcCurve"}function Ty(){var e=0,t=0,n=0,i=0;function r(r,a,o,s){e=r,t=o,n=-3*r+3*a-2*o-s,i=2*r-2*a+o+s}return{initCatmullRom:function(e,t,n,i,a){r(t,n,a*(n-e),a*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,a,o,s){var l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(i-t)/(o+s)+(i-n)/s;r(t,n,l*=o,u*=o)},calc:function(r){var a=r*r;return e+t*r+n*a+i*(a*r)}}}dy.prototype=Object.assign(Object.create(cy.prototype),{constructor:dy,load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=sy.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;if(void 0===hy[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],l=!!o[2],u=o[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),f=0;f<u.length;f++)d[f]=u.charCodeAt(f);c="blob"===h?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}setTimeout((function(){t&&t(c),r.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}),0)}}else{hy[e]=[],hy[e].push({onLoad:t,onProgress:n,onError:i});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",(function(t){var n=this.response,i=hy[e];if(delete hy[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),sy.add(e,n);for(var a=0,o=i.length;a<o;a++){(s=i[a]).onLoad&&s.onLoad(n)}r.manager.itemEnd(e)}else{for(a=0,o=i.length;a<o;a++){var s;(s=i[a]).onError&&s.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}}),!1),m.addEventListener("progress",(function(t){for(var n=hy[e],i=0,r=n.length;i<r;i++){var a=n[i];a.onProgress&&a.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var n=hy[e];delete hy[e];for(var i=0,a=n.length;i<a;i++){var o=n[i];o.onError&&o.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),m.addEventListener("abort",(function(t){var n=hy[e];delete hy[e];for(var i=0,a=n.length;i<a;i++){var o=n[i];o.onError&&o.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return r.manager.itemStart(e),m}hy[e].push({onLoad:t,onProgress:n,onError:i})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),fy.prototype=Object.assign(Object.create(cy.prototype),{constructor:fy,load:function(e,t,n,i){var r=this,a=new dy(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var i=ay.parse(e[n]);t.push(i)}return t}}),py.prototype=Object.assign(Object.create(cy.prototype),{constructor:py,load:function(e,t,n,i){var r=this,a=[],o=new _g;o.image=a;var s=new dy(this.manager);function l(l){s.load(e[l],(function(e){var n=r.parse(e,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=1006),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,h=e.length;c<h;++c)l(c);else s.load(e,(function(e){var n=r.parse(e,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,s=0;s<i;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=1006),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}}),my.prototype=Object.assign(Object.create(cy.prototype),{constructor:my,load:function(e,t,n,i){var r=this,a=new mf,o=new dy(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,(function(e){var n=r.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:1001,a.wrapT=void 0!==n.wrapT?n.wrapT:1001,a.magFilter=void 0!==n.magFilter?n.magFilter:1006,a.minFilter=void 0!==n.minFilter?n.minFilter:1006,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=1008),1===n.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,t&&t(a,n))}),n,i),a}}),gy.prototype=Object.assign(Object.create(cy.prototype),{constructor:gy,load:function(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=sy.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),sy.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}),vy.prototype=Object.assign(Object.create(cy.prototype),{constructor:vy,load:function(e,t,n,i){var r=new Ff,a=new gy(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){r.images[n]=e,6===++o&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(var l=0;l<e.length;++l)s(l);return r}}),yy.prototype=Object.assign(Object.create(cy.prototype),{constructor:yy,load:function(e,t,n,i){var r=new Nc,a=new gy(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){r.image=n;var i=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);r.format=i?1022:1023,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}),Object.assign(_y.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],r=this.getPoint(0),a=0;for(i.push(0),n=1;n<=e;n++)a+=(t=this.getPoint(n/e)).distanceTo(r),i.push(a),r=t;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,i=this.getLengths(),r=0,a=i.length;n=t||e*i[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=i[r=Math.floor(s+(l-s)/2)]-n)<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(i[r=l]===n)return r/(a-1);var u=i[r];return(r+(n-u)/(i[r+1]-u))/(a-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var i=this.getPoint(t);return this.getPoint(n).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,i,r,a=new zc,o=[],s=[],l=[],u=new zc,c=new Qc;for(n=0;n<=e;n++)i=n/e,o[n]=this.getTangentAt(i),o[n].normalize();s[0]=new zc,l[0]=new zc;var h=Number.MAX_VALUE,d=Math.abs(o[0].x),f=Math.abs(o[0].y),p=Math.abs(o[0].z);for(d<=h&&(h=d,a.set(1,0,0)),f<=h&&(h=f,a.set(0,1,0)),p<=h&&a.set(0,0,1),u.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],u),l[0].crossVectors(o[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(o[n-1],o[n]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(Ic.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,r))),l[n].crossVectors(o[n],s[n]);if(!0===t)for(r=Math.acos(Ic.clamp(s[0].dot(s[e]),-1,1)),r/=e,o[0].dot(u.crossVectors(s[0],s[e]))>0&&(r=-r),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(o[n],r*n)),l[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),by.prototype=Object.create(_y.prototype),by.prototype.constructor=by,by.prototype.isEllipseCurve=!0,by.prototype.getPoint=function(e,t){for(var n=t||new Pc,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=a?0:i),!0!==this.aClockwise||a||(r===i?r=-i:r-=i);var o=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)},by.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},by.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},by.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ey.prototype=Object.create(by.prototype),Ey.prototype.constructor=Ey,Ey.prototype.isArcCurve=!0;var wy=new zc,xy=new Ty,Ay=new Ty,Sy=new Ty;function My(e,t,n,i){_y.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Cy(e,t,n,i,r){var a=.5*(i-t),o=.5*(r-n),s=e*e;return(2*n-2*i+a+o)*(e*s)+(-3*n+3*i-2*a-o)*s+a*e+n}function Ry(e,t,n,i){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function Iy(e,t,n,i,r){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}function Py(e,t,n,i){_y.call(this),this.type="CubicBezierCurve",this.v0=e||new Pc,this.v1=t||new Pc,this.v2=n||new Pc,this.v3=i||new Pc}function Ly(e,t,n,i){_y.call(this),this.type="CubicBezierCurve3",this.v0=e||new zc,this.v1=t||new zc,this.v2=n||new zc,this.v3=i||new zc}function Dy(e,t){_y.call(this),this.type="LineCurve",this.v1=e||new Pc,this.v2=t||new Pc}function Oy(e,t){_y.call(this),this.type="LineCurve3",this.v1=e||new zc,this.v2=t||new zc}function Ny(e,t,n){_y.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Pc,this.v1=t||new Pc,this.v2=n||new Pc}function ky(e,t,n){_y.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new zc,this.v1=t||new zc,this.v2=n||new zc}function Fy(e){_y.call(this),this.type="SplineCurve",this.points=e||[]}My.prototype=Object.create(_y.prototype),My.prototype.constructor=My,My.prototype.isCatmullRomCurve3=!0,My.prototype.getPoint=function(e,t){var n,i,r,a,o=t||new zc,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?n=s[(c-1)%l]:(wy.subVectors(s[0],s[1]).add(s[0]),n=wy),i=s[c%l],r=s[(c+1)%l],this.closed||c+2<l?a=s[(c+2)%l]:(wy.subVectors(s[l-1],s[l-2]).add(s[l-1]),a=wy),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(i),d),p=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(a),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),xy.initNonuniformCatmullRom(n.x,i.x,r.x,a.x,f,p,m),Ay.initNonuniformCatmullRom(n.y,i.y,r.y,a.y,f,p,m),Sy.initNonuniformCatmullRom(n.z,i.z,r.z,a.z,f,p,m)}else"catmullrom"===this.curveType&&(xy.initCatmullRom(n.x,i.x,r.x,a.x,this.tension),Ay.initCatmullRom(n.y,i.y,r.y,a.y,this.tension),Sy.initCatmullRom(n.z,i.z,r.z,a.z,this.tension));return o.set(xy.calc(h),Ay.calc(h),Sy.calc(h)),o},My.prototype.copy=function(e){_y.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},My.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},My.prototype.fromJSON=function(e){_y.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new zc).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Py.prototype=Object.create(_y.prototype),Py.prototype.constructor=Py,Py.prototype.isCubicBezierCurve=!0,Py.prototype.getPoint=function(e,t){var n=t||new Pc,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Iy(e,i.x,r.x,a.x,o.x),Iy(e,i.y,r.y,a.y,o.y)),n},Py.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Py.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Py.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ly.prototype=Object.create(_y.prototype),Ly.prototype.constructor=Ly,Ly.prototype.isCubicBezierCurve3=!0,Ly.prototype.getPoint=function(e,t){var n=t||new zc,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Iy(e,i.x,r.x,a.x,o.x),Iy(e,i.y,r.y,a.y,o.y),Iy(e,i.z,r.z,a.z,o.z)),n},Ly.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ly.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ly.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Dy.prototype=Object.create(_y.prototype),Dy.prototype.constructor=Dy,Dy.prototype.isLineCurve=!0,Dy.prototype.getPoint=function(e,t){var n=t||new Pc;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Dy.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Dy.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Dy.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Dy.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Dy.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Oy.prototype=Object.create(_y.prototype),Oy.prototype.constructor=Oy,Oy.prototype.isLineCurve3=!0,Oy.prototype.getPoint=function(e,t){var n=t||new zc;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Oy.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Oy.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Oy.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Oy.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ny.prototype=Object.create(_y.prototype),Ny.prototype.constructor=Ny,Ny.prototype.isQuadraticBezierCurve=!0,Ny.prototype.getPoint=function(e,t){var n=t||new Pc,i=this.v0,r=this.v1,a=this.v2;return n.set(Ry(e,i.x,r.x,a.x),Ry(e,i.y,r.y,a.y)),n},Ny.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ny.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ny.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ky.prototype=Object.create(_y.prototype),ky.prototype.constructor=ky,ky.prototype.isQuadraticBezierCurve3=!0,ky.prototype.getPoint=function(e,t){var n=t||new zc,i=this.v0,r=this.v1,a=this.v2;return n.set(Ry(e,i.x,r.x,a.x),Ry(e,i.y,r.y,a.y),Ry(e,i.z,r.z,a.z)),n},ky.prototype.copy=function(e){return _y.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ky.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ky.prototype.fromJSON=function(e){return _y.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Fy.prototype=Object.create(_y.prototype),Fy.prototype.constructor=Fy,Fy.prototype.isSplineCurve=!0,Fy.prototype.getPoint=function(e,t){var n=t||new Pc,i=this.points,r=(i.length-1)*e,a=Math.floor(r),o=r-a,s=i[0===a?a:a-1],l=i[a],u=i[a>i.length-2?i.length-1:a+1],c=i[a>i.length-3?i.length-1:a+2];return n.set(Cy(o,s.x,l.x,u.x,c.x),Cy(o,s.y,l.y,u.y,c.y)),n},Fy.prototype.copy=function(e){_y.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this},Fy.prototype.toJSON=function(){var e=_y.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e},Fy.prototype.fromJSON=function(e){_y.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new Pc).fromArray(i))}return this};var By=Object.freeze({__proto__:null,ArcCurve:Ey,CatmullRomCurve3:My,CubicBezierCurve:Py,CubicBezierCurve3:Ly,EllipseCurve:by,LineCurve:Dy,LineCurve3:Oy,QuadraticBezierCurve:Ny,QuadraticBezierCurve3:ky,SplineCurve:Fy});function Uy(){_y.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function jy(e){Uy.call(this),this.type="Path",this.currentPoint=new Pc,e&&this.setFromPoints(e)}function Gy(e){jy.call(this,e),this.uuid=Ic.generateUUID(),this.type="Shape",this.holes=[]}function zy(e,t){ph.call(this),this.type="Light",this.color=new ad(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Hy(e,t,n){zy.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ph.DefaultUp),this.updateMatrix(),this.groundColor=new ad(t)}function Vy(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Pc(512,512),this.map=null,this.mapPass=null,this.matrix=new Qc,this._frustum=new yf,this._frameExtents=new Pc(1,1),this._viewportCount=1,this._viewports=[new kc(0,0,1,1)]}function Wy(){Vy.call(this,new df(50,1,.5,500))}function qy(e,t,n,i,r,a){zy.call(this,e,t),this.type="SpotLight",this.position.copy(ph.DefaultUp),this.updateMatrix(),this.target=new ph,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new Wy}function Yy(){Vy.call(this,new df(90,1,.5,500)),this._frameExtents=new Pc(4,2),this._viewportCount=6,this._viewports=[new kc(2,1,1,1),new kc(0,1,1,1),new kc(3,1,1,1),new kc(1,1,1,1),new kc(3,0,1,1),new kc(1,0,1,1)],this._cubeDirections=[new zc(1,0,0),new zc(-1,0,0),new zc(0,0,1),new zc(0,0,-1),new zc(0,1,0),new zc(0,-1,0)],this._cubeUps=[new zc(0,1,0),new zc(0,1,0),new zc(0,1,0),new zc(0,1,0),new zc(0,0,1),new zc(0,0,-1)]}function Xy(e,t,n,i){zy.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Yy}function Ky(e,t,n,i,r,a){hf.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Qy(){Vy.call(this,new Ky(-5,5,5,-5,.5,500))}function Zy(e,t){zy.call(this,e,t),this.type="DirectionalLight",this.position.copy(ph.DefaultUp),this.updateMatrix(),this.target=new ph,this.shadow=new Qy}function Jy(e,t){zy.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function $y(e,t,n,i){zy.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function e_(e){cy.call(this,e),this.textures={}}Uy.prototype=Object.assign(Object.create(_y.prototype),{constructor:Uy,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Dy(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var r=n[i]-t,a=this.curves[i],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],i=0,r=this.curves;i<r.length;i++)for(var a=r[i],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){_y.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=_y.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){_y.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push((new By[i.type]).fromJSON(i))}return this}}),jy.prototype=Object.assign(Object.create(Uy.prototype),{constructor:jy,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new Dy(this.currentPoint.clone(),new Pc(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,i){var r=new Ny(this.currentPoint.clone(),new Pc(e,t),new Pc(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(e,t,n,i,r,a){var o=new Py(this.currentPoint.clone(),new Pc(e,t),new Pc(n,i),new Pc(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this},splineThru:function(e){var t=new Fy([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,i,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,i,r,a),this},absarc:function(e,t,n,i,r,a){return this.absellipse(e,t,n,n,i,r,a),this},ellipse:function(e,t,n,i,r,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,i,r,a,o,s),this},absellipse:function(e,t,n,i,r,a,o,s){var l=new by(e,t,n,i,r,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this},copy:function(e){return Uy.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Uy.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Uy.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Gy.prototype=Object.assign(Object.create(jy.prototype),{constructor:Gy,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){jy.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=jy.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){jy.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push((new jy).fromJSON(i))}return this}}),zy.prototype=Object.assign(Object.create(ph.prototype),{constructor:zy,isLight:!0,copy:function(e){return ph.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=ph.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Hy.prototype=Object.assign(Object.create(zy.prototype),{constructor:Hy,isHemisphereLight:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Vy.prototype,{_projScreenMatrix:new Qc,_lightPositionWorld:new zc,_lookTarget:new zc,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Wy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:Wy,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*Ic.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),Vy.prototype.updateMatrices.call(this,e)}}),qy.prototype=Object.assign(Object.create(zy.prototype),{constructor:qy,isSpotLight:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Yy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:Yy,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var n=this.camera,i=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(e.matrixWorld),n.position.copy(r),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),Xy.prototype=Object.assign(Object.create(zy.prototype),{constructor:Xy,isPointLight:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Ky.prototype=Object.assign(Object.create(hf.prototype),{constructor:Ky,isOrthographicCamera:!0,copy:function(e,t){return hf.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,a=n+e,o=i+t,s=i-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(r+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=ph.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Qy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:Qy,isDirectionalLightShadow:!0,updateMatrices:function(e){Vy.prototype.updateMatrices.call(this,e)}}),Zy.prototype=Object.assign(Object.create(zy.prototype),{constructor:Zy,isDirectionalLight:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Jy.prototype=Object.assign(Object.create(zy.prototype),{constructor:Jy,isAmbientLight:!0}),$y.prototype=Object.assign(Object.create(zy.prototype),{constructor:$y,isRectAreaLight:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=zy.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),e_.prototype=Object.assign(Object.create(cy.prototype),{constructor:e_,load:function(e,t,n,i){var r=this,a=new dy(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=new Wv[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=(new ad).setHex(e.sheen)),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(i.morphNormals=e.morphNormals),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.vertexTangents&&(i.vertexTangents=e.vertexTangents),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var r in e.uniforms){var a=e.uniforms[r];switch(i.uniforms[r]={},a.type){case"t":i.uniforms[r].value=n(a.value);break;case"c":i.uniforms[r].value=(new ad).setHex(a.value);break;case"v2":i.uniforms[r].value=(new Pc).fromArray(a.value);break;case"v3":i.uniforms[r].value=(new zc).fromArray(a.value);break;case"v4":i.uniforms[r].value=(new kc).fromArray(a.value);break;case"m3":i.uniforms[r].value=(new Lc).fromArray(a.value);case"m4":i.uniforms[r].value=(new Qc).fromArray(a.value);break;default:i.uniforms[r].value=a.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)i.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),i.normalScale=(new Pc).fromArray(s)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Pc).fromArray(e.clearcoatNormalScale)),i},setTextures:function(e){return this.textures=e,this}});var t_=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function n_(){Dd.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function i_(e,t,n,i){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),pd.call(this,e,t,n),this.meshPerAttribute=i||1}function r_(e){cy.call(this,e)}n_.prototype=Object.assign(Object.create(Dd.prototype),{constructor:n_,isInstancedBufferGeometry:!0,copy:function(e){return Dd.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=Dd.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),i_.prototype=Object.assign(Object.create(pd.prototype),{constructor:i_,isInstancedBufferAttribute:!0,copy:function(e){return pd.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=pd.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),r_.prototype=Object.assign(Object.create(cy.prototype),{constructor:r_,load:function(e,t,n,i){var r=this,a=new dy(r.manager);a.setPath(r.path),a.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},parse:function(e){var t=e.isInstancedBufferGeometry?new n_:new Dd,n=e.data.index;if(void 0!==n){var i=new a_[n.type](n.array);t.setIndex(new pd(i,1))}var r=e.data.attributes;for(var a in r){var o=r[a],s=(i=new a_[o.type](o.array),new(o.isInstancedBufferAttribute?i_:pd)(i,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),t.setAttribute(a,s)}var l=e.data.morphAttributes;if(l)for(var a in l){for(var u=l[a],c=[],h=0,d=u.length;h<d;h++){o=u[h],s=new pd(i=new a_[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),c.push(s)}t.morphAttributes[a]=c}e.data.morphTargetsRelative&&(t.morphTargetsRelative=!0);var f=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==f){h=0;for(var p=f.length;h!==p;++h){var m=f[h];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var v=new zc;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new Lh(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var a_={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function o_(e){cy.call(this,e)}o_.prototype=Object.assign(Object.create(cy.prototype),{constructor:o_,load:function(e,t,n,i){var r=this,a=""===this.path?t_(e):this.path;this.resourcePath=this.resourcePath||a;var o=new dy(r.manager);o.setPath(this.path),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,i)},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,i,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,i=e.length;n<i;n++){var r=(new Gy).fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var i=new r_,r=0,a=e.length;r<a;r++){var o,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Ov[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Ov[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Ov[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Ov[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Ov[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Ov[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Ov[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Ov[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Ov[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Ov[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Ov[s.type]((new By[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Ov[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Ov[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],u=0,c=s.shapes.length;u<c;u++){var h=t[s.shapes[u]];l.push(h)}o=new Ov[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],u=0,c=s.shapes.length;u<c;u++){h=t[s.shapes[u]];l.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new By[d.type]).fromJSON(d)),o=new Ov[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(e,t){var n={},i={};if(void 0!==e){var r=new e_;r.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=r.parse(c)),l.push(n[c.uuid])}i[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=ay.parse(i);void 0!==i.uuid&&(r.uuid=i.uuid),t.push(r)}return t},parseImages:function(e,t){var n=this,i={};function r(e){return n.manager.itemStart(e),a.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var a=new gy(new ly(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var l=e[o],u=l.url;if(Array.isArray(u)){i[l.uuid]=[];for(var c=0,h=u.length;c<h;c++){var d=u[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;i[l.uuid].push(r(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.resourcePath+l.url;i[l.uuid]=r(f)}}}return i},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var i={};if(void 0!==e)for(var r=0,a=e.length;r<a;r++){var o,s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new Ff(t[s.image]):new Nc(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,l_)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],u_),o.wrapT=n(s.wrap[1],u_)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,c_)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,c_)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),i[s.uuid]=o}return i},parseObject:function(e,t,n){var i;function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],i=0,r=e.length;i<r;i++){var a=e[i];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new mh,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new ad(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new Em(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new bm(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new df(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new Ky(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new Jy(e.color,e.intensity);break;case"DirectionalLight":i=new Zy(e.color,e.intensity);break;case"PointLight":i=new Xy(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new $y(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new qy(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Hy(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=r(e.geometry),s=a(e.material);i=o.bones&&o.bones.length>0?new Vm(o,s):new Zd(o,s);break;case"InstancedMesh":o=r(e.geometry),s=a(e.material);var l=e.count,u=e.instanceMatrix;(i=new $m(o,s,l)).instanceMatrix=new pd(new Float32Array(u.array),16);break;case"LOD":i=new Hm;break;case"Line":i=new og(r(e.geometry),a(e.material),e.mode);break;case"LineLoop":i=new cg(r(e.geometry),a(e.material));break;case"LineSegments":i=new ug(r(e.geometry),a(e.material));break;case"PointCloud":case"Points":i=new gg(r(e.geometry),a(e.material));break;case"Sprite":i=new Um(a(e.material));break;case"Group":i=new vm;break;default:i=new ph}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,h=0;h<c.length;h++)i.add(this.parseObject(c[h],t,n));if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);for(var d=e.levels,f=0;f<d.length;f++){var p=d[f],m=i.getObjectByProperty("uuid",p.object);void 0!==m&&i.addLevel(m,p.distance)}}return i}});var s_,l_={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},u_={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},c_={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function h_(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),cy.call(this,e),this.options=void 0}function d_(){this.type="ShapePath",this.color=new ad,this.subPaths=[],this.currentPath=null}function f_(e){this.type="Font",this.data=e}function p_(e,t,n,i,r){var a=r.glyphs[e]||r.glyphs["?"];if(a){var o,s,l,u,c,h,d,f,p=new d_;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*t+n,s=m[g++]*t+i,p.moveTo(o,s);break;case"l":o=m[g++]*t+n,s=m[g++]*t+i,p.lineTo(o,s);break;case"q":l=m[g++]*t+n,u=m[g++]*t+i,c=m[g++]*t+n,h=m[g++]*t+i,p.quadraticCurveTo(c,h,l,u);break;case"b":l=m[g++]*t+n,u=m[g++]*t+i,c=m[g++]*t+n,h=m[g++]*t+i,d=m[g++]*t+n,f=m[g++]*t+i,p.bezierCurveTo(c,h,d,f,l,u)}}return{offsetX:a.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".")}function m_(e){cy.call(this,e)}h_.prototype=Object.assign(Object.create(cy.prototype),{constructor:h_,setOptions:function(e){return this.options=e,this},load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=sy.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===r.options?createImageBitmap(e):createImageBitmap(e,r.options)})).then((function(n){sy.add(e,n),t&&t(n),r.manager.itemEnd(e)})).catch((function(t){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}}),Object.assign(d_.prototype,{moveTo:function(e,t){return this.currentPath=new jy,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this},bezierCurveTo:function(e,t,n,i,r,a){return this.currentPath.bezierCurveTo(e,t,n,i,r,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],a=new Gy;a.curves=r.curves,t.push(a)}return t}function i(e,t){for(var n=t.length,i=!1,r=n-1,a=0;a<n;r=a++){var o=t[r],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[r],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0===c)return!0;if(c<0)continue;i=!i}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return i}var r=uv.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);var o,s,l,u=[];if(1===a.length)return s=a[0],(l=new Gy).curves=s.curves,u.push(l),u;var c=!r(a[0].getPoints());c=e?!c:c;var h,d,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=r(h=(s=a[v]).getPoints()),(o=e?!o:o)?(!c&&p[g]&&g++,p[g]={s:new Gy,p:h},p[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!p[0])return n(a);if(p.length>1){for(var _=!1,b=[],E=0,T=p.length;E<T;E++)f[E]=[];for(E=0,T=p.length;E<T;E++)for(var w=m[E],x=0;x<w.length;x++){for(var A=w[x],S=!0,M=0;M<p.length;M++)i(A.p,p[M].p)&&(E!==M&&b.push({froms:E,tos:M,hole:x}),S?(S=!1,f[M].push(A)):_=!0);S&&f[E].push(A)}b.length>0&&(_||(m=f))}v=0;for(var C=p.length;v<C;v++){l=p[v].s,u.push(l);for(var R=0,I=(d=m[v]).length;R<I;R++)l.holes.push(d[R].h)}return u}}),Object.assign(f_.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],i=function(e,t,n){for(var i=Array.from?Array.from(e):String(e).split(""),r=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[],s=0,l=0,u=0;u<i.length;u++){var c=i[u];if("\n"===c)s=0,l-=a;else{var h=p_(c,r,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}(e,t,this.data),r=0,a=i.length;r<a;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}}),m_.prototype=Object.assign(Object.create(cy.prototype),{constructor:m_,load:function(e,t,n,i){var r=this,a=new dy(this.manager);a.setPath(this.path),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var i=r.parse(n);t&&t(i)}),n,i)},parse:function(e){return new f_(e)}});var g_=function(){return void 0===s_&&(s_=new(window.AudioContext||window.webkitAudioContext)),s_};function v_(e){cy.call(this,e)}function y_(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new zc)}function __(e,t){zy.call(this,void 0,t),this.sh=void 0!==e?e:new y_}function b_(e,t,n){__.call(this,void 0,n);var i=(new ad).set(e),r=(new ad).set(t),a=new zc(i.r,i.g,i.b),o=new zc(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function E_(e,t){__.call(this,void 0,t);var n=(new ad).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}v_.prototype=Object.assign(Object.create(cy.prototype),{constructor:v_,load:function(e,t,n,i){var r=new dy(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,(function(e){var n=e.slice(0);g_().decodeAudioData(n,(function(e){t(e)}))}),n,i)}}),Object.assign(y_.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScale(a[1],.488603*i),t.addScale(a[2],.488603*r),t.addScale(a[3],.488603*n),t.addScale(a[4],n*i*1.092548),t.addScale(a[5],i*r*1.092548),t.addScale(a[6],.315392*(3*r*r-1)),t.addScale(a[7],n*r*1.092548),t.addScale(a[8],.546274*(n*n-i*i)),t},getIrradianceAt:function(e,t){var n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScale(a[1],1.023328*i),t.addScale(a[2],1.023328*r),t.addScale(a[3],1.023328*n),t.addScale(a[4],.858086*n*i),t.addScale(a[5],.858086*i*r),t.addScale(a[6],.743125*r*r-.247708),t.addScale(a[7],.858086*n*r),t.addScale(a[8],.429043*(n*n-i*i)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}}),Object.assign(y_,{getBasisAt:function(e,t){var n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}),__.prototype=Object.assign(Object.create(zy.prototype),{constructor:__,isLightProbe:!0,copy:function(e){return zy.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return zy.prototype.toJSON.call(this,e)}}),b_.prototype=Object.assign(Object.create(__.prototype),{constructor:b_,isHemisphereLightProbe:!0,copy:function(e){return __.prototype.copy.call(this,e),this},toJSON:function(e){return __.prototype.toJSON.call(this,e)}}),E_.prototype=Object.assign(Object.create(__.prototype),{constructor:E_,isAmbientLightProbe:!0,copy:function(e){return __.prototype.copy.call(this,e),this},toJSON:function(e){return __.prototype.toJSON.call(this,e)}});var T_=new Qc,w_=new Qc;function x_(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new df,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new df,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,i,r=e.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,s=t.near*Math.tan(Ic.DEG2RAD*t.fov*.5)/t.zoom;w_.elements[12]=-a,T_.elements[12]=a,n=-s*t.aspect+o,i=s*t.aspect+o,r.elements[0]=2*t.near/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraL.projectionMatrix.copy(r),n=-s*t.aspect-o,i=s*t.aspect-o,r.elements[0]=2*t.near/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(w_),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(T_)}}),Object.assign(x_.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var A_=new zc,S_=new Uc,M_=new zc,C_=new zc;function R_(){ph.call(this),this.type="AudioListener",this.context=g_(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new x_}function I_(e){ph.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}R_.prototype=Object.assign(Object.create(ph.prototype),{constructor:R_,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){ph.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(A_,S_,M_),C_.set(0,0,-1).applyQuaternion(S_),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(A_.x,i),t.positionY.linearRampToValueAtTime(A_.y,i),t.positionZ.linearRampToValueAtTime(A_.z,i),t.forwardX.linearRampToValueAtTime(C_.x,i),t.forwardY.linearRampToValueAtTime(C_.y,i),t.forwardZ.linearRampToValueAtTime(C_.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(A_.x,A_.y,A_.z),t.setOrientation(C_.x,C_.y,C_.z,n.x,n.y,n.z)}}),I_.prototype=Object.assign(Object.create(ph.prototype),{constructor:I_,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var P_=new zc,L_=new Uc,D_=new zc,O_=new zc;function N_(e){I_.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function k_(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function F_(e,t,n){this.binding=e,this.valueSize=n;var i,r=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}N_.prototype=Object.assign(Object.create(I_.prototype),{constructor:N_,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(ph.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(P_,L_,D_),O_.set(0,0,1).applyQuaternion(L_);var t=this.panner;if(t.positionX){var n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(P_.x,n),t.positionY.linearRampToValueAtTime(P_.y,n),t.positionZ.linearRampToValueAtTime(P_.z,n),t.orientationX.linearRampToValueAtTime(O_.x,n),t.orientationY.linearRampToValueAtTime(O_.y,n),t.orientationZ.linearRampToValueAtTime(O_.z,n)}else t.setPosition(P_.x,P_.y,P_.z),t.setOrientation(O_.x,O_.y,O_.z)}}}),Object.assign(k_.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(F_.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,r=e*i+i,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==i;++o)n[r+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*t;this._mixBufferRegion(n,i,o,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){a.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=3*n;e.getValue(t,i);for(var r=n,a=i;r!==a;++r)t[r]=t[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,r){if(i>=.5)for(var a=0;a!==r;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,i){Uc.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var a=1-i,o=0;o!==r;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*i}}});var B_=new RegExp("[\\[\\]\\.:\\/]","g"),U_="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",j_=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),G_=/(WCOD+)?/.source.replace("WCOD",U_),z_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),H_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),V_=new RegExp("^"+j_+G_+z_+H_+"$"),W_=["material","materials","bones"];function q_(e,t,n){var i=n||Y_.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function Y_(e,t,n){this.path=t,this.parsedPath=n||Y_.parseTrackName(t),this.node=Y_.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function X_(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,r=i.length,a=new Array(r),o={endingStart:2400,endingEnd:2400},s=0;s!==r;++s){var l=i[s].createInterpolant(null);a[s]=l,l.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function K_(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Q_(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Z_(e,t,n){Tm.call(this,e,t),this.meshPerAttribute=n||1}function J_(e,t,n,i){this.ray=new jh(e,t),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new eh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function $_(e,t){return e.distance-t.distance}function eb(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i)for(var r=e.children,a=0,o=r.length;a<o;a++)eb(r[a],t,n,!0)}function tb(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}Object.assign(q_.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Y_,{Composite:q_,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Y_.Composite(e,t,n):new Y_(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(B_,"")},parseTrackName:function(e){var t=V_.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==W_.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var i=function(e){for(var n=0;n<e.length;n++){var r=e[n];if(r.name===t||r.uuid===t)return r;var a=i(r.children);if(a)return a}return null},r=i(e.children);if(r)return r}return null}}),Object.assign(Y_.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=Y_.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[i];if(void 0!==s){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===r){r=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Y_.prototype,{_getValue_unbound:Y_.prototype.getValue,_setValue_unbound:Y_.prototype.setValue}),Object.assign(function(){this.uuid=Ic.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=i[d];if(void 0===f){f=t++,i[d]=f,e.push(h);for(var p=0,m=s;p!==m;++p)o[p].push(new Y_(h,r[p],a[p]))}else if(f<n){l=e[f];var g=--n,v=e[g];i[v.uuid]=f,e[f]=v,i[d]=g,e[g]=h;for(p=0,m=s;p!==m;++p){var y=o[p],_=y[g],b=y[f];y[f]=_,void 0===b&&(b=new Y_(h,r[p],a[p])),y[g]=b}}else e[f]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=n[l];if(void 0!==u&&u>=t){var c=t++,h=e[c];n[h.uuid]=u,e[u]=h,n[l]=c,e[c]=s;for(var d=0,f=r;d!==f;++d){var p=i[d],m=p[c],g=p[u];p[u]=m,p[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],u=l.uuid,c=i[u];if(void 0!==c)if(delete i[u],c<n){var h=--n,d=e[h],f=e[y=--t];i[d.uuid]=c,e[c]=d,i[f.uuid]=h,e[h]=f,e.pop();for(var p=0,m=a;p!==m;++p){var g=(_=r[p])[h],v=_[y];_[c]=g,_[h]=v,_.pop()}}else{var y;i[(f=e[y=--t]).uuid]=c,e[c]=f,e.pop();for(p=0,m=a;p!==m;++p){var _;(_=r[p])[c]=_[y],_.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(void 0!==i)return r[i];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[e]=i,a.push(e),o.push(t),r.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new Y_(f,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var i=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}),Object.assign(X_.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,r=e._clip.duration,a=r/i,o=i/r;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+n,l[0]=e/o,l[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var r=this._startTime;if(null!==r){var a=(e-r)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(i,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,i=this.loop,r=this._loopCount,a=2202===i;if(0===e)return-1===r?t:a&&1==(1&r)?n-t:t;if(2200===i){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=n||t<0){var o=Math.floor(t/n);t-=n*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&1==(1&r))return n-t}return t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=t,o[1]=r+e,s[1]=n,this}}),K_.prototype=Object.assign(Object.create(Sc.prototype),{constructor:K_,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==r;++c){var h=i[c],d=h.name,f=u[d];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(f=new F_(Y_.create(n,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),a[c]=f}o[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var r=e._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,a=r[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],a=this._bindings;void 0===r&&(r={},i[t]=r),r[n]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[r],0===Object.keys(o).length&&delete a[i]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Kv(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?ay.findByName(n,e):e,a=null!==r?r.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var l=o.actionByRoot[i];if(void 0!==l)return l;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var u=new X_(this,r,t);return this._bindAction(u,s),this._addInactiveAction(u,a,i),u},existingAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?ay.findByName(n,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(i,e,r,a)}var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Q_.prototype.clone=function(){return new Q_(void 0===this.value.clone?this.value:this.value.clone())},Z_.prototype=Object.assign(Object.create(Tm.prototype),{constructor:Z_,isInstancedInterleavedBuffer:!0,copy:function(e){return Tm.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(J_.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return eb(e,this,i,t),i.sort($_),i},intersectObjects:function(e,t,n){var i=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,a=e.length;r<a;r++)eb(e[r],this,i,t);return i.sort($_),i}}),Object.assign(tb.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ic.clamp(t/this.radius,-1,1))),this}}),Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var nb=new Pc;function ib(e,t){this.min=void 0!==e?e:new Pc(1/0,1/0),this.max=void 0!==t?t:new Pc(-1/0,-1/0)}Object.assign(ib.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=nb.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Pc),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Pc),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Pc),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Pc),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return nb.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var rb=new zc,ab=new zc;function ob(e,t){this.start=void 0!==e?e:new zc,this.end=void 0!==t?t:new zc}function sb(e){ph.call(this),this.material=e,this.render=function(){}}Object.assign(ob.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new zc),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new zc),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new zc),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){rb.subVectors(e,this.start),ab.subVectors(this.end,this.start);var n=ab.dot(ab),i=ab.dot(rb)/n;return t&&(i=Ic.clamp(i,0,1)),i},closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new zc),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),sb.prototype=Object.create(ph.prototype),sb.prototype.constructor=sb,sb.prototype.isImmediateRenderObject=!0;var lb=new zc;function ub(e,t){ph.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Dd,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1;r<32;r++,a++){var o=r/32*Math.PI*2,s=a/32*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new Td(i,3));var l=new eg({fog:!1});this.cone=new ug(n,l),this.add(this.cone),this.update()}ub.prototype=Object.create(ph.prototype),ub.prototype.constructor=ub,ub.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ub.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),lb.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lb),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var cb=new zc,hb=new Qc,db=new Qc;function fb(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var i=0;i<t.children.length;i++)n.push.apply(n,e(t.children[i]));return n}(e),n=new Dd,i=[],r=[],a=new ad(0,0,1),o=new ad(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Td(i,3)),n.setAttribute("color",new Td(r,3));var u=new eg({vertexColors:!0,depthTest:!1,depthWrite:!1,transparent:!0});ug.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function pb(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new _v(t,4,2),r=new dd({wireframe:!0,fog:!1});Zd.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}fb.prototype=Object.create(ug.prototype),fb.prototype.constructor=fb,fb.prototype.isSkeletonHelper=!0,fb.prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");db.getInverse(this.root.matrixWorld);for(var r=0,a=0;r<t.length;r++){var o=t[r];o.parent&&o.parent.isBone&&(hb.multiplyMatrices(db,o.matrixWorld),cb.setFromMatrixPosition(hb),i.setXYZ(a,cb.x,cb.y,cb.z),hb.multiplyMatrices(db,o.parent.matrixWorld),cb.setFromMatrixPosition(hb),i.setXYZ(a+1,cb.x,cb.y,cb.z),a+=2)}n.getAttribute("position").needsUpdate=!0,ph.prototype.updateMatrixWorld.call(this,e)},pb.prototype=Object.create(Zd.prototype),pb.prototype.constructor=pb,pb.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},pb.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var mb=new zc,gb=new ad,vb=new ad;function yb(e,t,n){ph.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new Ig(t);i.rotateY(.5*Math.PI),this.material=new dd({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=!0);var r=i.getAttribute("position"),a=new Float32Array(3*r.count);i.setAttribute("color",new pd(a,3)),this.add(new Zd(i,this.material)),this.update()}function _b(e,t,n,i){e=e||10,t=t||10,n=new ad(void 0!==n?n:4473924),i=new ad(void 0!==i?i:8947848);for(var r=t/2,a=e/t,o=e/2,s=[],l=[],u=0,c=0,h=-o;u<=t;u++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=u===r?n:i;d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3,d.toArray(l,c),c+=3}var f=new Dd;f.setAttribute("position",new Td(s,3)),f.setAttribute("color",new Td(l,3));var p=new eg({vertexColors:!0});ug.call(this,f,p)}function bb(e,t,n,i,r,a){e=e||10,t=t||16,n=n||8,i=i||64,r=new ad(void 0!==r?r:4473924),a=new ad(void 0!==a?a:8947848);var o,s,l,u,c,h,d,f=[],p=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),o=Math.sin(l)*e,s=Math.cos(l)*e,f.push(0,0,0),f.push(o,0,s),d=1&u?r:a,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?r:a,h=e-e/n*u,c=0;c<i;c++)l=c/i*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b),l=(c+1)/i*(2*Math.PI),o=Math.sin(l)*h,s=Math.cos(l)*h,f.push(o,0,s),p.push(d.r,d.g,d.b);var m=new Dd;m.setAttribute("position",new Td(f,3)),m.setAttribute("color",new Td(p,3));var g=new eg({vertexColors:!0});ug.call(this,m,g)}yb.prototype=Object.create(ph.prototype),yb.prototype.constructor=yb,yb.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},yb.prototype.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");gb.copy(this.light.color),vb.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var r=n<i/2?gb:vb;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(mb.setFromMatrixPosition(this.light.matrixWorld).negate())},_b.prototype=Object.assign(Object.create(ug.prototype),{constructor:_b,copy:function(e){return ug.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),bb.prototype=Object.create(ug.prototype),bb.prototype.constructor=bb;var Eb=new zc,Tb=new zc,wb=new zc;function xb(e,t,n){ph.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var i=new Dd;i.setAttribute("position",new Td([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new eg({fog:!1});this.lightPlane=new og(i,r),this.add(this.lightPlane),(i=new Dd).setAttribute("position",new Td([0,0,0,0,0,1],3)),this.targetLine=new og(i,r),this.add(this.targetLine),this.update()}xb.prototype=Object.create(ph.prototype),xb.prototype.constructor=xb,xb.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},xb.prototype.update=function(){Eb.setFromMatrixPosition(this.light.matrixWorld),Tb.setFromMatrixPosition(this.light.target.matrixWorld),wb.subVectors(Tb,Eb),this.lightPlane.lookAt(Tb),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Tb),this.targetLine.scale.z=wb.length()};var Ab=new zc,Sb=new hf;function Mb(e){var t=new Dd,n=new eg({color:16777215,vertexColors:!0}),i=[],r=[],a={},o=new ad(16755200),s=new ad(16711680),l=new ad(43775),u=new ad(16777215),c=new ad(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(i.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.setAttribute("position",new Td(i,3)),t.setAttribute("color",new Td(r,3)),ug.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Cb(e,t,n,i,r,a,o){Ab.set(r,a,o).unproject(i);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Ab.x,Ab.y,Ab.z)}Mb.prototype=Object.create(ug.prototype),Mb.prototype.constructor=Mb,Mb.prototype.update=function(){var e=this.geometry,t=this.pointMap;Sb.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Cb("c",t,e,Sb,0,0,-1),Cb("t",t,e,Sb,0,0,1),Cb("n1",t,e,Sb,-1,-1,-1),Cb("n2",t,e,Sb,1,-1,-1),Cb("n3",t,e,Sb,-1,1,-1),Cb("n4",t,e,Sb,1,1,-1),Cb("f1",t,e,Sb,-1,-1,1),Cb("f2",t,e,Sb,1,-1,1),Cb("f3",t,e,Sb,-1,1,1),Cb("f4",t,e,Sb,1,1,1),Cb("u1",t,e,Sb,.7,1.1,-1),Cb("u2",t,e,Sb,-.7,1.1,-1),Cb("u3",t,e,Sb,0,2,-1),Cb("cf1",t,e,Sb,-1,0,1),Cb("cf2",t,e,Sb,1,0,1),Cb("cf3",t,e,Sb,0,-1,1),Cb("cf4",t,e,Sb,0,1,1),Cb("cn1",t,e,Sb,-1,0,-1),Cb("cn2",t,e,Sb,1,0,-1),Cb("cn3",t,e,Sb,0,-1,-1),Cb("cn4",t,e,Sb,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Rb=new Rh;function Ib(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Dd;r.setIndex(new pd(n,1)),r.setAttribute("position",new pd(i,3)),ug.call(this,r,new eg({color:t})),this.matrixAutoUpdate=!1,this.update()}function Pb(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Dd;i.setIndex(new pd(n,1)),i.setAttribute("position",new Td([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ug.call(this,i,new eg({color:t})),this.geometry.computeBoundingSphere()}function Lb(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var i=void 0!==n?n:16776960,r=new Dd;r.setAttribute("position",new Td([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),og.call(this,r,new eg({color:i}));var a=new Dd;a.setAttribute("position",new Td([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Zd(a,new dd({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}Ib.prototype=Object.create(ug.prototype),Ib.prototype.constructor=Ib,Ib.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Rb.setFromObject(this.object),!Rb.isEmpty()){var t=Rb.min,n=Rb.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Ib.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Ib.prototype.copy=function(e){return ug.prototype.copy.call(this,e),this.object=e.object,this},Ib.prototype.clone=function(){return(new this.constructor).copy(this)},Pb.prototype=Object.create(ug.prototype),Pb.prototype.constructor=Pb,Pb.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),ph.prototype.updateMatrixWorld.call(this,e))},Lb.prototype=Object.create(og.prototype),Lb.prototype.constructor=Lb,Lb.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?1:0,this.lookAt(this.plane.normal),ph.prototype.updateMatrixWorld.call(this,e)};var Db,Ob,Nb=new zc;function kb(e,t,n,i,r,a){ph.call(this),void 0===e&&(e=new zc(0,0,1)),void 0===t&&(t=new zc(0,0,0)),void 0===n&&(n=1),void 0===i&&(i=16776960),void 0===r&&(r=.2*n),void 0===a&&(a=.2*r),void 0===Db&&((Db=new Dd).setAttribute("position",new Td([0,0,0,0,1,0],3)),(Ob=new Rv(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new og(Db,new eg({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Zd(Ob,new dd({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,a)}function Fb(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Dd;n.setAttribute("position",new Td(t,3)),n.setAttribute("color",new Td([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new eg({vertexColors:!0});ug.call(this,n,i)}kb.prototype=Object.create(ph.prototype),kb.prototype.constructor=kb,kb.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Nb.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Nb,t)}},kb.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},kb.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},kb.prototype.copy=function(e){return ph.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},kb.prototype.clone=function(){return(new this.constructor).copy(this)},Fb.prototype=Object.create(ug.prototype),Fb.prototype.constructor=Fb;var Bb,Ub,jb,Gb,zb=[.125,.215,.35,.446,.526,.582],Hb=5+zb.length,Vb={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},{_lodPlanes:Wb,_sizeLods:qb,_sigmas:Yb}=(new Ky,Bb=20,Ub=new Float32Array(Bb),jb=new zc(0,1,0),(Gb=new kv({defines:{n:Bb},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:Ub},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:jb},inputEncoding:{value:Vb[3e3]},outputEncoding:{value:Vb[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfor (int dir = -1; dir < 2; dir += 2) {\n\t\t\tif (i == 0 && dir == 1)\n\t\t\t\tcontinue;\n\t\t\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\t\t\tif (all(equal(axis, vec3(0.0))))\n\t\t\t\taxis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);\n\t\t\taxis = normalize(axis);\n\t\t\tfloat theta = dTheta * float(dir * i);\n\t\t\tfloat cosTheta = cos(theta);\n\t\t\t// Rodrigues' axis-angle rotation\n\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t\t\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\t\t\tgl_FragColor.rgb +=\n\t\t\t\t\tweights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);\n\t\t}\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",function(){for(var e=[],t=[],n=[],i=8,r=0;r<Hb;r++){var a=Math.pow(2,i);t.push(a);var o=1/a;r>4?o=zb[r-8+4-1]:0==r&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=new Float32Array(108),d=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,g=p>2?0:-1,v=[m,g,0,m+2/3,g,0,m+2/3,g+1,0,m,g,0,m+2/3,g+1,0,m,g+1,0];h.set(v,18*p),d.set(c,12*p);var y=[p,p,p,p,p,p];f.set(y,6*p)}var _=new Dd;_.setAttribute("position",new pd(h,3)),_.setAttribute("uv",new pd(d,2)),_.setAttribute("faceIndex",new pd(f,1)),e.push(_),i>4&&i--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}());function Xb(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),My.call(this,e),this.type="catmullrom"}_y.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(_y.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Uy.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new af,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new zc(r.x,r.y,r.z||0))}return t}}),Object.assign(jy.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Xb.prototype=Object.create(My.prototype),Object.assign(Xb.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),_b.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},fb.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(cy.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),t_(e)}}),cy.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(o_.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(ib.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Rh.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),yf.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},ob.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Ic,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ic.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ic.ceilPowerOfTwo(e)}}),Object.assign(Lc.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Qc.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new zc).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,a)}}),Vh.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Uc.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(jh.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(td.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(td,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),td.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),td.getNormal(e,t,n,i)}}),Object.assign(Gy.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new dv(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new xv(this,e)}}),Object.assign(Pc.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zc.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(kc.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(af.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(ph.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(ph.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Zd.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Zd.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Hm.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ym.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Vm.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(_y.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),df.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(zy.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(pd.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(pd.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Dd.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new pd(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Dd.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(J_.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Tm.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Tm.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(fv.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Q_.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(hd.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ad}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Uv.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(cf.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(_m.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(_m.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?3001:3e3}}}),Object.defineProperties(dm.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Fc.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(I_.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new v_).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),k_.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ff.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Dc.crossOrigin=void 0,Dc.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new yy;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a},Dc.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new vy;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a},Dc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Dc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"114"}}));var Kb=function(e,t){var n,i,r,a,o;void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new zc,this.currentDistance=1,this.minDistance=-700,this.maxDistance=200,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:_c,MIDDLE:bc,RIGHT:Ec},this.touches={ONE:Tc,TWO:xc},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(l),s.update(),f=d.NONE},this.update=(n=new zc,i=(new Uc).setFromUnitVectors(e.up,new zc(0,1,0)),r=i.clone().inverse(),a=new zc,o=new Uc,function(){var e=s.object.position;if(n.copy(e).sub(s.target),n.applyQuaternion(i),m.setFromVector3(n),s.autoRotate&&f===d.NONE&&R(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(m.theta+=g.theta*s.dampingFactor,m.phi+=g.phi*s.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi),m.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,m.theta)),m.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,m.phi)),m.makeSafe(),s.currentDistance>=0){var t=s.currentDistance;m.radius!=t&&(m.radius=s.currentDistance,y=!0)}else{var c=75+.06*s.currentDistance;s.object.fov!=c&&(s.object.fov=c,s.object.updateProjectionMatrix(),y=!0)}return m.radius=Math.max(s.minDistance,Math.min(s.maxDistance,m.radius)),!0===s.enableDamping?s.target.addScaledVector(v,s.dampingFactor):s.target.add(v),n.setFromSpherical(m),n.applyQuaternion(r),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(g.theta*=1-s.dampingFactor,g.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(g.set(0,0,0),v.set(0,0,0)),!!(y||a.distanceToSquared(s.object.position)>p||8*(1-o.dot(s.object.quaternion))>p)&&(y?s.dispatchEvent(u):s.dispatchEvent(l),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",$,!1),s.domElement.removeEventListener("mousedown",W,!1),s.domElement.removeEventListener("wheel",X,!1),s.domElement.removeEventListener("touchstart",Q,!1),s.domElement.removeEventListener("touchend",J,!1),s.domElement.removeEventListener("touchmove",Z,!1),document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",Y,!1),s.domElement.removeEventListener("keydown",K,!1)};var s=this,l={type:"change"},u={type:"zoom"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=d.NONE,p=1e-6,m=new tb,g=new tb,v=new zc,y=!1,_=new Pc,b=new Pc,E=new Pc,T=new Pc,w=new Pc,x=new Pc,A=new Pc,S=new Pc,M=new Pc;function C(){return Math.pow(.95,s.zoomSpeed)}function R(e){g.theta-=e}function I(e){g.phi-=e}var P,L=(P=new zc,function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),v.add(P)}),D=function(){var e=new zc;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),O=function(){var e=new zc;return function(t,n){var i=s.domElement;if(s.object.isPerspectiveCamera){var r=s.object.position;e.copy(r).sub(s.target);var a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),L(2*t*a/i.clientHeight,s.object.matrix),D(2*n*a/i.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(L(t*(s.object.right-s.object.left)/s.object.zoom/i.clientWidth,s.object.matrix),D(n*(s.object.top-s.object.bottom)/s.object.zoom/i.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function N(e){s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),y=!0):s.object.isPerspectiveCamera||(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),y=!0):s.object.isPerspectiveCamera||(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function F(e){_.set(e.clientX,e.clientY)}function B(e){T.set(e.clientX,e.clientY)}function U(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,n)}}function j(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,n)}}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);A.set(0,i)}function z(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,n)}E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var i=s.domElement;R(2*Math.PI*E.x/i.clientHeight),I(2*Math.PI*E.y/i.clientHeight),_.copy(b)}function H(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,n)}x.subVectors(w,T).multiplyScalar(s.panSpeed),O(x.x,x.y),T.copy(w)}function V(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);S.set(0,i),M.set(0,Math.pow(S.y/A.y,s.zoomSpeed)),N(M.y),A.copy(S)}function W(e){if(!1!==s.enabled){var t;switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case bc:if(!1===s.enableZoom)return;!function(e){A.set(e.clientX,e.clientY)}(e),f=d.DOLLY;break;case _c:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;B(e),f=d.PAN}else{if(!1===s.enableRotate)return;F(e),f=d.ROTATE}break;case Ec:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;F(e),f=d.ROTATE}else{if(!1===s.enablePan)return;B(e),f=d.PAN}break;default:f=d.NONE}f!==d.NONE&&(document.addEventListener("mousemove",q,!1),document.addEventListener("mouseup",Y,!1),s.dispatchEvent(c))}}function q(e){if(!1!==s.enabled)switch(e.preventDefault(),f){case d.ROTATE:if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var t=s.domElement;R(2*Math.PI*E.x/t.clientHeight),I(2*Math.PI*E.y/t.clientHeight),_.copy(b),s.update()}(e);break;case d.DOLLY:if(!1===s.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),M.subVectors(S,A),M.y>0?N(C()):M.y<0&&k(C()),A.copy(S),s.update()}(e);break;case d.PAN:if(!1===s.enablePan)return;!function(e){w.set(e.clientX,e.clientY),x.subVectors(w,T).multiplyScalar(s.panSpeed),O(x.x,x.y),T.copy(w),s.update()}(e)}}function Y(e){!1!==s.enabled&&(document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",Y,!1),s.dispatchEvent(h),f=d.NONE)}function X(e){!1===s.enabled||!1===s.enableZoom||f!==d.NONE&&f!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(c),function(e){s.currentDistance+=15*Math.sign(e.deltaY),s.currentDistance=Math.clamp(0!=s.currentDistance?s.currentDistance:Math.sign(e.deltaY)+.1,s.minDistance,s.maxDistance),e.deltaY<0?k(C()):e.deltaY>0&&N(C()),s.update()}(e),s.dispatchEvent(h))}function K(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:O(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:O(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:O(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:O(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function Q(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(s.touches.ONE){case Tc:if(!1===s.enableRotate)return;U(e),f=d.TOUCH_ROTATE;break;case wc:if(!1===s.enablePan)return;j(e),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(s.touches.TWO){case xc:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&G(e),s.enablePan&&j(e)}(e),f=d.TOUCH_DOLLY_PAN;break;case Ac:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&G(e),s.enableRotate&&U(e)}(e),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&s.dispatchEvent(c)}}function Z(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),f){case d.TOUCH_ROTATE:if(!1===s.enableRotate)return;z(e),s.update();break;case d.TOUCH_PAN:if(!1===s.enablePan)return;H(e),s.update();break;case d.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&V(e),s.enablePan&&H(e)}(e),s.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&V(e),s.enableRotate&&z(e)}(e),s.update();break;default:f=d.NONE}}function J(e){!1!==s.enabled&&(s.dispatchEvent(h),f=d.NONE)}function $(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",$,!1),s.domElement.addEventListener("mousedown",W,!1),s.domElement.addEventListener("wheel",X,!1),s.domElement.addEventListener("touchstart",Q,!1),s.domElement.addEventListener("touchend",J,!1),s.domElement.addEventListener("touchmove",Z,!1),s.domElement.addEventListener("keydown",K,!1),-1===s.domElement.tabIndex&&(s.domElement.tabIndex=0),this.update()};(Kb.prototype=Object.create(Sc.prototype)).constructor=Kb;var Qb=function(e,t){Kb.call(this,e,t),this.mouseButtons.LEFT=Ec,this.mouseButtons.RIGHT=_c,this.touches.ONE=wc,this.touches.TWO=Ac};(Qb.prototype=Object.create(Sc.prototype)).constructor=Qb;var Zb=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n,i,r,a,o=function(e){t.deviceOrientation=e},s=function(){t.screenOrientation=window.orientation||0},l=(n=new zc(0,0,1),i=new $c,r=new Uc,a=new Uc(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,o,s,l){i.set(o,t,-s,"YXZ"),e.setFromEuler(i),e.multiply(a),e.multiply(r.setFromAxisAngle(n,-l))});this.connect=function(){s(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",o,!1))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",o,!1)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",o,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var n=e.alpha?Ic.degToRad(e.alpha)+t.alphaOffset:0,i=e.beta?Ic.degToRad(e.beta):0,r=e.gamma?Ic.degToRad(e.gamma):0,a=t.screenOrientation?Ic.degToRad(t.screenOrientation):0;l(t.object.quaternion,n,i,r,a)}}},this.dispose=function(){t.disconnect()},this.connect()};var Jb=function(){function e(e){this.object=e.camera,this.domElement=e.canvas,this.orbit=new Kb(this.object,this.domElement),this.speed=.5,this.orbit.target.set(0,1,-1),this.orbit.enableZoom=!0,this.orbit.enablePan=!1,this.orbit.rotateSpeed=-this.speed,e.orientation&&(this.orientation=new Zb(this.object)),e.halfView&&(this.orbit.minAzimuthAngle=-Math.PI/4,this.orbit.maxAzimuthAngle=Math.PI/4)}var t=e.prototype;return t.update=function(){if(this.orientation){this.orientation.update();var e=this.orientation.object.quaternion,t=function(e,t,n,i){var r=e*t+n*i;if(r>.499){var a=2*Math.atan2(e,i);return new zc(Math.PI/2,0,a)}if(r<-.499){var o=-2*Math.atan2(e,i);return new zc(-Math.PI/2,0,o)}var s=e*e,l=t*t,u=n*n,c=Math.atan2(2*t*i-2*e*n,1-2*l-2*u);return new zc(Math.asin(2*r),Math.atan2(2*e*i-2*t*n,1-2*s-2*u),c)}(e.x,e.y,e.z,e.w);void 0===this.lastAngle_&&(this.lastAngle_=t),this.orbit.rotateLeft((this.lastAngle_.z-t.z)*(1+this.speed)),this.orbit.rotateUp((this.lastAngle_.y-t.y)*(1+this.speed)),this.lastAngle_=t}this.orbit.update()},t.dispose=function(){this.orbit.dispose(),this.orientation&&this.orientation.dispose()},t.enable=function(){this.orbit.enabled=!0,this.orientation&&(this.orientation.enabled=!0)},t.disable=function(){this.orbit.enabled=!1,this.orientation&&(this.orientation.enabled=!1)},e}(),$b=function(e){function n(n,i){var r;return(r=e.call(this)||this).player=n,r.canvas=i,r.onMoveEnd=t.a.bind(o(r),r.onMoveEnd),r.onMoveStart=t.a.bind(o(r),r.onMoveStart),r.onMove=t.a.bind(o(r),r.onMove),r.onControlBarMove=t.a.bind(o(r),r.onControlBarMove),r.player.controlBar.on(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],r.onControlBarMove),r.oldReportUserActivity=r.player.reportUserActivity,r.player.reportUserActivity=function(){},r.canvas.addEventListener("mousedown",r.onMoveStart),r.canvas.addEventListener("touchstart",r.onMoveStart),r.canvas.addEventListener("mousemove",r.onMove),r.canvas.addEventListener("touchmove",r.onMove),r.canvas.addEventListener("mouseup",r.onMoveEnd),r.canvas.addEventListener("touchend",r.onMoveEnd),r.shouldTogglePlay=!1,r}a(n,e);var i=n.prototype;return i.togglePlay=function(){this.trigger("vrtoggleplay")},i.onMoveStart=function(e){this.player.controls()&&("mousedown"!==e.type||t.a.dom.isSingleLeftClick(e))?(this.shouldTogglePlay=!0,this.touchMoveCount_=0):this.shouldTogglePlay=!1},i.onMoveEnd=function(e){if("touchend"===e.type&&this.touchMoveCount_<10)return!1===this.player.userActive()?void this.player.userActive(!0):void this.player.userActive(!1);this.shouldTogglePlay&&"mouseup"===e.type&&this.togglePlay()},i.onMove=function(e){this.touchMoveCount_++,this.shouldTogglePlay=!1},i.onControlBarMove=function(e){this.player.userActive(!0)},i.dispose=function(){this.canvas.removeEventListener("mousedown",this.onMoveStart),this.canvas.removeEventListener("touchstart",this.onMoveStart),this.canvas.removeEventListener("mousemove",this.onMove),this.canvas.removeEventListener("touchmove",this.onMove),this.canvas.removeEventListener("mouseup",this.onMoveEnd),this.canvas.removeEventListener("touchend",this.onMoveEnd),this.player.controlBar.off(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.player.reportUserActivity=this.oldReportUserActivity},n}(t.a.EventTarget),eE=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.buildCSSClass=function(){return"vjs-big-vr-play-button "+e.prototype.buildCSSClass.call(this)},t}(t.a.getComponent("BigPlayButton"));t.a.registerComponent("BigVrPlayButton",eE);var tE=function(e){function t(t,n){return e.call(this,t,n)||this}a(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-button-vr "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.active_?(r.a.dispatchEvent(new r.a.Event("vrdisplaydeactivate")),this.active_=!1):(r.a.dispatchEvent(new r.a.Event("vrdisplayactivate")),this.active_=!0)},n.dispose=function(){e.prototype.dispose.call(this)},t}(t.a.getComponent("Button"));t.a.registerComponent("CardboardButton",tE);var nE=t.a.getPlugin("plugin"),iE={},rE=function(e){function n(n,i){var r;return(r=e.call(this,n)||this).options=t.a.mergeOptions(iE,i),r.bigPlayButtonIndex_=n.children().indexOf(n.getChild("BigPlayButton"))||0,navigator.xr||(r.polyfill_=new yc),r.handleVrDisplayActivate_=t.a.bind(o(r),r.handleVrDisplayActivate_),r.handleVrDisplayDeactivate_=t.a.bind(o(r),r.handleVrDisplayDeactivate_),r.handleResize_=t.a.bind(o(r),r.handleResize_),r.animate_=t.a.bind(o(r),r.animate_),r.currentSession=null,r.on(n,"loadedmetadata",r.init),r.player.ready((function(){r.player.addClass("vjs-xr")})),r}a(n,e);var i=n.prototype;return i.handleVrDisplayActivate_=function(){if(this.xrSupported){var e=this;navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor"]}).then((function(t){e.renderer.xr.setSession(t),e.xrActive=!0,e.currentSession=t,t.requestReferenceSpace("local").then((function(t){e.xrReferenceSpace=t})),e.controls3d.disable(),e.trigger("xrSessionActivated")}))}},i.handleVrDisplayDeactivate_=function(){this.xrSupported&&(this.animationFrameId_&&(this.currentSession.cancelAnimationFrame(this.animationFrameId_),this.animationFrameId_=0),this.currentSession.end(),this.currentSession=null,this.xrActive=!1,this.controls3d.enable(),this.trigger("xrSessionDeactivated"))},i.requestAnimationFrame=function(e){return this.xrActive?this.currentSession.requestAnimationFrame(e):this.player.requestAnimationFrame(e)},i.cancelAnimationFrame=function(e){return this.player.cancelAnimationFrame(e)},i.togglePlay_=function(){this.player.paused()?this.player.play():this.player.pause()},i.animate_=function(e,t){this.initialized_&&(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.camera.getWorldDirection(this.cameraVector),this.animationFrameId_=this.requestAnimationFrame(this.animate_),this.xrActive||this.controls3d.update(),this.xrActive&&t&&(this.xrPose=t.getViewerPose(this.xrReferenceSpace),this.trigger("xrCameraUpdate")),this.renderer.render(this.scene,this.camera))},i.handleResize_=function(){var e=this.player.currentWidth(),t=this.player.currentHeight();this.camera.aspect=e/t,this.camera.updateProjectionMatrix()},i.init=function(){this.reset(),this.xrSupported=!1,this.camera=new df(75,this.player.currentWidth()/this.player.currentHeight(),1,1e3),this.cameraVector=new zc,this.camera.layers.enable(1),this.scene=new mh,this.videoTexture=new yg(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=1006,this.videoTexture.magFilter=1006,this.videoTexture.format=1022;var e=0,t=0,n=0;this.scene&&this.scene.remove(this.movieScreen),this.movieGeometry=new _v(256,32,32),this.movieMaterial=new dd({map:this.videoTexture,side:1}),this.movieScreen=new Zd(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(e,t,n),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.scene.add(this.movieScreen),this.player.removeChild("BigPlayButton"),this.player.addChild("BigVrPlayButton",{},this.bigPlayButtonIndex_),this.player.bigPlayButton=this.player.getChild("BigVrPlayButton"),this.camera.position.set(0,0,0),this.renderer=new _m({devicePixelRatio:window.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0}),this.renderer.setSize(this.player.currentWidth(),this.player.currentHeight()),this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");var i=this.getVideoEl_().style;if(this.player.el().insertBefore(this.renderedCanvas,this.player.el().firstChild),i.zIndex="-1",i.opacity="0",this.xrActive=!1,!this.controls3d){var r={camera:this.camera,canvas:this.renderedCanvas,halfView:!1,orientation:!1};this.controls3d=new Jb(r),this.canvasPlayerControls=new $b(this.player,this.renderedCanvas)}if(window.navigator.xr){this.renderer.xr.enabled=!0;var a=this;navigator.xr.isSessionSupported("immersive-vr").then((function(e){e?(a.xrSupported=!0,a.addCardboardButton_(),console.log("webxr session supported")):console.log("web xr device not found, using orbit controls")}))}else console.log("web xr not available");a.completeInitialization(),this.animationFrameId_=this.requestAnimationFrame(this.animate_),this.on(this.player,"fullscreenchange",this.handleResize_),window.addEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.addEventListener("resize",this.handleResize_,!0),window.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0)},i.completeInitialization=function(){this.initialized_=!0,this.trigger("initialized")},i.addCardboardButton_=function(){this.player.controlBar.getChild("CardboardButton")||this.player.controlBar.addChild("CardboardButton",{})},i.getVideoEl_=function(){return this.player.el().getElementsByTagName("video")[0]},i.reset=function(){if(this.initialized_){this.controls3d&&(this.controls3d.dispose(),this.controls3d=null),this.canvasPlayerControls&&(this.canvasPlayerControls.dispose(),this.canvasPlayerControls=null),window.removeEventListener("resize",this.handleResize_,!0),window.removeEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.player.getChild("BigPlayButton")||this.player.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player.getChild("BigVrPlayButton")&&this.player.removeChild("BigVrPlayButton"),this.player.getChild("CardboardButton")&&this.player.controlBar.removeChild("CardboardButton");var e=this.getVideoEl_().style;e.zIndex="",e.opacity="",this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}},i.dispose=function(){this.reset(),e.prototype.dispose.call(this)},i.polyfillVersion=function(){return yc.version},n}(nE);rE.defaultState={},rE.VERSION="0.0.2",t.a.registerPlugin("xr",rE)}).call(this,n(17))},function(e,t,n){var i=n(113),r=n(298);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};i(r,a);e.exports=r.locals||{}},function(e,t,n){(t=n(114)(!1)).push([e.i,'@charset "UTF-8";\n.vjs-modal-dialog .vjs-modal-dialog-content, .video-js .vjs-modal-dialog, .vjs-button > .vjs-icon-placeholder:before, .video-js .vjs-big-play-button .vjs-icon-placeholder:before {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.vjs-button > .vjs-icon-placeholder:before, .video-js .vjs-big-play-button .vjs-icon-placeholder:before {\n  text-align: center;\n}\n\n@font-face {\n  font-family: VideoJS;\n  src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABDkAAsAAAAAG6gAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAPgAAAFZRiV3hY21hcAAAAYQAAADaAAADPv749/pnbHlmAAACYAAAC3AAABHQZg6OcWhlYWQAAA3QAAAAKwAAADYZw251aGhlYQAADfwAAAAdAAAAJA+RCLFobXR4AAAOHAAAABMAAACM744AAGxvY2EAAA4wAAAASAAAAEhF6kqubWF4cAAADngAAAAfAAAAIAE0AIFuYW1lAAAOmAAAASUAAAIK1cf1oHBvc3QAAA/AAAABJAAAAdPExYuNeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS7wTiBgZWBgaWQ5RkDA8MvCM0cwxDOeI6BgYmBlZkBKwhIc01hcPjI+FGJHcRdyA4RZgQRADK3CxEAAHic7dFZbsMgAEXRS0ycyZnnOeG7y+qC8pU1dHusIOXxuoxaOlwZYWQB0Aea4quIEN4E9LzKbKjzDeM6H/mua6Lmc/p8yhg0lvdYx15ZG8uOLQOGjMp3EzqmzJizYMmKNRu27Nhz4MiJMxeu3Ljz4Ekqm7T8P52G8PP3lnTOVk++Z6iN6QZzNN1F7ptuN7eGOjDUoaGODHVsuvU8MdTO9Hd5aqgzQ50b6sJQl4a6MtS1oW4MdWuoO0PdG+rBUI+GejLUs6FeDPVqqDdDvRvqw1CfhpqM9At0iFLaAAB4nJ1YDXBTVRZ+5/22TUlJ8we0pHlJm7RJf5O8F2j6EymlSPkpxaL8U2xpa3DKj0CBhc2IW4eWKSokIoLsuMqssM64f+jA4HSdWXXXscBq67IOs3FXZ1ZYWVyRFdo899yXtIBQZ90k7717zz3v3HPPOfd854YCCj9cL9dL0RQFOqCbGJnrHb5EayiKIWN8iA/hWBblo6hUWm8TtCDwE80WMJus/irwyxOdxeB0MDb14VNJHnXYoLLSl6FfCUYO9nYPTA8Epg9090LprfbBbZ2hY0UlJUXHQp3/vtWkS6EBv8+rPMq5u9692f/dNxJNiqwC1xPE9TCUgCsSdQWgE3XQD25lkG4CN2xmTcOXWBOyser6RN6KnGbKSbmQ3+d0OI1m2W8QzLLkI2sykrWAgJJEtA8vGGW/2Q+CmT3n8zS9wZwu2DCvtuZKZN3xkrLh36yCZuUomQSqGpY8t/25VfHVhw8z4ebGBtfLb0ya9PCaDc+8dGTvk2dsh6z7WzvowlXKUSWo9MJ15a3KrEP2loOr2Ojhw6iW6hf2BDdEccQvZGpaAy7YovSwq8kr7HGllxpd71rkS6G0Sf11sl9OvMK1+jwPPODxjUwkOim9CU3ix1wNjXDfmJSEn618Bs6lpWwUpU+8PCqLMY650zjq8VhCIP17NEKTx3eaLL+s5Pi6yJWaWjTHLR1jYzPSV9VF/6Ojdb/1kO3Mk3uhHC0x6gc1BjlKQ+nQFxTYdaJkZ7ySVxLBbhR1dsboNXp1tCYKW2LRaEzpYcIx2BKNxaL0ZaUnSqfFoiNhHKR/GkX6PWUSAaJelQaqZL1EpoHNsajSEyPSoJ9IjhIxTdjHLmwZvhRDOiFTY/YeQnvrVZmiTQtGncECXtFTBZLOVwwMRgoXHAkXzMzPn1nAJJ8jYSbMDaqN2waGLzNhih/bZynUBMpIWSg7VYi7DRx2m8ALkIdRCJwI6ArJx2EI8kaDWeTQKeAFk9fjl/1AvwktjQ1P7NjyMGQyfd4vjipX6M/i52D7Cq80kqlcxEcGXRr/FEcgs0u5uGgB4VWuMFfpdn2Re6Hi3PqzmxWKsz6+ae2Pn9hXXw/fqM859UiGC0oKYYILJBqJrsn1Z1E5qOs9rQCiUQRREjm8yJcbHF5cUJufX1vAHlefw0XgUoboS3ETfQlTxBC4SOtuE8VPRJTBSCQSjZCpk7Gqzu+masaZ2y7Zjehho4F3g82BNDkAHpORG4+OCS+f6JTPmtRn/PH1kch6d04sp7AQb25aQ/pqUyXeQ8vrebG8OYQdXOQ+585u0sdW9rqalzRURiJ+9F4MweRFrKUjl1GUYhH1A27WOHw5cTFSFPMo9EeUIGnQTZHIaJ7AHLaOKsOODaNF9jkBjYG2QEsQ2xjMUAx2bBEbeTBWMHwskBjngq56S/yfgkBnWBa4K9sqKtq2t1UI8S9He5XuBRbawAdatrQEAi30Aks2+LM8WeCbalVZkWNylvJ+dqJnzVb+OHlSoKW8nPCP7Rd+CcZ2DdWAGqJ2CBFOphgywFFCFBNtfAbGtNPBCwxvygHeYMZMY9ZboBqwq/pVrsbgN5tkv152ODlbMfiqwGMBgxa4Exz3QhovRIUp6acqZmQzRq0ypDXS2TPLT02YIkQETnOE445oOGxOmXAqUJNNG7XgupMjPq2ua9asrj5yY/yuKteO1Kx0YNJTufrirLe1mZnat7OL6rnUdCWenpW6I8mAnbsY8KWs1PuSovCW9A/Z25PQ24a7cNOqgmTkLmBMgh4THgc4b9k2IVv1/g/F5nGljwPLfOgHAzJzh45V/4+WenTzmMtR5Z7us2Tys909UHqrPY7KbckoxRvRHhmVc3cJGE97uml0R1S0jdULVl7EvZtDFVBF35N9cEdjpgmAiOlFZ+Dtoh93+D3zzHr8RRNZQhnCNMNbcegOvpEwZoL+06cJQ07h+th3fZ/7PVbVC6ngTAV/KoLFuO6+2KFcU651gEb5ugPSIb1D+Xp8V4+k3sEIGnw5mYe4If4k1lFYr6SCzmM2EQ8iWtmwjnBI9kTwe1TlfAmXh7H02by9fW2gsjKwtv0aaURKil4OdV7rDL1MXIFNrhdxohcZXYTnq47WisrKitaObbf5+yvkLi5J6lCNZZ+B6GC38VNBZBDidSS/+mSvh6s+srgC8pyKMvDtt+de3c9fU76ZPfuM8ud4Kv0fyP/LqfepMT/3oZxSqpZaTa1DaQYLY8TFsHYbWYsPoRhRWfL5eSSQbhUGgGC3YLbVMk6PitTFNGpAsNrC6D1VNBKgBHMejaiuRWEWGgsSDBTJjqWIl8kJLlsaLJ2tXDr6xGfT85bM2Q06a46x2HTgvdnV8z5YDy/27J4zt6x2VtkzjoYpkq36kaBr4eQSg7tyiVweWubXZugtadl58ydapfbORfKsDTuZ0OBgx4cfdjCf5tbWNITnL120fdOi1RV1C3uKGzNdwYLcMvZ3BxoPyTOCD1XvXTp7U10gWCVmTV9b3r2z0SkGWovb2hp9I89O8a2smlyaO8muMU+dRmtzp60IzAoFpjLr1n388boLyf0dRvxhsHZ0qbWqDkwqvvpkj4l0fY6EIXRi5sQSrAvsVYwXRy4qJ2EVtD1AN7a0HWth9ymvL1xc3WTUKK/TAHA/bXDVtVWfOMfuGxGZv4Ln/jVr9jc3j1yMv0tndmyt9Vq88Y9gH1wtLX3KWjot5++jWHgAoZZkQ14wGQ20Fli71UmKJAy4xKMSTGbVdybW7FDDAut9XpD5AzWrYO7zQ8qffqF8+Ynd/clrHcdyxGy3a/3+mfNnzC/cBsveTjnTvXf1o6vzOlZw7WtqtdmPK/Errz/6NNtD72zmNOZfbmYdTGHfoofqI79Oc+R2n1lrnL6pOm0Up7kwxhTW12Amm7WYkXR2qYrF2AmgmbAsxZjwy1xpg/m1Je2vrp8v/nz2xpmlBg4E9hrMU341wVpTOh/OfmGvAnra8q6uctr60ZQHV3Q+WMQJykMj8ZsWn2QBOmmHMB+m5pDIpTFonYigiaKAhGEiAHF7EliVnQkjoLVIMPtJpBKHYd3A8GYH9jJzrWwmHx5Qjp7vDAX0suGRym1vtm/9W1/HyR8vczfMs6Sk8DSv855/5dlX9oQq52hT8syyp2rx5Id17IAyAM3wIjQPMOHzytEB64q6D5zT91yNbnx3V/nqnd017S9Y0605k3izoXLpsxde2n38yoOV9s1LcjwzNjbdX6asnBVaBj/6/DwKwPkpcqbDG7BnsXoSqWnUAmottYF6jMSdVyYZh3zVXCjwTiwwHH6sGuRiEHQGzuRX6whZkp123oy1BWE2mEfJ/tvIRtM4ZM5bDXiMsPMaAKOTyc5uL57rqyyc5y5JE5pm1i2S2iUX0CcaQ6lC6Zog7JqSqZmYlosl2K6pwNA84zRnQW6SaALYZQGW5lhCtU/W34N6o+bKfZ8cf3/Cl/+iTX3wBzpOY4mRkeNf3rptycGSshQWgGbYt5jFc2e0+DglIrwl6DVWQ7BuwaJ3Xk1J4VL5urnLl/Wf+gHU/hZoZdKNym6lG+I34FaNeZKcSpJIo2IeCVvpdsDGfKvzJnAwmeD37Ow65ZWwSowpgwX5T69s/rB55dP5BcpgDKFV8p7q2sn/1uc93bVzT/w6UrCqDTWvfCq/oCD/qZXNoUj8BL5Kp6GU017frfNXkAtiiyf/SOCEeLqnd8R/Ql9GlCRfctS6k5chvIBuQ1zCCjoCHL2DHNHIXxMJ3kQeO8lbsUXONeSfA5EjcG6/E+KdhN4bP04vBhdi883+BFBzQbxFbvZzQeY9LNBZc0FNfn5NwfDn6rCTnTw6R8o+gfpf5hCom33cRuiTlss3KHmZjD+BPN+5gXuA2ziS/Q73mLxUkpbKN/eqwz5uK0X9F3h2d1V4nGNgZGBgAOJd776+iue3+crAzc4AAje5Bfcg0xz9YHEOBiYQBQA8FQlFAHicY2BkYGBnAAGOPgaG//85+hkYGVCBMgBGGwNYAAAAeJxjYGBgYB8EmKOPgQEAQ04BfgAAAAAAAA4AaAB+AMwA4AECAUIBbAGYAcICGAJYArQC4AMwA7AD3gQwBJYE3AUkBWYFigYgBmYGtAbqB1gIEghYCG4IhAi2COh4nGNgZGBgUGYoZWBnAAEmIOYCQgaG/2A+AwAYCQG2AHicXZBNaoNAGIZfE5PQCKFQ2lUps2oXBfOzzAESyDKBQJdGR2NQR3QSSE/QE/QEPUUPUHqsvsrXjTMw83zPvPMNCuAWP3DQDAejdm1GjzwS7pMmwi75XngAD4/CQ/oX4TFe4Qt7uMMbOzjuDc0EmXCP/C7cJ38Iu+RP4QEe8CU8pP8WHmOPX2EPz87TPo202ey2OjlnQSXV/6arOjWFmvszMWtd6CqwOlKHq6ovycLaWMWVydXKFFZnmVFlZU46tP7R2nI5ncbi/dDkfDtFBA2DDXbYkhKc+V0Bqs5Zt9JM1HQGBRTm/EezTmZNKtpcAMs9Yu6AK9caF76zoLWIWcfMGOSkVduvSWechqZsz040Ib2PY3urxBJTzriT95lipz+TN1fmAAAAeJxtkMl2wjAMRfOAhABlKm2h80C3+ajgCKKDY6cegP59TYBzukAL+z1Zsq8ctaJTTKPrsUQLbXQQI0EXKXroY4AbDDHCGBNMcYsZ7nCPB8yxwCOe8IwXvOIN7/jAJ76wxHfUqWX+OzgumWAjJMV17i0Ndlr6irLKO+qftdT7i6y4uFSUvCknay+lFYZIZaQcmfH/xIFdYn98bqhra1aKTM/6lWMnyaYirx1rFUQZFBkb2zJUtoXeJCeg0WnLtHeSFc3OtrnozNwqi0TkSpBMDB1nSde5oJXW23hTS2/T0LilglXX7dmFVxLnq5U0vYATHFk3zX3BOisoQHNDFDeZnqKDy9hRNawN7Vh727hFzcJ5c8TILrKZfH7tIPxAFP0BpLeJPA==) format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-play, .video-js .vjs-play-control .vjs-icon-placeholder, .video-js .vjs-big-play-button .vjs-icon-placeholder:before {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-play:before, .video-js .vjs-play-control .vjs-icon-placeholder:before, .video-js .vjs-big-play-button .vjs-icon-placeholder:before {\n  content: "\\f101";\n}\n\n.vjs-icon-play-circle {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-play-circle:before {\n  content: "\\f102";\n}\n\n.vjs-icon-pause, .video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-pause:before, .video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder:before {\n  content: "\\f103";\n}\n\n.vjs-icon-volume-mute, .video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-volume-mute:before, .video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder:before {\n  content: "\\f104";\n}\n\n.vjs-icon-volume-low, .video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-volume-low:before, .video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder:before {\n  content: "\\f105";\n}\n\n.vjs-icon-volume-mid, .video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-volume-mid:before, .video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder:before {\n  content: "\\f106";\n}\n\n.vjs-icon-volume-high, .video-js .vjs-mute-control .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-volume-high:before, .video-js .vjs-mute-control .vjs-icon-placeholder:before {\n  content: "\\f107";\n}\n\n.vjs-icon-fullscreen-enter, .video-js .vjs-fullscreen-control .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-fullscreen-enter:before, .video-js .vjs-fullscreen-control .vjs-icon-placeholder:before {\n  content: "\\f108";\n}\n\n.vjs-icon-fullscreen-exit, .video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-fullscreen-exit:before, .video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder:before {\n  content: "\\f109";\n}\n\n.vjs-icon-square {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-square:before {\n  content: "\\f10a";\n}\n\n.vjs-icon-spinner {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-spinner:before {\n  content: "\\f10b";\n}\n\n.vjs-icon-subtitles, .video-js .vjs-subs-caps-button .vjs-icon-placeholder,\n.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder,\n.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder,\n.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder,\n.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder, .video-js .vjs-subtitles-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-subtitles:before, .video-js .vjs-subs-caps-button .vjs-icon-placeholder:before,\n.video-js.video-js:lang(en-GB) .vjs-subs-caps-button .vjs-icon-placeholder:before,\n.video-js.video-js:lang(en-IE) .vjs-subs-caps-button .vjs-icon-placeholder:before,\n.video-js.video-js:lang(en-AU) .vjs-subs-caps-button .vjs-icon-placeholder:before,\n.video-js.video-js:lang(en-NZ) .vjs-subs-caps-button .vjs-icon-placeholder:before, .video-js .vjs-subtitles-button .vjs-icon-placeholder:before {\n  content: "\\f10c";\n}\n\n.vjs-icon-captions, .video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder,\n.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder, .video-js .vjs-captions-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-captions:before, .video-js:lang(en) .vjs-subs-caps-button .vjs-icon-placeholder:before,\n.video-js:lang(fr-CA) .vjs-subs-caps-button .vjs-icon-placeholder:before, .video-js .vjs-captions-button .vjs-icon-placeholder:before {\n  content: "\\f10d";\n}\n\n.vjs-icon-chapters, .video-js .vjs-chapters-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-chapters:before, .video-js .vjs-chapters-button .vjs-icon-placeholder:before {\n  content: "\\f10e";\n}\n\n.vjs-icon-share {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-share:before {\n  content: "\\f10f";\n}\n\n.vjs-icon-cog {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-cog:before {\n  content: "\\f110";\n}\n\n.vjs-icon-circle, .vjs-seek-to-live-control .vjs-icon-placeholder, .video-js .vjs-volume-level, .video-js .vjs-play-progress {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-circle:before, .vjs-seek-to-live-control .vjs-icon-placeholder:before, .video-js .vjs-volume-level:before, .video-js .vjs-play-progress:before {\n  content: "\\f111";\n}\n\n.vjs-icon-circle-outline {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-circle-outline:before {\n  content: "\\f112";\n}\n\n.vjs-icon-circle-inner-circle {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-circle-inner-circle:before {\n  content: "\\f113";\n}\n\n.vjs-icon-hd {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-hd:before {\n  content: "\\f114";\n}\n\n.vjs-icon-cancel, .video-js .vjs-control.vjs-close-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-cancel:before, .video-js .vjs-control.vjs-close-button .vjs-icon-placeholder:before {\n  content: "\\f115";\n}\n\n.vjs-icon-replay, .video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-replay:before, .video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder:before {\n  content: "\\f116";\n}\n\n.vjs-icon-facebook {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-facebook:before {\n  content: "\\f117";\n}\n\n.vjs-icon-gplus {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-gplus:before {\n  content: "\\f118";\n}\n\n.vjs-icon-linkedin {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-linkedin:before {\n  content: "\\f119";\n}\n\n.vjs-icon-twitter {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-twitter:before {\n  content: "\\f11a";\n}\n\n.vjs-icon-tumblr {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-tumblr:before {\n  content: "\\f11b";\n}\n\n.vjs-icon-pinterest {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-pinterest:before {\n  content: "\\f11c";\n}\n\n.vjs-icon-audio-description, .video-js .vjs-descriptions-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-audio-description:before, .video-js .vjs-descriptions-button .vjs-icon-placeholder:before {\n  content: "\\f11d";\n}\n\n.vjs-icon-audio, .video-js .vjs-audio-button .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-audio:before, .video-js .vjs-audio-button .vjs-icon-placeholder:before {\n  content: "\\f11e";\n}\n\n.vjs-icon-next-item {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-next-item:before {\n  content: "\\f11f";\n}\n\n.vjs-icon-previous-item {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-previous-item:before {\n  content: "\\f120";\n}\n\n.vjs-icon-picture-in-picture-enter, .video-js .vjs-picture-in-picture-control .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-picture-in-picture-enter:before, .video-js .vjs-picture-in-picture-control .vjs-icon-placeholder:before {\n  content: "\\f121";\n}\n\n.vjs-icon-picture-in-picture-exit, .video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder {\n  font-family: VideoJS;\n  font-weight: normal;\n  font-style: normal;\n}\n.vjs-icon-picture-in-picture-exit:before, .video-js.vjs-picture-in-picture .vjs-picture-in-picture-control .vjs-icon-placeholder:before {\n  content: "\\f122";\n}\n\n.video-js {\n  display: block;\n  vertical-align: top;\n  box-sizing: border-box;\n  color: #fff;\n  background-color: #000;\n  position: relative;\n  padding: 0;\n  font-size: 10px;\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  font-family: Arial, Helvetica, sans-serif;\n  word-break: initial;\n}\n.video-js:-moz-full-screen {\n  position: absolute;\n}\n.video-js:-webkit-full-screen {\n  width: 100% !important;\n  height: 100% !important;\n}\n\n.video-js[tabindex="-1"] {\n  outline: none;\n}\n\n.video-js *,\n.video-js *:before,\n.video-js *:after {\n  box-sizing: inherit;\n}\n\n.video-js ul {\n  font-family: inherit;\n  font-size: inherit;\n  line-height: inherit;\n  list-style-position: outside;\n  margin-left: 0;\n  margin-right: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.video-js.vjs-fluid,\n.video-js.vjs-16-9,\n.video-js.vjs-4-3 {\n  width: 100%;\n  max-width: 100%;\n  height: 0;\n}\n\n.video-js.vjs-16-9 {\n  padding-top: 56.25%;\n}\n\n.video-js.vjs-4-3 {\n  padding-top: 75%;\n}\n\n.video-js.vjs-fill {\n  width: 100%;\n  height: 100%;\n}\n\n.video-js .vjs-tech {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\nbody.vjs-full-window {\n  padding: 0;\n  margin: 0;\n  height: 100%;\n}\n\n.vjs-full-window .video-js.vjs-fullscreen {\n  position: fixed;\n  overflow: hidden;\n  z-index: 1000;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n}\n\n.video-js.vjs-fullscreen {\n  width: 100% !important;\n  height: 100% !important;\n  padding-top: 0 !important;\n}\n\n.video-js.vjs-fullscreen.vjs-user-inactive {\n  cursor: none;\n}\n\n.vjs-hidden {\n  display: none !important;\n}\n\n.vjs-disabled {\n  opacity: 0.5;\n  cursor: default;\n}\n\n.video-js .vjs-offscreen {\n  height: 1px;\n  left: -9999px;\n  position: absolute;\n  top: 0;\n  width: 1px;\n}\n\n.vjs-lock-showing {\n  display: block !important;\n  opacity: 1;\n  visibility: visible;\n}\n\n.vjs-no-js {\n  padding: 20px;\n  color: #fff;\n  background-color: #000;\n  font-size: 18px;\n  font-family: Arial, Helvetica, sans-serif;\n  text-align: center;\n  width: 300px;\n  height: 150px;\n  margin: 0px auto;\n}\n\n.vjs-no-js a,\n.vjs-no-js a:visited {\n  color: #66A8CC;\n}\n\n.video-js .vjs-big-play-button {\n  font-size: 3em;\n  line-height: 1.5em;\n  height: 1.63332em;\n  width: 3em;\n  display: block;\n  position: absolute;\n  top: 10px;\n  left: 10px;\n  padding: 0;\n  cursor: pointer;\n  opacity: 1;\n  border: 0.06666em solid #fff;\n  background-color: #2B333F;\n  background-color: rgba(43, 51, 63, 0.7);\n  border-radius: 0.3em;\n  transition: all 0.4s;\n}\n.vjs-big-play-centered .vjs-big-play-button {\n  top: 50%;\n  left: 50%;\n  margin-top: -0.81666em;\n  margin-left: -1.5em;\n}\n\n.video-js:hover .vjs-big-play-button,\n.video-js .vjs-big-play-button:focus {\n  border-color: #fff;\n  background-color: #73859f;\n  background-color: rgba(115, 133, 159, 0.5);\n  transition: all 0s;\n}\n\n.vjs-controls-disabled .vjs-big-play-button,\n.vjs-has-started .vjs-big-play-button,\n.vjs-using-native-controls .vjs-big-play-button,\n.vjs-error .vjs-big-play-button {\n  display: none;\n}\n\n.vjs-has-started.vjs-paused.vjs-show-big-play-button-on-pause .vjs-big-play-button {\n  display: block;\n}\n\n.video-js button {\n  background: none;\n  border: none;\n  color: inherit;\n  display: inline-block;\n  font-size: inherit;\n  line-height: inherit;\n  text-transform: none;\n  text-decoration: none;\n  transition: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n}\n\n.vjs-control .vjs-button {\n  width: 100%;\n  height: 100%;\n}\n\n.video-js .vjs-control.vjs-close-button {\n  cursor: pointer;\n  height: 3em;\n  position: absolute;\n  right: 0;\n  top: 0.5em;\n  z-index: 2;\n}\n.video-js .vjs-modal-dialog {\n  background: rgba(0, 0, 0, 0.8);\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(255, 255, 255, 0));\n  overflow: auto;\n}\n\n.video-js .vjs-modal-dialog > * {\n  box-sizing: border-box;\n}\n\n.vjs-modal-dialog .vjs-modal-dialog-content {\n  font-size: 1.2em;\n  line-height: 1.5;\n  padding: 20px 24px;\n  z-index: 1;\n}\n\n.vjs-menu-button {\n  cursor: pointer;\n}\n\n.vjs-menu-button.vjs-disabled {\n  cursor: default;\n}\n\n.vjs-workinghover .vjs-menu-button.vjs-disabled:hover .vjs-menu {\n  display: none;\n}\n\n.vjs-menu .vjs-menu-content {\n  display: block;\n  padding: 0;\n  margin: 0;\n  font-family: Arial, Helvetica, sans-serif;\n  overflow: auto;\n}\n\n.vjs-menu .vjs-menu-content > * {\n  box-sizing: border-box;\n}\n\n.vjs-scrubbing .vjs-control.vjs-menu-button:hover .vjs-menu {\n  display: none;\n}\n\n.vjs-menu li {\n  list-style: none;\n  margin: 0;\n  padding: 0.2em 0;\n  line-height: 1.4em;\n  font-size: 1.2em;\n  text-align: center;\n  text-transform: lowercase;\n}\n\n.vjs-menu li.vjs-menu-item:focus,\n.vjs-menu li.vjs-menu-item:hover,\n.js-focus-visible .vjs-menu li.vjs-menu-item:hover {\n  background-color: #73859f;\n  background-color: rgba(115, 133, 159, 0.5);\n}\n\n.vjs-menu li.vjs-selected,\n.vjs-menu li.vjs-selected:focus,\n.vjs-menu li.vjs-selected:hover,\n.js-focus-visible .vjs-menu li.vjs-selected:hover {\n  background-color: #fff;\n  color: #2B333F;\n}\n\n.vjs-menu li.vjs-menu-title {\n  text-align: center;\n  text-transform: uppercase;\n  font-size: 1em;\n  line-height: 2em;\n  padding: 0;\n  margin: 0 0 0.3em 0;\n  font-weight: bold;\n  cursor: default;\n}\n\n.vjs-menu-button-popup .vjs-menu {\n  display: none;\n  position: absolute;\n  bottom: 0;\n  width: 10em;\n  left: -3em;\n  height: 0em;\n  margin-bottom: 1.5em;\n  border-top-color: rgba(43, 51, 63, 0.7);\n}\n\n.vjs-menu-button-popup .vjs-menu .vjs-menu-content {\n  background-color: #2B333F;\n  background-color: rgba(43, 51, 63, 0.7);\n  position: absolute;\n  width: 100%;\n  bottom: 1.5em;\n  max-height: 15em;\n}\n\n.vjs-layout-tiny .vjs-menu-button-popup .vjs-menu .vjs-menu-content,\n.vjs-layout-x-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content {\n  max-height: 5em;\n}\n\n.vjs-layout-small .vjs-menu-button-popup .vjs-menu .vjs-menu-content {\n  max-height: 10em;\n}\n\n.vjs-layout-medium .vjs-menu-button-popup .vjs-menu .vjs-menu-content {\n  max-height: 14em;\n}\n\n.vjs-layout-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,\n.vjs-layout-x-large .vjs-menu-button-popup .vjs-menu .vjs-menu-content,\n.vjs-layout-huge .vjs-menu-button-popup .vjs-menu .vjs-menu-content {\n  max-height: 25em;\n}\n\n.vjs-workinghover .vjs-menu-button-popup:hover .vjs-menu,\n.vjs-menu-button-popup .vjs-menu.vjs-lock-showing {\n  display: block;\n}\n\n.video-js .vjs-menu-button-inline {\n  transition: all 0.4s;\n  overflow: hidden;\n}\n\n.video-js .vjs-menu-button-inline:before {\n  width: 2.222222222em;\n}\n\n.video-js .vjs-menu-button-inline:hover,\n.video-js .vjs-menu-button-inline:focus,\n.video-js .vjs-menu-button-inline.vjs-slider-active,\n.video-js.vjs-no-flex .vjs-menu-button-inline {\n  width: 12em;\n}\n\n.vjs-menu-button-inline .vjs-menu {\n  opacity: 0;\n  height: 100%;\n  width: auto;\n  position: absolute;\n  left: 4em;\n  top: 0;\n  padding: 0;\n  margin: 0;\n  transition: all 0.4s;\n}\n\n.vjs-menu-button-inline:hover .vjs-menu,\n.vjs-menu-button-inline:focus .vjs-menu,\n.vjs-menu-button-inline.vjs-slider-active .vjs-menu {\n  display: block;\n  opacity: 1;\n}\n\n.vjs-no-flex .vjs-menu-button-inline .vjs-menu {\n  display: block;\n  opacity: 1;\n  position: relative;\n  width: auto;\n}\n\n.vjs-no-flex .vjs-menu-button-inline:hover .vjs-menu,\n.vjs-no-flex .vjs-menu-button-inline:focus .vjs-menu,\n.vjs-no-flex .vjs-menu-button-inline.vjs-slider-active .vjs-menu {\n  width: auto;\n}\n\n.vjs-menu-button-inline .vjs-menu-content {\n  width: auto;\n  height: 100%;\n  margin: 0;\n  overflow: hidden;\n}\n\n.video-js .vjs-control-bar {\n  display: none;\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 3em;\n  background-color: #2B333F;\n  background-color: rgba(43, 51, 63, 0.7);\n}\n\n.vjs-has-started .vjs-control-bar {\n  display: flex;\n  visibility: visible;\n  opacity: 1;\n  transition: visibility 0.1s, opacity 0.1s;\n}\n\n.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar {\n  visibility: visible;\n  opacity: 0;\n  transition: visibility 1s, opacity 1s;\n}\n\n.vjs-controls-disabled .vjs-control-bar,\n.vjs-using-native-controls .vjs-control-bar,\n.vjs-error .vjs-control-bar {\n  display: none !important;\n}\n\n.vjs-audio.vjs-has-started.vjs-user-inactive.vjs-playing .vjs-control-bar {\n  opacity: 1;\n  visibility: visible;\n}\n\n.vjs-has-started.vjs-no-flex .vjs-control-bar {\n  display: table;\n}\n\n.video-js .vjs-control {\n  position: relative;\n  text-align: center;\n  margin: 0;\n  padding: 0;\n  height: 100%;\n  width: 4em;\n  flex: none;\n}\n\n.vjs-button > .vjs-icon-placeholder:before {\n  font-size: 1.8em;\n  line-height: 1.67;\n}\n\n.video-js .vjs-control:focus:before,\n.video-js .vjs-control:hover:before,\n.video-js .vjs-control:focus {\n  text-shadow: 0em 0em 1em white;\n}\n\n.video-js .vjs-control-text {\n  border: 0;\n  clip: rect(0 0 0 0);\n  height: 1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.vjs-no-flex .vjs-control {\n  display: table-cell;\n  vertical-align: middle;\n}\n\n.video-js .vjs-custom-control-spacer {\n  display: none;\n}\n\n.video-js .vjs-progress-control {\n  cursor: pointer;\n  flex: auto;\n  display: flex;\n  align-items: center;\n  min-width: 4em;\n  touch-action: none;\n}\n\n.video-js .vjs-progress-control.disabled {\n  cursor: default;\n}\n\n.vjs-live .vjs-progress-control {\n  display: none;\n}\n\n.vjs-liveui .vjs-progress-control {\n  display: flex;\n  align-items: center;\n}\n\n.vjs-no-flex .vjs-progress-control {\n  width: auto;\n}\n\n.video-js .vjs-progress-holder {\n  flex: auto;\n  transition: all 0.2s;\n  height: 0.3em;\n}\n\n.video-js .vjs-progress-control .vjs-progress-holder {\n  margin: 0 10px;\n}\n\n.video-js .vjs-progress-control:hover .vjs-progress-holder {\n  font-size: 1.6666666667em;\n}\n\n.video-js .vjs-progress-control:hover .vjs-progress-holder.disabled {\n  font-size: 1em;\n}\n\n.video-js .vjs-progress-holder .vjs-play-progress,\n.video-js .vjs-progress-holder .vjs-load-progress,\n.video-js .vjs-progress-holder .vjs-load-progress div {\n  position: absolute;\n  display: block;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  width: 0;\n}\n\n.video-js .vjs-play-progress {\n  background-color: #fff;\n}\n.video-js .vjs-play-progress:before {\n  font-size: 0.9em;\n  position: absolute;\n  right: -0.5em;\n  top: -0.3333333333em;\n  z-index: 1;\n}\n\n.video-js .vjs-load-progress {\n  background: rgba(115, 133, 159, 0.5);\n}\n\n.video-js .vjs-load-progress div {\n  background: rgba(115, 133, 159, 0.75);\n}\n\n.video-js .vjs-time-tooltip {\n  background-color: #fff;\n  background-color: rgba(255, 255, 255, 0.8);\n  border-radius: 0.3em;\n  color: #000;\n  float: right;\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 1em;\n  padding: 6px 8px 8px 8px;\n  pointer-events: none;\n  position: absolute;\n  top: -3.4em;\n  visibility: hidden;\n  z-index: 1;\n}\n\n.video-js .vjs-progress-holder:focus .vjs-time-tooltip {\n  display: none;\n}\n\n.video-js .vjs-progress-control:hover .vjs-time-tooltip,\n.video-js .vjs-progress-control:hover .vjs-progress-holder:focus .vjs-time-tooltip {\n  display: block;\n  font-size: 0.6em;\n  visibility: visible;\n}\n\n.video-js .vjs-progress-control.disabled:hover .vjs-time-tooltip {\n  font-size: 1em;\n}\n\n.video-js .vjs-progress-control .vjs-mouse-display {\n  display: none;\n  position: absolute;\n  width: 1px;\n  height: 100%;\n  background-color: #000;\n  z-index: 1;\n}\n\n.vjs-no-flex .vjs-progress-control .vjs-mouse-display {\n  z-index: 0;\n}\n\n.video-js .vjs-progress-control:hover .vjs-mouse-display {\n  display: block;\n}\n\n.video-js.vjs-user-inactive .vjs-progress-control .vjs-mouse-display {\n  visibility: hidden;\n  opacity: 0;\n  transition: visibility 1s, opacity 1s;\n}\n\n.video-js.vjs-user-inactive.vjs-no-flex .vjs-progress-control .vjs-mouse-display {\n  display: none;\n}\n\n.vjs-mouse-display .vjs-time-tooltip {\n  color: #fff;\n  background-color: #000;\n  background-color: rgba(0, 0, 0, 0.8);\n}\n\n.video-js .vjs-slider {\n  position: relative;\n  cursor: pointer;\n  padding: 0;\n  margin: 0 0.45em 0 0.45em;\n  /* iOS Safari */\n  -webkit-touch-callout: none;\n  /* Safari */\n  -webkit-user-select: none;\n  /* Konqueror HTML */\n  /* Firefox */\n  -moz-user-select: none;\n  /* Internet Explorer/Edge */\n  -ms-user-select: none;\n  /* Non-prefixed version, currently supported by Chrome and Opera */\n  user-select: none;\n  background-color: #73859f;\n  background-color: rgba(115, 133, 159, 0.5);\n}\n\n.video-js .vjs-slider.disabled {\n  cursor: default;\n}\n\n.video-js .vjs-slider:focus {\n  text-shadow: 0em 0em 1em white;\n  box-shadow: 0 0 1em #fff;\n}\n\n.video-js .vjs-mute-control {\n  cursor: pointer;\n  flex: none;\n}\n.video-js .vjs-volume-control {\n  cursor: pointer;\n  margin-right: 1em;\n  display: flex;\n}\n\n.video-js .vjs-volume-control.vjs-volume-horizontal {\n  width: 5em;\n}\n\n.video-js .vjs-volume-panel .vjs-volume-control {\n  visibility: visible;\n  opacity: 0;\n  width: 1px;\n  height: 1px;\n  margin-left: -1px;\n}\n\n.video-js .vjs-volume-panel {\n  transition: width 1s;\n}\n.video-js .vjs-volume-panel:hover .vjs-volume-control, .video-js .vjs-volume-panel:active .vjs-volume-control, .video-js .vjs-volume-panel:focus .vjs-volume-control, .video-js .vjs-volume-panel .vjs-volume-control:hover, .video-js .vjs-volume-panel .vjs-volume-control:active, .video-js .vjs-volume-panel .vjs-mute-control:hover ~ .vjs-volume-control, .video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active {\n  visibility: visible;\n  opacity: 1;\n  position: relative;\n  transition: visibility 0.1s, opacity 0.1s, height 0.1s, width 0.1s, left 0s, top 0s;\n}\n.video-js .vjs-volume-panel:hover .vjs-volume-control.vjs-volume-horizontal, .video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-horizontal, .video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-horizontal, .video-js .vjs-volume-panel .vjs-volume-control:hover.vjs-volume-horizontal, .video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-horizontal, .video-js .vjs-volume-panel .vjs-mute-control:hover ~ .vjs-volume-control.vjs-volume-horizontal, .video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-horizontal {\n  width: 5em;\n  height: 3em;\n}\n.video-js .vjs-volume-panel:hover .vjs-volume-control.vjs-volume-vertical, .video-js .vjs-volume-panel:active .vjs-volume-control.vjs-volume-vertical, .video-js .vjs-volume-panel:focus .vjs-volume-control.vjs-volume-vertical, .video-js .vjs-volume-panel .vjs-volume-control:hover.vjs-volume-vertical, .video-js .vjs-volume-panel .vjs-volume-control:active.vjs-volume-vertical, .video-js .vjs-volume-panel .vjs-mute-control:hover ~ .vjs-volume-control.vjs-volume-vertical, .video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active.vjs-volume-vertical {\n  left: -3.5em;\n}\n.video-js .vjs-volume-panel.vjs-volume-panel-horizontal:hover, .video-js .vjs-volume-panel.vjs-volume-panel-horizontal:active, .video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active {\n  width: 9em;\n  transition: width 0.1s;\n}\n.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-mute-toggle-only {\n  width: 4em;\n}\n\n.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical {\n  height: 8em;\n  width: 3em;\n  left: -3000em;\n  transition: visibility 1s, opacity 1s, height 1s 1s, width 1s 1s, left 1s 1s, top 1s 1s;\n}\n\n.video-js .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal {\n  transition: visibility 1s, opacity 1s, height 1s 1s, width 1s, left 1s 1s, top 1s 1s;\n}\n\n.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-horizontal {\n  width: 5em;\n  height: 3em;\n  visibility: visible;\n  opacity: 1;\n  position: relative;\n  transition: none;\n}\n\n.video-js.vjs-no-flex .vjs-volume-control.vjs-volume-vertical,\n.video-js.vjs-no-flex .vjs-volume-panel .vjs-volume-control.vjs-volume-vertical {\n  position: absolute;\n  bottom: 3em;\n  left: 0.5em;\n}\n\n.video-js .vjs-volume-panel {\n  display: flex;\n}\n\n.video-js .vjs-volume-bar {\n  margin: 1.35em 0.45em;\n}\n\n.vjs-volume-bar.vjs-slider-horizontal {\n  width: 5em;\n  height: 0.3em;\n}\n\n.vjs-volume-bar.vjs-slider-vertical {\n  width: 0.3em;\n  height: 5em;\n  margin: 1.35em auto;\n}\n\n.video-js .vjs-volume-level {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background-color: #fff;\n}\n.video-js .vjs-volume-level:before {\n  position: absolute;\n  font-size: 0.9em;\n}\n\n.vjs-slider-vertical .vjs-volume-level {\n  width: 0.3em;\n}\n.vjs-slider-vertical .vjs-volume-level:before {\n  top: -0.5em;\n  left: -0.3em;\n}\n\n.vjs-slider-horizontal .vjs-volume-level {\n  height: 0.3em;\n}\n.vjs-slider-horizontal .vjs-volume-level:before {\n  top: -0.3em;\n  right: -0.5em;\n}\n\n.video-js .vjs-volume-panel.vjs-volume-panel-vertical {\n  width: 4em;\n}\n\n.vjs-volume-bar.vjs-slider-vertical .vjs-volume-level {\n  height: 100%;\n}\n\n.vjs-volume-bar.vjs-slider-horizontal .vjs-volume-level {\n  width: 100%;\n}\n\n.video-js .vjs-volume-vertical {\n  width: 3em;\n  height: 8em;\n  bottom: 8em;\n  background-color: #2B333F;\n  background-color: rgba(43, 51, 63, 0.7);\n}\n\n.video-js .vjs-volume-horizontal .vjs-menu {\n  left: -2em;\n}\n\n.vjs-poster {\n  display: inline-block;\n  vertical-align: middle;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n  background-size: contain;\n  background-color: #000000;\n  cursor: pointer;\n  margin: 0;\n  padding: 0;\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  height: 100%;\n}\n\n.vjs-has-started .vjs-poster {\n  display: none;\n}\n\n.vjs-audio.vjs-has-started .vjs-poster {\n  display: block;\n}\n\n.vjs-using-native-controls .vjs-poster {\n  display: none;\n}\n\n.video-js .vjs-live-control {\n  display: flex;\n  align-items: flex-start;\n  flex: auto;\n  font-size: 1em;\n  line-height: 3em;\n}\n\n.vjs-no-flex .vjs-live-control {\n  display: table-cell;\n  width: auto;\n  text-align: left;\n}\n\n.video-js:not(.vjs-live) .vjs-live-control,\n.video-js.vjs-liveui .vjs-live-control {\n  display: none;\n}\n\n.video-js .vjs-seek-to-live-control {\n  cursor: pointer;\n  flex: none;\n  display: inline-flex;\n  height: 100%;\n  padding-left: 0.5em;\n  padding-right: 0.5em;\n  font-size: 1em;\n  line-height: 3em;\n  width: auto;\n  min-width: 4em;\n}\n\n.vjs-no-flex .vjs-seek-to-live-control {\n  display: table-cell;\n  width: auto;\n  text-align: left;\n}\n\n.video-js.vjs-live:not(.vjs-liveui) .vjs-seek-to-live-control,\n.video-js:not(.vjs-live) .vjs-seek-to-live-control {\n  display: none;\n}\n\n.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge {\n  cursor: auto;\n}\n\n.vjs-seek-to-live-control .vjs-icon-placeholder {\n  margin-right: 0.5em;\n  color: #888;\n}\n\n.vjs-seek-to-live-control.vjs-control.vjs-at-live-edge .vjs-icon-placeholder {\n  color: red;\n}\n\n.video-js .vjs-time-control {\n  flex: none;\n  font-size: 1em;\n  line-height: 3em;\n  min-width: 2em;\n  width: auto;\n  padding-left: 1em;\n  padding-right: 1em;\n}\n\n.vjs-live .vjs-time-control {\n  display: none;\n}\n\n.video-js .vjs-current-time,\n.vjs-no-flex .vjs-current-time {\n  display: none;\n}\n\n.video-js .vjs-duration,\n.vjs-no-flex .vjs-duration {\n  display: none;\n}\n\n.vjs-time-divider {\n  display: none;\n  line-height: 3em;\n}\n\n.vjs-live .vjs-time-divider {\n  display: none;\n}\n\n.video-js .vjs-play-control {\n  cursor: pointer;\n}\n\n.video-js .vjs-play-control .vjs-icon-placeholder {\n  flex: none;\n}\n\n.vjs-text-track-display {\n  position: absolute;\n  bottom: 3em;\n  left: 0;\n  right: 0;\n  top: 0;\n  pointer-events: none;\n}\n\n.video-js.vjs-user-inactive.vjs-playing .vjs-text-track-display {\n  bottom: 1em;\n}\n\n.video-js .vjs-text-track {\n  font-size: 1.4em;\n  text-align: center;\n  margin-bottom: 0.1em;\n}\n\n.vjs-subtitles {\n  color: #fff;\n}\n\n.vjs-captions {\n  color: #fc6;\n}\n\n.vjs-tt-cue {\n  display: block;\n}\n\nvideo::-webkit-media-text-track-display {\n  transform: translateY(-3em);\n}\n\n.video-js.vjs-user-inactive.vjs-playing video::-webkit-media-text-track-display {\n  transform: translateY(-1.5em);\n}\n\n.video-js .vjs-picture-in-picture-control {\n  cursor: pointer;\n  flex: none;\n}\n.video-js .vjs-fullscreen-control {\n  cursor: pointer;\n  flex: none;\n}\n.vjs-playback-rate > .vjs-menu-button,\n.vjs-playback-rate .vjs-playback-rate-value {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.vjs-playback-rate .vjs-playback-rate-value {\n  pointer-events: none;\n  font-size: 1.5em;\n  line-height: 2;\n  text-align: center;\n}\n\n.vjs-playback-rate .vjs-menu {\n  width: 4em;\n  left: 0em;\n}\n\n.vjs-error .vjs-error-display .vjs-modal-dialog-content {\n  font-size: 1.4em;\n  text-align: center;\n}\n\n.vjs-error .vjs-error-display:before {\n  color: #fff;\n  content: "X";\n  font-family: Arial, Helvetica, sans-serif;\n  font-size: 4em;\n  left: 0;\n  line-height: 1;\n  margin-top: -0.5em;\n  position: absolute;\n  text-shadow: 0.05em 0.05em 0.1em #000;\n  text-align: center;\n  top: 50%;\n  vertical-align: middle;\n  width: 100%;\n}\n\n.vjs-loading-spinner {\n  display: none;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n  opacity: 0.85;\n  text-align: left;\n  border: 6px solid rgba(43, 51, 63, 0.7);\n  box-sizing: border-box;\n  background-clip: padding-box;\n  width: 50px;\n  height: 50px;\n  border-radius: 25px;\n  visibility: hidden;\n}\n\n.vjs-seeking .vjs-loading-spinner,\n.vjs-waiting .vjs-loading-spinner {\n  display: block;\n  -webkit-animation: vjs-spinner-show 0s linear 0.3s forwards;\n          animation: vjs-spinner-show 0s linear 0.3s forwards;\n}\n\n.vjs-loading-spinner:before,\n.vjs-loading-spinner:after {\n  content: "";\n  position: absolute;\n  margin: -6px;\n  box-sizing: inherit;\n  width: inherit;\n  height: inherit;\n  border-radius: inherit;\n  opacity: 1;\n  border: inherit;\n  border-color: transparent;\n  border-top-color: white;\n}\n\n.vjs-seeking .vjs-loading-spinner:before,\n.vjs-seeking .vjs-loading-spinner:after,\n.vjs-waiting .vjs-loading-spinner:before,\n.vjs-waiting .vjs-loading-spinner:after {\n  -webkit-animation: vjs-spinner-spin 1.1s cubic-bezier(0.6, 0.2, 0, 0.8) infinite, vjs-spinner-fade 1.1s linear infinite;\n  animation: vjs-spinner-spin 1.1s cubic-bezier(0.6, 0.2, 0, 0.8) infinite, vjs-spinner-fade 1.1s linear infinite;\n}\n\n.vjs-seeking .vjs-loading-spinner:before,\n.vjs-waiting .vjs-loading-spinner:before {\n  border-top-color: white;\n}\n\n.vjs-seeking .vjs-loading-spinner:after,\n.vjs-waiting .vjs-loading-spinner:after {\n  border-top-color: white;\n  -webkit-animation-delay: 0.44s;\n  animation-delay: 0.44s;\n}\n\n@keyframes vjs-spinner-show {\n  to {\n    visibility: visible;\n  }\n}\n@-webkit-keyframes vjs-spinner-show {\n  to {\n    visibility: visible;\n  }\n}\n@keyframes vjs-spinner-spin {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n@-webkit-keyframes vjs-spinner-spin {\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n@keyframes vjs-spinner-fade {\n  0% {\n    border-top-color: #73859f;\n  }\n  20% {\n    border-top-color: #73859f;\n  }\n  35% {\n    border-top-color: white;\n  }\n  60% {\n    border-top-color: #73859f;\n  }\n  100% {\n    border-top-color: #73859f;\n  }\n}\n@-webkit-keyframes vjs-spinner-fade {\n  0% {\n    border-top-color: #73859f;\n  }\n  20% {\n    border-top-color: #73859f;\n  }\n  35% {\n    border-top-color: white;\n  }\n  60% {\n    border-top-color: #73859f;\n  }\n  100% {\n    border-top-color: #73859f;\n  }\n}\n.vjs-chapters-button .vjs-menu ul {\n  width: 24em;\n}\n\n.video-js .vjs-subs-caps-button + .vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder {\n  vertical-align: middle;\n  display: inline-block;\n  margin-bottom: -0.1em;\n}\n\n.video-js .vjs-subs-caps-button + .vjs-menu .vjs-captions-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before {\n  font-family: VideoJS;\n  content: "";\n  font-size: 1.5em;\n  line-height: inherit;\n}\n\n.video-js .vjs-audio-button + .vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder {\n  vertical-align: middle;\n  display: inline-block;\n  margin-bottom: -0.1em;\n}\n\n.video-js .vjs-audio-button + .vjs-menu .vjs-main-desc-menu-item .vjs-menu-item-text .vjs-icon-placeholder:before {\n  font-family: VideoJS;\n  content: " ";\n  font-size: 1.5em;\n  line-height: inherit;\n}\n\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-current-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-time-divider,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-duration,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-remaining-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-playback-rate,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-chapters-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-descriptions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-captions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-subtitles-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-audio-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-volume-control, .video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-current-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-time-divider,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-duration,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-remaining-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-playback-rate,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-chapters-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-descriptions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-captions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-subtitles-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-audio-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-volume-control, .video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-current-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-time-divider,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-duration,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-remaining-time,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-playback-rate,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-chapters-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-descriptions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-captions-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-subtitles-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-audio-button,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-volume-control {\n  display: none;\n}\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,\n.video-js:not(.vjs-fullscreen).vjs-layout-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active, .video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:hover,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal:active,\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active, .video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:hover,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal:active,\n.video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active {\n  width: auto;\n  width: initial;\n}\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small:not(.vjs-liveui) .vjs-subs-caps-button, .video-js:not(.vjs-fullscreen).vjs-layout-x-small:not(.vjs-live) .vjs-subs-caps-button, .video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-subs-caps-button {\n  display: none;\n}\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small.vjs-liveui .vjs-custom-control-spacer, .video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-custom-control-spacer {\n  flex: auto;\n  display: block;\n}\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small.vjs-liveui.vjs-no-flex .vjs-custom-control-spacer, .video-js:not(.vjs-fullscreen).vjs-layout-tiny.vjs-no-flex .vjs-custom-control-spacer {\n  width: auto;\n}\n.video-js:not(.vjs-fullscreen).vjs-layout-x-small.vjs-liveui .vjs-progress-control, .video-js:not(.vjs-fullscreen).vjs-layout-tiny .vjs-progress-control {\n  display: none;\n}\n\n.vjs-modal-dialog.vjs-text-track-settings {\n  background-color: #2B333F;\n  background-color: rgba(43, 51, 63, 0.75);\n  color: #fff;\n  height: 70%;\n}\n\n.vjs-text-track-settings .vjs-modal-dialog-content {\n  display: table;\n}\n\n.vjs-text-track-settings .vjs-track-settings-colors,\n.vjs-text-track-settings .vjs-track-settings-font,\n.vjs-text-track-settings .vjs-track-settings-controls {\n  display: table-cell;\n}\n\n.vjs-text-track-settings .vjs-track-settings-controls {\n  text-align: right;\n  vertical-align: bottom;\n}\n\n@supports (display: grid) {\n  .vjs-text-track-settings .vjs-modal-dialog-content {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-template-rows: 1fr;\n    padding: 20px 24px 0px 24px;\n  }\n\n  .vjs-track-settings-controls .vjs-default-button {\n    margin-bottom: 20px;\n  }\n\n  .vjs-text-track-settings .vjs-track-settings-controls {\n    grid-column: 1/-1;\n  }\n\n  .vjs-layout-small .vjs-text-track-settings .vjs-modal-dialog-content,\n.vjs-layout-x-small .vjs-text-track-settings .vjs-modal-dialog-content,\n.vjs-layout-tiny .vjs-text-track-settings .vjs-modal-dialog-content {\n    grid-template-columns: 1fr;\n  }\n}\n.vjs-track-setting > select {\n  margin-right: 1em;\n  margin-bottom: 0.5em;\n}\n\n.vjs-text-track-settings fieldset {\n  margin: 5px;\n  padding: 3px;\n  border: none;\n}\n\n.vjs-text-track-settings fieldset span {\n  display: inline-block;\n}\n\n.vjs-text-track-settings fieldset span > select {\n  max-width: 7.3em;\n}\n\n.vjs-text-track-settings legend {\n  color: #fff;\n  margin: 0 0 5px 0;\n}\n\n.vjs-text-track-settings .vjs-label {\n  position: absolute;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  display: block;\n  margin: 0 0 5px 0;\n  padding: 0;\n  border: 0;\n  height: 1px;\n  width: 1px;\n  overflow: hidden;\n}\n\n.vjs-track-settings-controls button:focus,\n.vjs-track-settings-controls button:active {\n  outline-style: solid;\n  outline-width: medium;\n  background-image: linear-gradient(0deg, #fff 88%, #73859f 100%);\n}\n\n.vjs-track-settings-controls button:hover {\n  color: rgba(43, 51, 63, 0.75);\n}\n\n.vjs-track-settings-controls button {\n  background-color: #fff;\n  background-image: linear-gradient(-180deg, #fff 88%, #73859f 100%);\n  color: #2B333F;\n  cursor: pointer;\n  border-radius: 2px;\n}\n\n.vjs-track-settings-controls .vjs-default-button {\n  margin-right: 1em;\n}\n\n@media print {\n  .video-js > *:not(.vjs-tech):not(.vjs-poster) {\n    visibility: hidden;\n  }\n}\n.vjs-resize-manager {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  border: none;\n  z-index: -1000;\n}\n\n.js-focus-visible .video-js *:focus:not(.focus-visible) {\n  outline: none;\n  background: none;\n}\n\n.video-js *:focus:not(:focus-visible),\n.video-js .vjs-menu *:focus:not(:focus-visible) {\n  outline: none;\n  background: none;\n}\n',""]),e.exports=t},function(e,t,n){var i=n(113),r=n(300);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};i(r,a);e.exports=r.locals||{}},function(e,t,n){(t=n(114)(!1)).push([e.i,'.vjs-picture-in-picture-control {\n  display: none !important;\n}\n\n.video-js .vjs-http-source-selector {\n    display: block;\n}\n\n.vjs-http-source-selector .vjs-icon-placeholder::before {\n    font-family:VideoJS;\n    font-weight:normal;\n    font-style:normal;\n    content:"\\f110"\n}\n\n.video-js .vjs-button-vr .vjs-icon-placeholder {\n    height: 30px;\n    width: 30px;\n    display: inline-block;\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMjAuNzQgNkgzLjIxQzIuNTUgNiAyIDYuNTcgMiA3LjI4djEwLjQ0YzAgLjcuNTUgMS4yOCAxLjIzIDEuMjhoNC43OWMuNTIgMCAuOTYtLjMzIDEuMTQtLjc5bDEuNC0zLjQ4Yy4yMy0uNTkuNzktMS4wMSAxLjQ0LTEuMDFzMS4yMS40MiAxLjQ1IDEuMDFsMS4zOSAzLjQ4Yy4xOS40Ni42My43OSAxLjExLjc5aDQuNzljLjcxIDAgMS4yNi0uNTcgMS4yNi0xLjI4VjcuMjhjMC0uNy0uNTUtMS4yOC0xLjI2LTEuMjh6TTcuNSAxNC42MmMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTMgMS4xOCAwIDIuMTIuOTYgMi4xMiAyLjEzcy0uOTUgMi4xMi0yLjEyIDIuMTJ6bTkgMGMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTNzMi4xMi45NiAyLjEyIDIuMTMtLjk1IDIuMTItMi4xMiAyLjEyeiIvPgogICAgPHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgwVjB6Ii8+Cjwvc3ZnPgo=) no-repeat left center\n}\n\n.vjs-button-vr .vjs-icon-placeholder::before {\n    content:""\n}',""]),e.exports=t},function(e,t,n){"use strict";n.r(t),n.d(t,"HOAST360",(function(){return Bc}));var i=n(11),r=n.n(i),a=n(4),o=n(0),s=n.n(o),l=n(1),u=n.n(l);
/*! @name videojs-contrib-dash @version 2.11.1 @license Apache-2.0 */
function c(e,t){var n=e.dash.mediaPlayer,i=n.getTracksFor("audio"),o=e.audioTracks();function s(e){return"dash-audio-"+e}function l(e,t){return e.find((function(e){return s(e.index)===t.id}))}o.length&&t.clearTracks(["audio"]);var u=n.getCurrentTrackFor("audio");i.forEach((function(t){var n,i;if(Array.isArray(t.labels))for(var r=0;r<t.labels.length;r++)if(t.labels[r].lang&&-1!==e.language().indexOf(t.labels[r].lang.toLowerCase())){n=t.labels[r];break}n?i=n.text:Array.isArray(t.labels)&&1===t.labels.length?i=t.labels[0].text:(i=t.lang,t.roles&&t.roles.length&&(i+=" ("+t.roles.join(", ")+")")),o.addTrack(new a.a.AudioTrack({enabled:t===u,id:s(t.index),kind:t.kind||"main",label:i,language:t.lang}))}));var c=function(){for(var e=0;e<o.length;e++){var t=o[e];if(t.enabled){var r=l(i,t);n.setCurrentTrack(r)}else;}};o.addEventListener("change",c),e.dash.mediaPlayer.on(r.a.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,(function(){o.removeEventListener("change",c)}))}function h(e,t){e.dash.mediaPlayer.on(r.a.MediaPlayer.events.PLAYBACK_METADATA_LOADED,c.bind(null,e,t))}function d(e,t,n){s.a.VTTCue&&!/\[native code\]/.test(s.a.VTTCue.toString())&&(s.a.VTTCue=!1);var i=[];if(t.featuresNativeTextTracks)a.a.log.error("You must pass {html: {nativeCaptions: false}} in the videojs constructor to use text tracks in videojs-contrib-dash");else{var o=e.dash.mediaPlayer;o.on(r.a.MediaPlayer.events.TEXT_TRACKS_ADDED,l),o.on(r.a.MediaPlayer.events.CAN_PLAY,(function(){o.off(r.a.MediaPlayer.events.TEXT_TRACKS_ADDED,l)}))}function l(t){t.index;var n=t.tracks;o.off(r.a.MediaPlayer.events.TEXT_TRACKS_ADDED,l),i.forEach(e.removeRemoteTextTrack.bind(e)),i=[],n.length&&(i=function(e,t,n){var i=[],a=n.map((function(t){var n;if(Array.isArray(t.labels))for(var i=0;i<t.labels.length;i++)if(t.labels[i].lang&&-1!==e.language().indexOf(t.labels[i].lang.toLowerCase())){n=t.labels[i];break}return{dashTrack:t,trackConfig:{label:n?n.text:Array.isArray(t.labels)&&1===t.labels.length?t.labels[0].text:t.lang||t.label,language:t.lang,srclang:t.lang,kind:t.kind}}})).map((function(t){var n=t.trackConfig,r=t.dashTrack,a=e.addRemoteTextTrack(n,!1);return i.push({textTrack:a.track,dashTrack:r}),a}));function o(){for(var t=e.dash.mediaPlayer,r=e.textTracks(),a=-1,o=function(e){var t=r[e];if("showing"===t.mode){var o=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}(i,(function(e){return e.textTrack===t})),s=o?o.dashTrack:null;s&&(a=n.indexOf(s))}},s=0;s<r.length;s+=1)o(s);a!==t.getCurrentTextTrackIndex()&&t.setTextTrack(a)}return e.textTracks().on("change",o),e.dash.mediaPlayer.on(r.a.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,(function(){e.textTracks().off("change",o)})),o(),a}(e,0,n))}}var f=function(){function e(t,n,i){var o=this;if(i=i||n.options_,this.player=Object(a.a)(i.playerId),this.player.dash=this.player.dash||{},this.tech_=n,this.el_=n.el(),this.elParent_=this.el_.parentNode,this.hasFiniteDuration_=!1,t.src){n.isReady_=!1,e.updateSourceData&&(a.a.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=e.updateSourceData(t)),e.hooks("updatesource").forEach((function(e){t=e(t)}));var s=t.src;this.keySystemOptions_=e.buildDashJSProtData(t.keySystemOptions),this.player.dash.mediaPlayer=r.a.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,this.mediaPlayer_.setTextDefaultEnabled(!1),e.useVideoJSDebug&&(a.a.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.useVideoJSDebug(this.mediaPlayer_)),e.beforeInitialize&&(a.a.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.beforeInitialize(this.player,this.mediaPlayer_)),e.hooks("beforeinitialize").forEach((function(e){e(o.player,o.mediaPlayer_)})),this.mediaPlayer_.initialize(),this.retriggerError_=function(e){if("capability"===e.error&&"mediasource"===e.event)o.player.error({code:4,message:"The media cannot be played because it requires a feature that your browser does not support."});else if("manifestError"!==e.error||"createParser"!==e.event.id&&"codec"!==e.event.id&&"nostreams"!==e.event.id&&"nostreamscomposed"!==e.event.id&&"parse"!==e.event.id&&"multiplexedrep"!==e.event.id)if("mediasource"===e.error)e.event.match("MEDIA_ERR_ABORTED")?o.player.error({code:1,message:e.event}):e.event.match("MEDIA_ERR_NETWORK")?o.player.error({code:2,message:e.event}):e.event.match("MEDIA_ERR_DECODE")?o.player.error({code:3,message:e.event}):e.event.match("MEDIA_ERR_SRC_NOT_SUPPORTED")?o.player.error({code:4,message:e.event}):e.event.match("MEDIA_ERR_ENCRYPTED")?o.player.error({code:5,message:e.event}):(e.event.match("UNKNOWN"),o.player.error({code:4,message:e.event}));else if("capability"===e.error&&"encryptedmedia"===e.event)o.player.error({code:5,message:"The media cannot be played because it requires encryption features that your browser does not support."});else if("key_session"===e.error)o.player.error({code:5,message:e.event});else if("download"===e.error)o.player.error({code:2,message:"The media playback was aborted because too many consecutive download errors occurred."});else{if("mssError"!==e.error)return;o.player.error({code:3,message:e.event})}else o.player.error({code:4,message:e.event.message});setTimeout((function(){o.mediaPlayer_.reset()}),10)},this.mediaPlayer_.on(r.a.MediaPlayer.events.ERROR,this.retriggerError_),this.getDuration_=function(e){var t=e.data.Period_asArray,n=o.hasFiniteDuration_;e.data.mediaPresentationDuration||t[t.length-1].duration?o.hasFiniteDuration_=!0:o.hasFiniteDuration_=!1,o.hasFiniteDuration_!==n&&o.player.trigger("durationchange")},this.mediaPlayer_.on(r.a.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),i.dash&&Object.keys(i.dash).forEach((function(e){var t,n="set"+e.charAt(0).toUpperCase()+e.slice(1),r=i.dash[e];o.mediaPlayer_.hasOwnProperty(n)&&(a.a.log.warn("Using dash options in videojs-contrib-dash without the set prefix has been deprecated. Change '"+e+"' to '"+n+"'"),e=n),o.mediaPlayer_.hasOwnProperty(e)?(Array.isArray(r)||(r=[r]),(t=o.mediaPlayer_)[e].apply(t,r)):a.a.log.warn("Warning: dash configuration option unrecognized: "+e)})),this.mediaPlayer_.attachView(this.el_),this.mediaPlayer_.setAutoPlay(!1),h.call(null,this.player,n),d.call(null,this.player,n,i),this.setupQualityLevels_(),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(s),this.tech_.triggerReady()}}var t=e.prototype;return t.setupQualityLevels_=function(){var e=this,t=this.player;t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.mediaPlayer_.on(r.a.MediaPlayer.events.PLAYBACK_METADATA_LOADED,(function(){e.videoRates_=e.mediaPlayer_.getBitrateInfoListFor("video"),e.audioRates_=e.mediaPlayer_.getBitrateInfoListFor("audio");var t=e.videoRates_[e.videoRates_.length-1].bitrate;e.audioMapper_=e.videoRates_.map((function(n){return Math.round(n.bitrate/t*(e.audioRates_.length-1))})),e.videoRates_.forEach((function(t){e.qualityLevels_.addQualityLevel({id:t.bitrate,width:t.width,height:t.height,bandwidth:t.bitrate,enabled:function(e){if(void 0===e)return void 0===this.enabled__||this.enabled__;this.enabled__=e}})}))})),this.qualityLevels_.on("change",(function(n){e.mediaPlayer_=t.dash.mediaPlayer;var i=e.qualityLevels_.levels_.filter((function(e){return e.enabled})),r=e.mediaPlayer_.getSettings().streaming.abr.autoSwitchBitrate;1===i.length?(r.video&&e.mediaPlayer_.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1,audio:!1}}}}),e.mediaPlayer_.setQualityFor("video",n.selectedIndex),e.mediaPlayer_.setQualityFor("audio",e.audioMapper_[n.selectedIndex])):r.video||e.mediaPlayer_.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0,audio:!0}}}})})),this.mediaPlayer_.on(r.a.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,(function(t){"video"===t.mediaType&&(e.qualityLevels_.selectedIndex_=t.newQuality)})))},e.buildDashJSProtData=function(e){var t={};if(!e||!Array.isArray(e))return null;for(var n=0;n<e.length;n++){var i=e[n],r=a.a.mergeOptions({},i.options);r.licenseUrl&&(r.serverURL=r.licenseUrl,delete r.licenseUrl),t[i.name]=r}return t},t.dispose=function(){this.mediaPlayer_&&(this.mediaPlayer_.off(r.a.MediaPlayer.events.ERROR,this.retriggerError_),this.mediaPlayer_.off(r.a.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),this.mediaPlayer_.reset()),this.player.dash&&delete this.player.dash,this.qualityLevels_&&this.qualityLevels_.dispose()},t.duration=function(){return this.mediaPlayer_.isDynamic()&&!this.hasFiniteDuration_?1/0:this.mediaPlayer_.duration()},e.hooks=function(t,n){return e.hooks_[t]=e.hooks_[t]||[],n&&(e.hooks_[t]=e.hooks_[t].concat(n)),e.hooks_[t]},e.hook=function(t,n){e.hooks(t,n)},e.removeHook=function(t,n){var i=e.hooks(t).indexOf(n);return-1!==i&&(e.hooks_[t]=e.hooks_[t].slice(),e.hooks_[t].splice(i,1),!0)},e}();f.hooks_={};a.a.DashSourceHandler=function(){return{canHandleSource:function(e){return function(e){e=JSON.parse(JSON.stringify(e)),f.updateSourceData&&(a.a.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),e=f.updateSourceData(e)),f.hooks("updatesource").forEach((function(t){e=t(e)}));var t=u.a.createElement("video");return!(e.keySystemOptions&&!s.a.navigator.requestMediaKeySystemAccess&&!t.msSetMediaKeys)}(e)?a.a.DashSourceHandler.canPlayType(e.type)?"probably":/\.mpd/i.test(e.src)?"maybe":"":""},handleSource:function(e,t,n){return new f(e,t,n)},canPlayType:function(e){return a.a.DashSourceHandler.canPlayType(e)}}},a.a.DashSourceHandler.canPlayType=function(e){return/^application\/dash\+xml/i.test(e)?"probably":""},s.a.MediaSource&&a.a.getTech("Html5").registerSourceHandler(a.a.DashSourceHandler(),0),a.a.Html5DashJS=f;function p(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var g=a.a.getComponent("MenuItem"),v=a.a.getComponent("Component"),y=function(e){function t(t,n){var i;return n.selectable=!0,n.multiSelectable=!1,(i=e.call(this,t,n)||this).update(),i}p(t,e);var n=t.prototype;return n.handleClick=function(){var t=this.options_;e.prototype.handleClick.call(this);for(var n=this.player().qualityLevels(),i=0;i<n.length;i++)t.index==n.length||t.index==i?n[i].enabled=!0:n[i].enabled=!1;n.selectedIndex_=t.index,n.trigger({type:"change",selectedIndex:t.index})},n.update=function(){for(var e=this.player().qualityLevels(),t=0,n=0;n<e.length;n++)e[n].enabled&&(t+=1);1===t?this.selected(this.options_.index===e.selectedIndex):this.selected(this.options_.index===e.length)},t}(g);v.registerComponent("SourceMenuItem",y);var _=a.a.getComponent("MenuButton"),b=function(e){function t(t,n){var i;i=e.call(this,t,n)||this,_.apply(m(i),arguments);var r=i.player().qualityLevels();if(n&&n.default)if("low"===n.default)for(var o=0;o<r.length;o++)r[o].enabled=0==o;else if("high"===n.default)for(var s=0;s<r.length;s++)r[s].enabled=s==r.length-1;return i.player().qualityLevels().on(["change","addqualitylevel"],a.a.bind(m(i),i.update)),i}p(t,e);var n=t.prototype;return n.createEl=function(){return a.a.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},n.buildCSSClass=function(){return _.prototype.buildCSSClass.call(this)},n.createItems=function(){this.menuItems=[];for(var e=this.player().qualityLevels(),t=[],n=0;n<e.length;n++){var i=e.length-(n+1),r=i===e.selectedIndex,a=""+i,o=i;e[i].height?(a=e[i].height+"p",o=parseInt(e[i].height,10)):e[i].bitrate&&(a=Math.floor(e[i].bitrate/1e3)+" kbps",o=parseInt(e[i].bitrate,10)),t.indexOf(a)>=0||(t.push(a),this.menuItems.push(new y(this.player_,{label:a,index:i,selected:r,sortVal:o})))}return e.length>1&&this.menuItems.push(new y(this.player_,{label:"Auto",index:e.length,selected:-1===e.selectedIndex,sortVal:99999})),this.menuItems.sort((function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0})),this.menuItems},t}(_),E={},T=a.a.registerPlugin||a.a.plugin,w=function(e){var t=this;this.ready((function(){!function(e,t){if(e.addClass("vjs-http-source-selector"),"Html5"!==e.techName_)return!1;e.on(["loadedmetadata"],(function(t){if("undefined"!==e.videojs_http_source_selector_initialized&&!0!==e.videojs_http_source_selector_initialized){e.videojs_http_source_selector_initialized=!0;var n=e.controlBar,i=n.getChild("fullscreenToggle").el();n.el().insertBefore(n.addChild("SourceMenuButton").el(),i)}}))}(t,a.a.mergeOptions(E,e))})),a.a.registerComponent("SourceMenuButton",b),a.a.registerComponent("SourceMenuItem",y)};T("httpSourceSelector",w),w.VERSION="1.1.7";function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var A=function e(t){var n=this;if(a.a.browser.IS_IE8)for(var i in n=u.a.createElement("custom"),e.prototype)"constructor"!==i&&(n[i]=e.prototype[i]);return n.id=t.id,n.label=n.id,n.width=t.width,n.height=t.height,n.bitrate=t.bandwidth,n.enabled_=t.enabled,Object.defineProperty(n,"enabled",{get:function(){return n.enabled_()},set:function(e){n.enabled_(e)}}),n},S=function(e){
/*! @name videojs-contrib-quality-levels @version 2.0.9 @license Apache-2.0 */
var t,n;function i(){var t,n=x(x(t=e.call(this)||this));if(a.a.browser.IS_IE8)for(var r in n=u.a.createElement("custom"),i.prototype)"constructor"!==r&&(n[r]=i.prototype[r]);return n.levels_=[],n.selectedIndex_=-1,Object.defineProperty(n,"selectedIndex",{get:function(){return n.selectedIndex_}}),Object.defineProperty(n,"length",{get:function(){return n.levels_.length}}),n||x(t)}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.addQualityLevel=function(e){var t=this.getQualityLevelById(e.id);if(t)return t;var n=this.levels_.length;return t=new A(e),""+n in this||Object.defineProperty(this,n,{get:function(){return this.levels_[n]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t},r.removeQualityLevel=function(e){for(var t=null,n=0,i=this.length;n<i;n++)if(this[n]===e){t=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t},r.getQualityLevelById=function(e){for(var t=0,n=this.length;t<n;t++){var i=this[t];if(i.id===e)return i}return null},r.dispose=function(){this.selectedIndex_=-1,this.levels_.length=0},i}(a.a.EventTarget);for(var M in S.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},S.prototype.allowedEvents_)S.prototype["on"+M]=null;var C=a.a.registerPlugin||a.a.plugin,R=function(e){return t=this,a.a.mergeOptions({},e),n=t.qualityLevels,i=new S,t.on("dispose",(function e(){i.dispose(),t.qualityLevels=n,t.off("dispose",e)})),t.qualityLevels=function(){return i},t.qualityLevels.VERSION="2.0.9",i;var t,n,i};C("qualityLevels",R),R.VERSION="2.0.9";n(296);var I=n(27);function P(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var L=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.mtx=I.identity(this.nCh),this.bypassed=!1,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gain=new Array(this.nCh);for(var i=0;i<this.nCh;i++){this.gain[i]=new Array(this.nCh);for(var r=0;r<this.nCh;r++)this.gain[i][r]=this.ctx.createGain(),this.gain[i][r].gain.value=this.mtx[i][r],this.in.connect(this.gain[i][r],r,0),this.gain[i][r].connect(this.out,0,i)}}var t,n,i;return t=e,(n=[{key:"updateMtx",value:function(e){if(!this.bypassed){this.mtx=e;for(var t=0;t<this.nCh;t++)for(var n=0;n<this.nCh;n++)this.gain[t][n].gain.value=this.mtx[t][n]}}},{key:"bypass",value:function(e){e?(this.updateMtx(I.identity(this.nCh)),this.bypassed=!0):this.bypassed=!1}},{key:"printGainMtx",value:function(){console.log(this)}}])&&P(t.prototype,n),i&&P(t,i),e}(),D=[[[.64625,24461e-9,-4089e-7,.20862,50219e-9,-52748e-8,-.1093,-78951e-8,.14164,21747e-8,-79888e-8,48411e-8,44694e-8,-.093541,-90626e-8,.049019,50964e-8,-48203e-8,92489e-8,43532e-8,.02554,37256e-8,-.037707,-83965e-8,-.025445],[24406e-9,.58558,-41143e-8,38856e-9,.14513,50484e-9,33858e-8,-5266e-7,25715e-8,.14072,-22435e-9,-.040347,57186e-8,54592e-8,1218e-7,52198e-8,.086187,-23946e-8,-.041983,36777e-9,-68321e-8,43714e-8,11039e-8,79005e-8,54782e-8],[-41095e-8,-41143e-8,.54842,-61474e-8,-5266e-7,42247e-8,26998e-9,.087242,-5966e-7,-28013e-8,73651e-8,-69342e-9,-.073972,-34061e-8,.064364,-48763e-8,97077e-9,79363e-8,-2939e-7,-12281e-8,43887e-8,-.084714,-68878e-8,.023305,-28636e-8],[.19849,38828e-9,-61123e-8,.80458,93387e-9,-5152e-7,-.16302,-.0011348,.22524,31308e-8,-79098e-8,53699e-8,6568e-7,-.14343,-.0012054,.09861,66164e-8,-50598e-8,.0010547,42777e-8,.044786,51993e-8,-.06468,-.0010368,-.005522],[5007e-8,.12861,-51876e-8,93477e-9,.74158,-2227e-8,47805e-8,-67306e-8,43128e-8,.25473,-19268e-8,-.072517,72336e-8,79392e-8,12221e-8,81618e-8,.16658,-50117e-8,-.078524,90285e-9,-97769e-8,55924e-8,2361e-7,94543e-8,83181e-8],[-53486e-8,51058e-9,42512e-8,-53024e-8,-18728e-9,.54246,17457e-8,62628e-8,10378e-8,-17933e-8,.084803,94887e-9,-38837e-8,-86558e-9,32679e-8,59316e-8,-31921e-8,.08438,95179e-9,-.043767,41066e-8,-17795e-8,49007e-9,94514e-10,59243e-8],[-.10942,34082e-8,22597e-9,-.155,48623e-8,16632e-8,.59766,30628e-9,-.11113,27213e-8,25502e-8,-26441e-8,-42634e-9,.10856,-11253e-9,-.040205,-16775e-8,15033e-8,-31258e-8,-15558e-8,-.054583,-43195e-9,.055009,-64321e-9,.020717],[-79322e-8,-51876e-8,.071127,-.0011409,-67306e-8,61665e-8,39219e-9,.65142,-.0010244,-37954e-8,.0011148,-84578e-9,-.13605,-64922e-8,.1291,-77723e-8,7844e-8,.0012888,-37488e-8,-17509e-8,86799e-8,-.15496,-.001181,.059043,-42839e-8],[.14124,25889e-8,-592e-6,.2102,43602e-8,11808e-8,-.11045,-.0010182,.69736,45932e-8,1479e-7,38072e-10,60212e-8,-.11147,-91345e-8,.15847,35583e-8,-22808e-10,21347e-8,-10435e-8,.03617,41567e-8,-.064123,-64686e-8,.092688],[22089e-8,.14043,-26296e-8,31846e-8,.23004,-18435e-8,25461e-8,-36269e-8,45478e-8,.77017,-44779e-8,-.072371,36414e-8,5903e-7,-19878e-9,59567e-8,.22612,-7213e-7,-.08933,12329e-8,-74496e-8,28962e-8,38758e-8,3379e-7,5309e-7],[-79789e-8,-26105e-9,73409e-8,-8018e-7,-19331e-8,.063567,26358e-8,.0011215,12331e-8,-44427e-8,.65129,89263e-9,-6662e-7,-13017e-8,70771e-8,83994e-8,-62751e-8,.17635,-27017e-9,-.087071,60488e-8,-31948e-8,36444e-9,23471e-8,84011e-8],[49378e-8,-.040321,-75659e-9,55307e-8,-.066254,96763e-9,-26913e-8,-93945e-9,19178e-9,-.072552,94236e-9,.53533,87417e-9,-63206e-9,13943e-9,-48195e-8,-.047059,-78326e-9,.062868,-70113e-9,-84252e-9,49647e-9,16646e-8,10368e-8,-58817e-8],[4444e-7,5667e-7,-.074704,65323e-8,7277e-7,-37858e-8,-47253e-9,-.12171,59911e-8,38479e-8,-656e-6,77767e-9,.61874,33408e-8,-.10117,45402e-8,-14948e-8,-74103e-8,3734e-7,16911e-9,-44109e-8,.15258,70315e-8,-.038455,24201e-8],[-.09601,54403e-8,-34849e-8,-.14309,79927e-8,-918e-7,.086601,-66395e-8,-.10716,61085e-8,-14028e-8,-61614e-9,3471e-7,.62695,-77092e-8,-.051024,16023e-8,-10633e-8,1919e-7,48363e-9,-.096681,2607e-7,.09402,-74571e-8,.0019158],[-90935e-8,14083e-8,.064898,-.0012115,14918e-8,31277e-8,-9.9481e-7,.10959,-91848e-8,-17227e-10,68618e-8,1483e-8,-.10023,-75551e-8,.62343,-57355e-8,-20829e-8,.0010125,50756e-9,-15674e-8,.0010724,-.13186,-.001046,.11144,-26243e-8],[.051801,52227e-8,-47921e-8,.097067,82131e-8,59196e-8,-.04061,-76706e-8,.13419,60936e-8,853e-6,-4871e-7,45284e-8,-.049994,-56946e-8,.69569,13044e-9,37685e-8,-54845e-8,-51755e-8,.014479,25727e-8,-.055169,-29779e-8,.2151],[51658e-8,.088775,11285e-8,67289e-8,.16423,-32031e-8,-18918e-8,1013e-7,35665e-8,.19258,-62824e-8,-.047327,-17334e-8,12974e-8,-20709e-8,-24617e-10,.71786,-81442e-8,-.062173,11207e-8,-24106e-8,-12571e-8,51769e-8,-52429e-8,-18112e-8],[-45845e-8,-24851e-8,78155e-8,-48969e-8,-51038e-8,.084815,14762e-8,.0012812,-22354e-9,-72528e-8,.1468,-84189e-9,-74318e-8,-96694e-9,.0010287,34062e-8,-81659e-8,.69566,-45531e-8,-.089395,3471e-7,-43499e-8,-84247e-9,63284e-8,33745e-8],[93369e-8,-.043038,-29946e-8,.0010751,-.077832,91543e-9,-3188e-7,-38777e-8,2427e-7,-.083693,-27488e-9,.037125,38519e-8,18917e-8,38876e-9,-52703e-8,-.062622,-44958e-8,.59638,-63301e-9,-5158e-7,26879e-8,44977e-8,44357e-8,-73249e-8],[43394e-8,39403e-9,-11519e-8,43287e-8,92062e-9,-.044092,-16019e-8,-16586e-8,-90741e-9,12205e-8,-.076371,-68027e-9,11431e-9,42146e-9,-15562e-8,-50978e-8,10852e-8,-.090178,-63215e-9,.55076,-30071e-8,-10061e-8,-44091e-9,-18634e-8,-52989e-8],[.024287,-68098e-8,44025e-8,.046456,-98422e-8,41334e-8,-.055264,87045e-8,.035731,-76679e-8,61854e-8,-78956e-9,-44819e-8,-.076,.0010755,.015605,-26965e-8,37256e-8,-50905e-8,-30948e-8,.5861,-35748e-8,-.068219,.0010858,-.0080666],[36278e-8,4236e-7,-.088187,50613e-8,55013e-8,-16319e-8,-46573e-9,-.1555,40323e-8,29887e-8,-29669e-8,41029e-9,.12447,24422e-8,-.12393,2491e-7,-10458e-8,-41303e-8,25301e-8,-98766e-9,-34343e-8,.68038,48316e-8,-.062931,9542e-8],[-.036394,97977e-9,-6982e-7,-.067832,21983e-8,59647e-9,.055717,-.0011988,-.063915,37975e-8,53604e-9,16491e-8,72268e-8,.070836,-.0010605,-.050376,52623e-8,-72473e-9,44212e-8,-53054e-9,-.067734,50953e-8,.57914,-7305e-7,-.034854],[-83493e-8,79998e-8,.026126,-.0010351,97432e-8,16225e-10,-53865e-9,.058505,-6492e-7,37984e-8,21376e-8,92154e-9,-.038997,-72785e-8,.082227,-29911e-8,-49514e-8,60306e-8,43943e-8,-18093e-8,.0010741,-.061081,-72224e-8,.64196,-93765e-9],[-.026973,53825e-8,-27366e-8,-.0017445,82228e-8,56764e-8,.021988,-41243e-8,.09185,53812e-8,81817e-8,-57411e-8,23488e-8,.0017919,-25756e-8,.18228,-15563e-8,35494e-8,-72595e-8,-51764e-8,-.0087198,97547e-9,-.034296,-95702e-9,.76345]],[[.587,10936e-9,21995e-8,.22357,-12525e-8,52665e-8,-.12183,24653e-8,.16726,-42001e-8,87024e-8,-17717e-9,-27965e-8,-.1162,-20894e-8,.079485,-72313e-8,63269e-8,-11138e-8,-55681e-8,.043034,-16766e-8,-.058607,-75764e-8,-.0027889],[13453e-9,.5122,41908e-8,-9663e-8,.14497,46143e-8,-18693e-9,58522e-8,-35626e-8,.14812,76269e-8,-.041486,-66906e-8,-40991e-9,-47655e-9,-52001e-8,.10853,60956e-8,-.049085,-3212e-7,-53337e-9,-62472e-8,-27486e-8,-85503e-8,-43094e-8],[22731e-8,41908e-8,.47752,19813e-8,58522e-8,-42166e-10,-50531e-9,.087118,-1388e-7,3751e-7,-16618e-8,-35399e-9,-.070649,6476e-8,.066165,-44804e-8,-54522e-9,-59191e-8,13014e-8,-94357e-9,-21832e-8,-.08609,-98574e-9,.031453,-5487e-7],[.19052,-10907e-8,17584e-8,.76943,-33859e-8,54445e-8,-.19196,15457e-8,.27705,-67656e-8,8991e-7,-41963e-9,-22123e-8,-.17887,-32998e-8,.14113,-97169e-8,65186e-8,-24377e-8,-58218e-8,.069117,-10029e-8,-.09471,-89466e-8,.022901],[-14079e-8,.091335,55927e-8,-34253e-8,.6736,61634e-8,23739e-9,78045e-8,-61504e-8,.29159,.0010097,-.081031,-89889e-8,-98872e-9,-68201e-9,-74007e-8,.21073,78527e-8,-.093753,-42078e-8,41262e-9,-84257e-8,-47826e-8,-.0011437,-5475e-7],[55581e-8,47424e-8,-21353e-10,60115e-8,66261e-8,.46752,-2822e-7,-14037e-8,-41528e-9,46736e-8,.084676,14672e-8,-86235e-9,-57514e-9,-58129e-8,-65502e-8,45509e-9,.079704,50601e-8,-.038675,-25213e-8,-49656e-9,-1754e-8,-.0010075,-83182e-8],[-.12272,-14076e-9,-35527e-9,-.16574,18466e-9,-24961e-8,.54282,-35473e-9,-.13781,81276e-9,-41996e-8,-75118e-9,41261e-9,.13968,46084e-9,-.069897,12341e-8,-3151e-7,-14685e-8,28454e-8,-.063923,1529e-8,.070979,13473e-8,.0015837],[23571e-8,55927e-8,.034616,1624e-7,78045e-8,-15434e-8,-49681e-9,.57853,-28336e-8,49872e-8,-53035e-8,-54614e-9,-.14532,58476e-9,.14795,-68265e-8,-72608e-9,-.0012119,16021e-8,-3101e-8,-2336e-7,-.16497,-20779e-8,.074562,-79425e-8],[.16674,-37376e-8,-16977e-8,.22789,-63911e-8,-97983e-9,-.13551,-32386e-8,.66329,-73505e-8,-16578e-8,-11944e-8,21977e-8,-.15126,-35402e-8,.20173,-68928e-8,-12466e-8,-49324e-8,98012e-9,.057386,22846e-8,-.091151,-33529e-8,.10988],[-46008e-8,.14922,3115e-7,-7135e-7,.2117,38666e-8,10637e-8,43339e-8,-72197e-8,.73371,6142e-7,-.081181,-50759e-8,-20602e-8,-4241e-8,-60208e-8,.30099,42817e-8,-.11561,-25057e-8,35043e-8,-47818e-8,-56969e-8,-62459e-8,-32467e-8],[87755e-8,74968e-8,-18303e-8,94845e-8,.0010383,.015795,-4539e-7,-53665e-8,-70515e-9,71283e-8,.56617,24289e-8,83571e-9,-10334e-8,-.0011916,-.001037,28558e-9,.19361,81459e-8,-.088821,-38316e-8,12401e-8,-2744e-8,-.0017587,-.0012989],[-12527e-9,-.041911,-15593e-9,-40766e-9,-.060723,17501e-8,-79366e-9,-28841e-9,-13596e-8,-.081693,29976e-8,.4658,45291e-9,-1566e-7,-58756e-10,-23345e-8,-.064719,25926e-8,.078461,-1366e-7,20827e-8,61588e-9,-11007e-8,41947e-9,-24589e-8],[-27333e-8,-65289e-8,-.074051,-23434e-8,-91748e-8,-8159e-8,56771e-9,-.098597,1763e-7,-59474e-8,52732e-9,75544e-9,.55085,-85288e-9,-.1093,54703e-8,78646e-9,59813e-8,-16846e-8,21206e-8,27729e-8,.18439,12369e-8,-.058698,65847e-8],[-.12401,-42674e-9,75271e-9,-.17794,-10753e-8,-27989e-9,.068014,76141e-9,-.13726,-22709e-8,-5717e-8,-15054e-8,-10325e-8,.57506,-11153e-8,-.079334,-37814e-8,-55202e-9,-36816e-8,58381e-9,-.11968,-6759e-8,.12818,-34618e-8,-.017439],[-26384e-8,-11929e-8,.069338,-38999e-8,-17077e-8,-60613e-8,64088e-9,.084731,-36054e-8,-11379e-8,-.0012344,25475e-10,-.10651,-11662e-8,.55842,-30142e-8,2581e-8,-.0016245,-51097e-9,42263e-8,24084e-8,-.15779,-28213e-8,.13738,-21951e-8],[.08773,-51248e-8,-46167e-8,.13578,-74876e-8,-66335e-8,-.070682,-7181e-7,.12241,-6334e-7,-.0010966,-19813e-8,58602e-8,-.075445,-34127e-8,.63319,-34374e-8,-78187e-8,-6792e-7,70974e-8,.029344,48856e-8,-.079183,19165e-8,.24662],[-75913e-8,.1168,-12719e-8,-.0010153,.20442,-37202e-9,16034e-8,-17643e-8,-69473e-8,.19208,-10178e-8,-.065659,19822e-8,-34109e-8,27693e-9,-31539e-8,.68451,-18867e-8,-.085002,43521e-9,73445e-8,18409e-8,-55823e-8,32967e-8,-19921e-9],[55398e-8,53374e-8,-64303e-8,59676e-8,71701e-8,.083751,-29748e-8,-.0012756,-50365e-9,44194e-8,.098569,19308e-8,70265e-8,-80763e-9,-.0015965,-64309e-8,-94928e-9,.62729,60047e-8,-.088009,-21995e-8,6881e-7,-90439e-10,-.001667,-75426e-8],[-12064e-8,-.052475,15649e-8,-25972e-8,-.091997,52931e-8,-14448e-8,20598e-8,-52079e-8,-.097269,88753e-8,-.0051841,-21779e-8,-37285e-8,-32722e-9,-73475e-8,-.086445,72645e-8,.52063,-39696e-8,48166e-8,-1717e-7,-41294e-8,-29842e-8,-67731e-8],[-56349e-8,-29988e-8,-98596e-9,-61614e-8,-41066e-8,-.040634,30788e-8,-57013e-9,35928e-9,-27584e-8,-.054116,-10789e-8,21971e-8,90579e-9,36152e-8,67102e-8,-74605e-10,-.090099,-35018e-8,.47806,22216e-8,19329e-8,17083e-9,82013e-8,87003e-8],[.038195,-62543e-9,-22772e-8,.074183,17895e-9,-27043e-8,-.067145,-26393e-8,.055714,31949e-8,-43415e-8,20617e-8,30397e-8,-.052367,19648e-8,.033209,72351e-8,-29696e-8,46785e-8,25631e-8,.5135,20764e-8,-.072454,76991e-8,2467e-7],[-13864e-8,-5743e-7,-.097476,-86233e-9,-8102e-7,-39066e-9,20131e-9,-.16797,18998e-8,-52754e-8,98761e-9,85299e-9,.093169,-49658e-9,-.13214,42683e-8,67516e-9,56963e-8,-11564e-8,17115e-8,16617e-8,.62967,13685e-8,-.085793,47754e-8],[-.05284,-31082e-8,-1308e-7,-.10398,-53831e-8,-38177e-9,.074059,-25608e-8,-.090313,-62992e-8,-61739e-9,-92038e-9,1683e-7,.052794,-29875e-8,-.064083,-60017e-8,-36338e-9,-39615e-8,35458e-9,-.071162,17938e-8,.51628,-30385e-8,-.045999],[-81926e-8,-91472e-8,.04043,-98663e-8,-.0012783,-996e-6,18071e-8,.073818,-39491e-8,-80468e-8,-.0017808,89624e-9,-.0605,-32221e-8,.042798,19881e-8,18949e-8,-.0017505,-25602e-8,86978e-8,78885e-8,-.079564,-32601e-8,.56016,49632e-8],[-.010655,-37483e-8,-5194e-7,.03283,-49429e-8,-75177e-8,.007781,-77663e-8,.10793,-32154e-8,-.0012254,-20055e-8,64903e-8,-.016619,-27053e-8,.14045,-52848e-9,-82206e-8,-58626e-8,82325e-8,-.0024109,51115e-8,-.043315,41371e-8,.69773]],[[.53332,-86478e-8,27166e-8,.23291,-.0014148,-14464e-8,-.13098,40892e-8,.18602,-.0013398,-26134e-8,26761e-8,-30622e-8,-.1348,16256e-8,.10507,-7004e-7,-2715e-7,8021e-8,96284e-9,.058845,-19821e-8,-.078358,-19865e-8,.021045],[-90985e-8,.44769,-11815e-8,-.0011527,.14455,27429e-8,60892e-8,-18031e-8,-3661e-7,.15062,48797e-8,-.041865,14747e-8,35878e-8,-74965e-9,60646e-8,.12104,50935e-8,-.053368,-96561e-9,41347e-10,1167e-7,-89577e-9,70802e-9,.0012522],[28759e-8,-11815e-8,.41457,3356e-7,-18031e-8,-47149e-8,-28169e-9,.086711,11326e-8,-16492e-8,-91004e-8,-40426e-9,-.066605,1799e-7,.065367,-12066e-8,-99163e-9,-.0010352,-14725e-8,43378e-8,-39039e-8,-.083296,1111e-7,.034984,-26994e-8],[.17421,-.0010423,29403e-8,.73101,-.0017132,-15908e-8,-.2161,43704e-8,.32079,-.0016401,-29144e-8,32487e-8,-31571e-8,-.20973,16503e-8,.18008,-88877e-8,-31458e-8,98381e-9,10185e-8,.091587,-17934e-8,-.1232,-22674e-8,.054197],[-.0014152,.049946,-16761e-8,-.0018015,.60492,3823e-7,94954e-8,-25934e-8,-59625e-8,.3182,67573e-8,-.087543,2054e-7,56198e-8,-12312e-8,90336e-8,.24329,70609e-8,-.10563,-10217e-8,-34285e-10,1616e-7,-15295e-8,68444e-9,.0019108],[-16086e-8,29014e-8,-49595e-8,-19003e-8,43639e-8,.40162,32538e-9,-8087e-7,-6638e-8,40177e-8,.087628,19764e-8,73131e-8,-68853e-9,-416e-6,56337e-9,25116e-8,.074795,5755e-7,-.035127,17509e-8,74014e-8,-50437e-9,24938e-8,1179e-7],[-.13364,53735e-8,61261e-10,-.16983,88139e-8,14409e-9,.49172,25862e-9,-.15788,796e-6,22049e-9,-32706e-8,-89418e-9,.17035,55162e-10,-.097012,30599e-8,22108e-9,-39624e-8,1177e-8,-.07533,-1754e-7,.088908,-63338e-9,-.020377],[40229e-8,-16761e-8,-.0060338,46373e-8,-25934e-8,-73061e-8,-20827e-9,.50675,14908e-8,-24644e-8,-.0014207,-6202e-8,-.15157,28546e-8,.1619,-17743e-8,-16457e-8,-.0016442,-22065e-8,66734e-8,-58746e-8,-.16949,16686e-8,.086096,-38442e-8],[.18672,-20498e-8,57035e-9,.23363,-35963e-8,-3498e-8,-.15352,76583e-9,.62827,-41958e-8,-78058e-9,-25584e-9,-61877e-9,-.18721,-45833e-10,.24698,-38487e-8,-11782e-8,-18337e-8,2439e-8,.079212,-27086e-9,-.11941,-12286e-8,.13485],[-.0012036,.15644,-13455e-8,-.0015501,.1786,30698e-8,76583e-8,-21707e-8,-59149e-8,.68216,54237e-8,-.084436,16329e-8,40189e-8,-13412e-8,61452e-8,.36417,5664e-7,-.1366,-78115e-9,91856e-9,13422e-8,-19129e-8,-6161e-9,.001454],[-26978e-8,47869e-8,-90884e-8,-3231e-7,71541e-8,-.033353,49152e-9,-.001493,-12892e-8,65943e-8,.48346,36997e-8,.0013348,-12564e-8,-80979e-8,6484e-8,42316e-8,.20587,.0010421,-.090794,30344e-8,.0013566,-98268e-9,36915e-8,16723e-8],[22108e-8,-.043628,-572e-7,28283e-8,-.052084,23844e-8,-31699e-8,-91147e-9,-23164e-10,-.085377,46214e-8,.40214,93055e-9,-39136e-8,-33124e-9,-38245e-8,-.077651,48058e-8,.095957,-33935e-8,41676e-8,9877e-8,-90395e-9,59714e-9,-6221e-7],[-28637e-8,13378e-8,-.074912,-31889e-8,201e-6,65439e-8,-58413e-9,-.069798,-11168e-8,18324e-8,.0012592,67431e-9,.48303,-33506e-8,-.10772,78951e-9,11568e-8,.0014198,21008e-8,-60998e-8,60184e-8,.21086,-15305e-8,-.071426,19194e-8],[-.14805,25645e-8,21451e-8,-.20869,4223e-7,-81669e-9,.044261,35151e-8,-.1633,33068e-8,-15524e-8,-35567e-8,-3827e-7,.52375,13231e-8,-.10609,-21583e-9,-1659e-7,-61963e-8,88258e-9,-.14476,-44808e-8,.16406,-25556e-8,-.040697],[93291e-9,-43083e-9,.074033,97733e-9,-81333e-9,-2876e-7,-61962e-10,.051506,-28197e-10,-10843e-8,-59761e-8,-13327e-9,-.103,64884e-9,.49105,-1126e-7,-11984e-8,-79528e-8,-59505e-9,24068e-8,-11644e-8,-.17428,45472e-9,.16356,-18319e-8],[.11808,73649e-8,-16218e-8,.17022,.0011718,69683e-9,-.097733,-25267e-8,.10725,97467e-8,10306e-8,-44825e-8,1442e-7,-.098128,-16722e-8,.57495,20865e-8,56758e-9,-55838e-8,-30894e-9,.045411,56194e-9,-.10397,-57899e-9,.28097],[-43129e-8,.13428,-62207e-9,-5877e-7,.23464,14304e-8,15382e-8,-11574e-8,-39076e-8,.17521,26077e-8,-.079679,80071e-9,-75027e-9,-11694e-8,-12457e-8,.64054,26654e-8,-.10168,-98848e-9,31663e-8,83163e-9,-21019e-8,-90779e-9,12033e-8],[-24497e-8,43596e-8,-94313e-8,-30588e-8,65136e-8,.08692,42003e-9,-.0015776,-15911e-8,60025e-8,.041647,34299e-8,.0013693,-12071e-8,-96417e-8,-54095e-10,38228e-8,.54472,95989e-8,-.079407,2771e-7,.0014047,-11755e-8,15227e-8,92483e-9],[-38413e-9,-.058893,-16951e-8,-47598e-9,-.10358,61439e-8,-32203e-8,-26882e-8,-21846e-8,-.10533,.0011687,-.050337,25149e-8,-61088e-8,-11326e-8,-4818e-7,-.10448,.0012144,.44441,-72985e-8,85798e-8,2478e-7,-24241e-8,12905e-8,-62427e-8],[8632e-8,-54223e-9,40836e-8,98225e-9,-5074e-8,-.04042,62587e-10,66197e-8,38134e-9,-48001e-9,-.030707,-30475e-8,-6105e-7,77506e-9,32101e-8,-12032e-9,-10096e-8,-.082863,-67652e-8,.4097,-14358e-8,-621e-6,38371e-9,-24809e-8,-30663e-9],[.04866,70266e-9,-41611e-8,.099601,10626e-8,17813e-8,-.083395,-66127e-8,.075838,18568e-8,32842e-8,36065e-8,66412e-8,-.027901,-23518e-8,.05308,34727e-8,33957e-8,8165e-7,-1603e-7,.44254,7028e-7,-.071921,47772e-8,.012711],[-12703e-8,85424e-9,-.10275,-11532e-8,12754e-8,5968e-7,-15922e-8,-.17746,-38296e-9,1223e-7,.0011538,69515e-9,.052386,-38879e-8,-.1311,-10053e-9,94817e-9,.0013138,1888e-7,-55874e-8,59095e-8,.56611,-13321e-8,-.098787,-81604e-10],[-.065256,-13081e-8,73937e-9,-.13753,-22989e-8,-30907e-9,.09636,11609e-8,-.11766,-27166e-8,-67881e-9,-25943e-9,-97473e-9,.033249,51346e-9,-.078993,-25628e-8,-99628e-9,-13762e-8,22714e-9,-.069944,-83109e-9,.45469,-53426e-9,-.058191],[-29594e-8,99494e-9,.049968,-35676e-8,12462e-8,36576e-8,-33474e-9,.086916,-19831e-8,61055e-9,63375e-8,57795e-9,-.075546,-295e-6,-58358e-8,-58434e-9,-41169e-9,52313e-8,15845e-8,-37978e-8,58641e-8,-.08738,-13265e-8,.47959,27647e-9],[.0020659,.0012258,-26624e-8,.067349,.00198,9976e-8,-.0057097,-40732e-8,.13285,.0017418,16042e-8,-65422e-8,23053e-8,-.037488,-24598e-8,.096915,59714e-8,12964e-8,-71902e-8,-38515e-9,.0068276,73255e-9,-.051904,-34608e-9,.62072]],[[.48444,15705e-8,58138e-8,.23811,25076e-8,-78536e-9,-.13719,.001163,.20144,19008e-8,-14565e-8,-1639e-7,-76151e-8,-.15006,.0014598,.13013,-18133e-9,-16595e-8,-26e-5,50548e-9,.073115,-89218e-8,-.097071,.0016982,.048857],[17215e-8,.38846,-65903e-9,21316e-8,.13935,-13323e-8,-20532e-8,-10281e-8,-23094e-10,.14819,-22673e-8,-.040915,80807e-9,-22636e-8,-54913e-9,-27833e-8,.12757,-92678e-9,-.055125,3184e-7,15229e-8,6414e-8,-96775e-9,1837e-9,-45754e-8],[61109e-8,-65903e-9,.35838,94798e-8,-10281e-8,-14845e-9,-15306e-8,.08465,.0010105,-10222e-8,-34107e-9,-24325e-9,-.0619,2259e-7,.064114,.0010426,-83146e-9,-89249e-9,-87359e-9,-79612e-9,-63941e-8,-.077718,47262e-8,.037663,96853e-8],[.15672,17553e-8,89285e-8,.69162,27738e-8,-83992e-9,-.23513,.001773,.35838,20084e-8,-16309e-8,-18922e-8,-.0012033,-.23771,.0021601,.22071,-45266e-9,-20707e-8,-30368e-8,51592e-9,.11269,-.0014222,-.15119,.0024199,.092031],[24882e-8,.0094769,-90311e-9,30505e-8,.53203,-16443e-8,-30259e-8,-1474e-7,-17625e-9,.33037,-25437e-8,-.090134,10815e-8,-33687e-8,-10491e-8,-42944e-8,.26907,10882e-9,-.11424,4593e-7,22694e-8,89423e-9,-15092e-8,-59171e-9,-69527e-8],[-92222e-9,-14872e-8,-15659e-9,-11091e-8,-2157e-7,.3417,16689e-9,-30375e-9,-48598e-9,-84998e-9,.087448,22263e-8,-67316e-9,-4351e-8,-10367e-8,41892e-10,24221e-8,.069441,41653e-8,-.031127,10555e-8,-14221e-8,-35079e-9,-22712e-8,13486e-9],[-.14266,-18914e-8,-8919e-8,-.17176,-30667e-8,13866e-10,.4438,-21036e-8,-.17376,-27394e-8,15337e-10,86478e-9,3286e-8,.1967,-42605e-8,-.12354,-10311e-8,74302e-10,70957e-9,14004e-9,-.089046,69609e-10,.10947,-72788e-8,-.046798],[.0012135,-90311e-9,-.042955,.0018682,-1474e-7,-28181e-9,-34599e-8,.43639,.0019308,-16348e-8,-65168e-9,-36498e-9,-.15255,37109e-8,.17014,.0019167,-16223e-8,-15886e-8,-12883e-8,-11878e-8,-.0011711,-.17104,8794e-7,.098231,.0017221],[.20541,-62541e-9,95077e-8,.23881,-11243e-8,-22095e-9,-.16761,.0018385,.59489,-1414e-7,-6632e-8,-1976e-8,-.001411,-.2195,.0019884,.28939,-15078e-8,-14134e-8,-81978e-9,18392e-9,.10153,-.0017145,-.14964,.0018591,.16726],[12932e-8,.16276,-74602e-9,14876e-8,.14306,15032e-9,-20484e-8,-13808e-8,-71847e-9,.61862,12821e-8,-.082671,90833e-9,-25889e-8,-15266e-8,-35192e-8,.41002,51557e-8,-.15037,2309e-7,20645e-8,92048e-9,-14105e-8,-17511e-8,-52657e-8],[-14842e-8,-22003e-8,-35125e-9,-18659e-8,-29277e-8,-.077332,22808e-9,-68584e-9,-10973e-8,-11312e-9,.39913,4181e-7,-11415e-8,-77315e-9,-20593e-8,-51534e-9,61841e-8,.20652,82151e-8,-.087635,17692e-8,-24959e-8,-72164e-9,-43527e-8,-52264e-9],[-18098e-8,-.045053,-39744e-9,-22934e-8,-.042624,21136e-8,95729e-9,-63247e-9,-8602e-8,-.084034,43093e-8,.34299,64502e-9,20865e-9,-2296e-8,891e-7,-.08624,49619e-8,.1094,-32486e-8,10291e-8,68014e-9,-20778e-9,4026e-8,21294e-8],[-72477e-8,68217e-9,-.076931,-.0011552,1054e-7,-77841e-9,89586e-9,-.042325,-.0013635,10851e-8,-14792e-8,40949e-9,.4145,-4378e-7,-.099758,-.0015731,1016e-7,-89748e-9,12253e-8,25352e-8,97249e-8,.22552,-69284e-8,-.080646,-.0015946],[-.16753,-19196e-8,31996e-8,-.23729,-31368e-8,-52091e-9,.025255,58348e-8,-.18871,-30567e-8,-993e-7,14531e-9,-56788e-8,.47294,44567e-8,-.13302,-18374e-8,-10782e-8,-88898e-9,55598e-9,-.16661,-72129e-8,.19598,10743e-8,-.06796],[.0015377,-25959e-9,.080991,.0023032,-67475e-9,-10658e-8,-62865e-8,.021978,.0021052,-12947e-8,-22261e-8,-44344e-10,-.093965,11932e-8,.4231,.0017358,-20395e-8,-30352e-8,-34348e-9,83179e-9,-.0010386,-.18248,8454e-7,.18239,.0012725],[.14612,-32247e-8,95961e-8,.20726,-53661e-8,99127e-10,-.12473,.0018012,.099974,-51256e-8,-23151e-9,1569e-7,-.001569,-.12095,.0016626,.51792,-26493e-8,-12389e-8,1405e-7,15289e-9,.062144,-.0019548,-.12832,.0010848,.30653],[-13553e-8,.14362,-56113e-9,-19031e-8,.26223,36192e-8,32342e-9,-12864e-8,-15404e-8,.16177,83212e-8,-.090793,80524e-9,-51527e-9,-20398e-8,-10685e-8,.5881,.0013166,-.11309,-30246e-8,13275e-8,11472e-8,-86653e-9,-28441e-8,-62521e-9],[-13634e-8,93663e-10,-99665e-9,-19483e-8,13414e-8,.094062,2275e-8,-18303e-8,-1814e-7,52852e-8,-.0095829,39039e-8,-21695e-10,-687e-7,-28476e-8,-18419e-8,.0011742,.45221,90964e-8,-.064164,15775e-8,-11335e-8,-98091e-9,-44028e-8,-20584e-8],[-26444e-8,-.061956,-10478e-8,-33816e-8,-.11346,38545e-8,71931e-9,-16927e-8,-17618e-8,-.11111,81581e-8,-.087784,1556e-7,-93349e-9,-85086e-9,12929e-9,-.11722,.001052,.36706,-51528e-8,30359e-8,15566e-8,-10045e-8,39986e-9,15386e-8],[39057e-9,35566e-8,-10735e-8,45511e-9,57303e-8,-.04125,10956e-9,-17653e-8,28536e-9,45023e-8,-.0082026,-34614e-8,2897e-7,49348e-9,90994e-10,26493e-9,-1845e-8,-.068135,-56418e-8,.34248,-76252e-9,41041e-8,31322e-9,34378e-8,45599e-9],[.056827,11455e-8,-69085e-8,.12211,18667e-8,10644e-8,-.10395,-.0013113,.096197,20931e-8,19859e-8,99635e-9,.0010888,-.012363,-.0012891,.074171,20063e-8,21633e-8,29313e-8,-89983e-9,.37372,.001344,-.068601,-98811e-8,.028622],[-78321e-8,36515e-9,-.10259,-.0012578,6083e-8,-14815e-8,68033e-9,-.18576,-.0015243,80516e-9,-2866e-7,40842e-9,.015151,-52644e-8,-.12867,-.0018046,11091e-8,-24219e-8,10614e-8,34752e-8,.0011171,.49093,-79147e-8,-.10704,-.0018639],[-.074733,-63458e-9,54333e-8,-.16723,-10994e-8,-12217e-9,.12284,.0010458,-.14661,-12609e-8,-37071e-9,-85744e-10,-82189e-8,.023297,.0011035,-.097792,-11469e-8,-79587e-9,-58657e-9,11575e-9,-.066173,-.0010052,.39489,98594e-8,-.072602],[.0017706,18058e-9,.056467,.0025726,-22476e-9,-22454e-8,-96359e-8,.10296,.001999,-1281e-7,-45862e-8,4024e-8,-.089975,-30459e-8,-.034888,.0011367,-25475e-8,-51506e-8,73723e-9,39399e-8,-63475e-8,-.091869,63725e-8,.39532,3378e-7],[.015382,-41929e-8,82433e-8,.10313,-69277e-8,-13914e-9,-.021293,.0015129,.16707,-642e-6,-69987e-9,23399e-8,-.0014455,-.062138,.0012068,.064233,-28881e-8,-17e-5,24544e-8,49782e-9,.019169,-.0018323,-.061826,42494e-8,.53265]],[[.44202,40148e-8,76252e-8,.2418,69148e-8,40455e-8,-.14126,.0013649,.21217,77214e-8,85235e-8,19886e-9,-.0012121,-.16032,.0010716,.14831,66569e-8,.0011326,32045e-8,-41324e-8,.08267,-.0014352,-.11085,38083e-8,.07076],[45229e-8,.33814,35116e-8,60261e-8,.13559,56961e-8,-1892e-7,62533e-8,347e-6,.14691,.0011388,-.040013,-54973e-8,48693e-9,47693e-8,32998e-9,.1308,.0013702,-.055003,-5729e-7,-40204e-8,-63701e-8,15351e-8,11438e-8,-19864e-8],[84881e-8,35116e-8,.31037,.0011743,62533e-8,36543e-8,-42546e-8,.083721,77183e-8,73287e-8,77461e-8,-16323e-9,-.059947,-90962e-9,.064185,2282e-7,6605e-7,.0010054,18224e-8,-48082e-8,-43698e-8,-.074061,16859e-8,.038769,-24283e-8],[.14275,48067e-8,97279e-8,.65234,83274e-8,51499e-8,-.24792,.001763,.38476,95146e-8,.001086,58219e-9,-.0015491,-.2587,.0014587,.25315,8684e-7,.0014461,46617e-8,-52282e-8,.1277,-.0018599,-.17274,67351e-8,.12383],[6976e-7,-.020151,57712e-8,93453e-8,.46597,85161e-8,-2562e-7,.0010288,57539e-8,.33434,.0017116,-.090205,-90024e-8,14492e-8,79005e-8,14526e-8,.2882,.0020849,-.11926,-8542e-7,-71624e-8,-.0010416,28602e-8,19969e-8,-16291e-8],[50799e-8,64419e-8,40796e-8,70073e-8,.0010877,.29045,-24447e-8,73004e-8,45162e-8,.0011524,.088387,-18332e-9,-74621e-8,-30414e-9,49029e-8,9559e-8,86e-5,.069551,33892e-8,-.030071,-28584e-8,-95654e-8,13034e-8,-50365e-9,-25183e-8],[-.14972,-95569e-9,-26888e-8,-.17246,-14087e-8,-12882e-8,.39844,-4883e-7,-.18289,-14157e-8,-26824e-8,-15274e-8,41425e-8,.21405,-41871e-8,-.14274,-13982e-8,-35366e-8,-43473e-8,11714e-8,-.10164,48774e-8,.1279,-22877e-8,-.069111],[.001393,57712e-8,-.069385,.0019511,.0010288,60475e-8,-70159e-8,.37378,.0013518,.0012085,.0012891,-22865e-9,-.15221,-15831e-8,.17375,52832e-8,.0010931,.0016961,30878e-8,-78767e-8,-71005e-8,-.17472,28944e-8,.10817,-20149e-8],[.21974,17631e-8,49545e-8,.24148,33537e-8,25131e-8,-.17497,95633e-8,.55831,45889e-8,53359e-8,34421e-9,-80504e-8,-.24118,98187e-8,.31986,55078e-8,71787e-8,20026e-8,-25457e-8,.11901,-.001042,-.17468,82739e-8,.19955],[64423e-8,.17111,59511e-8,88397e-8,.11706,72437e-8,-20026e-8,.0010631,63029e-8,.55124,.0014769,-.077863,-92558e-8,2e-4,82453e-8,33545e-8,.43193,.0018528,-.15489,-73186e-8,-74652e-8,-.0010712,32252e-8,22032e-8,12895e-8],[98781e-8,.0011382,7974e-7,.0013641,.0019318,-.10658,-47052e-8,.0014347,88574e-8,.0020714,.32588,-28867e-9,-.0014493,-50069e-9,99971e-8,19855e-8,.0015906,.20395,60875e-8,-.084602,-5653e-7,-.0018601,26231e-8,-43029e-10,-47917e-8],[12712e-8,-.046678,62591e-9,19812e-8,-.035038,12794e-8,-21591e-8,11466e-8,10456e-8,-.079367,25635e-8,.28925,-11353e-8,-32246e-8,86519e-9,-77592e-9,-.089373,2953e-7,.11661,-1649e-7,37097e-8,-14818e-8,-15551e-8,1226e-8,-27836e-8],[-.0012036,-4853e-7,-.082189,-.001672,-86159e-8,-62776e-8,58845e-8,-.024668,-.001128,-.0010078,-.0013249,70083e-10,.35208,10162e-8,-.089757,-39213e-8,-90823e-8,-.0016976,-28732e-8,84211e-8,65765e-8,.23066,-25913e-8,-.083384,25083e-8],[-.17937,18078e-8,11703e-8,-.25832,35527e-8,96921e-9,.012463,19859e-8,-.20813,42213e-8,21008e-8,-27835e-8,-20882e-8,.42088,99087e-9,-.15339,32082e-8,28486e-8,-55112e-8,-12448e-8,-.17967,-25339e-8,.21602,-94357e-9,-.091088],[82362e-8,33316e-8,.089844,.0012299,59836e-8,27608e-8,-43865e-8,.0020521,.0010629,71118e-8,61945e-8,-12425e-9,-.082757,-14717e-8,.35835,78325e-8,65128e-8,91638e-8,18071e-8,-31766e-8,-36391e-8,-.18237,19855e-8,.19069,482e-6],[.16385,-10881e-8,-19721e-9,.23533,-11923e-8,-67339e-9,-.1446,7471e-8,.097909,15365e-9,-1373e-7,-67753e-9,-38962e-10,-.13718,41929e-8,.46334,25452e-8,-17683e-8,-24153e-8,64349e-9,.075072,-15112e-8,-.14571,89591e-8,.32201],[41159e-8,.14389,43121e-8,61134e-8,.28286,32997e-8,-12503e-8,77231e-8,57592e-8,.1543,71035e-8,-.097865,-67016e-8,11889e-8,60314e-8,53101e-8,.52683,98224e-8,-.11741,-35311e-8,-44773e-8,-77728e-8,23417e-8,1585e-7,48727e-8],[.001155,.0010941,89343e-8,.0015988,.0018833,.10731,-54556e-8,.0016309,.0010497,.0020791,-.039323,-36125e-9,-.0015922,-50256e-9,.001248,25118e-8,.0016994,.36626,57137e-8,-.050197,-66744e-8,-.0020477,31862e-8,28802e-8,-55351e-8],[57188e-8,-.060864,33962e-8,82764e-8,-.11934,54431e-8,-60614e-8,61227e-8,45791e-8,-.1136,.0010935,-.11231,-56344e-8,-6964e-7,46817e-8,-14755e-8,-.12223,.0013001,.2935,-62101e-8,58257e-8,-68794e-8,-25315e-8,10089e-8,-74315e-8],[-41535e-8,-49844e-8,-48794e-8,-5697e-7,-84098e-8,-.045268,18181e-8,-86714e-8,-36808e-8,-90085e-8,.0048159,-26568e-9,91042e-8,-1036e-8,-54623e-8,-84657e-9,-70009e-8,-.054693,-3546e-7,.2816,27527e-8,.0011728,-12969e-8,15604e-8,19055e-8],[.059634,-52659e-8,-5936e-7,.13525,-96789e-8,-34532e-8,-.12358,-.0010504,.11093,-.0011082,-73267e-8,40108e-8,97468e-8,-.0070676,-75686e-8,.091678,-87415e-8,-9757e-7,61263e-8,38215e-8,.31028,.0011655,-.063395,-11247e-8,.044566],[-.0012082,-46667e-8,-.099419,-.0017059,-82704e-8,-71353e-8,58222e-8,-.19554,-.0012378,-96785e-8,-.0015092,-10671e-9,-.0079951,88965e-9,-.12901,-59069e-8,-87487e-8,-.001942,-31624e-8,96018e-8,68344e-8,.41463,-28798e-8,-.10927,-55779e-10],[-.078503,15722e-8,1922e-7,-.18593,29636e-8,14907e-8,.14733,36705e-8,-.16959,3659e-7,32034e-8,-88382e-9,-31541e-8,.022851,36133e-8,-.11541,34724e-8,4377e-7,-10804e-8,-16181e-8,-.060452,-40633e-8,.33726,27747e-8,-.085698],[-7213e-8,-10087e-8,.057061,62398e-9,-17285e-8,-2823e-7,-23261e-9,.11613,49086e-8,-19396e-8,-52822e-8,-27229e-10,-.09956,-12264e-8,-.055426,9739e-7,-17538e-8,-45373e-8,-68199e-9,46836e-8,17883e-8,-.090157,36088e-9,.31648,.0012946],[.021411,-20532e-8,-32344e-8,.12628,-26089e-8,-31626e-8,-.031478,-46198e-8,.20041,-12018e-8,-66794e-8,-20602e-8,4717e-7,-.082611,18783e-9,.050641,1389e-7,-90184e-8,-64047e-8,311e-6,.031205,39892e-8,-.070278,80208e-8,.44958]],[[.40316,97095e-8,99913e-9,.2426,.0017327,18476e-8,-.14377,24888e-8,.22102,.001926,37541e-8,-48221e-8,-73085e-9,-.16939,52259e-8,.16682,.0014628,4507e-7,-52419e-8,-23218e-8,.09214,-97122e-9,-.12489,94897e-8,.096164],[.0011362,.29173,16858e-8,.0015704,.12614,-26681e-8,-91183e-8,28868e-8,8099e-7,.14047,-56541e-8,-.037962,-29858e-8,-78441e-8,15645e-8,-32267e-8,.12945,-68934e-8,-.053516,45284e-8,23514e-8,-36481e-8,-24425e-8,-10367e-8,-.001389],[94016e-9,16858e-8,.26716,18925e-8,28868e-8,41397e-8,43045e-9,.079058,36333e-8,30359e-8,86588e-8,-50296e-9,-.056349,15258e-8,.062593,60509e-8,21318e-8,.0010832,-15912e-9,-55893e-8,-27358e-8,-.068758,15149e-8,.039611,81559e-8],[.13228,.0011912,21105e-8,.61458,.0021277,20704e-8,-.25676,4877e-7,.40544,.0023668,42403e-8,-60166e-8,-23861e-8,-.27883,86504e-8,.28706,.0017987,51844e-8,-66642e-8,-26497e-8,.14364,-33022e-8,-.19624,.0014176,.16239],[.0017991,-.044327,24263e-8,.0024888,.39875,-42694e-8,-.0014548,41814e-8,.001284,.32241,-90188e-8,-.086415,-43464e-8,-.0012639,23471e-8,-51389e-8,.29731,-.0010909,-.12094,72633e-8,3996e-7,-53883e-8,-4006e-7,-12618e-8,-.0022086],[25674e-8,-3126e-7,48579e-8,33971e-8,-56023e-8,.24416,-16906e-8,85861e-8,15308e-8,-60345e-8,.083148,24398e-8,-90172e-8,-10389e-8,52328e-8,-96919e-9,-39941e-8,.066366,37446e-8,-.027849,-37933e-9,-.0011618,-18085e-9,-21985e-8,-29948e-8],[-.15553,-66484e-8,48584e-9,-.17521,-.0011936,-88586e-9,.358,52076e-9,-.19132,-.0013331,-18543e-8,36979e-8,-15891e-8,.22539,-15517e-8,-.16184,-.0010144,-2353e-7,45103e-8,11839e-8,-.11408,-21548e-8,.14668,-53016e-8,-.0947],[27268e-8,24263e-8,-.088784,49754e-8,41814e-8,64278e-8,-39684e-10,.31338,78126e-8,44629e-8,.001346,-78411e-9,-.14454,20367e-8,.16866,.0011645,32852e-8,.0016858,-37775e-9,-87385e-8,-47646e-8,-.17364,25643e-8,.11589,.0014901],[.23342,25287e-8,41354e-8,.25015,45307e-8,13694e-9,-.18242,85147e-8,.52822,50588e-8,38207e-9,-1339e-7,-67932e-8,-.26094,.0010563,.34555,38704e-8,76748e-9,-15547e-8,-28524e-9,.13748,-9519e-7,-.20139,.001218,.23553],[.0015629,.17568,17617e-8,.0021644,.096375,-34853e-8,-.0012751,31099e-8,.0011176,.48181,-72899e-8,-.071156,-32534e-8,-.0011204,19939e-8,-44793e-8,.43225,-85536e-8,-.15324,60764e-8,3741e-7,-42098e-8,-36246e-8,-21175e-9,-.0019251],[43525e-8,-59259e-8,89215e-8,57877e-8,-.0010587,-.12667,-2942e-7,.0015786,26763e-8,-.0011318,.25475,46455e-8,-.0016633,-19256e-8,9629e-7,-14645e-8,-73119e-8,.1852,71547e-8,-.075621,-44847e-9,-.002151,-44315e-9,-40572e-8,-47267e-8],[-37434e-8,-.047505,-62965e-10,-52655e-8,-.029068,19205e-8,34708e-8,-16352e-9,-2723e-7,-.072787,40841e-8,.24078,1898e-8,35139e-8,-24025e-9,12194e-8,-.089246,51529e-8,.11552,-29458e-8,-19634e-8,37054e-9,13786e-8,-27444e-9,50339e-8],[-18074e-9,-26265e-8,-.085672,-1184e-7,-45432e-8,-6997e-7,-17939e-8,-.011662,-48413e-8,-48715e-8,-.0014684,8619e-8,.29319,-3444e-7,-.077336,-.0010029,-35832e-8,-.0018435,43966e-9,9622e-7,47866e-8,.22235,-27469e-8,-.082705,-.0014656],[-.18869,-40897e-8,15451e-8,-.27903,-74227e-8,-1801e-8,.010647,26875e-8,-.23045,-8359e-7,-47806e-9,27181e-8,-32097e-8,.37586,11852e-8,-.17684,-63783e-8,-83842e-9,38006e-8,36067e-9,-.18524,-43396e-8,.2285,-20391e-8,-.1178],[68456e-8,14306e-9,.097378,.0010926,34138e-9,1519e-7,-37244e-8,-.0099051,.0011492,61342e-9,31987e-8,-21212e-9,-.0703,-15895e-8,.29838,.0011739,10391e-8,40281e-8,-43018e-9,-21411e-8,-29993e-8,-.17438,12637e-8,.18804,.0011534],[.18082,-86642e-8,64785e-8,.26691,-.0015476,-17429e-8,-.16604,.0012662,.11135,-.0017199,-33333e-8,44279e-8,-.0011964,-.15775,.0012444,.41926,-.0013011,-33642e-8,49739e-8,20756e-8,.090038,-.0016788,-.16346,90992e-8,.32714],[55785e-8,.13763,25212e-9,77483e-8,.29689,-48908e-9,-46339e-8,64373e-9,40257e-8,.15847,-85516e-9,-.10331,-63983e-9,-41596e-8,11121e-8,-15603e-8,.47191,-34873e-9,-.12151,12819e-8,15056e-8,-12127e-8,-14047e-8,19466e-8,-68277e-8],[35248e-8,-55084e-8,85755e-8,47792e-8,-97485e-8,.11766,-25549e-8,.0015199,24629e-8,-.0010126,-.057906,45542e-8,-.0016097,-19379e-8,92818e-8,-5331e-8,-58803e-8,.28216,72187e-8,-.034802,54857e-10,-.0020932,-68083e-9,-39288e-8,-26146e-8],[-17352e-8,-.057598,59669e-9,-25811e-8,-.12308,25212e-8,23272e-8,89262e-9,-13422e-8,-.1172,539e-6,-.12464,-89466e-9,30541e-8,12514e-9,81309e-9,-.12677,69735e-8,.22573,-36486e-8,-27295e-8,-7921e-8,15052e-8,-10931e-8,30421e-8],[-25862e-8,51177e-8,-56368e-8,-34792e-8,91816e-8,-.04813,17966e-8,-.0010017,-16985e-8,.001002,.013837,-363e-6,.0010667,12531e-8,-61424e-8,73961e-9,69895e-8,-.039143,-52955e-8,.22623,86785e-10,.0013966,29305e-9,25767e-8,2765e-7],[.063586,-58865e-9,-26679e-8,.14778,-8961e-8,-89961e-9,-.14286,-51388e-8,.12696,-87192e-9,-17072e-8,-59372e-9,4722e-7,-.013822,-4949e-7,.11081,-65395e-9,-17935e-8,-1734e-7,91599e-9,.2548,64238e-8,-.061235,-34786e-8,.063742],[-50262e-9,-25496e-8,-.091137,-19443e-8,-449e-6,-75562e-8,-19651e-8,-.20009,-6526e-7,-49898e-8,-.0015913,97489e-9,-.019618,-39953e-8,-.13108,-.0012977,-40072e-8,-.0020052,76378e-9,.0010588,58271e-8,.34342,-33172e-8,-.11132,-.0018716],[-.083624,-36825e-9,14958e-8,-.2033,-68343e-9,-24842e-9,.17179,29489e-8,-.19401,-78596e-9,-57215e-9,30952e-9,-26135e-8,.036792,31012e-8,-.13849,-61442e-9,-85831e-9,47999e-9,301e-7,-.058195,-36068e-8,.29068,26831e-8,-.10346],[.0012543,-28534e-8,.054862,.0018951,-46579e-8,-61893e-8,-91931e-8,.12817,.0015589,-42752e-8,-.0012952,65325e-9,-.10903,-72899e-8,-.060411,9776e-7,-15552e-8,-.0016209,-21023e-9,83681e-8,38409e-9,-.091029,-10858e-8,.24714,38317e-8],[.032457,-.0015601,76732e-8,.15257,-.0027899,-23378e-8,-.045992,.0014697,.23832,-.0031031,-44103e-8,81544e-8,-.0014756,-.10783,.0012929,.057873,-.0023485,-42459e-8,93693e-8,29218e-8,.047159,-.0020718,-.083996,63964e-8,.37707]],[[.3697,-30446e-8,-4065e-7,.24299,-59382e-8,33247e-8,-.14569,-85327e-8,.22625,-7804e-7,73048e-8,20374e-8,77063e-8,-.17607,-.0010365,.17805,-83589e-8,.001,29869e-8,-47461e-8,.099396,.0011748,-.13548,-.0011391,.11219],[-35032e-8,.25386,3102e-7,-5267e-7,.12027,-30093e-9,32853e-8,57574e-8,-38838e-8,.13811,-74718e-9,-.037067,-59737e-8,3536e-7,43568e-8,-16076e-8,.13004,-10179e-8,-.053062,10783e-8,-19978e-8,-82269e-8,16926e-8,45257e-9,53777e-9],[-44376e-8,3102e-7,.23031,-72294e-8,57574e-8,-72904e-9,34717e-8,.074327,-74323e-8,69448e-8,-17593e-8,-15131e-8,-.053923,32344e-8,.060797,-72093e-8,62878e-8,-28841e-8,-16626e-8,11188e-8,-68783e-9,-.06503,10986e-8,.038773,-67862e-8],[.12654,-42486e-8,-65718e-8,.57902,-84164e-8,42558e-8,-.26151,-.0013736,.41584,-.0011388,93683e-8,27494e-8,.0012288,-.29399,-.0016621,.30941,-.0012766,.0012865,39518e-8,-60965e-8,.15666,.0018564,-.21509,-.0018214,.18901],[-62454e-8,-.055853,51208e-8,-95467e-8,.34562,-63609e-9,57698e-8,95223e-8,-7567e-7,.31076,-15532e-8,-.082956,-98858e-8,618e-6,72521e-8,-41328e-8,.30407,-21636e-8,-.12246,19716e-8,-3358e-7,-.0013653,29093e-8,85656e-9,-79485e-9],[4825e-7,-33332e-9,-79314e-9,69336e-8,-70246e-9,.20569,-38427e-8,-16053e-8,44261e-8,-83185e-9,.078463,10196e-8,16292e-8,-3393e-7,-17043e-8,3877e-8,-55662e-9,.06655,22543e-8,-.027371,10353e-8,24637e-8,-11319e-8,-16473e-8,-38307e-8],[-.15991,27171e-8,29848e-8,-.17891,52488e-8,-21653e-8,.32263,60879e-8,-.19613,67421e-8,-47791e-8,-18349e-8,-57312e-8,.23028,67324e-8,-.17356,68565e-8,-65015e-8,-27301e-8,3345e-7,-.12439,-856e-6,.16139,62866e-8,-.11227],[-92951e-8,51208e-8,-.098996,-.0015071,95223e-8,-14003e-8,70352e-8,.26128,-.0015426,.0011521,-34786e-8,-25274e-8,-.13474,62773e-8,.15825,-.0014912,.0010488,-59734e-8,-28149e-8,20673e-8,-82478e-9,-.17063,19294e-8,.11733,-.0013982],[.24156,-24086e-8,-66378e-8,.2564,-51657e-8,15208e-8,-.18573,-.0013828,.49644,-80043e-8,33875e-8,11908e-8,.0011916,-.27206,-.0016966,.35685,-.0010745,47968e-8,13629e-8,-20874e-8,.15147,.0017655,-.22144,-.0019126,.26152],[-7177e-7,.18121,49785e-8,-.0011317,.090331,-66544e-9,63446e-8,92905e-8,-.0010175,.42494,-16538e-8,-.066305,-95819e-8,66307e-8,72193e-8,-77331e-8,.42033,-24369e-8,-.14902,19542e-8,-31264e-8,-.0013248,29505e-8,12229e-8,-51483e-8],[9415e-7,-84164e-9,-17683e-8,.0013555,-17397e-8,-.13363,-75394e-8,-37048e-8,87065e-8,-21096e-8,.19926,20745e-8,35368e-8,-67092e-8,-44269e-8,86667e-9,-16182e-8,.16687,4482e-7,-.067643,21407e-8,54566e-8,-22532e-8,-50571e-8,-73446e-8],[22322e-8,-.048633,-87731e-9,33044e-8,-.027025,11534e-8,-20901e-8,-16532e-8,2236e-7,-.067894,25544e-8,.19994,19821e-8,-22571e-8,-11109e-8,38687e-9,-.087588,34744e-8,.11058,-18469e-8,13839e-8,29783e-8,-1083e-7,36999e-9,-16359e-8],[83245e-8,-54546e-8,-.088847,.001337,-.0010144,1496e-7,-65871e-8,-.0063706,.0013149,-.0012207,35485e-8,29532e-8,.24337,-61645e-8,-.065953,.0011873,-.0010925,5679e-7,36408e-8,-21708e-8,14896e-8,.20688,-21619e-8,-.076746,.0010215],[-.1933,25762e-8,22894e-8,-.29359,4944e-7,-12542e-8,.016062,44798e-8,-.24811,62358e-8,-27931e-8,-17628e-8,-44527e-8,.33781,42411e-8,-.19464,60442e-8,-37406e-8,-26689e-8,22608e-8,-.1848,-6451e-7,.23197,26496e-8,-.13757],[-.0011136,21496e-8,.10248,-.0017987,40435e-8,-13645e-8,76256e-8,-.015238,-.0018685,50395e-8,-3712e-7,-92689e-9,-.058153,58826e-8,.24457,-.0018623,48933e-8,-72148e-8,-84416e-9,17988e-8,11055e-8,-.15928,10655e-8,.17395,-.0018068],[.18695,-28704e-9,-62528e-8,.2843,-1325e-7,-19342e-8,-.17883,-.0013007,.12466,-38164e-8,-41889e-8,-82037e-9,.0010589,-.17164,-.0016392,.3805,-78713e-8,-54502e-8,-21604e-8,3054e-7,.1009,.0015273,-.17467,-.0019363,.32325],[-66997e-8,.12767,28303e-8,-.0011063,.3033,-2635e-8,52504e-8,53342e-8,-.0011781,.16978,-78278e-9,-.10659,-53076e-8,49742e-8,4449e-7,-.0011934,.42495,-14896e-8,-.12431,86754e-9,-11366e-8,-72911e-8,17698e-8,15633e-8,-.0011587],[.0010358,-97778e-9,-27085e-8,.0014964,-2058e-7,.12771,-82475e-8,-59464e-8,97995e-8,-26377e-8,-.057901,22639e-8,51877e-8,-72925e-8,-81466e-8,14e-5,-23822e-8,.21853,48546e-8,-.025236,22561e-8,82354e-8,-23458e-8,-.0010738,-74341e-8],[29165e-8,-.053233,-17349e-9,42366e-8,-.12458,22962e-8,-27711e-8,-36742e-9,25499e-8,-.12114,50413e-8,-.12471,97552e-9,-30307e-8,6216e-9,-397e-7,-.12984,6854e-7,.17263,-33533e-8,2025e-7,18781e-8,-14821e-8,11522e-8,-37873e-8],[-59701e-8,15949e-8,12838e-8,-86077e-8,30614e-8,-.051393,51186e-8,25347e-8,-53689e-8,36596e-8,.01486,-18584e-8,-24731e-8,49493e-8,25594e-8,-81601e-10,3032e-7,-.029642,-34748e-8,.18071,-22618e-8,-35744e-8,19816e-8,21694e-8,54758e-8],[.065877,-12584e-8,-40058e-10,.15509,-23451e-8,-28281e-9,-.15801,30981e-9,.1386,-26931e-8,-56633e-9,10533e-8,27187e-9,-.0287,1875e-7,.12577,-19496e-8,-86406e-9,18128e-8,-20545e-9,.21177,42194e-10,-.062911,45903e-8,.080377],[.0012247,-63944e-8,-.080771,.0019515,-.0011922,21149e-8,-94651e-8,-.20002,.0018873,-.0014352,50942e-8,37108e-8,-.020502,-85716e-8,-.13306,.0016603,-.0012794,8382e-7,48757e-8,-29208e-8,16085e-8,.28359,-28202e-8,-.10975,.0013765],[-.086589,69317e-9,-4755e-8,-.21319,11977e-8,95566e-10,.1902,-11179e-8,-.21175,11692e-8,22413e-9,-49254e-9,73957e-9,.057113,-18954e-8,-.15899,45834e-9,43471e-9,-76457e-9,89291e-10,-.059278,11824e-8,.25426,-30213e-8,-.12042],[-.0011904,-31552e-8,.047495,-.0019194,-57784e-8,-15623e-8,69871e-8,.1307,-.0020526,-66467e-8,-44682e-8,20376e-8,-.11135,39305e-8,-.059026,-.0021515,-52885e-8,-92251e-8,29328e-8,17116e-8,42264e-8,-.086715,-65963e-9,.18866,-.0021962],[.03526,62267e-9,-57369e-8,.16194,43163e-9,-44176e-8,-.052454,-.0011912,.26243,-17322e-8,-96537e-8,-21713e-8,91984e-8,-.12386,-.0015342,.076072,-61591e-8,-.0012872,-48821e-8,67944e-8,.059606,.0012904,-.095965,-.0018767,.32546]],[[.33938,13333e-8,-27637e-8,.24211,27273e-8,-51689e-8,-.1462,-52298e-8,.2318,38753e-8,-.0012045,-871e-7,54413e-8,-.18091,-42838e-8,.19241,46006e-8,-.0018644,-13072e-8,68563e-8,.10499,77272e-8,-.14509,-13652e-8,.13474],[15382e-8,.21796,-48112e-8,24382e-8,.10768,-26877e-8,-14304e-8,-94626e-8,21766e-8,.12788,-5806e-7,-.034082,88342e-8,-15992e-8,-95152e-8,15509e-8,.124,-76218e-8,-.049857,39486e-8,90239e-9,.0012554,-85679e-9,-71192e-8,75991e-9],[-34153e-8,-48112e-8,.1982,-4981e-7,-94626e-8,33417e-9,28501e-8,.068396,-33669e-8,-.0012887,86208e-9,18188e-8,-.050765,27071e-8,.059043,-77048e-9,-.0014584,15724e-8,13649e-8,-43358e-9,-94499e-9,-.061338,12389e-8,.040115,1849e-7],[.12487,20462e-8,-34994e-8,.54835,41838e-8,-73107e-8,-.2635,-66975e-8,.42539,59568e-8,-.0017087,-12712e-8,69183e-8,-.3065,-57578e-8,.33603,71043e-8,-.0026584,-18384e-8,97061e-8,.16787,9947e-7,-.23347,-24999e-8,.22589],[30504e-8,-.065722,-8759e-7,48332e-8,.29053,-40635e-8,-27625e-8,-.0017279,43498e-8,.28367,-87603e-8,-.075317,.0016094,-30128e-8,-.0017555,31742e-8,.29583,-.0011415,-.11762,60551e-8,15676e-8,.0022946,-15672e-8,-.0013486,1674e-7],[-74739e-8,-34447e-8,35437e-9,-.0011371,-62934e-8,.17159,53669e-8,78023e-9,-96178e-8,-73026e-8,.068783,18185e-8,-63909e-9,4302e-7,11022e-8,-62653e-8,-6022e-7,.061316,21896e-8,-.024637,11288e-9,-10139e-8,13111e-8,14754e-8,-22012e-8],[-.16253,-11838e-8,1884e-7,-.18373,-23735e-8,27898e-8,.29214,36102e-8,-.20202,-323e-6,65273e-8,87009e-9,-37469e-8,.23063,30903e-8,-.18706,-35632e-8,.0010127,13901e-8,-38227e-8,-.13163,-54106e-8,.17343,12538e-8,-.13421],[-5519e-7,-8759e-7,-.10261,-8133e-7,-.0017279,74819e-9,46529e-8,.21712,-57479e-8,-.0023654,19078e-8,33243e-8,-.12286,45054e-8,.14679,-18678e-8,-.0026981,3416e-7,25214e-8,-98342e-9,-1654e-7,-.16528,2139e-7,.12026,20233e-8],[.25108,16471e-8,-12109e-8,.27143,33878e-8,-51542e-8,-.19196,-25426e-8,.47751,49367e-8,-.0012177,-76954e-9,24412e-8,-.28338,-30216e-8,.37092,61352e-8,-.0019322,-84209e-9,67926e-8,.16422,38435e-8,-.24084,-3295e-7,.29162],[40992e-8,.1791,-.0010705,65031e-8,.082773,-31298e-8,-3509e-7,-.0021227,5994e-7,.36873,-66838e-8,-.05962,.0019652,-36224e-8,-.0021968,46604e-8,.39387,-84539e-8,-.13904,48462e-8,15136e-8,.0028141,-17577e-8,-.0017682,29101e-8],[-.0016052,-61728e-8,95579e-9,-.0024497,-.0011257,-.13547,.0011546,20749e-8,-.0020936,-.0012975,.14856,33912e-8,-17422e-8,93045e-8,28161e-8,-.0014012,-.0010495,.13788,42547e-8,-.05519,19491e-9,-27308e-8,28765e-8,35897e-8,-55487e-8],[-99164e-9,-.047706,60748e-9,-15085e-8,-.024335,69083e-9,10335e-8,12247e-8,-10849e-8,-.061059,15574e-8,.16463,-12586e-8,12331e-8,12268e-8,-28924e-9,-.082717,21893e-8,.10015,-11194e-8,-8697e-8,-19384e-8,69805e-9,84571e-9,63608e-9],[61047e-8,78452e-8,-.089851,89543e-8,.0015454,-58137e-9,-5143e-7,-.005483,61809e-8,.0021067,-15007e-8,-31088e-8,.20145,-4961e-7,-.058199,1652e-7,.0023843,-27251e-8,-25912e-8,78598e-9,18378e-8,.18696,-2322e-7,-.073902,-29881e-8],[-.19593,-11584e-8,12614e-8,-.30567,-22732e-8,99577e-9,.027499,2488e-7,-.26654,-29537e-8,23728e-8,91578e-9,-25518e-8,.30929,2352e-7,-.21581,-29879e-8,37229e-8,15077e-8,-15594e-8,-.18062,-38118e-8,.23232,14091e-8,-.16201],[-20294e-8,-72266e-8,.10655,-32853e-8,-.0014413,10961e-8,18175e-8,-.01145,-32346e-8,-.002013,27208e-8,2669e-7,-.051436,19917e-8,.20487,-30157e-8,-.0023681,46751e-8,1902e-7,-1448e-7,-88264e-9,-.14692,11663e-8,.16128,-29419e-8],[.19817,91305e-9,13336e-8,.31025,19183e-8,-20506e-8,-.19601,20786e-8,.15428,30098e-8,-50635e-8,27028e-10,-2617e-7,-.1927,-33449e-10,.36026,41974e-8,-86838e-8,66831e-9,25657e-8,.11411,-31197e-8,-.1888,-43534e-8,.31928],[44894e-8,.11462,-.001051,71425e-8,.30023,-34528e-9,-3486e-7,-.0021005,68528e-8,.18342,-57004e-9,-.10716,.0019221,-32249e-8,-.0022397,58605e-8,.39167,-81808e-10,-.12622,91263e-9,63144e-9,.0027677,-13227e-8,-.0019345,44583e-8],[-.0022133,-5432e-7,18372e-8,-.003395,-9823e-7,.13079,.0015892,39141e-8,-.0029564,-.0011025,-.055007,33035e-8,-33673e-8,.0012824,50444e-8,-.0020753,-82452e-8,.16353,45353e-8,-.015618,37776e-9,-51807e-8,39802e-8,60128e-8,-98184e-8],[-12904e-8,-.047295,-15155e-8,-18928e-8,-.12151,11037e-9,14423e-8,-29272e-8,-10758e-8,-.12225,3917e-8,-.11865,24504e-8,17751e-8,-3012e-7,35895e-9,-.13131,8655e-8,.12962,-38289e-9,-13811e-8,31558e-8,10259e-8,-25319e-8,19752e-8],[81682e-8,41613e-8,-43288e-9,.0012462,76637e-8,-.051606,-60466e-8,-95489e-9,.0010539,90114e-8,.015796,-23273e-8,81973e-9,-50966e-8,-13213e-8,68094e-8,7628e-7,-.019079,-29851e-8,.14176,41469e-9,13253e-8,-17558e-8,-1706e-7,22654e-8],[.068688,6431e-8,24013e-9,.16087,11801e-8,20148e-8,-.16877,35621e-9,.14904,12873e-8,46473e-8,-65248e-9,-36497e-9,-.047843,23943e-10,.13991,79721e-9,7197e-7,-11766e-8,-2331e-7,.17976,-30341e-9,-.069454,-50757e-9,.097775],[71936e-8,9656e-7,-.069785,.001069,.0019093,-91666e-9,-61423e-8,-.19608,77783e-8,.0026165,-23325e-8,-39541e-8,-.014194,-60713e-8,-.1378,29088e-8,.0029827,-41365e-8,-35173e-8,1267e-7,24023e-8,.23924,-29585e-8,-.11498,-21214e-8],[-.091135,-16788e-9,5147e-8,-.2222,-28598e-9,-84955e-9,.2047,10151e-8,-.22818,-24611e-9,-1984e-7,19606e-9,-99587e-9,.083339,98436e-9,-.18086,2.5708e-7,-31285e-8,36666e-9,10063e-8,-.065865,-14565e-8,.23194,61992e-9,-.14079],[33703e-8,-31046e-8,.042786,42621e-8,-6492e-7,14648e-8,-27355e-8,.13605,74611e-9,-98486e-8,35348e-8,91197e-9,-.11806,-2263e-7,-.043261,-46585e-8,-.0013,5814e-7,23848e-9,-19158e-8,75866e-9,-.094091,-67492e-9,.15119,-.0010431],[.049763,15764e-9,25546e-8,.18481,3964e-8,88669e-9,-.067998,42573e-8,.29301,96758e-9,1717e-7,74907e-9,-5189e-7,-.14755,11117e-8,.10827,20384e-8,15821e-8,19734e-8,-14462e-8,.075987,-67251e-8,-.11483,-56106e-8,.29147]],[[.31363,-41101e-8,53517e-9,.24148,-81202e-8,23273e-8,-.147,36807e-9,.23417,-.0010772,58812e-8,29418e-8,-46975e-9,-.18483,-17434e-8,.19896,-.0011403,.0010566,45549e-8,-25734e-8,.10964,67167e-9,-.15213,-53544e-8,.14545],[-51527e-8,.19046,20222e-8,-78816e-8,.10169,24513e-8,50206e-8,43499e-8,-60158e-8,.12481,52734e-8,-.033124,-32469e-8,56687e-8,60977e-8,-24747e-8,.12357,71933e-8,-.049267,-26743e-8,-32219e-8,-47777e-8,3205e-7,8151e-7,16694e-8],[12129e-8,20222e-8,.17107,11911e-8,43499e-8,-85475e-9,-31851e-9,.062795,-7016e-8,69824e-8,-21551e-8,-19332e-9,-.048365,75361e-9,.056424,-33496e-8,98882e-8,-35721e-8,77751e-9,16866e-8,-16816e-8,-.058979,12642e-8,.038952,-60143e-8],[.12617,-57528e-8,-49614e-9,.52022,-.0011369,39165e-8,-.26331,-19226e-8,.42636,-.0015154,97857e-8,38822e-8,16688e-8,-.31495,-48291e-8,.3489,-.001623,.0017216,5782e-7,-45565e-8,.17701,42577e-8,-.24717,-91837e-8,.24574],[-93034e-8,-.064638,4467e-7,-.0014232,.2536,34399e-8,87887e-8,94768e-8,-.0011031,.26675,73335e-8,-.070658,-74521e-8,96546e-8,.0012639,-49521e-8,.29184,99138e-8,-.11537,-34817e-8,-50443e-8,-.0010977,52891e-8,.0015908,21612e-8],[28975e-8,33393e-8,-96852e-9,48711e-8,60873e-8,.14458,-13859e-8,-20809e-8,59526e-8,73448e-8,.06217,-48062e-9,2406e-7,-4176e-8,-22413e-8,72625e-8,68815e-8,.060039,1153e-7,-.0241,-19933e-8,41336e-8,29679e-9,-17256e-8,82785e-8],[-.16417,37565e-8,95406e-9,-.18898,72766e-8,-74836e-9,.26692,22552e-8,-.20549,93949e-8,-20414e-8,-23063e-8,-23971e-8,.22812,31544e-8,-.1937,95554e-8,-4162e-7,-31512e-8,52811e-9,-.1363,-4426e-7,.18098,38961e-8,-.14614],[17306e-9,4467e-7,-.10092,-89715e-9,94768e-8,-18624e-8,93328e-9,.1807,-37553e-8,.0014834,-46275e-8,-7699e-8,-.1111,2634e-7,.1325,-75346e-8,.0020386,-75819e-8,89057e-9,34369e-8,-31126e-8,-.15799,27604e-8,.11556,-.0011219],[.25367,-29197e-8,-31992e-8,.2797,-58706e-8,48483e-8,-.19405,-69142e-8,.45488,-82095e-8,.001177,14757e-8,62707e-8,-.28743,-89643e-8,.37172,-96186e-8,.0019564,17162e-8,-63432e-8,.17251,.0010063,-.2527,-.0010748,.30696],[-.0010337,.17852,73966e-8,-.0015876,.08755,247e-6,92589e-8,.001541,-.0012804,.33134,51567e-8,-.056696,-.0012947,9693e-7,.0019145,-68737e-8,.37037,6814e-7,-.13175,-20737e-8,-4202e-7,-.0019102,50205e-8,.0021826,10906e-9],[77306e-8,55917e-8,-25475e-8,.0012775,.0010114,-.12865,-42263e-8,-53764e-8,.0014708,.0012114,.11512,-37407e-9,5976e-7,-21176e-8,-5721e-7,.0016764,.0011281,.11844,30404e-8,-.047719,-38947e-8,99724e-8,374e-8,-43967e-8,.0018042],[35095e-8,-.047367,46489e-9,51691e-8,-.025226,12056e-8,-29071e-8,80985e-9,36127e-8,-.058053,28332e-8,.13652,-11437e-8,-26834e-8,20468e-9,95741e-9,-.079582,41831e-8,.08966,-22776e-8,71205e-9,-17042e-8,-10649e-8,-1175e-7,-1975e-7],[-20886e-9,-27094e-8,-.089692,76135e-9,-59833e-8,22642e-8,-12201e-8,-.0084482,31949e-8,-.0010051,55144e-8,-13828e-9,.16915,-32414e-8,-.052153,62607e-8,-.0014978,8743e-7,-20102e-8,-41577e-8,40043e-8,.16776,-32617e-8,-.067064,91082e-8],[-.19592,33672e-8,24777e-8,-.31235,63843e-8,36841e-9,.041285,50228e-8,-.27931,80155e-8,67902e-9,-1613e-7,-53484e-8,.28773,4977e-7,-.23054,7834e-7,38558e-9,-16209e-8,-92233e-9,-.17457,-84217e-8,.22892,3281e-7,-.17829],[-53338e-8,68132e-8,.10645,-89894e-8,.0013983,-18669e-8,44845e-8,-.007567,-9981e-7,.0020511,-45789e-8,-24116e-8,-.044536,48119e-8,.16977,-.0010721,.0025859,-75462e-8,-16352e-8,29275e-8,-16821e-8,-.13042,28627e-8,.14167,-.001116],[.19758,11229e-8,-56847e-8,.31717,1954e-7,55568e-8,-.20212,-.0011413,.17323,17001e-8,.0013154,-16545e-8,.0010217,-.204,-.0012566,.34107,-62759e-10,.0020696,-33049e-8,-79975e-8,.12255,.0014647,-.1964,-.001194,.31157],[-79257e-8,.10212,.0010424,-.0012342,.29167,36944e-9,63214e-8,.0021379,-.0010948,.19632,5963e-8,-.10615,-.0019008,58818e-8,.0024813,-79718e-8,.36644,50026e-9,-.1277,31289e-9,-10946e-8,-.0028105,26101e-8,.0025254,-43315e-8],[.0014898,46433e-8,-41705e-8,.0024096,82563e-8,.13259,-94155e-8,-86901e-8,.002555,9719e-7,-.041282,44921e-9,91805e-8,-65006e-8,-9323e-7,.0026071,88969e-8,.13126,44808e-8,-.013553,-40724e-8,.001486,-17593e-8,-75507e-8,.0025091],[41859e-8,-.042133,23062e-8,59588e-8,-.11749,40682e-8,-29089e-8,45331e-8,38224e-8,-.12324,92864e-8,-.10748,-46171e-8,-19069e-8,42452e-8,44434e-9,-.1327,.001338,.099632,-65792e-8,-81039e-9,-68567e-8,-23324e-10,23859e-8,-30934e-8],[-20477e-8,-18918e-8,23108e-8,-36868e-8,-32215e-8,-.052357,40246e-9,47061e-8,-55055e-8,-36239e-8,.010402,-91112e-9,-52555e-8,-81005e-9,45227e-8,-80463e-8,-31958e-8,-.017613,-37083e-8,.11385,29881e-8,-8453e-7,-10644e-8,25635e-8,-.0010424],[.070773,-13904e-8,-32558e-8,.16356,-23926e-8,-2213e-7,-.17425,-61284e-8,.1558,-25608e-8,-52461e-8,-9.537e-7,66974e-8,-.06671,-45871e-8,.14993,-18182e-8,-82728e-8,-1138e-7,31716e-8,.15713,96922e-8,-.077784,8.8884e-7,.11179],[33757e-8,-38402e-8,-.059394,64421e-8,-84014e-8,3727e-7,-45108e-8,-.18799,82986e-8,-.0013897,89475e-8,-4.7474e-7,-.0041612,-69089e-8,-.1388,99795e-8,-.0020381,.0013971,-23956e-8,-64896e-8,59044e-8,.20779,-54188e-8,-.11449,.0011069],[-.094363,28314e-9,99717e-9,-.22618,4212e-8,99806e-9,.21228,19137e-8,-.23799,32568e-9,23459e-8,21108e-9,-21177e-8,.10733,15223e-8,-.19737,20976e-10,36229e-8,80665e-9,-14877e-8,-.073989,-31651e-8,.21727,21217e-9,-.15805],[-.0011939,91547e-8,.0339,-.001848,.0018285,-10146e-8,81456e-8,.12917,-.0016949,.0025287,-24643e-8,-46318e-8,-.11427,6066e-7,-.033049,-.0013819,.0029092,-4337e-7,-55738e-8,73783e-9,17608e-8,-.090871,17404e-8,.12049,-.0010266],[.0528,42988e-8,-66133e-8,.18711,80881e-8,51955e-8,-.072458,-.0012989,.30275,95112e-8,.0012079,-38218e-8,.0011314,-.15757,-.0013723,.13589,76198e-8,.0018195,-64908e-8,-80352e-8,.086229,.0015389,-.12785,-.0012231,.27476]],[[.29045,-19386e-8,33846e-8,.24015,-30362e-8,79368e-9,-.1471,72776e-8,.23683,-21266e-8,11931e-8,10437e-8,-6044e-7,-.18797,97645e-8,.20739,12741e-8,-3.0863e-7,11287e-8,-99209e-9,.11372,-93099e-8,-.15887,.0012408,.15985],[-33292e-8,.16481,12625e-8,-4302e-7,.091774,-1032e-7,27397e-8,19551e-8,-10452e-8,.11645,-22452e-8,-.030856,-23047e-8,22894e-8,-4.156e-7,40487e-8,.11854,-28269e-8,-.047069,18907e-8,-81065e-9,-25071e-8,51118e-9,-40697e-8,95421e-8],[38016e-8,12625e-8,.14747,63746e-8,19551e-8,-11345e-8,-2503e-7,.056524,73849e-8,13353e-8,-21944e-8,-46073e-9,-.044907,-19615e-8,.053296,84981e-8,-92775e-9,-20869e-8,-15926e-9,16279e-8,-87622e-9,-.05557,-90548e-9,.038687,94219e-8],[.12996,-1008e-7,57366e-8,.49704,-89492e-9,-4.3725e-7,-.26233,.0012225,.42788,15476e-8,-98236e-9,63941e-9,-.0010361,-.32219,.0015939,.36383,67869e-8,-42181e-8,64931e-9,20211e-9,.18558,-.0015887,-.26073,.001951,.27055],[-3125e-7,-.06335,8656e-8,-33772e-8,.21756,-14365e-8,26579e-8,69326e-9,16977e-8,.24287,-30651e-8,-.064279,-14379e-8,20183e-8,-29677e-8,9364e-7,.27887,-3605e-7,-.10989,28118e-8,-10104e-8,-47922e-9,-69226e-10,-97369e-8,.001743],[28667e-8,-14912e-8,-18702e-8,37142e-8,-27616e-8,.12097,-20976e-8,-31949e-8,10624e-8,-3139e-7,.052814,13161e-8,36107e-8,-14092e-8,-12854e-8,-31256e-8,-22636e-8,.05411,23135e-8,-.021404,-69653e-10,458e-6,83242e-10,29954e-8,-77938e-8],[-.16479,54774e-9,-17635e-8,-.19487,62772e-9,22013e-9,.24652,-38361e-8,-.21044,-30252e-9,92824e-9,-36722e-9,29275e-8,.22523,-54734e-8,-.20198,-24616e-8,25528e-8,-44489e-9,-46544e-9,-.13974,4417e-7,.18724,-75543e-8,-.16031],[84634e-8,8656e-8,-.096328,.0014031,69326e-9,-96532e-9,-57623e-8,.15046,.001569,-15503e-8,-14429e-8,-14165e-9,-.09869,-47007e-8,.11873,.0017271,-63031e-8,76602e-10,52303e-9,13956e-8,-13941e-8,-.14787,-22188e-8,.11125,.0018375],[.25746,39376e-8,68788e-8,.29354,84694e-8,-29521e-8,-.19924,.0014372,.44269,.0013247,-7664e-7,-18164e-8,-.0012845,-.29378,.001743,.3764,.0018012,-.0013953,-21411e-8,42942e-8,.18087,-.0019587,-.26486,.0019128,.32349],[24354e-8,.17281,-20233e-8,53579e-8,.089972,-60847e-9,-17272e-8,-53103e-8,97191e-8,.2982,-1086e-7,-.053558,41438e-8,-21374e-8,-99896e-8,.0015633,.34482,-40383e-9,-.12373,17149e-8,-20413e-9,81243e-8,-22345e-8,-.0016922,.002134],[33741e-8,-25173e-8,-23102e-8,36699e-8,-45932e-8,-.12087,-2287e-7,-35189e-8,-14622e-8,-49631e-8,.085425,24982e-8,44699e-8,-92711e-9,43156e-9,-92808e-8,-29431e-8,.094375,46004e-8,-.037718,-62161e-9,50714e-8,12375e-8,84243e-8,-.001782],[-44085e-9,-.045788,69947e-9,-80966e-9,-.02565,76953e-9,28161e-9,15138e-8,-114e-6,-.054933,17899e-8,.1136,-14572e-8,2408e-8,19016e-8,-15699e-8,-.075974,25944e-8,.078971,-14462e-8,13622e-9,-24071e-8,16391e-9,21318e-8,-19717e-8],[-60683e-8,-13574e-8,-.087044,-.0010229,-17505e-8,15339e-8,37017e-8,-.011445,-.0012176,-11982e-9,28185e-8,31503e-9,.14218,25236e-8,-.047953,-.0014527,39824e-8,21762e-8,-3954e-8,-21997e-8,22431e-8,.14755,91709e-9,-.062981,-.0016681],[-.19604,-88342e-9,-69582e-9,-.31846,-19448e-8,136e-6,.057827,-15664e-8,-.29254,-31688e-8,34247e-8,31302e-9,83448e-9,.27546,-2666e-7,-.24727,-4532e-7,59049e-8,24414e-9,-21155e-8,-.17065,10994e-8,.22808,-44386e-8,-.19708],[.0012459,-37507e-8,.10482,.002017,-83384e-8,26734e-8,-92596e-8,-39943e-8,.0020711,-.0013628,6843e-7,19743e-8,-.041372,-83657e-8,.14487,.0020101,-.0019481,.0012222,27478e-8,-37889e-8,2116e-8,-.11804,-42826e-8,.12604,.0018552],[.20181,91367e-8,77771e-8,.33038,.00182,-6184e-7,-.21156,.0015965,.20056,.0025104,-.0014899,-44294e-8,-.001503,-.22048,.0017973,.33501,.0028789,-.0024249,-51249e-8,87227e-8,.1332,-.0022881,-.20773,.0017181,.30767],[.0011846,.090921,-68709e-8,.0019608,.27976,13415e-8,-92284e-8,-.0014981,.0021129,.20873,34383e-8,-.10405,.0013388,-90885e-8,-.0019949,.0021747,.35291,63742e-8,-.12963,-1305e-7,13964e-8,.0021713,-54773e-8,-.0024732,.0021122],[-21634e-8,-14533e-8,92864e-9,-54784e-8,-23808e-8,.12853,22216e-8,31995e-8,-.0011178,-15997e-8,-.031125,23098e-8,-17508e-8,37336e-8,82619e-8,-.0019099,15368e-8,.10421,48221e-8,-.01043,-18391e-8,-44737e-8,41755e-8,.0016355,-.0027269],[-26734e-8,-.037612,23219e-8,-39272e-8,-.11244,1239e-7,20125e-8,45644e-8,-28285e-8,-.12357,29748e-8,-.094137,-46538e-8,16555e-8,4268e-7,-94726e-9,-.1347,45836e-8,.079807,-23167e-8,-89577e-10,-69224e-8,54434e-9,23575e-8,11938e-8],[-18904e-8,23937e-8,16051e-8,-20847e-8,454e-6,-.050161,11755e-8,25999e-8,64079e-9,54247e-8,.0080357,-21963e-8,-30953e-8,30322e-9,43752e-9,47663e-8,44747e-8,-.013477,-39561e-8,.090187,67312e-9,-37214e-8,-86365e-9,-41222e-8,92463e-8],[.074596,18043e-8,-18927e-8,.16779,32798e-8,-18207e-8,-.17772,-39237e-8,.1633,37715e-8,-40984e-8,-78995e-9,39768e-8,-.086576,-42944e-8,.1596,30001e-8,-57962e-8,-70109e-9,27513e-8,.1438,63364e-8,-.089728,-37077e-8,.12485],[-9118e-7,58168e-9,-.049475,-.0015219,23785e-8,38495e-9,56294e-8,-.17617,-.0017657,61966e-8,-37834e-10,-78528e-9,.0050053,38663e-8,-.13813,-.0020483,.001232,-2705e-7,-19727e-8,-56402e-9,31636e-8,.18438,13442e-8,-.11671,-.0023007],[-.099706,-35423e-9,64061e-9,-.23182,-65586e-9,85321e-9,.21754,12907e-8,-.24796,-79844e-9,19928e-8,11406e-9,-1432e-7,.13193,12082e-8,-.21392,-74321e-9,30357e-8,34169e-10,-12832e-8,-.085603,-22861e-8,.21236,60459e-9,-.17638],[.0016477,-.0010298,.028378,.0026151,-.0020929,75964e-8,-.0013266,.12467,.0024708,-.0029939,.0017874,48445e-8,-.11351,-.0013014,-.017793,.002053,-.0036317,.0027874,55021e-8,-.00108,32505e-8,-.09551,-71119e-8,.1028,.0014826],[.064155,.0011563,76615e-8,.1999,.0022549,-80822e-8,-.083472,.0015552,.31614,.0029892,-.0019024,-56956e-8,-.0015247,-.1724,.001654,.16657,.0032106,-.0029779,-65872e-8,.0011248,.098179,-.0023275,-.14457,.0013883,.26835]],[[.27052,-.001436,24056e-9,.23917,-.0028499,-54443e-8,-.14703,24454e-9,.23882,-.0038187,-.0012727,.0010131,23912e-9,-.18998,-64801e-10,.2139,-.0040951,-.0019369,.0016263,83273e-8,.11631,12545e-8,-.16369,-33997e-9,.17142],[-.0019515,.14345,-57781e-8,-.0029966,.08358,32768e-9,.0018556,-.0011404,-.0023531,.10912,50985e-9,-.028823,.0011654,.002111,-.0010782,-.0010762,.11366,29823e-9,-.044832,1348e-8,-.001189,.0017445,.0013382,-62124e-8,52216e-8],[59075e-9,-57781e-8,.12778,65753e-9,-.0011404,-37678e-8,33153e-9,.051499,24357e-9,-.001528,-87548e-8,34631e-8,-.04238,14416e-8,.050743,-15329e-9,-.0016521,-.0013164,49174e-8,58088e-8,-22242e-8,-.05365,18269e-8,.038504,-31696e-9],[.13538,-.0019229,-25937e-9,.47744,-.0038238,-71777e-8,-.26029,-81103e-9,.42736,-.0051387,-.0016807,.0013721,1523e-7,-.32632,-11057e-8,.37476,-.0055362,-.0025657,.002221,.0010994,.19131,34934e-8,-.27065,-9022e-8,.2911],[-.0033615,-.058997,-98035e-8,-.0051712,.18887,-13633e-9,.0032167,-.001938,-.0040798,.2212,-75105e-9,-.058421,.0019794,.0036859,-.0018423,-.0018997,.26369,-19354e-8,-.10344,13176e-8,-.0021087,.002969,.0023602,-.0010834,83761e-8],[-.0010239,69745e-9,-52082e-8,-.001564,10797e-8,.10192,89749e-8,-.0010213,-.0012455,95463e-9,.045322,52197e-9,.0010554,93737e-8,-93762e-8,-6246e-7,35843e-9,.049444,19563e-8,-.019513,-3998e-7,.0015741,53343e-8,-47946e-8,1459e-7],[-.16435,.0011544,11504e-8,-.20005,.0023018,36143e-8,.22944,24497e-8,-.21454,.0030995,84711e-8,-85703e-8,-29204e-8,.22094,25204e-8,-.20833,.0033415,.0012922,-.0014224,-56141e-8,-.14058,-50995e-8,.19027,16216e-8,-.17177],[-22873e-10,-98035e-8,-.088896,-44527e-9,-.001938,-6253e-7,15278e-8,.1276,-7753e-8,-.0026037,-.0014564,59025e-8,-.08882,35321e-8,.10732,-72894e-9,-.0028283,-.0021986,84205e-8,96736e-8,-43656e-8,-.13928,37951e-8,.1065,-10997e-9],[.25877,-82526e-8,-10511e-8,.3055,-.0016586,-31702e-8,-.20332,-21784e-8,.43316,-.0022689,-75011e-8,60929e-8,2634e-7,-.29756,-20478e-8,.37971,-.0025178,-.0011681,.0010126,48456e-8,.18624,45028e-8,-.27311,-90541e-9,.33708],[-.0034965,.16496,-.0010127,-.0053979,.092325,-13122e-8,.0033758,-.0020087,-.0043032,.27064,-3505e-7,-.050731,.002046,.0039092,-.0019343,-.0020877,.31891,-6118e-7,-.11535,31747e-8,-.0022814,.0030793,.002543,-.0011934,70796e-8],[-.0020495,2748e-8,-.0010182,-.0031352,-51434e-10,-.1104,.001801,-.0020009,-.0025091,-10387e-8,.06507,17701e-8,.0020684,.0018882,-.0018489,-.0012817,-24281e-8,.076343,50134e-8,-.030616,-81303e-8,.0030947,.0010818,-97213e-8,2445e-7],[95378e-8,-.043572,17236e-8,.0014806,-.025887,14049e-8,-96524e-8,34307e-8,.0011795,-.051932,33754e-8,.094967,-35902e-8,-.0011673,32613e-8,55501e-8,-.071864,52507e-8,.068541,-25241e-8,75578e-8,-54992e-8,-79332e-8,1867e-7,-24692e-8],[96068e-9,.0010234,-.083964,19316e-8,.0020222,67088e-8,-2506e-7,-.016473,20405e-8,.0027121,.0015621,-62473e-8,.12265,-47578e-8,-.046765,14802e-8,.0029348,.0023558,-90097e-8,-.0010398,52118e-8,.13215,-46521e-8,-.060467,17351e-9],[-.19455,99376e-8,25611e-8,-.32071,.001995,22368e-8,.073016,52072e-8,-.30174,.0027074,52759e-8,-78674e-8,-57122e-8,.26649,50716e-8,-.26093,.0029457,81e-5,-.0013573,-35824e-8,-.16625,-91999e-8,.22638,30052e-8,-.21366],[-2028e-7,-5021e-7,.10161,-32663e-8,-.0010023,-2716e-7,26754e-8,.0075454,-26122e-8,-.0013715,-64341e-8,30177e-8,-.040308,39223e-8,.127,-10422e-8,-.0015379,-.0010007,43253e-8,42735e-8,-33573e-8,-.10862,33126e-8,.11364,11826e-8],[.20358,68167e-8,-11362e-8,.33856,.0013218,20958e-8,-.21747,-2086e-7,.22523,.0016934,47477e-8,-46823e-8,21089e-8,-.23384,-15306e-8,.33487,.0016653,67555e-8,-72812e-8,-32795e-8,.14197,28044e-8,-.21749,3.8801e-7,.30878],[-.0023134,.079781,-68389e-8,-.0036041,.26221,-24794e-8,.0022661,-.0013689,-.0029609,.21287,-6069e-7,-.099662,.0013793,.0026748,-.0013673,-.0016085,.33829,-97056e-8,-.12854,45669e-8,-.0016048,.0020917,.001796,-95473e-8,11929e-8],[-.0023854,-18445e-8,-.0011255,-.0036604,-43244e-8,.12241,.0021001,-.0022221,-.0029637,-68904e-8,-.020342,34067e-8,.0022961,.0022114,-.0020862,-.001582,-88912e-8,.086794,78118e-8,-.0097905,-9577e-7,.0034577,.001279,-.0011712,14324e-8],[.0010514,-.032932,51891e-9,.0016518,-.1049,33754e-8,-.0011337,10854e-8,.0013379,-.12017,79532e-8,-.081346,-1296e-7,-.0014491,1059e-7,65171e-8,-.13315,.001209,.065427,-56652e-8,.0010425,-2212e-7,-.0010417,56938e-9,-25425e-8],[.0012794,99963e-9,65467e-8,.001958,23615e-8,-.047728,-.0011378,.0012879,.0015614,37589e-8,.0042213,-20188e-8,-.0013344,-.0012082,.0011919,7824e-7,48081e-8,-.012883,-46896e-8,.072991,54548e-8,-.0020019,-70392e-8,6276e-7,-18862e-8],[.07712,-34151e-8,-32763e-8,.16921,-70456e-8,69349e-9,-.17684,-65083e-8,.16769,-98104e-8,15721e-8,35371e-8,68507e-8,-.10197,-61266e-8,.16632,-.0010921,23327e-8,69117e-8,-86107e-9,.13433,.0010508,-.10026,-33766e-8,.13581],[39676e-8,.0012374,-.042038,66488e-8,.0024503,79998e-8,-57081e-8,-.16485,5864e-7,.0032968,.0018695,-76649e-8,.015281,-88201e-8,-.13727,33578e-8,.0035845,.0028364,-.0011196,-.0012475,80497e-8,.17063,-76093e-8,-.11918,-5248e-8],[-.10433,34436e-8,15666e-8,-.23516,69767e-8,28921e-9,.21847,31705e-8,-.25435,9588e-7,69421e-9,-28729e-8,-33433e-8,.15174,31545e-8,-.2267,.0010619,10757e-8,-51113e-8,-52363e-9,-.096238,-52625e-8,.21063,20975e-8,-.19233],[-30178e-8,40814e-8,.023414,-43206e-8,78453e-8,35814e-8,223e-6,.11772,-27684e-8,99378e-8,80895e-8,-25652e-8,-.11005,17371e-8,-.0039195,-20196e-9,96066e-8,.0011504,-37232e-8,-54321e-8,1126e-8,-.098365,55787e-9,.093704,26963e-8],[.074793,.0019177,-23909e-10,.21074,.0037741,62253e-8,-.093374,3195e-8,.32537,.0049637,.0014372,-.0013877,-74083e-9,-.18444,10552e-8,.19589,.0051284,.0021279,-.0022517,-97008e-8,.10835,-22347e-8,-.15978,18829e-8,.27267]],[[.25276,-28176e-8,-44466e-8,.23765,-55342e-8,11908e-8,-.14703,-91486e-8,.23962,-74835e-8,30165e-8,10422e-8,82233e-8,-.19228,-.0010663,.21816,-82947e-8,51706e-8,65875e-9,-20674e-8,.11967,.0012279,-.1687,-.0011014,.17948],[-41535e-8,.12546,1095e-7,-63558e-8,.076819,-90303e-9,30309e-8,23622e-8,-54197e-8,.1032,-2105e-7,-.027274,-2451e-7,24487e-8,28123e-8,-35021e-8,.11038,-33965e-8,-.043541,83716e-9,30029e-9,-41534e-8,85989e-9,28225e-8,-95256e-9],[-58113e-8,1095e-7,.11038,-92378e-8,23622e-8,-18624e-8,42234e-8,.04565,-90377e-8,36002e-8,-44229e-8,-95328e-9,-.038688,36099e-8,.046627,-8138e-7,46523e-8,-6907e-7,-17824e-8,2869e-7,31447e-9,-.049914,17233e-8,.036557,-67989e-8],[.14132,-36379e-8,-65107e-8,.46047,-70888e-8,20146e-8,-.25841,-.0013441,.42496,-947e-6,50554e-8,12155e-8,.0012052,-.33036,-.0015825,.38127,-.0010296,85711e-8,48334e-9,-34055e-8,.19799,.0018073,-.28047,-.0016631,.30529],[-70468e-8,-.052361,24524e-8,-.0010719,.16753,-14424e-8,49971e-8,52249e-8,-90118e-8,.20487,-33771e-8,-.054155,-53594e-8,37972e-8,6088e-7,-56077e-8,.25226,-55406e-8,-.098985,12104e-8,95459e-9,-89116e-8,10485e-8,59184e-8,-11164e-8],[16442e-8,-12982e-8,-26109e-8,27764e-8,-25494e-8,.0859,-18333e-8,-52526e-8,28392e-8,-35954e-8,.038079,-29316e-10,52919e-8,-2505e-7,-53049e-8,25677e-8,-44216e-8,.043958,-10253e-8,-.017209,17504e-8,80898e-8,-20965e-8,-3725e-7,19908e-8],[-.16379,88912e-9,19612e-8,-.20564,16386e-8,-13263e-8,.21649,40744e-8,-.219,20741e-8,-32717e-8,21755e-9,-32958e-8,.21854,51536e-8,-.21373,21423e-8,-54031e-8,12925e-8,22118e-8,-.14218,-47182e-8,.19357,62042e-8,-.1805],[-.0010891,24524e-8,-.081549,-.0017375,52249e-8,-33272e-8,79218e-8,.10714,-.0017191,78502e-8,-78792e-8,-19759e-8,-.077945,68152e-8,.094342,-.0015789,99872e-8,-.0012239,-35531e-8,51228e-8,56411e-9,-.12712,33334e-8,.097961,-.0013593],[.25846,-17624e-8,-55747e-8,.3158,-3306e-7,19611e-8,-.20761,-.0011614,.4251,-41045e-8,48507e-8,47461e-9,.001056,-.30187,-.0013865,.38002,-38595e-8,81069e-8,-1147e-8,-31262e-8,.19222,.0016179,-.28094,-.0014815,.34372],[-74521e-8,.15765,37423e-8,-.0011199,.098284,-16117e-8,5086e-7,78847e-8,-9082e-7,.25433,-38296e-8,-.05009,-79674e-8,35017e-8,90337e-8,-50357e-8,.30328,-64513e-8,-.1111,1325e-7,16133e-8,-.0012991,47633e-9,85834e-8,2398e-8],[45065e-8,-24271e-8,-55566e-8,74826e-8,-47821e-8,-.099721,-47422e-8,-.0011151,74343e-8,-68471e-8,.049512,-29274e-9,.0011256,-61818e-8,-.0011161,6448e-7,-86609e-8,.060939,-25372e-8,-.024338,39939e-8,.0017163,-49586e-8,-76142e-8,46809e-8],[-51005e-9,-.041712,-11415e-8,-91757e-9,-.027483,-88668e-9,10584e-8,-23355e-8,-83246e-9,-.051463,-21336e-8,.080631,24018e-8,19052e-8,-24434e-8,-46651e-9,-.070524,-32747e-8,.0606,17337e-8,-21012e-8,37945e-8,18009e-8,-18879e-8,10298e-9],[87556e-8,-26047e-8,-.078867,.001396,-55152e-8,33051e-8,-59061e-8,-.01893,.0014058,-81987e-8,78373e-8,21142e-8,.1054,-44583e-8,-.043881,.0013435,-.0010273,.0012196,38013e-8,-51144e-8,-1829e-7,.11603,-16833e-8,-.055965,.0012345],[-.19422,-98994e-9,46959e-10,-.32371,-2185e-7,-16141e-8,.08924,1849e-8,-.31072,-32823e-8,-39114e-8,15436e-8,56124e-9,.26406,10485e-8,-.27361,-40231e-8,-62977e-8,34667e-8,26064e-8,-.16567,12198e-8,.22843,28814e-8,-.228],[-.0010786,29268e-8,.096011,-.0017387,61232e-8,-22083e-8,82578e-8,.012546,-.0017507,90281e-8,-5152e-7,-19936e-8,-.038186,77514e-8,.11051,-.0016452,.0011277,-77807e-8,-32487e-8,33763e-8,-67789e-9,-.097962,44249e-8,.0993,-.001455],[.20364,81143e-9,-43204e-8,.3425,18524e-8,14473e-8,-.22114,-91287e-8,.24484,31758e-8,35168e-8,-36423e-9,86661e-8,-.24537,-.0010981,.33417,48459e-8,57997e-8,-45047e-9,-20675e-8,.1506,.0013828,-.22698,-.0011679,.30702],[-52055e-8,.073002,45752e-8,-75655e-8,.24915,-16941e-8,33123e-8,95539e-8,-54164e-8,.22123,-41328e-8,-.096585,-94805e-8,1774e-7,.0010842,-15814e-8,.33511,-71435e-8,-.13,16871e-8,18532e-8,-.0015168,-57319e-9,.0010217,33234e-8],[8024e-7,-29732e-8,-72008e-8,.0013133,-59377e-8,.11455,-79505e-8,-.0014378,.0012758,-87333e-8,-.010949,-48287e-9,.0014564,-98305e-8,-.0014126,.0010724,-.0011474,.075531,-34045e-8,-.0099532,57053e-8,.0022081,-7505e-7,-90432e-8,74143e-8],[-42043e-8,-.030403,-19319e-8,-67762e-8,-.10004,-26387e-8,47902e-8,-38828e-8,-59004e-8,-.1197,-63081e-8,-.067976,39782e-8,65041e-8,-38694e-8,-36315e-8,-.13511,-9784e-7,.058187,45897e-8,-506e-6,6123e-7,51227e-8,-26242e-8,-41583e-9],[-34122e-8,16811e-9,33001e-8,-55732e-8,25029e-9,-.044369,35211e-8,66244e-8,-52954e-8,47358e-9,.0015492,1204e-7,-67195e-8,44782e-8,66102e-8,-42097e-8,10957e-8,-.01229,33236e-8,.059427,-28339e-8,-.0010273,34599e-8,44584e-8,-25205e-8],[.081858,32311e-8,3279e-7,.17381,66398e-8,1063e-7,-.1764,66498e-8,.17432,93412e-8,24892e-8,-27717e-8,-69455e-8,-.11772,67028e-8,.17375,.001072,37898e-8,-50761e-8,-16467e-8,.13046,-.0010925,-.11256,46328e-8,.14581],[.0010558,-43696e-8,-.034625,.0016946,-91447e-8,41481e-8,-67486e-8,-.14998,.0017626,-.0013398,97981e-8,33096e-8,.021187,-46163e-8,-.13092,.0017829,-.0016498,.0015128,57192e-8,-6435e-7,-33079e-8,.15675,-13896e-8,-.11625,.0017665],[-.11037,-17816e-8,-94945e-9,-.24028,-36954e-8,-72093e-9,.2188,-19029e-8,-.26125,-52802e-8,-1727e-7,15634e-8,21737e-8,.17038,-17052e-8,-.23868,-62143e-8,-27371e-8,29062e-8,1131e-7,-.10797,35024e-8,.21354,-64823e-9,-.20704],[-91442e-8,25483e-8,.018567,-.0014996,52175e-8,55323e-9,79734e-8,.10772,-.0015311,75523e-8,1512e-7,-12357e-8,-.1036,88457e-8,.0042628,-.0014452,93133e-8,29302e-8,-14831e-8,-90688e-9,-34836e-8,-.097142,61696e-8,.083344,-.0012649],[.082637,33001e-8,-31924e-8,.21635,68187e-8,51283e-9,-.10067,-68463e-8,.32636,.0010164,11916e-8,-10474e-8,70262e-8,-.19233,-81089e-8,.21563,.0013192,19457e-8,-43017e-9,-40629e-9,.11634,.0011786,-.17193,-8138e-7,.27475]],[[.2374,49985e-9,-48501e-9,.2364,66211e-9,66793e-8,-.14678,-10908e-8,.2403,-42657e-10,.0016095,-54027e-9,66755e-9,-.19358,-17984e-8,.22189,-1955e-7,.0025947,-87825e-9,-.0010025,.12166,95689e-9,-.1722,-29432e-8,.18679],[14155e-8,.11013,72578e-8,18826e-8,.070788,65739e-9,-15279e-8,.0014768,38822e-9,.097326,15764e-8,-.025654,-.0014458,-17226e-8,.001578,-219e-6,.10643,24392e-8,-.041754,-11985e-8,1196e-7,-.0022169,-84349e-9,.0013174,-53501e-8],[-47168e-9,72578e-8,.09591,-8393e-8,.0014768,63208e-10,32661e-10,.041218,-12852e-8,.0020962,48557e-10,-41298e-8,-.035995,-33465e-9,.043502,-20116e-8,.0024909,-33814e-9,-57725e-8,-38536e-9,88752e-9,-.047565,-41577e-9,.035238,-29082e-8],[.1477,-10964e-9,-89775e-9,.44628,-7761e-8,93646e-8,-.25598,-19954e-8,.42231,-25929e-8,.0022595,-1851e-8,13753e-8,-.33214,-31043e-8,.38643,-5945e-7,.0036508,-26955e-9,-.0014049,.20212,20526e-8,-.28737,-47953e-8,.31814],[1232e-7,-.045378,.0013091,12428e-8,.1497,11686e-8,-14854e-8,.0026671,-13901e-8,.18939,28051e-8,-.049957,-.002607,-15714e-8,.002863,-57309e-8,.23894,43522e-8,-.093392,-21207e-8,13118e-8,-.0040017,-36068e-9,.0024177,-.0010955],[.0013177,93466e-9,26883e-9,.0020749,1893e-7,.072924,-.0011274,4411e-8,.0018676,25786e-8,.032488,-86552e-9,-90846e-9,-.0011811,-2274e-8,.0013641,27958e-8,.039651,-16109e-8,-.015518,4266e-7,-15072e-8,-7309e-7,-17893e-8,67053e-8],[-.1624,-32604e-9,-91872e-10,-.20999,-35826e-9,-40094e-8,.20539,-10493e-9,-.22265,24815e-9,-9672e-7,76022e-10,39394e-9,.21538,36749e-9,-.21831,1689e-7,-.001563,-20236e-9,59966e-8,-.14196,63831e-9,.19481,13924e-8,-.18837],[-11889e-8,.0013091,-.073038,-20745e-8,.0026671,-12471e-9,35755e-9,.092153,-29098e-8,.0037944,-51718e-9,-7438e-7,-.069905,-26597e-9,.084612,-42259e-8,.004525,-1666e-7,-.0010397,-32296e-9,14633e-8,-.1177,-50776e-9,.091044,-58389e-8],[.25704,-26586e-8,-15078e-8,.32469,-58899e-8,60944e-8,-.21112,-32407e-8,.41937,-95945e-8,.0014784,15377e-8,27688e-8,-.30478,-43124e-8,.38131,-.0013736,.0024114,24146e-8,-91383e-8,.19609,43244e-8,-.28644,-5498e-7,.35056],[-19411e-8,.14865,.0015514,-40267e-8,.10139,12224e-8,13952e-8,.0031683,-6922e-7,.23874,29431e-8,-.048778,-.0030885,18077e-8,.0034302,-.0011203,.28648,4589e-7,-.10572,-22256e-8,-25383e-9,-.0047515,22355e-8,.0029557,-.0016115],[.0028023,19604e-8,23624e-9,.0044183,39746e-8,-.088639,-.0023958,21763e-9,.0039954,54289e-8,.039259,-17976e-8,-12463e-8,-.0025112,-1385e-7,.0029519,59185e-8,.050258,-33354e-8,-.020166,90218e-8,-2084e-7,-.0015597,-48307e-8,.0015077],[-60345e-9,-.039237,-15299e-8,-74461e-9,-.027982,-61026e-9,24327e-9,-31259e-8,-16556e-9,-.049984,-14564e-8,.068721,30186e-8,-20909e-9,-34114e-8,72871e-9,-.067994,-22783e-8,.053059,9931e-8,75234e-9,46258e-8,-63299e-9,-3006e-7,17491e-8],[14531e-9,-.0012336,-.07403,41505e-9,-.0025111,-50329e-9,55133e-9,-.022434,13717e-8,-.0035677,-10095e-8,69899e-8,.093083,1244e-7,-.043276,30169e-8,-.0042464,-81399e-9,97384e-8,13196e-8,-18494e-8,.10475,1137e-7,-.053598,50822e-8],[-.1927,28933e-9,-49121e-9,-.32388,89803e-9,-20292e-8,.10279,-92329e-9,-.31648,19333e-8,-49178e-8,-68421e-9,1128e-7,.26204,-57746e-9,-.28385,34135e-8,-80247e-8,-17798e-8,30028e-8,-.16457,17274e-8,.22978,43394e-9,-.24117],[-27041e-8,99298e-8,.090145,-45026e-8,.0020342,-13283e-8,18799e-8,.017784,-51026e-8,.0029223,-34546e-8,-56297e-8,-.037642,16044e-8,.098962,-58082e-8,.0035371,-64208e-8,-79011e-8,17153e-8,33164e-9,-.090708,8677e-8,.089185,-65987e-8],[.20333,-581e-6,-23411e-8,.34495,-.0012155,13604e-8,-.22333,-49346e-8,.26273,-.0018049,34485e-8,35661e-8,46808e-8,-.25502,-59207e-8,.33726,-.0022928,6044e-7,54307e-8,-20419e-8,.15791,74373e-8,-.23563,-63442e-8,.31016],[-79982e-8,.066175,.0014235,-.0013722,.2327,76351e-9,69247e-8,.0029196,-.001596,.22157,18563e-8,-.091767,-.0028333,80749e-8,.0032081,-.0018334,.32683,2933e-7,-.12811,-14257e-8,-31465e-8,-.0043773,66041e-8,.0028591,-.0020561],[.0037409,23062e-8,-94262e-9,.0059123,469e-6,.10603,-.0031955,-23637e-8,.0053925,64381e-8,-.0027747,-21324e-8,93345e-9,-.0033548,-49762e-8,.0040677,70756e-8,.068432,-39792e-8,-.010934,.0011971,14107e-8,-.0020999,-96487e-8,.0022153],[87447e-10,-.027426,90602e-9,41684e-9,-.093025,-97407e-9,-9996e-8,18131e-8,73544e-9,-.11533,-23218e-8,-.056803,-18727e-8,-23204e-8,17693e-8,95111e-9,-.13268,-36527e-8,.052108,15086e-8,29739e-8,-28761e-8,-25662e-8,11065e-8,99207e-9],[-.0015425,-17211e-8,-99033e-9,-.0024306,-34783e-8,-.041083,.0013155,-18587e-8,-.0021953,-47641e-8,-.0013977,14172e-8,25108e-8,.0013741,-96514e-9,-.0016182,-52521e-8,-.013258,25029e-8,.049542,-48693e-8,40101e-8,84871e-8,15264e-8,-82123e-8],[.084997,-61103e-9,99842e-9,.17577,-13652e-8,-20206e-8,-.17312,20188e-8,.17827,-20131e-8,-4846e-7,12441e-8,-19724e-8,-.1287,21222e-8,.17893,-23222e-8,-77256e-8,29363e-8,30848e-8,.12715,-29932e-8,-.12201,17071e-8,.15431],[16694e-9,-.0015392,-.029621,54701e-9,-.0031383,-5836e-8,72159e-9,-.1375,19189e-8,-.0044722,-10933e-8,86864e-8,.027452,15854e-8,-.12571,42647e-8,-.0053484,-56056e-9,.0012079,16148e-8,-23711e-8,.14846,14071e-8,-.11444,72139e-8],[-.11546,83771e-9,-38661e-9,-.24377,18506e-8,25352e-9,.21673,-75814e-9,-.26593,28775e-8,59404e-9,-95164e-9,79906e-9,.18444,-67767e-9,-.24805,37832e-8,89945e-9,-20034e-8,-40765e-9,-.11745,12046e-8,.21648,-27318e-9,-.21979],[-51014e-8,21939e-8,.014907,-8307e-7,47355e-8,-33998e-8,44256e-8,.098137,-83376e-8,74064e-8,-84518e-8,-12414e-8,-.096711,48442e-8,.011531,-77322e-8,.0010057,-.0014301,-18402e-8,5324e-7,-18428e-8,-.09538,33002e-8,.077874,-678e-6],[.091151,-80783e-8,-30383e-8,.22326,-.0016605,-31276e-8,-.10852,-63553e-8,.32773,-.0023928,-73349e-8,49021e-8,629e-6,-.20009,-72759e-8,.23465,-.0029099,-.0011259,72361e-8,46718e-8,.12379,.001007,-.18345,-70653e-8,.28206]],[[.2231,94076e-8,82348e-8,.23411,.0019197,-63238e-8,-.14592,.0017436,.24057,.0027074,-.0015573,-65781e-8,-.0016521,-.19443,.0021163,.22635,.0031593,-.0025895,-.0010767,99446e-8,.12357,-.0026459,-.17593,.0023041,.19631],[.0013673,.095478,-66815e-8,.0021577,.062385,12773e-8,-.0012949,-.0013902,.0018851,.087626,30956e-8,-.023049,.0013742,-.0015058,-.0015675,.0012435,.097884,50736e-8,-.038244,-18416e-8,81219e-8,.0021874,-.0010492,-.0014602,36719e-8],[.0010491,-66815e-8,.082991,.0017171,-.0013902,26992e-8,-90887e-8,.036216,.0017514,-.0020372,64841e-8,43308e-8,-.032334,-.0010044,.039427,.0016654,-.0025272,.0010332,6856e-7,-42244e-8,36714e-8,-.043531,-72888e-8,.03311,.0014988],[.15367,.0012947,.001287,.43417,.0026465,-94796e-8,-.25364,.0027299,.42067,.0037431,-.0023348,-91029e-8,-.0025834,-.33404,.0033307,.39343,.0043875,-.003884,-.0014973,.0014895,.20656,-.0041459,-.29515,.0036578,.33458],[.0024155,-.040895,-.0012921,.0038177,.13003,22835e-8,-.0022947,-.0026885,.0033503,.16891,55536e-8,-.044486,.0026558,-.0026796,-.0030339,.0022374,.21858,91641e-8,-.085181,-32781e-8,.0014568,.0042266,-.0018805,-.0028324,71331e-8],[-.0011781,1829e-7,39834e-8,-.0018981,37347e-8,.061611,.0010757,80752e-8,-.0018064,53669e-8,.026463,-92821e-9,-81621e-8,.0012323,83413e-8,-.0014793,65367e-8,.033591,-11559e-8,-.013066,-57575e-8,-.0012639,8886e-7,63039e-8,-98034e-8],[-.16071,-70683e-8,-57986e-8,-.21401,-.0014469,46557e-8,.19658,-.0012318,-.22708,-.002047,.001146,51512e-8,.0011578,.21362,-.0015146,-.2247,-.0023958,.0019032,86709e-8,-73426e-8,-.14229,.0018563,.19709,-.0016877,-.199],[.0021021,-.0012921,-.065543,.0034478,-.0026885,46867e-8,-.0018231,.078342,.003538,-.0039412,.0011277,83549e-8,-.061136,-.0020211,.074462,.0033993,-.0048925,.0018025,.0013207,-73352e-8,74127e-8,-.10595,-.0014779,.083251,.0031056],[.25695,69216e-8,.001215,.33595,.0014271,-74963e-8,-.21676,.0025886,.41964,.00205,-.0018482,-48928e-8,-.0024461,-.31123,.003195,.38811,.0024639,-.0030821,-81336e-8,.0011729,.20216,-.0039485,-.29527,.0035741,.36243],[.0026784,.13681,-.0016983,.0042462,.098507,27421e-8,-.0025529,-.0035352,.0037642,.21921,67149e-8,-.045911,.0034865,-.0029984,-.0039982,.0025859,.26513,.0011215,-.098422,-39315e-8,.0016419,.0055475,-.0021294,-.0037527,96313e-8],[-.0026941,38239e-8,81402e-8,-.0043408,7833e-7,-.079267,.0024568,.0016524,-.0041336,.0011329,.029244,-19111e-8,-.001668,.0028111,.0017153,-.0033909,.001394,.037897,-2348e-7,-.015152,-.0013075,-.0025863,.0020255,.0013154,-.0022582],[-56557e-8,-.036011,27028e-8,-89952e-8,-.026893,-73682e-10,56544e-8,56153e-8,-79118e-8,-.046861,-18418e-9,.058593,-55875e-8,69384e-8,62794e-8,-52417e-8,-.063835,-35547e-9,.046012,11129e-10,-42789e-8,-89016e-8,51389e-8,57389e-8,-15298e-8],[-.0018986,.0012413,-.067946,-.0031126,.002582,-47536e-8,.0016372,-.023252,-.0031951,.0037813,-.0011429,-80743e-8,.081175,.0018034,-.040968,-.0030743,.0046861,-.0018237,-.001281,74466e-8,-64075e-8,.092351,.0013104,-.050493,-.0028167],[-.19256,-56754e-8,-47469e-8,-.3259,-.0011692,37984e-8,.11659,-.0010148,-.32418,-.0016663,93469e-8,44043e-8,94118e-8,.26429,-.0012765,-.29695,-.0019672,.0015509,77163e-8,-60115e-8,-.16651,.001514,.23518,-.0014782,-.25835],[.0023078,-.001204,.083407,.0038052,-.0025073,28073e-8,-.0020145,.021064,.00396,-.0036835,68208e-8,76946e-8,-.036397,-.0022601,.088957,.0038921,-.0045902,.0011101,.0012075,-43879e-8,85315e-8,-.083456,-.0016891,.080495,.003669],[.20786,-16574e-8,.0010537,.35462,-31196e-8,-391e-6,-.22992,.0022598,.28667,-36985e-8,-96838e-8,12052e-8,-.0021345,-.27048,.0028332,.34908,-29317e-8,-.0016312,18967e-8,60273e-8,.16922,-.0034774,-.2503,.0032452,.32107],[.0020959,.059517,-.0018059,.0033471,.21463,27066e-8,-.0020035,-.0037626,.0030435,.2167,67066e-8,-.086112,.0036996,-.0023744,-.0042745,.0022377,.31601,.0011416,-.12458,-39074e-8,.0013032,.0058863,-.0017264,-.0040548,.0011101],[-.0040089,50864e-8,99198e-8,-.0064611,.0010488,.095754,.0036462,.0020198,-.0061643,.0015352,28526e-8,-25197e-8,-.0020323,.004163,.0021212,-.0050811,.0019236,.058204,-3093e-7,-.0096467,-.0019174,-.0031605,.0029964,.0016811,-.0034263],[-50173e-8,-.024477,22528e-8,-80974e-8,-.085329,61297e-9,54764e-8,46721e-8,-72357e-8,-.10922,14716e-8,-.047295,-47009e-8,72575e-8,51613e-8,-48914e-8,-.12834,22795e-8,.047498,-11177e-8,-52165e-8,-75082e-8,58116e-8,45793e-8,-15227e-8],[.0015931,-18769e-8,-49265e-8,.0025655,-38359e-8,-.036907,-.0014587,-99979e-8,.0024354,-55562e-8,-.0018568,8214e-8,.0010105,-.0016747,-.0010362,.0019828,-6882e-7,-.011326,83407e-9,.040614,79118e-8,.0015672,-.0012085,-79051e-8,.0012963],[.089774,90347e-9,-55354e-9,.18067,19639e-8,-12207e-9,-.17116,-10754e-8,.18521,29274e-8,-28768e-9,-12077e-8,12734e-8,-.14026,-81918e-9,.18706,35797e-8,-42008e-9,-26352e-8,25162e-9,.12701,20121e-8,-.13299,84066e-10,.16552],[-.0027483,.0017417,-.024578,-.004518,.0036231,-58487e-8,.0023669,-.12334,-.0046783,.005307,-.0014095,-.0011324,.029682,.0026113,-.11747,-.0045686,.0065791,-.002259,-.0017961,91668e-8,-918e-6,.13773,.0019123,-.11037,-.0042757],[-.12311,-19066e-8,-21344e-8,-.25182,-39939e-8,11943e-8,.21693,-46028e-8,-.2751,-58209e-8,29466e-8,16345e-8,4199e-7,.2001,-59617e-8,-.26136,-70835e-8,49072e-8,30387e-8,-1902e-7,-.12857,67908e-8,.22412,-72261e-8,-.23627],[.0022109,-69946e-8,.012637,.0036754,-.0014626,-1e-4,-.0019569,.089981,.003902,-.0021693,-22365e-8,42828e-8,-.090715,-.0022437,.018059,.0039532,-.0027469,-30619e-8,65448e-8,15832e-8,89905e-8,-.094565,-.0017344,.074646,.0038746],[.1067,-92034e-8,87377e-8,.24193,-.0018437,30622e-9,-.12365,.0018873,.33951,-.0025035,65633e-9,66869e-8,-.0017865,-.21679,.0024025,.25978,-.0027261,73903e-9,.0011045,-64954e-9,.13654,-.0029427,-.20188,.0028111,.29581]],[[.21133,-47612e-8,-76483e-8,.23289,-.0010025,-17291e-8,-.14566,-.0016019,.24057,-.0014421,-40751e-8,5252e-7,.0015887,-.19535,-.0018383,.22834,-.0016871,-61632e-8,.0010796,29451e-8,.12518,.0025582,-.1785,-.001787,.20075],[-64539e-8,.084493,-22056e-8,-.0010559,.05826,-29775e-8,80754e-8,-4416e-7,-92871e-8,.083272,-71686e-8,-.021894,47585e-8,.0011769,-41547e-8,-56611e-8,.094829,-.001143,-.036999,4746e-7,-98403e-8,74665e-8,.0010305,-21375e-8,-20295e-9],[-.0010488,-22056e-8,.072282,-.0016941,-4416e-7,99269e-9,97497e-8,.032569,-.0016192,-59625e-8,23929e-8,17016e-8,-.029788,.0011399,.03632,-.0013456,-63979e-8,38809e-8,29104e-8,-14393e-8,-56113e-8,-.041002,85234e-8,.031266,-94291e-8],[.15982,-75052e-8,-.0011307,.42405,-.0015747,-21137e-8,-.2515,-.0023769,.41758,-.002256,-49492e-8,80864e-8,.0023497,-.33467,-.0027608,.39538,-.0026264,-73661e-8,.001647,36523e-8,.20955,.0037983,-.29985,-.0027504,.34222],[-.0013317,-.033526,-35546e-8,-.0021695,.11922,-51243e-8,.0016351,-70868e-8,-.001896,.1587,-.0012343,-.041777,77279e-8,.0023521,-65005e-8,-.0011407,.20825,-.0019692,-.081061,81806e-8,-.0019346,.0012123,.0020344,-29104e-8,-16101e-9],[-46093e-8,-45609e-8,15066e-8,-71739e-8,-92772e-8,.052643,45661e-8,3061e-7,-5817e-7,-.0013039,.022544,30472e-8,-29453e-8,54603e-8,32994e-8,-28959e-8,-.0015145,.029984,48265e-8,-.011688,-33394e-8,-44583e-8,37954e-8,28534e-8,10406e-8],[-.15908,6628e-7,5781e-7,-.21748,.0013859,1346e-7,.18938,.0012165,-.23022,.0019893,31865e-8,-6555e-7,-.0012023,.2119,.0014165,-.22812,.0023377,48403e-8,-.0012939,-23494e-8,-.142,-.0019461,.1978,.0014176,-.20443],[-.0019709,-35546e-8,-.057688,-.0031951,-70868e-8,16881e-8,.0018341,.068351,-.0030909,-94685e-8,40826e-8,28146e-8,-.05498,.0021543,.066843,-.0026353,-99374e-8,66718e-8,48701e-8,-24187e-8,-.0010603,-.097323,.0016318,.076348,-.0019512],[.25427,-50579e-8,-86507e-8,.34205,-.0010505,-23963e-9,-.21954,-.0018426,.41602,-.00148,-43235e-9,53623e-8,.0017997,-.31362,-.0022301,.38891,-.0016773,-18685e-9,.001081,56694e-9,.20508,.0029486,-.29917,-.002401,.36609],[-.0017531,.12814,-30577e-8,-.0028408,.10089,-54293e-8,.0021205,-60051e-8,-.0024523,.20996,-.0013089,-.045341,67843e-8,.0030144,-50344e-8,-.0014239,.25473,-.0020906,-.095249,86931e-8,-.002448,.0010604,.0025724,-10029e-8,8546e-8],[-89141e-8,-92725e-8,29947e-8,-.0013834,-.0018869,-.069534,89343e-8,61018e-8,-.0011023,-.0026535,.024121,62182e-8,-58078e-8,.0010767,66798e-8,-50479e-8,-.0030843,.031982,9879e-7,-.012882,-67762e-8,-87799e-8,74947e-8,60089e-8,29856e-8],[8825e-7,-.033763,98602e-9,.0014255,-.027483,90299e-9,-9869e-7,1993e-7,.0012629,-.046368,2185e-7,.050922,-22095e-8,-.0013333,18843e-8,82123e-8,-.062595,35073e-8,.041161,-14621e-8,98582e-8,-35586e-8,-.0010981,95664e-9,17398e-8],[.0019534,41742e-8,-.062684,.0031619,83728e-8,-15186e-8,-.0018182,-.025069,.003043,.0011323,-36544e-8,-33025e-8,.072919,-.0021329,-.040217,.0025657,.0012167,-59404e-8,-57364e-8,21223e-8,.0010525,.084403,-.0016074,-.04829,.0018549],[-.19152,9388e-7,50733e-8,-.32551,.0019553,10352e-8,.1277,.001078,-.3278,.002801,24555e-8,-87583e-8,-.001057,.26527,.0012932,-.30433,.003294,3709e-7,-.0016868,-18949e-8,-.16756,-.0017285,.23831,.0013688,-.26834],[-.0016857,-82335e-9,.076813,-.0027708,-14993e-8,10932e-8,.0015736,.023785,-.0028006,-15579e-8,26998e-8,88473e-9,-.035693,.0018787,.080869,-.002602,-6568e-8,45884e-8,16838e-8,-15289e-8,-92071e-8,-.077902,.0014892,.072932,-.0022558],[.2067,30548e-9,-46622e-8,.35416,83359e-9,2298e-7,-.22996,-.001034,.29894,17354e-8,56818e-8,-14133e-9,9719e-7,-.27684,-.0014039,.3526,31038e-8,95083e-8,-26136e-9,-36539e-8,.17477,.0016585,-.25731,-.0018042,.32558],[-.0016503,.05573,-65069e-9,-.0026537,.20099,-38348e-8,.0019835,-10381e-8,-.0022314,.21443,-92636e-8,-.081616,17571e-8,.0027959,35954e-9,-.0011807,.30914,-.0014834,-.12203,6183e-7,-.0022652,26087e-8,.0023503,36093e-8,33021e-8],[-912e-6,-.0011106,36164e-8,-.0014017,-.0022619,.086998,94003e-8,74235e-8,-.0010555,-.0031842,.0052607,75004e-8,-69341e-8,.0011508,83988e-8,-34368e-8,-.0037062,.054659,.0011984,-.01063,-77288e-8,-.0010504,7977e-7,81388e-8,60624e-8],[.0017541,-.022982,93853e-9,.0028242,-.080029,28742e-9,-.0019067,19189e-8,.0025053,-.10539,71968e-9,-.038419,-22273e-8,-.0025208,18023e-8,.0016511,-.12596,1207e-7,.04509,-51481e-9,.0017913,-37105e-8,-.0020364,83206e-9,40926e-8],[63496e-8,57144e-8,-14922e-8,99076e-8,.0011635,-.033601,-64177e-8,-30211e-8,80419e-8,.0016376,-.0037522,-38505e-8,28066e-8,-78236e-8,-33032e-8,39848e-8,.0019055,-.012399,-6141e-7,.03472,49881e-8,41402e-8,-55703e-8,-30029e-8,-15121e-8],[.093128,-87242e-8,-61593e-9,.18322,-.0018112,-33842e-9,-.16756,-14297e-8,.18909,-.002595,-84342e-9,75645e-8,1319e-7,-.14787,-21403e-8,.19137,-.0030668,-13581e-8,.0014095,71871e-9,.12611,2372e-7,-.1404,-30687e-8,.17207],[.0027055,50172e-8,-.021536,.0044007,.0010036,-16237e-8,-.0025225,-.11218,.0043013,.0013456,-3918e-7,-41346e-8,.03284,-.0029774,-.11063,.0037444,.0014176,-64465e-8,-73249e-8,21496e-8,.0014699,.13109,-.0022811,-.10605,.0028891],[-.12799,59307e-8,27298e-8,-.25539,.0012323,21298e-9,.21407,58934e-8,-.27897,.0017625,49269e-9,-53479e-8,-56841e-8,.20971,74226e-8,-.26837,.0020725,67297e-9,-.0010141,-47214e-9,-.13585,-94388e-8,.2279,85389e-8,-.24599],[-83924e-8,4267e-7,.01034,-.0014573,88864e-8,85013e-10,79067e-8,.080861,-.0017169,.0013037,34866e-9,-28467e-8,-.083143,.0010027,.021161,-.0020124,.0016221,98968e-9,-46028e-8,-10372e-9,-47784e-8,-.09027,9257e-7,.070184,-.002334],[.11331,73778e-8,-11573e-8,.24654,.0015664,4424e-7,-.1298,-32136e-8,.33769,.0023157,.0010807,-70187e-8,24204e-8,-.22182,-66947e-8,.27174,.0028558,.0017624,-.0013773,-72386e-8,.14171,51581e-8,-.21008,-.0012605,.30244]],[[.2013,-18674e-8,-40977e-8,.23228,-36405e-8,-12887e-8,-.14538,-86363e-8,.24148,-49048e-8,-32847e-8,47852e-9,84291e-8,-.19585,-.0010164,.23172,-54677e-8,-57186e-8,-20322e-9,21969e-8,.12593,.0013597,-.18047,-.0010354,.20721],[-34685e-8,.074247,-12402e-8,-52963e-8,.053022,-11328e-8,24391e-8,-26873e-8,-45303e-8,.077015,-2798e-7,-.020187,27216e-8,17805e-8,-33034e-8,-30124e-8,.089348,-46905e-8,-.034663,17518e-8,58015e-9,46286e-8,25227e-9,-35657e-8,-1103e-7],[-56518e-8,-12402e-8,.063414,-92158e-8,-26873e-8,-16614e-8,5149e-7,.030112,-91364e-8,-41569e-8,-40144e-8,10131e-8,-.028067,59636e-8,.034456,-81585e-8,-55177e-8,-64521e-8,18913e-8,26174e-8,-27028e-8,-.039571,45237e-8,.030802,-65099e-8],[.16645,-18996e-8,-62475e-8,.41702,-36177e-8,-21748e-8,-.2499,-.0013182,.41682,-47488e-8,-55163e-8,93801e-10,.0012857,-.33504,-.0015564,.39977,-51448e-8,-95434e-8,-13192e-8,36696e-8,.21131,.0020767,-.3037,-.001595,.35282],[-48854e-8,-.027971,-27695e-8,-73546e-8,.10765,-21335e-8,29933e-8,-59613e-8,-62019e-8,.14623,-52812e-8,-.03838,60197e-8,14364e-8,-72261e-8,-40772e-8,.19465,-88869e-8,-.075419,32984e-8,21816e-8,.0010138,-92838e-9,-76319e-8,-15233e-8],[-19274e-8,-16306e-8,-26262e-8,-32635e-8,-33964e-8,.044952,20421e-8,-53641e-8,-34491e-8,-50029e-8,.018855,10068e-8,5415e-7,27543e-8,-56613e-8,-33669e-8,-6273e-7,.026085,15417e-8,-.010103,-17976e-8,8468e-7,24494e-8,-45008e-8,-30327e-8],[-.15729,-18656e-9,29499e-8,-.22034,-57523e-9,1328e-7,.18318,62294e-8,-.23332,-1101e-7,33455e-8,95352e-9,-60524e-8,.21017,73899e-8,-.23211,-16442e-8,57162e-8,25522e-8,-22574e-8,-.14112,-97716e-8,.19797,76478e-8,-.21093],[-.0011067,-27695e-8,-.049616,-.0018069,-59613e-8,-28507e-8,.0010091,.061858,-.001798,-91415e-8,-68852e-8,21913e-8,-.051156,.0011711,.062563,-.0016168,-.0012009,-.0011065,40113e-8,44745e-8,-53169e-8,-.091774,89277e-8,.072917,-.0013059],[.25342,18418e-9,-53627e-8,.35054,54972e-9,-22123e-8,-.22362,-.001135,.41699,10084e-8,-55633e-8,-96245e-9,.0011063,-.31747,-.0013509,.39398,14244e-8,-95274e-8,-25653e-8,36329e-8,.20789,.0017946,-.30366,-.001404,.37359],[-31771e-8,.11846,-43259e-8,-45526e-8,.099825,-27462e-8,94997e-9,-92479e-8,-36571e-8,.1986,-68226e-8,-.043761,92888e-8,-14762e-8,-.0011064,-23377e-8,.24221,-.001155,-.09074,42505e-8,44933e-8,.0015468,-34813e-8,-.0011454,-10198e-8],[-52766e-8,-35985e-8,-53391e-8,-88478e-8,-75125e-8,-.061078,54501e-8,-.0010901,-91648e-8,-.001111,.019557,22188e-8,.0010984,71679e-8,-.0011509,-86792e-8,-.0014013,.026235,34026e-8,-.01047,-44917e-8,.0017151,61981e-8,-91678e-8,-74874e-8],[-17641e-8,-.031093,11176e-8,-29721e-8,-.026859,30591e-9,23244e-8,23595e-8,-28296e-8,-.044507,76299e-9,.044299,-24297e-8,35478e-8,26887e-8,-21278e-8,-.059933,13076e-8,.036699,-45493e-9,-30536e-8,-4019e-7,33258e-8,25139e-8,-94425e-9],[.0010345,28069e-8,-.058073,.0016884,60314e-8,28698e-8,-94011e-8,-.027436,.0016802,92104e-8,69249e-8,-22702e-8,.066974,-.0010873,-.041114,.001512,.0012018,.0011114,-41929e-8,-44924e-8,48777e-8,.079263,-82579e-8,-.04871,.0012239],[-.19034,-2444e-7,24239e-8,-.32454,-52342e-8,16241e-8,.13709,51388e-8,-.33052,-77718e-8,40516e-8,26508e-8,-49573e-8,.26618,6184e-7,-.31105,-95782e-8,68165e-8,54823e-8,-27416e-8,-.16856,-80239e-8,.24124,65755e-8,-.27829],[-.0011081,-34774e-8,.071494,-.0018156,-74006e-8,-15856e-8,.0010154,.028119,-.0018241,-.0011194,-38273e-8,25426e-8,-.037219,.0011883,.077203,-.0016686,-.0014478,-6159e-7,44309e-8,24492e-8,-5473e-7,-.076816,92024e-8,.070376,-.0013866],[.20913,22496e-8,-37233e-8,.35904,46008e-8,-18722e-8,-.23271,-79276e-8,.31504,64806e-8,-46561e-8,-16837e-8,77334e-8,-.28564,-95727e-8,.36127,75063e-8,-78811e-8,-28733e-8,29339e-8,.18106,.0012658,-.26608,-.0010188,.33465],[84963e-9,.052382,-5571e-7,17865e-8,.18766,-29331e-8,-27621e-8,-.0011836,18806e-8,.20994,-73248e-8,-.076903,.0011801,-56632e-8,-.0014015,13191e-8,.30101,-.0012502,-.11842,45557e-8,65345e-8,.0019428,-62852e-8,-.0014294,43093e-10],[-96754e-8,-51675e-8,-63912e-8,-.0016072,-.001083,.078185,97014e-8,-.0013043,-.0016347,-.0016121,.0079833,31921e-8,.0013094,.0012388,-.0013789,-.0015057,-.0020524,.050354,4924e-7,-.010578,-73444e-8,.0020394,.0010368,-.0011048,-.0012466],[-69394e-8,-.021271,19483e-8,-.0011302,-.074072,35281e-10,76388e-8,4068e-7,-.0010388,-.099936,10649e-9,-.031056,-42128e-8,.0010285,44823e-8,-75137e-8,-.12139,25112e-9,.043023,-12284e-10,-7363e-7,-68809e-8,86357e-8,38901e-8,-31354e-8],[37037e-8,19832e-8,3188e-7,61685e-8,41386e-8,-.030053,-38582e-8,6499e-7,62399e-8,61231e-8,-.0042581,-11967e-8,-65333e-8,-50769e-8,68416e-8,56521e-8,77347e-8,-.011831,-18042e-8,.029331,32482e-8,-.0010165,-43409e-8,54187e-8,45129e-8],[.095555,42337e-8,11436e-9,.18453,8833e-7,-10025e-8,-.16336,21057e-9,.19159,.0012792,-24538e-8,-35687e-8,-27472e-9,-.15337,10234e-9,.19432,.0015399,-39922e-8,-65934e-8,16937e-8,.12543,-4234e-8,-.14617,-19446e-9,.17714],[.0014689,47696e-8,-.020051,.0024015,.0010178,33936e-8,-.0013345,-.10387,.002403,.0015391,81767e-8,-37548e-8,.036416,-.0015459,-.10635,.0021849,.0019836,.0013106,-68114e-8,-52628e-8,69154e-8,.1272,-.0011805,-.10495,.0018007],[-.13246,-27364e-8,10347e-8,-.25866,-57337e-8,93873e-9,.211,22088e-8,-.28239,-83314e-8,23232e-8,24413e-8,-21091e-8,.21733,27205e-8,-.27447,-.001005,38613e-8,464e-6,-15691e-8,-.1418,-34326e-8,.23114,30141e-8,-.25458],[-84761e-8,-35117e-8,.010279,-.001399,-73733e-8,96257e-9,78781e-8,.076047,-.0014315,-.0010985,23238e-8,22525e-8,-.079296,94095e-8,.027346,-.0013499,-.001398,37009e-8,35742e-8,-15889e-8,-45169e-8,-.091108,75352e-8,.070644,-.0011753],[.12401,30104e-8,-18076e-8,.25828,59544e-8,-11157e-8,-.13978,-39045e-8,.34268,80897e-8,-27245e-8,-13805e-8,38381e-8,-.23116,-48559e-8,.2872,90023e-8,-45398e-8,-13681e-8,15649e-8,.14854,64302e-8,-.22059,-53981e-8,.31211]]];function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.eventsRegistered=!1}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e,t){this.videoPlayer=e,this.audioPlayer=t,this.allBuffersLoaded=!1,this.wasPlaying=!1,this.waitingForPlayback=!1,this.isSeeking=!1,this.videoPlayer.bigPlayButton.hide(),this.videoPlayer.addClass("vjs-seeking"),this.eventsRegistered||this.registerEvents()}},{key:"reset",value:function(){this.unregisterEvents()}},{key:"registerEvents",value:function(){var e=this;this.videoPlayer.bigPlayButton.off("click"),this.videoPlayer.controlBar.playToggle.off("click"),this.videoPlayer.xr().canvasPlayerControls.addEventListener("vrtoggleplay",(function(){e.togglePlay()})),this.videoPlayer.controlBar.playToggle.on("click",(function(){e.togglePlay()})),this.videoPlayer.bigPlayButton.on("click",(function(){e.togglePlay()})),this.audioPlayer.on(i.MediaPlayer.events.CAN_PLAY,this.onAudioCanPlay,this),this.audioPlayer.on(i.MediaPlayer.events.PLAYBACK_WAITING,this.onAudioPlaybackWaiting,this),this.audioPlayer.on(i.MediaPlayer.events.PLAYBACK_SEEKING,this.onAudioPlaybackSeeking,this),this.audioPlayer.on(i.MediaPlayer.events.PLAYBACK_SEEKED,this.onAudioPlaybackSeeked,this),this.videoPlayer.on("canplay",(function(){e.checkReadyStates()})),this.videoPlayer.on("play",(function(){"running"!==e.context.state&&(e.context.resume(),console.log("resuming context")),e.audioPlayer.play()})),this.videoPlayer.on("pause",(function(){e.audioPlayer.pause()})),this.videoPlayer.on("seeking",(function(){e.isSeeking=!0,e.startWaitingRoutine()})),this.videoPlayer.on("seeked",(function(){var t=this.currentTime();e.audioPlayer.getVideoElement().currentTime=t})),this.videoPlayer.on("waiting",(function(){e.startWaitingRoutine()})),this.eventsRegistered=!0}},{key:"unregisterEvents",value:function(){this.eventsRegistered&&(this.videoPlayer.xr().canvasPlayerControls.removeEventListener("vrtoggleplay"),this.videoPlayer.controlBar.playToggle.off("click"),this.videoPlayer.bigPlayButton.off("click"),this.audioPlayer.off(i.MediaPlayer.events.CAN_PLAY,this.onAudioCanPlay,this),this.audioPlayer.off(i.MediaPlayer.events.PLAYBACK_WAITING,this.onAudioPlaybackWaiting,this),this.audioPlayer.off(i.MediaPlayer.events.PLAYBACK_SEEKING,this.onAudioPlaybackSeeking,this),this.videoPlayer.off("canplay"),this.videoPlayer.off("seeking"),this.videoPlayer.off("seeked"),this.videoPlayer.off("waiting"),this.eventsRegistered=!1)}},{key:"onAudioCanPlay",value:function(){this.checkReadyStates()}},{key:"onAudioPlaybackWaiting",value:function(){this.startWaitingRoutine()}},{key:"onAudioPlaybackSeeking",value:function(){this.startWaitingRoutine()}},{key:"onAudioPlaybackSeeked",value:function(){this.audioPlayer.isSeeking()||(this.isSeeking=!1,this.checkReadyStates())}},{key:"startWaitingRoutine",value:function(){this.waitingForPlayback||(this.waitingForPlayback=!0,this.videoPlayer.pause(),this.videoPlayer.addClass("vjs-seeking"),this.audioPlayer.pause())}},{key:"togglePlay",value:function(){this.wasPlaying?(this.videoPlayer.pause(),this.wasPlaying=!1):this.readyForPlayback()&&this.startPlayback()}},{key:"checkReadyStates",value:function(){this.readyForPlayback()&&this.videoPlayer.paused()&&(this.wasPlaying?this.startPlayback():this.videoPlayer.bigPlayButton.show())}},{key:"startPlayback",value:function(){this.wasPlaying=!0,this.waitingForPlayback=!1,this.videoPlayer.play()}},{key:"readyForPlayback",value:function(){return!(!(this.videoPlayer.readyState()>=3&&this.isAudioReady()&&this.allBuffersLoaded)||this.isSeeking||(this.videoPlayer.removeClass("vjs-seeking"),0))}},{key:"isAudioReady",value:function(){return!(this.audioPlayer.getVideoElement().readyState<3)}},{key:"setAllBuffersLoaded",value:function(e){this.allBuffersLoaded=e,this.checkReadyStates()}}])&&O(t.prototype,n),r&&O(t,r),e}();function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var F=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.order=n,this.nCh=(n+1)*(n+1),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=r;var a=i.slice(i.length-3,i.length);this.fileExt=a;var o=i.slice(0,i.length-4);switch(this.order){case 1:this.nChGroups=1,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a;break;case 2:this.nChGroups=2,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-09ch."+a;break;case 3:this.nChGroups=3,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-12ch."+a,this.urls[2]=o+"_13-16ch."+a;break;case 4:this.nChGroups=4,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-12ch."+a,this.urls[2]=o+"_13-20ch."+a,this.urls[3]=o+"_21-25ch."+a;break;default:console.error("HOASTloader: unsupported Ambisonics order!")}}var t,n,i;return t=e,(n=[{key:"loadBuffers",value:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var i=this;n.onload=function(){i.context.decodeAudioData(n.response,(function(n){n?(i.buffers[t]=n,i.loadCount++,i.loadCount==i.nChGroups&&(i.loaded=!0,i.concatBuffers(),console.log("HOASTloader: all buffers loaded and concatenated"),i.onLoad(i.foaBuffer,i.hoaBuffer))):alert("error decoding file data: "+e)}),(function(t){alert("Browser cannot decode audio data:  "+e+"\n\nError: "+t+"\n\n(If you re using Safari and get a null error, this is most likely due to Apple's shady plan going on to stop the .ogg format from easing web developer's life :)")}))},n.onerror=function(){alert("HOASTloader: XHR error")},n.send()}},{key:"load",value:function(){for(var e=0;e<this.nChGroups;++e)this.loadBuffers(this.urls[e],e)}},{key:"concatBuffers",value:function(){if(this.loaded){var e=this.nCh,t=this.nChGroups;if(this.foaBuffer=this.buffers[0],1!==this.order){for(var n=0,i=1;i<this.nChGroups;++i)n=Math.max(n,this.buffers[i].length);var r=this.buffers[1].sampleRate;this.hoaBuffer=this.context.createBuffer(e-4,n,r);for(var a=1;a<t;a++)for(var o=0;o<this.buffers[a].numberOfChannels;o++)this.hoaBuffer.getChannelData(8*(a-1)+o).set(this.buffers[a].getChannelData(0))}}}}])&&k(t.prototype,n),i&&k(t,i),e}();function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var U=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialized=!1,this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var i=0;i<this.nCh;i++)this.decFilterNodes[i]=this.ctx.createConvolver(),this.decFilterNodes[i].normalize=!1;this.resetFilters();for(var r=0;r<this.nCh;r++){this.in.connect(this.decFilterNodes[r],r,0);var a=Math.floor(Math.sqrt(r));r-a*a-a>=0?this.decFilterNodes[r].connect(this.gainMid):this.decFilterNodes[r].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}var t,n,i;return t=e,(n=[{key:"updateFilters",value:function(e,t){for(var n=0;n<4;++n)this.decFilters[n]=this.ctx.createBuffer(1,e.length,e.sampleRate),this.decFilters[n].getChannelData(0).set(e.getChannelData(n)),this.decFilterNodes[n].buffer=this.decFilters[n];for(var i=4;i<this.nCh;++i)this.decFilters[i]=this.ctx.createBuffer(1,t.length,t.sampleRate),this.decFilters[i].getChannelData(0).set(t.getChannelData(i-4)),this.decFilterNodes[i].buffer=this.decFilters[i]}},{key:"resetFilters",value:function(){var e=new Array(this.nCh);e.fill(0),e[0]=.5,e[1]=.5/Math.sqrt(3);for(var t=0;t<this.nCh;t++){this.decFilters[t]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(var n=0;n<64;n++)this.decFilters[t].getChannelData(0)[n]=0;this.decFilters[t].getChannelData(0)[0]=e[t],this.decFilterNodes[t].buffer=this.decFilters[t]}}}])&&B(t.prototype,n),i&&B(t,i),e}(),j=n(49);function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var z=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=I.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var i=1;i<=this.order;i++){for(var r=new Array(2*i+1),a=0;a<2*i+1;a++){r[a]=new Array(2*i+1);for(var o=0;o<2*i+1;o++)r[a][o]=this.ctx.createGain(),r[a][o].gain.value=a==o?1:0}this.rotMtxNodes[i-1]=r}this.in.connect(this.out,0,0);var s=1;for(i=1;i<=this.order;i++){for(a=0;a<2*i+1;a++)for(o=0;o<2*i+1;o++)this.in.connect(this.rotMtxNodes[i-1][a][o],s+o,0),this.rotMtxNodes[i-1][a][o].connect(this.out,0,s+a);s=s+2*i+1}}var t,n,i;return t=e,(n=[{key:"updateRotMtx",value:function(){var e=this.yaw*Math.PI/180,t=this.pitch*Math.PI/180,n=this.roll*Math.PI/180;this.rotMtx=j.getSHrotMtx(j.yawPitchRoll2Rzyx(e,t,n),this.order);for(var i=1,r=1;r<this.order+1;r++){for(var a=0;a<2*r+1;a++)for(var o=0;o<2*r+1;o++)this.rotMtxNodes[r-1][a][o].gain.value=this.rotMtx[i+a][i+o];i=i+2*r+1}}},{key:"updateRotationFromCamera",value:function(e){this.rotMtx=j.getSHrotMtx([[e[10],e[8],e[9]],[e[2],e[0],e[1]],[e[6],e[4],e[5]]],this.order);for(var t=1,n=1;n<this.order+1;n++){for(var i=0;i<2*n+1;i++)for(var r=0;r<2*n+1;r++)this.rotMtxNodes[n-1][i][r].gain.value=this.rotMtx[t+i][t+r];t=t+2*n+1}}}])&&G(t.prototype,n),i&&G(t,i),e}(),H=(n(297),n(299),n(122)),V=n.n(H);void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(null!=n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t});function W(){}Object.assign(W.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e)}}});const q=[];for(let e=0;e<256;e++)q[e]=(e<16?"0":"")+e.toString(16);let Y=1234567;const X={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(q[255&e]+q[e>>8&255]+q[e>>16&255]+q[e>>24&255]+"-"+q[255&t]+q[t>>8&255]+"-"+q[t>>16&15|64]+q[t>>24&255]+"-"+q[63&n|128]+q[n>>8&255]+"-"+q[n>>16&255]+q[n>>24&255]+q[255&i]+q[i>>8&255]+q[i>>16&255]+q[i>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(Y=e%2147483647),Y=16807*Y%2147483647,(Y-1)/2147483646},degToRad:function(e){return e*X.DEG2RAD},radToDeg:function(e){return e*X.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+i)/2),c=o((t+i)/2),h=a((t-i)/2),d=o((t-i)/2),f=a((i-t)/2),p=o((i-t)/2);switch(r){case"XYX":e.set(s*c,l*h,l*d,s*u);break;case"YZY":e.set(l*d,s*c,l*h,s*u);break;case"ZXZ":e.set(l*h,l*d,s*c,s*u);break;case"XZX":e.set(s*c,l*p,l*f,s*u);break;case"YXY":e.set(l*f,s*c,l*p,s*u);break;case"ZYZ":e.set(l*p,l*f,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};function K(e=0,t=0){this.x=e,this.y=t}function Q(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let Z;Object.defineProperties(K.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(K.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*n-a*i+e.x,this.y=r*i+a*n+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Q.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,a,o,s,l){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=r,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},extractBasis:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],E=i[5],T=i[8];return r[0]=a*p+o*v+s*b,r[3]=a*m+o*y+s*E,r[6]=a*g+o*_+s*T,r[1]=l*p+u*v+c*b,r[4]=l*m+u*y+c*E,r[7]=l*g+u*_+c*T,r[2]=h*p+d*v+f*b,r[5]=h*m+d*y+f*E,r[8]=h*g+d*_+f*T,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*r*u+n*o*s+i*r*l-i*a*s},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const n=e.elements,i=this.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],f=d*l-u*h,p=u*c-d*s,m=h*s-l*c,g=r*f+a*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return i[0]=f*v,i[1]=(o*h-d*a)*v,i[2]=(u*a-o*l)*v,i[3]=p*v,i[4]=(d*r-o*c)*v,i[5]=(o*s-u*r)*v,i[6]=m*v,i[7]=(a*c-h*r)*v,i[8]=(l*r-a*s)*v,this},transpose:function(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,a,o){const s=Math.cos(r),l=Math.sin(r);this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-i*l,i*s,-i*(-l*a+s*o)+o+t,0,0,1)},scale:function(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],u=i[7];return i[0]=t*r+n*s,i[3]=t*a+n*l,i[6]=t*o+n*u,i[1]=-n*r+t*s,i[4]=-n*a+t*l,i[7]=-n*o+t*u,this},translate:function(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});const J={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Z&&(Z=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Z.width=e.width,Z.height=e.height;const n=Z.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Z}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let $=0;function ee(e,t,n,i,r,a,o,s,l,u){Object.defineProperty(this,"id",{value:$++}),this.uuid=X.generateUUID(),this.name="",this.image=void 0!==e?e:ee.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:ee.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==i?i:1001,this.magFilter=void 0!==r?r:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:1023,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new K(0,0),this.repeat=new K(1,1),this.center=new K(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Q,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function te(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}function ne(e,t,n){this.width=e,this.height=t,this.scissor=new te(0,0,e,t),this.scissorTest=!1,this.viewport=new te(0,0,e,t),n=n||{},this.texture=new ee(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function ie(e,t,n){ne.call(this,e,t,n),this.samples=4}function re(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}ee.DEFAULT_IMAGE=void 0,ee.DEFAULT_MAPPING=300,ee.prototype=Object.assign(Object.create(W.prototype),{constructor:ee,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=X.generateUUID()),!t&&void 0===e.images[i.uuid]){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)t.push(J.getDataURL(i[e]))}else t=J.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:t}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(ee.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(te.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(te.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){const t=this.x,n=this.y,i=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){let t,n,i,r;const a=e.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],h=a[9],d=a[2],f=a[6],p=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(o+1)/2,a=(c+1)/2,m=(p+1)/2,g=(s+u)/4,v=(l+d)/4,y=(h+f)/4;return e>a&&e>m?e<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=g/n,r=v/n):a>m?a<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=g/i,r=y/i):m<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(m),n=v/r,i=y/r),this.set(n,i,r,t),this}let m=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(m)<.001&&(m=1),this.x=(f-h)/m,this.y=(l-d)/m,this.z=(u-s)/m,this.w=Math.acos((o+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),ne.prototype=Object.assign(Object.create(W.prototype),{constructor:ne,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),ie.prototype=Object.assign(Object.create(ne.prototype),{constructor:ie,isWebGLMultisampleRenderTarget:!0,copy:function(e){return ne.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(re,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,a,o){let s=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3];const h=r[a+0],d=r[a+1],f=r[a+2],p=r[a+3];if(c!==p||s!==h||l!==d||u!==f){let e=1-o,t=s*h+l*d+u*f+c*p,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),a=Math.atan2(r,t*n);e=Math.sin(e*a)/r,o=Math.sin(o*a)/r}const r=o*n;if(s=s*e+h*r,l=l*e+d*r,u=u*e+f*r,c=c*e+p*r,e===1-o){const e=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=e,l*=e,u*=e,c*=e}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c},multiplyQuaternionsFlat:function(e,t,n,i,r,a){const o=n[i],s=n[i+1],l=n[i+2],u=n[i+3],c=r[a],h=r[a+1],d=r[a+2],f=r[a+3];return e[t]=o*f+u*c+s*d-l*h,e[t+1]=s*f+u*h+l*c-o*d,e[t+2]=l*f+u*d+o*h-s*c,e[t+3]=u*f-o*c-s*h-l*d,e}}),Object.defineProperties(re.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(re.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,r=e._z,a=e.order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(i/2),c=o(r/2),h=s(n/2),d=s(i/2),f=s(r/2);switch(a){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){const t=e.elements,n=t[0],i=t[4],r=t[8],a=t[1],o=t[5],s=t[9],l=t[2],u=t[6],c=t[10],h=n+o+c;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(u-s)*e,this._y=(r-l)*e,this._z=(a-i)*e}else if(n>o&&n>c){const e=2*Math.sqrt(1+n-o-c);this._w=(u-s)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(r+l)/e}else if(o>c){const e=2*Math.sqrt(1+o-n-c);this._w=(r-l)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(s+u)/e}else{const e=2*Math.sqrt(1+c-n-o);this._w=(a-i)/e,this._x=(r+l)/e,this._y=(s+u)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(e,t){let n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(X.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){const n=e._x,i=e._y,r=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+i*l-r*s,this._y=i*u+a*s+r*o-n*l,this._z=r*u+a*l+n*s-i*o,this._w=a*u-n*o-i*s-r*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,a=this._w;let o=a*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;const s=1-o*o;if(s<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),u=Math.atan2(l,o),c=Math.sin((1-t)*u)/l,h=Math.sin(t*u)/l;return this._w=a*c+this._w*h,this._x=n*c+this._x*h,this._y=i*c+this._y*h,this._z=r*c+this._z*h,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});const ae=new se,oe=new re;function se(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}Object.assign(se.prototype,{isVector3:!0,set:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(oe.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(oe.setFromAxisAngle(e,t))},applyMatrix3:function(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){const t=this.x,n=this.y,i=this.z,r=e.elements,a=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*a,this},applyQuaternion:function(e){const t=this.x,n=this.y,i=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*n,u=s*n+o*t-r*i,c=s*i+r*n-a*t,h=-r*t-a*n-o*i;return this.x=l*s+h*-r+u*-o-c*-a,this.y=u*s+h*-a+c*-r-l*-o,this.z=c*s+h*-o+l*-a-u*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){const n=e.x,i=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this},projectOnVector:function(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return ae.copy(this).projectOnVector(e),this.sub(ae)},reflect:function(e){return this.sub(ae.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(X.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const le=new se,ue=new me,ce=new se(0,0,0),he=new se(1,1,1),de=new se,fe=new se,pe=new se;function me(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(me.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,a,o,s,l,u,c,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new me).fromArray(this.elements)},copy:function(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){const t=this.elements,n=e.elements,i=1/le.setFromMatrixColumn(e,0).length(),r=1/le.setFromMatrixColumn(e,1).length(),a=1/le.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,r=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===e.order){const e=a*u,n=a*c,i=o*u,r=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*s,t[2]=r-e*l,t[6]=i+n*l,t[10]=a*s}else if("YXZ"===e.order){const e=s*u,n=s*c,i=l*u,r=l*c;t[0]=e+r*o,t[4]=i*o-n,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=a*s}else if("ZXY"===e.order){const e=s*u,n=s*c,i=l*u,r=l*c;t[0]=e-r*o,t[4]=-a*c,t[8]=i+n*o,t[1]=n+i*o,t[5]=a*u,t[9]=r-e*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){const e=a*u,n=a*c,i=o*u,r=o*c;t[0]=s*u,t[4]=i*l-n,t[8]=e*l+r,t[1]=s*c,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){const e=a*s,n=a*l,i=o*s,r=o*l;t[0]=s*u,t[4]=r-e*c,t[8]=i*c+n,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=n*c+i,t[10]=e-r*c}else if("XZY"===e.order){const e=a*s,n=a*l,i=o*s,r=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=e*c+r,t[5]=a*u,t[9]=n*c-i,t[2]=i*c-n,t[6]=o*u,t[10]=r*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(ce,e,he)},lookAt:function(e,t,n){const i=this.elements;return pe.subVectors(e,t),0===pe.lengthSq()&&(pe.z=1),pe.normalize(),de.crossVectors(n,pe),0===de.lengthSq()&&(1===Math.abs(n.z)?pe.x+=1e-4:pe.z+=1e-4,pe.normalize(),de.crossVectors(n,pe)),de.normalize(),fe.crossVectors(pe,de),i[0]=de.x,i[4]=fe.x,i[8]=pe.x,i[1]=de.y,i[5]=fe.y,i[9]=pe.y,i[2]=de.z,i[6]=fe.z,i[10]=pe.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],E=i[0],T=i[4],w=i[8],x=i[12],A=i[1],S=i[5],M=i[9],C=i[13],R=i[2],I=i[6],P=i[10],L=i[14],D=i[3],O=i[7],N=i[11],k=i[15];return r[0]=a*E+o*A+s*R+l*D,r[4]=a*T+o*S+s*I+l*O,r[8]=a*w+o*M+s*P+l*N,r[12]=a*x+o*C+s*L+l*k,r[1]=u*E+c*A+h*R+d*D,r[5]=u*T+c*S+h*I+d*O,r[9]=u*w+c*M+h*P+d*N,r[13]=u*x+c*C+h*L+d*k,r[2]=f*E+p*A+m*R+g*D,r[6]=f*T+p*S+m*I+g*O,r[10]=f*w+p*M+m*P+g*N,r[14]=f*x+p*C+m*L+g*k,r[3]=v*E+y*A+_*R+b*D,r[7]=v*T+y*S+_*I+b*O,r[11]=v*w+y*M+_*P+b*N,r[15]=v*x+y*C+_*L+b*k,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+r*s*c-i*l*c-r*o*h+n*l*h+i*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*a*h-i*a*d+i*l*u-r*s*u)+e[11]*(+t*l*c-t*o*d-r*a*c+n*a*d+r*o*u-n*l*u)+e[15]*(-i*o*u-t*s*c+t*o*h+i*a*c-n*a*h+n*s*u)},transpose:function(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const n=this.elements,i=e.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],u=i[5],c=i[6],h=i[7],d=i[8],f=i[9],p=i[10],m=i[11],g=i[12],v=i[13],y=i[14],_=i[15],b=f*y*h-v*p*h+v*c*m-u*y*m-f*c*_+u*p*_,E=g*p*h-d*y*h-g*c*m+l*y*m+d*c*_-l*p*_,T=d*v*h-g*f*h+g*u*m-l*v*m-d*u*_+l*f*_,w=g*f*c-d*v*c-g*u*p+l*v*p+d*u*y-l*f*y,x=r*b+a*E+o*T+s*w;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/x;return n[0]=b*A,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*_-a*p*_)*A,n[2]=(u*y*s-v*c*s+v*o*h-a*y*h-u*o*_+a*c*_)*A,n[3]=(f*c*s-u*p*s-f*o*h+a*p*h+u*o*m-a*c*m)*A,n[4]=E*A,n[5]=(d*y*s-g*p*s+g*o*m-r*y*m-d*o*_+r*p*_)*A,n[6]=(g*c*s-l*y*s-g*o*h+r*y*h+l*o*_-r*c*_)*A,n[7]=(l*p*s-d*c*s+d*o*h-r*p*h-l*o*m+r*c*m)*A,n[8]=T*A,n[9]=(g*f*s-d*v*s-g*a*m+r*v*m+d*a*_-r*f*_)*A,n[10]=(l*v*s-g*u*s+g*a*h-r*v*h-l*a*_+r*u*_)*A,n[11]=(d*u*s-l*f*s-d*a*h+r*f*h+l*a*m-r*u*m)*A,n[12]=w*A,n[13]=(d*v*o-g*f*o+g*a*p-r*v*p-d*a*y+r*f*y)*A,n[14]=(g*u*o-l*v*o-g*a*c+r*v*c+l*a*y-r*u*y)*A,n[15]=(l*f*o-d*u*o+d*a*c-r*f*c-l*a*p+r*u*p)*A,this},scale:function(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,a=e.x,o=e.y,s=e.z,l=r*a,u=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,u*o+n,u*s-i*a,0,l*s-i*o,u*s+i*a,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){const i=this.elements,r=t._x,a=t._y,o=t._z,s=t._w,l=r+r,u=a+a,c=o+o,h=r*l,d=r*u,f=r*c,p=a*u,m=a*c,g=o*c,v=s*l,y=s*u,_=s*c,b=n.x,E=n.y,T=n.z;return i[0]=(1-(p+g))*b,i[1]=(d+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(d-_)*E,i[5]=(1-(h+g))*E,i[6]=(m+v)*E,i[7]=0,i[8]=(f+y)*T,i[9]=(m-v)*T,i[10]=(1-(h+p))*T,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:function(e,t,n){const i=this.elements;let r=le.set(i[0],i[1],i[2]).length(),a=le.set(i[4],i[5],i[6]).length(),o=le.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],ue.copy(this);const s=1/r,l=1/a,u=1/o;return ue.elements[0]*=s,ue.elements[1]*=s,ue.elements[2]*=s,ue.elements[4]*=l,ue.elements[5]*=l,ue.elements[6]*=l,ue.elements[8]*=u,ue.elements[9]*=u,ue.elements[10]*=u,t.setFromRotationMatrix(ue),n.x=r,n.y=a,n.z=o,this},makePerspective:function(e,t,n,i,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,s=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,i,r,a){const o=this.elements,s=1/(t-e),l=1/(n-i),u=1/(a-r),c=(t+e)*s,h=(n+i)*l,d=(a+r)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});const ge=new me,ve=new re;function ye(e=0,t=0,n=0,i=ye.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}function _e(){this.mask=1}ye.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ye.DefaultOrder="XYZ",Object.defineProperties(ye.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(ye.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){const i=X.clamp,r=e.elements,a=r[0],o=r[4],s=r[8],l=r[1],u=r[5],c=r[9],h=r[2],d=r[6],f=r[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0);break;case"ZXY":this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return ge.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ge,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return ve.setFromEuler(this),this.setFromQuaternion(ve,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new se(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(_e.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});let be=0;const Ee=new se,Te=new re,we=new me,xe=new se,Ae=new se,Se=new se,Me=new re,Ce=new se(1,0,0),Re=new se(0,1,0),Ie=new se(0,0,1),Pe={type:"added"},Le={type:"removed"};function De(){Object.defineProperty(this,"id",{value:be++}),this.uuid=X.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=De.DefaultUp.clone();const e=new se,t=new ye,n=new re,i=new se(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new me},normalMatrix:{value:new Q}}),this.matrix=new me,this.matrixWorld=new me,this.matrixAutoUpdate=De.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new _e,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Oe(){De.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}De.DefaultUp=new se(0,1,0),De.DefaultMatrixAutoUpdate=!0,De.prototype=Object.assign(Object.create(W.prototype),{constructor:De,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Te.setFromAxisAngle(e,t),this.quaternion.multiply(Te),this},rotateOnWorldAxis:function(e,t){return Te.setFromAxisAngle(e,t),this.quaternion.premultiply(Te),this},rotateX:function(e){return this.rotateOnAxis(Ce,e)},rotateY:function(e){return this.rotateOnAxis(Re,e)},rotateZ:function(e){return this.rotateOnAxis(Ie,e)},translateOnAxis:function(e,t){return Ee.copy(e).applyQuaternion(this.quaternion),this.position.add(Ee.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Ce,e)},translateY:function(e){return this.translateOnAxis(Re,e)},translateZ:function(e){return this.translateOnAxis(Ie,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(we.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?xe.copy(e):xe.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ae.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?we.lookAt(Ae,xe,this.up):we.lookAt(xe,Ae,this.up),this.quaternion.setFromRotationMatrix(we),i&&(we.extractRotation(i.matrixWorld),Te.setFromRotationMatrix(we),this.quaternion.premultiply(Te.inverse()))},add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Pe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Le)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),we.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),we.multiply(e.parent.matrixWorld)),e.applyMatrix4(we),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new se),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new re),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ae,e,Se),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new se),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ae,Me,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new se),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)},traverseAncestors:function(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}},toJSON:function(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(t){const t=a(e.geometries),i=a(e.materials),r=a(e.textures),o=a(e.images),s=a(e.shapes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s)}return n.object=i,n;function a(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}),Oe.prototype=Object.assign(Object.create(De.prototype),{constructor:Oe,isScene:!0,copy:function(e,t){return De.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){const t=De.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Ne=[new se,new se,new se,new se,new se,new se,new se,new se],ke=new se,Fe=new Xe,Be=new se,Ue=new se,je=new se,Ge=new se,ze=new se,He=new se,Ve=new se,We=new se,qe=new se,Ye=new se;function Xe(e,t){this.min=void 0!==e?e:new se(1/0,1/0,1/0),this.max=void 0!==t?t:new se(-1/0,-1/0,-1/0)}function Ke(e,t,n,i,r){for(let a=0,o=e.length-3;a<=o;a+=3){Ye.fromArray(e,a);const o=r.x*Math.abs(Ye.x)+r.y*Math.abs(Ye.y)+r.z*Math.abs(Ye.z),s=t.dot(Ye),l=n.dot(Ye),u=i.dot(Ye);if(Math.max(-Math.max(s,l,u),Math.min(s,l,u))>o)return!1}return!0}Object.assign(Xe.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){let t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.length;s<l;s+=3){const l=e[s],u=e[s+1],c=e[s+2];l<t&&(t=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>a&&(a=u),c>o&&(o=c)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromBufferAttribute:function(e){let t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=e.count;s<l;s++){const l=e.getX(s),u=e.getY(s),c=e.getZ(s);l<t&&(t=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>a&&(a=u),c>o&&(o=c)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const n=ke.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new se),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new se),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Fe.copy(t.boundingBox),Fe.applyMatrix4(e.matrixWorld),this.union(Fe));const n=e.children;for(let e=0,t=n.length;e<t;e++)this.expandByObject(n[e]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new se),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,ke),ke.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Ve),We.subVectors(this.max,Ve),Be.subVectors(e.a,Ve),Ue.subVectors(e.b,Ve),je.subVectors(e.c,Ve),Ge.subVectors(Ue,Be),ze.subVectors(je,Ue),He.subVectors(Be,je);let t=[0,-Ge.z,Ge.y,0,-ze.z,ze.y,0,-He.z,He.y,Ge.z,0,-Ge.x,ze.z,0,-ze.x,He.z,0,-He.x,-Ge.y,Ge.x,0,-ze.y,ze.x,0,-He.y,He.x,0];return!!Ke(t,Be,Ue,je,We)&&(t=[1,0,0,0,1,0,0,0,1],!!Ke(t,Be,Ue,je,We)&&(qe.crossVectors(Ge,ze),t=[qe.x,qe.y,qe.z],Ke(t,Be,Ue,je,We)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new se),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return ke.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(ke).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(Ne[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ne[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ne[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ne[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ne[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ne[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ne[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ne[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ne)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const Qe=new Xe;function Ze(e,t){this.center=void 0!==e?e:new se,this.radius=void 0!==t?t:-1}Object.assign(Ze.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){const n=this.center;void 0!==t?n.copy(t):Qe.setFromPoints(e).getCenter(n);let i=0;for(let t=0,r=e.length;t<r;t++)i=Math.max(i,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){const n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new se),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Xe),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});const Je=new se,$e=new se,et=new se,tt=new se,nt=new se,it=new se,rt=new se;function at(e,t){this.origin=void 0!==e?e:new se,this.direction=void 0!==t?t:new se(0,0,-1)}Object.assign(at.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new se),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Je)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new se),t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){const t=Je.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Je.copy(this.direction).multiplyScalar(t).add(this.origin),Je.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,i){$e.copy(e).add(t).multiplyScalar(.5),et.copy(t).sub(e).normalize(),tt.copy(this.origin).sub($e);const r=.5*e.distanceTo(t),a=-this.direction.dot(et),o=tt.dot(this.direction),s=-tt.dot(et),l=tt.lengthSq(),u=Math.abs(1-a*a);let c,h,d,f;if(u>0)if(c=a*s-o,h=a*o-s,f=r*u,c>=0)if(h>=-f)if(h<=f){const e=1/u;c*=e,h*=e,d=c*(c+a*h+2*o)+h*(a*c+h+2*s)+l}else h=r,c=Math.max(0,-(a*h+o)),d=-c*c+h*(h+2*s)+l;else h=-r,c=Math.max(0,-(a*h+o)),d=-c*c+h*(h+2*s)+l;else h<=-f?(c=Math.max(0,-(-a*r+o)),h=c>0?-r:Math.min(Math.max(-r,-s),r),d=-c*c+h*(h+2*s)+l):h<=f?(c=0,h=Math.min(Math.max(-r,-s),r),d=h*(h+2*s)+l):(c=Math.max(0,-(a*r+o)),h=c>0?r:Math.min(Math.max(-r,-s),r),d=-c*c+h*(h+2*s)+l);else h=a>0?-r:r,c=Math.max(0,-(a*h+o)),d=-c*c+h*(h+2*s)+l;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(et).multiplyScalar(h).add($e),d},intersectSphere:function(e,t){Je.subVectors(e.center,this.origin);const n=Je.dot(this.direction),i=Je.dot(Je)-n*n,r=e.radius*e.radius;if(i>r)return null;const a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){let n,i,r,a,o,s;const l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),u>=0?(r=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(r=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||r>i?null:((r>n||n!=n)&&(n=r),(a<i||i!=i)&&(i=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>i?null:((o>n||n!=n)&&(n=o),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Je)},intersectTriangle:function(e,t,n,i,r){nt.subVectors(t,e),it.subVectors(n,e),rt.crossVectors(nt,it);let a,o=this.direction.dot(rt);if(o>0){if(i)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}tt.subVectors(this.origin,e);const s=a*this.direction.dot(it.crossVectors(tt,it));if(s<0)return null;const l=a*this.direction.dot(nt.cross(tt));if(l<0)return null;if(s+l>o)return null;const u=-a*tt.dot(rt);return u<0?null:this.at(u/o,r)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});const ot=new se,st=new se,lt=new Q;function ut(e,t){this.normal=void 0!==e?e:new se(1,0,0),this.constant=void 0!==t?t:0}Object.assign(ut.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){const i=ot.subVectors(n,t).cross(st.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new se),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new se);const n=e.delta(ot),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?void 0:t.copy(n).multiplyScalar(r).add(e.start)},intersectsLine:function(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new se),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){const n=t||lt.getNormalMatrix(e),i=this.coplanarPoint(ot).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});const ct=new se,ht=new se,dt=new se,ft=new se,pt=new se,mt=new se,gt=new se,vt=new se,yt=new se,_t=new se;function bt(e,t,n){this.a=void 0!==e?e:new se,this.b=void 0!==t?t:new se,this.c=void 0!==n?n:new se}Object.assign(bt,{getNormal:function(e,t,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new se),i.subVectors(n,t),ct.subVectors(e,t),i.cross(ct);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)},getBarycoord:function(e,t,n,i,r){ct.subVectors(i,t),ht.subVectors(n,t),dt.subVectors(e,t);const a=ct.dot(ct),o=ct.dot(ht),s=ct.dot(dt),l=ht.dot(ht),u=ht.dot(dt),c=a*l-o*o;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new se),0===c)return r.set(-2,-1,-1);const h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return r.set(1-d-f,f,d)},containsPoint:function(e,t,n,i){return bt.getBarycoord(e,t,n,i,ft),ft.x>=0&&ft.y>=0&&ft.x+ft.y<=1},getUV:function(e,t,n,i,r,a,o,s){return this.getBarycoord(e,t,n,i,ft),s.set(0,0),s.addScaledVector(r,ft.x),s.addScaledVector(a,ft.y),s.addScaledVector(o,ft.z),s},isFrontFacing:function(e,t,n,i){return ct.subVectors(n,t),ht.subVectors(e,t),ct.cross(ht).dot(i)<0}}),Object.assign(bt.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return ct.subVectors(this.c,this.b),ht.subVectors(this.a,this.b),.5*ct.cross(ht).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new se),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return bt.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new ut),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return bt.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,i,r){return bt.getUV(e,this.a,this.b,this.c,t,n,i,r)},containsPoint:function(e){return bt.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return bt.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new se);const n=this.a,i=this.b,r=this.c;let a,o;pt.subVectors(i,n),mt.subVectors(r,n),vt.subVectors(e,n);const s=pt.dot(vt),l=mt.dot(vt);if(s<=0&&l<=0)return t.copy(n);yt.subVectors(e,i);const u=pt.dot(yt),c=mt.dot(yt);if(u>=0&&c<=u)return t.copy(i);const h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return a=s/(s-u),t.copy(n).addScaledVector(pt,a);_t.subVectors(e,r);const d=pt.dot(_t),f=mt.dot(_t);if(f>=0&&d<=f)return t.copy(r);const p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(n).addScaledVector(mt,o);const m=u*f-d*c;if(m<=0&&c-u>=0&&d-f>=0)return gt.subVectors(r,i),o=(c-u)/(c-u+(d-f)),t.copy(i).addScaledVector(gt,o);const g=1/(m+p+h);return a=p*g,o=h*g,t.copy(n).addScaledVector(pt,a).addScaledVector(mt,o)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});const Et={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Tt={h:0,s:0,l:0},wt={h:0,s:0,l:0};function xt(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function At(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function St(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Mt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function Ct(e,t,n,i,r,a){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new se,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new xt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Object.assign(xt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=X.euclideanModulo(e,1),t=X.clamp(t,0,1),n=X.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=At(r,i,e+1/3),this.g=At(r,i,e),this.b=At(r,i,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){let e;const i=n[1],r=n[2];switch(i){case"rgb":case"rgba":if(e=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[5]),this;if(e=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[5]),this;break;case"hsl":case"hsla":if(e=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){const n=parseFloat(e[1])/360,i=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100;return t(e[5]),this.setHSL(n,i,r)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){const e=n[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){const t=Et[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);const n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=St(e.r),this.g=St(e.g),this.b=St(e.b),this},copyLinearToSRGB:function(e){return this.r=Mt(e.r),this.g=Mt(e.g),this.b=Mt(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,n=this.g,i=this.b,r=Math.max(t,n,i),a=Math.min(t,n,i);let o,s;const l=(a+r)/2;if(a===r)o=0,s=0;else{const e=r-a;switch(s=l<=.5?e/(r+a):e/(2-r-a),r){case t:o=(n-i)/e+(n<i?6:0);break;case n:o=(i-t)/e+2;break;case i:o=(t-n)/e+4}o/=6}return e.h=o,e.s=s,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Tt),Tt.h+=e,Tt.s+=t,Tt.l+=n,this.setHSL(Tt.h,Tt.s,Tt.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Tt),e.getHSL(wt);const n=X.lerp(Tt.h,wt.h,t),i=X.lerp(Tt.s,wt.s,t),r=X.lerp(Tt.l,wt.l,t);return this.setHSL(n,i,r),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},fromBufferAttribute:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),xt.NAMES=Et,Object.assign(Ct.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});let Rt=0;function It(){Object.defineProperty(this,"id",{value:Rt++}),this.uuid=X.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Pt(e){It.call(this),this.type="MeshBasicMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}It.prototype=Object.assign(Object.create(W.prototype),{constructor:It,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}},toJSON:function(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(It.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Pt.prototype=Object.create(It.prototype),Pt.prototype.constructor=Pt,Pt.prototype.isMeshBasicMaterial=!0,Pt.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};const Lt=new se,Dt=new K;function Ot(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Nt(e,t,n){Ot.call(this,new Int8Array(e),t,n)}function kt(e,t,n){Ot.call(this,new Uint8Array(e),t,n)}function Ft(e,t,n){Ot.call(this,new Uint8ClampedArray(e),t,n)}function Bt(e,t,n){Ot.call(this,new Int16Array(e),t,n)}function Ut(e,t,n){Ot.call(this,new Uint16Array(e),t,n)}function jt(e,t,n){Ot.call(this,new Int32Array(e),t,n)}function Gt(e,t,n){Ot.call(this,new Uint32Array(e),t,n)}function zt(e,t,n){Ot.call(this,new Float32Array(e),t,n)}function Ht(e,t,n){Ot.call(this,new Float64Array(e),t,n)}function Vt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Wt(e){if(0===e.length)return-1/0;let t=e[0];for(let n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(Ot.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ot.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new xt),t[n++]=r.r,t[n++]=r.g,t[n++]=r.b}return this},copyVector2sArray:function(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new K),t[n++]=r.x,t[n++]=r.y}return this},copyVector3sArray:function(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new se),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z}return this},copyVector4sArray:function(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new te),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n++]=r.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Dt.fromBufferAttribute(this,t),Dt.applyMatrix3(e),this.setXY(t,Dt.x,Dt.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Lt.fromBufferAttribute(this,t),Lt.applyMatrix3(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this},applyMatrix4:function(e){for(let t=0,n=this.count;t<n;t++)Lt.x=this.getX(t),Lt.y=this.getY(t),Lt.z=this.getZ(t),Lt.applyMatrix4(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this},applyNormalMatrix:function(e){for(let t=0,n=this.count;t<n;t++)Lt.x=this.getX(t),Lt.y=this.getY(t),Lt.z=this.getZ(t),Lt.applyNormalMatrix(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this},transformDirection:function(e){for(let t=0,n=this.count;t<n;t++)Lt.x=this.getX(t),Lt.y=this.getY(t),Lt.z=this.getZ(t),Lt.transformDirection(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Nt.prototype=Object.create(Ot.prototype),Nt.prototype.constructor=Nt,kt.prototype=Object.create(Ot.prototype),kt.prototype.constructor=kt,Ft.prototype=Object.create(Ot.prototype),Ft.prototype.constructor=Ft,Bt.prototype=Object.create(Ot.prototype),Bt.prototype.constructor=Bt,Ut.prototype=Object.create(Ot.prototype),Ut.prototype.constructor=Ut,jt.prototype=Object.create(Ot.prototype),jt.prototype.constructor=jt,Gt.prototype=Object.create(Ot.prototype),Gt.prototype.constructor=Gt,zt.prototype=Object.create(Ot.prototype),zt.prototype.constructor=zt,Ht.prototype=Object.create(Ot.prototype),Ht.prototype.constructor=Ht,Object.assign(Vt.prototype,{computeGroups:function(e){const t=[];let n,i,r=void 0;const a=e.faces;for(i=0;i<a.length;i++){const e=a[i];e.materialIndex!==r&&(r=e.materialIndex,void 0!==n&&(n.count=3*i-n.start,t.push(n)),n={start:3*i,materialIndex:r})}void 0!==n&&(n.count=3*i-n.start,t.push(n)),this.groups=t},fromGeometry:function(e){const t=e.faces,n=e.vertices,i=e.faceVertexUvs,r=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=e.morphTargets,s=o.length;let l;if(s>0){l=[];for(let e=0;e<s;e++)l[e]={name:o[e].name,data:[]};this.morphTargets.position=l}const u=e.morphNormals,c=u.length;let h;if(c>0){h=[];for(let e=0;e<c;e++)h[e]={name:u[e].name,data:[]};this.morphTargets.normal=h}const d=e.skinIndices,f=e.skinWeights,p=d.length===n.length,m=f.length===n.length;n.length>0&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let e=0;e<t.length;e++){const g=t[e];this.vertices.push(n[g.a],n[g.b],n[g.c]);const v=g.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{const e=g.normal;this.normals.push(e,e,e)}const y=g.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{const e=g.color;this.colors.push(e,e,e)}if(!0===r){const t=i[0][e];void 0!==t?this.uvs.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",e),this.uvs.push(new K,new K,new K))}if(!0===a){const t=i[1][e];void 0!==t?this.uvs2.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",e),this.uvs2.push(new K,new K,new K))}for(let e=0;e<s;e++){const t=o[e].vertices;l[e].data.push(t[g.a],t[g.b],t[g.c])}for(let t=0;t<c;t++){const n=u[t].vertexNormals[e];h[t].data.push(n.a,n.b,n.c)}p&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),m&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});let qt=1;const Yt=new me,Xt=new De,Kt=new se,Qt=new Xe,Zt=new Xe,Jt=new se;function $t(){Object.defineProperty(this,"id",{value:qt+=2}),this.uuid=X.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}$t.prototype=Object.assign(Object.create(W.prototype),{constructor:$t,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Wt(e)>65535?Gt:Ut)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Q).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Yt.makeRotationX(e),this.applyMatrix4(Yt),this},rotateY:function(e){return Yt.makeRotationY(e),this.applyMatrix4(Yt),this},rotateZ:function(e){return Yt.makeRotationZ(e),this.applyMatrix4(Yt),this},translate:function(e,t,n){return Yt.makeTranslation(e,t,n),this.applyMatrix4(Yt),this},scale:function(e,t,n){return Yt.makeScale(e,t,n),this.applyMatrix4(Yt),this},lookAt:function(e){return Xt.lookAt(e),Xt.updateMatrix(),this.applyMatrix4(Xt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kt).negate(),this.translate(Kt.x,Kt.y,Kt.z),this},setFromObject:function(e){const t=e.geometry;if(e.isPoints||e.isLine){const e=new zt(3*t.vertices.length,3),n=new zt(3*t.colors.length,3);if(this.setAttribute("position",e.copyVector3sArray(t.vertices)),this.setAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){const e=new zt(t.lineDistances.length,1);this.setAttribute("lineDistance",e.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new zt(t,3)),this},updateFromObject:function(e){let t=e.geometry;if(e.isMesh){let e=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(e=void 0,t.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(t);e.verticesNeedUpdate=t.verticesNeedUpdate,e.normalsNeedUpdate=t.normalsNeedUpdate,e.colorsNeedUpdate=t.colorsNeedUpdate,e.uvsNeedUpdate=t.uvsNeedUpdate,e.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=e}if(!0===t.verticesNeedUpdate){const e=this.attributes.position;void 0!==e&&(e.copyVector3sArray(t.vertices),e.needsUpdate=!0),t.verticesNeedUpdate=!1}if(!0===t.normalsNeedUpdate){const e=this.attributes.normal;void 0!==e&&(e.copyVector3sArray(t.normals),e.needsUpdate=!0),t.normalsNeedUpdate=!1}if(!0===t.colorsNeedUpdate){const e=this.attributes.color;void 0!==e&&(e.copyColorsArray(t.colors),e.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){const e=this.attributes.uv;void 0!==e&&(e.copyVector2sArray(t.uvs),e.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){const e=this.attributes.lineDistance;void 0!==e&&(e.copyArray(t.lineDistances),e.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Vt).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){const t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new Ot(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){const t=new Float32Array(3*e.normals.length);this.setAttribute("normal",new Ot(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){const t=new Float32Array(3*e.colors.length);this.setAttribute("color",new Ot(t,3).copyColorsArray(e.colors))}if(e.uvs.length>0){const t=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new Ot(t,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){const t=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new Ot(t,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(const t in e.morphTargets){const n=[],i=e.morphTargets[t];for(let e=0,t=i.length;e<t;e++){const t=i[e],r=new zt(3*t.data.length,3);r.name=t.name,n.push(r.copyVector3sArray(t.data))}this.morphAttributes[t]=n}if(e.skinIndices.length>0){const t=new zt(4*e.skinIndices.length,4);this.setAttribute("skinIndex",t.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){const t=new zt(4*e.skinWeights.length,4);this.setAttribute("skinWeight",t.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xe);const e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];Qt.setFromBufferAttribute(n),this.morphTargetsRelative?(Jt.addVectors(this.boundingBox.min,Qt.min),this.boundingBox.expandByPoint(Jt),Jt.addVectors(this.boundingBox.max,Qt.max),this.boundingBox.expandByPoint(Jt)):(this.boundingBox.expandByPoint(Qt.min),this.boundingBox.expandByPoint(Qt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ze);const e=this.attributes.position,t=this.morphAttributes.position;if(e){const n=this.boundingSphere.center;if(Qt.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];Zt.setFromBufferAttribute(n),this.morphTargetsRelative?(Jt.addVectors(Qt.min,Zt.min),Qt.expandByPoint(Jt),Jt.addVectors(Qt.max,Zt.max),Qt.expandByPoint(Jt)):(Qt.expandByPoint(Zt.min),Qt.expandByPoint(Zt.max))}Qt.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)Jt.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(Jt));if(t)for(let r=0,a=t.length;r<a;r++){const a=t[r],o=this.morphTargetsRelative;for(let t=0,r=a.count;t<r;t++)Jt.fromBufferAttribute(a,t),o&&(Kt.fromBufferAttribute(e,t),Jt.add(Kt)),i=Math.max(i,n.distanceToSquared(Jt))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Ot(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new se,r=new se,a=new se,o=new se,s=new se,l=new se,u=new se,c=new se;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),u.subVectors(a,r),c.subVectors(i,r),u.cross(c),o.fromBufferAttribute(n,d),s.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),o.add(u),s.add(u),l.add(u),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),u.subVectors(a,r),c.subVectors(i,r),u.cross(c),n.setXYZ(e+0,u.x,u.y,u.z),n.setXYZ(e+1,u.x,u.y,u.z),n.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===e.attributes[i])continue;const r=n[i].array,a=e.attributes[i],o=a.array,s=a.itemSize*t,l=Math.min(o.length,r.length-s);for(let e=0,t=s;e<l;e++,t++)r[t]=o[e]}return this},normalizeNormals:function(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Jt.fromBufferAttribute(e,t),Jt.normalize(),e.setXYZ(t,Jt.x,Jt.y,Jt.z)},toNonIndexed:function(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,a=new n.constructor(t.length*i);let o=0,s=0;for(let e=0,r=t.length;e<r;e++){o=t[e]*i;for(let e=0;e<i;e++)a[s++]=n[o++]}return new Ot(a,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const t=new $t,n=this.index.array,i=this.attributes;for(const r in i){const a=e(i[r],n);t.setAttribute(r,a)}const r=this.morphAttributes;for(const i in r){const a=[],o=r[i];for(let t=0,i=o.length;t<i;t++){const i=e(o[t],n);a.push(i)}t.morphAttributes[i]=a}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let e=0,n=a.length;e<n;e++){const n=a[e];t.addGroup(n.start,n.count,n.materialIndex)}return t},toJSON:function(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const i=n[t],r=i.toJSON(e.data);""!==i.name&&(r.name=i.name),e.data.attributes[t]=r}const i={};let r=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],a=[];for(let t=0,i=n.length;t<i;t++){const i=n[t],r=i.toJSON(e.data);""!==i.name&&(r.name=i.name),a.push(r)}a.length>0&&(i[t]=a,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e},clone:function(){return(new $t).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const e in i){const n=i[e];this.setAttribute(e,n.clone(t))}const r=e.morphAttributes;for(const e in r){const n=[],i=r[e];for(let e=0,r=i.length;e<r;e++)n.push(i[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let e=0,t=a.length;e<t;e++){const t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const en=new me,tn=new at,nn=new Ze,rn=new se,an=new se,on=new se,sn=new se,ln=new se,un=new se,cn=new se,hn=new se,dn=new se,fn=new K,pn=new K,mn=new K,gn=new se,vn=new se;function yn(e,t){De.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new $t,this.material=void 0!==t?t:new Pt,this.updateMorphTargets()}function _n(e,t,n,i,r,a,o,s){let l;if(l=1===t.side?i.intersectTriangle(o,a,r,!0,s):i.intersectTriangle(r,a,o,2!==t.side,s),null===l)return null;vn.copy(s),vn.applyMatrix4(e.matrixWorld);const u=n.ray.origin.distanceTo(vn);return u<n.near||u>n.far?null:{distance:u,point:vn.clone(),object:e}}function bn(e,t,n,i,r,a,o,s,l,u,c,h){rn.fromBufferAttribute(r,u),an.fromBufferAttribute(r,c),on.fromBufferAttribute(r,h);const d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){cn.set(0,0,0),hn.set(0,0,0),dn.set(0,0,0);for(let e=0,t=a.length;e<t;e++){const t=d[e],n=a[e];0!==t&&(sn.fromBufferAttribute(n,u),ln.fromBufferAttribute(n,c),un.fromBufferAttribute(n,h),o?(cn.addScaledVector(sn,t),hn.addScaledVector(ln,t),dn.addScaledVector(un,t)):(cn.addScaledVector(sn.sub(rn),t),hn.addScaledVector(ln.sub(an),t),dn.addScaledVector(un.sub(on),t)))}rn.add(cn),an.add(hn),on.add(dn)}e.isSkinnedMesh&&(e.boneTransform(u,rn),e.boneTransform(c,an),e.boneTransform(h,on));const f=_n(e,t,n,i,rn,an,on,gn);if(f){s&&(fn.fromBufferAttribute(s,u),pn.fromBufferAttribute(s,c),mn.fromBufferAttribute(s,h),f.uv=bt.getUV(gn,rn,an,on,fn,pn,mn,new K)),l&&(fn.fromBufferAttribute(l,u),pn.fromBufferAttribute(l,c),mn.fromBufferAttribute(l,h),f.uv2=bt.getUV(gn,rn,an,on,fn,pn,mn,new K));const e=new Ct(u,c,h);bt.getNormal(rn,an,on,e.normal),f.face=e}return f}yn.prototype=Object.assign(Object.create(De.prototype),{constructor:yn,isMesh:!0,copy:function(e){return De.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),nn.copy(n.boundingSphere),nn.applyMatrix4(r),!1===e.ray.intersectsSphere(nn))return;if(en.getInverse(r),tn.copy(e.ray).applyMatrix4(en),null!==n.boundingBox&&!1===tn.intersectsBox(n.boundingBox))return;let a;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,u=n.attributes.uv,c=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,f=h.length;n<f;n++){const f=h[n],p=i[f.materialIndex];for(let n=Math.max(f.start,d.start),i=Math.min(f.start+f.count,d.start+d.count);n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);a=bn(this,p,e,tn,o,s,l,u,c,i,h,d),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=f.materialIndex,t.push(a))}}else{for(let n=Math.max(0,d.start),h=Math.min(r.count,d.start+d.count);n<h;n+=3){const h=r.getX(n),d=r.getX(n+1),f=r.getX(n+2);a=bn(this,i,e,tn,o,s,l,u,c,h,d,f),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}else if(void 0!==o)if(Array.isArray(i))for(let n=0,r=h.length;n<r;n++){const r=h[n],f=i[r.materialIndex];for(let n=Math.max(r.start,d.start),i=Math.min(r.start+r.count,d.start+d.count);n<i;n+=3){a=bn(this,f,e,tn,o,s,l,u,c,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=r.materialIndex,t.push(a))}}else{for(let n=Math.max(0,d.start),r=Math.min(o.count,d.start+d.count);n<r;n+=3){a=bn(this,i,e,tn,o,s,l,u,c,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}}else if(n.isGeometry){const r=Array.isArray(i),o=n.vertices,s=n.faces;let l;const u=n.faceVertexUvs[0];u.length>0&&(l=u);for(let n=0,u=s.length;n<u;n++){const u=s[n],c=r?i[u.materialIndex]:i;if(void 0===c)continue;const h=o[u.a],d=o[u.b],f=o[u.c];if(a=_n(this,c,e,tn,h,d,f,gn),a){if(l&&l[n]){const e=l[n];fn.copy(e[0]),pn.copy(e[1]),mn.copy(e[2]),a.uv=bt.getUV(gn,h,d,f,fn,pn,mn,new K)}a.face=u,a.faceIndex=n,t.push(a)}}}}});let En=0;const Tn=new me,wn=new De,xn=new se;function An(){Object.defineProperty(this,"id",{value:En+=2}),this.uuid=X.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}An.prototype=Object.assign(Object.create(W.prototype),{constructor:An,isGeometry:!0,applyMatrix4:function(e){const t=(new Q).getNormalMatrix(e);for(let t=0,n=this.vertices.length;t<n;t++){this.vertices[t].applyMatrix4(e)}for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];n.normal.applyMatrix3(t).normalize();for(let e=0,i=n.vertexNormals.length;e<i;e++)n.vertexNormals[e].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Tn.makeRotationX(e),this.applyMatrix4(Tn),this},rotateY:function(e){return Tn.makeRotationY(e),this.applyMatrix4(Tn),this},rotateZ:function(e){return Tn.makeRotationZ(e),this.applyMatrix4(Tn),this},translate:function(e,t,n){return Tn.makeTranslation(e,t,n),this.applyMatrix4(Tn),this},scale:function(e,t,n){return Tn.makeScale(e,t,n),this.applyMatrix4(Tn),this},lookAt:function(e){return wn.lookAt(e),wn.updateMatrix(),this.applyMatrix4(wn.matrix),this},fromBufferGeometry:function(e){const t=this,n=null!==e.index?e.index:void 0,i=e.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const r=i.position,a=i.normal,o=i.color,s=i.uv,l=i.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let e=0;e<r.count;e++)t.vertices.push((new se).fromBufferAttribute(r,e)),void 0!==o&&t.colors.push((new xt).fromBufferAttribute(o,e));function u(e,n,i,r){const u=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],c=new Ct(e,n,i,void 0===a?[]:[(new se).fromBufferAttribute(a,e),(new se).fromBufferAttribute(a,n),(new se).fromBufferAttribute(a,i)],u,r);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new K).fromBufferAttribute(s,e),(new K).fromBufferAttribute(s,n),(new K).fromBufferAttribute(s,i)]),void 0!==l&&t.faceVertexUvs[1].push([(new K).fromBufferAttribute(l,e),(new K).fromBufferAttribute(l,n),(new K).fromBufferAttribute(l,i)])}const c=e.groups;if(c.length>0)for(let e=0;e<c.length;e++){const t=c[e],i=t.start;for(let e=i,r=i+t.count;e<r;e+=3)void 0!==n?u(n.getX(e),n.getX(e+1),n.getX(e+2),t.materialIndex):u(e,e+1,e+2,t.materialIndex)}else if(void 0!==n)for(let e=0;e<n.count;e+=3)u(n.getX(e),n.getX(e+1),n.getX(e+2));else for(let e=0;e<r.count;e+=3)u(e,e+1,e+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(xn).negate(),this.translate(xn.x,xn.y,xn.z),this},normalize:function(){this.computeBoundingSphere();const e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new me;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){const e=new se,t=new se;for(let n=0,i=this.faces.length;n<i;n++){const i=this.faces[n],r=this.vertices[i.a],a=this.vertices[i.b],o=this.vertices[i.c];e.subVectors(o,a),t.subVectors(r,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);const t=new Array(this.vertices.length);for(let e=0,n=this.vertices.length;e<n;e++)t[e]=new se;if(e){const e=new se,n=new se;for(let i=0,r=this.faces.length;i<r;i++){const r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,o),n.subVectors(a,o),e.cross(n),t[r.a].add(e),t[r.b].add(e),t[r.c].add(e)}}else{this.computeFaceNormals();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let e=0,n=this.vertices.length;e<n;e++)t[e].normalize();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e],i=n.vertexNormals;3===i.length?(i[0].copy(t[n.a]),i[1].copy(t[n.b]),i[2].copy(t[n.c])):(i[0]=t[n.a].clone(),i[1]=t[n.b].clone(),i[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],n=t.vertexNormals;3===n.length?(n[0].copy(t.normal),n[1].copy(t.normal),n[2].copy(t.normal)):(n[0]=t.normal.clone(),n[1]=t.normal.clone(),n[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(let e=0,n=t.vertexNormals.length;e<n;e++)t.__originalVertexNormals[e]?t.__originalVertexNormals[e].copy(t.vertexNormals[e]):t.__originalVertexNormals[e]=t.vertexNormals[e].clone()}const e=new An;e.faces=this.faces;for(let t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const e=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals;for(let t=0,i=this.faces.length;t<i;t++){const t=new se,i={a:new se,b:new se,c:new se};e.push(t),n.push(i)}}const n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],i=n.faceNormals[e],r=n.vertexNormals[e];i.copy(t.normal),r.a.copy(t.vertexNormals[0]),r.b.copy(t.vertexNormals[1]),r.c.copy(t.vertexNormals[2])}}for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.normal=t.__originalFaceNormal,t.vertexNormals=t.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ze),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let i,r=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,u=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(i=(new Q).getNormalMatrix(t));for(let e=0,n=o.length;e<n;e++){const n=o[e].clone();void 0!==t&&n.applyMatrix4(t),a.push(n)}for(let e=0,t=c.length;e<t;e++)u.push(c[e].clone());for(let e=0,t=l.length;e<t;e++){let t,a,o,u=l[e],c=u.vertexNormals,h=u.vertexColors;t=new Ct(u.a+r,u.b+r,u.c+r),t.normal.copy(u.normal),void 0!==i&&t.normal.applyMatrix3(i).normalize();for(let e=0,n=c.length;e<n;e++)a=c[e].clone(),void 0!==i&&a.applyMatrix3(i).normalize(),t.vertexNormals.push(a);t.color.copy(u.color);for(let e=0,n=h.length;e<n;e++)o=h[e],t.vertexColors.push(o.clone());t.materialIndex=u.materialIndex+n,s.push(t)}for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,i=n.length;e<i;e++){const i=n[e],r=[];for(let e=0,t=i.length;e<t;e++)r.push(i[e].clone());this.faceVertexUvs[t].push(r)}}},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){const e={},t=[],n=[],i=Math.pow(10,4);for(let r=0,a=this.vertices.length;r<a;r++){const a=this.vertices[r],o=Math.round(a.x*i)+"_"+Math.round(a.y*i)+"_"+Math.round(a.z*i);void 0===e[o]?(e[o]=r,t.push(this.vertices[r]),n[r]=t.length-1):n[r]=n[e[o]]}const r=[];for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.a=n[t.a],t.b=n[t.b],t.c=n[t.c];const i=[t.a,t.b,t.c];for(let t=0;t<3;t++)if(i[t]===i[(t+1)%3]){r.push(e);break}}for(let e=r.length-1;e>=0;e--){const t=r[e];this.faces.splice(t,1);for(let e=0,n=this.faceVertexUvs.length;e<n;e++)this.faceVertexUvs[e].splice(t,1)}const a=this.vertices.length-t.length;return this.vertices=t,a},setFromPoints:function(e){this.vertices=[];for(let t=0,n=e.length;t<n;t++){const n=e[t];this.vertices.push(new se(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){const e=this.faces,t=e.length;for(let n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));const n=this.faceVertexUvs[0],i=this.faceVertexUvs[1];let r,a;n&&n.length===t&&(r=[]),i&&i.length===t&&(a=[]);for(let o=0;o<t;o++){const t=e[o]._id;r&&r.push(n[t]),a&&a.push(i[t])}r&&(this.faceVertexUvs[0]=r),a&&(this.faceVertexUvs[1]=a)},toJSON:function(){const e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}const t=[];for(let e=0;e<this.vertices.length;e++){const n=this.vertices[e];t.push(n.x,n.y,n.z)}const n=[],i=[],r={},a=[],o={},s=[],l={};for(let e=0;e<this.faces.length;e++){const t=this.faces[e],i=!0,r=!1,a=void 0!==this.faceVertexUvs[0][e],o=t.normal.length()>0,s=t.vertexNormals.length>0,l=1!==t.color.r||1!==t.color.g||1!==t.color.b,f=t.vertexColors.length>0;let p=0;if(p=u(p,0,0),p=u(p,1,i),p=u(p,2,r),p=u(p,3,a),p=u(p,4,o),p=u(p,5,s),p=u(p,6,l),p=u(p,7,f),n.push(p),n.push(t.a,t.b,t.c),n.push(t.materialIndex),a){const t=this.faceVertexUvs[0][e];n.push(d(t[0]),d(t[1]),d(t[2]))}if(o&&n.push(c(t.normal)),s){const e=t.vertexNormals;n.push(c(e[0]),c(e[1]),c(e[2]))}if(l&&n.push(h(t.color)),f){const e=t.vertexColors;n.push(h(e[0]),h(e[1]),h(e[2]))}}function u(e,t,n){return n?e|1<<t:e&~(1<<t)}function c(e){const t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==r[t]||(r[t]=i.length/3,i.push(e.x,e.y,e.z)),r[t]}function h(e){const t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==o[t]||(o[t]=a.length,a.push(e.getHex())),o[t]}function d(e){const t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=s.length/2,s.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=i,a.length>0&&(e.data.colors=a),s.length>0&&(e.data.uvs=[s]),e.data.faces=n,e},clone:function(){return(new An).copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;const t=e.vertices;for(let e=0,n=t.length;e<n;e++)this.vertices.push(t[e].clone());const n=e.colors;for(let e=0,t=n.length;e<t;e++)this.colors.push(n[e].clone());const i=e.faces;for(let e=0,t=i.length;e<t;e++)this.faces.push(i[e].clone());for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,i=n.length;e<i;e++){const i=n[e],r=[];for(let e=0,t=i.length;e<t;e++){const t=i[e];r.push(t.clone())}this.faceVertexUvs[t].push(r)}}const r=e.morphTargets;for(let e=0,t=r.length;e<t;e++){const t={};if(t.name=r[e].name,void 0!==r[e].vertices){t.vertices=[];for(let n=0,i=r[e].vertices.length;n<i;n++)t.vertices.push(r[e].vertices[n].clone())}if(void 0!==r[e].normals){t.normals=[];for(let n=0,i=r[e].normals.length;n<i;n++)t.normals.push(r[e].normals[n].clone())}this.morphTargets.push(t)}const a=e.morphNormals;for(let e=0,t=a.length;e<t;e++){const t={};if(void 0!==a[e].vertexNormals){t.vertexNormals=[];for(let n=0,i=a[e].vertexNormals.length;n<i;n++){const i=a[e].vertexNormals[n],r={};r.a=i.a.clone(),r.b=i.b.clone(),r.c=i.c.clone(),t.vertexNormals.push(r)}}if(void 0!==a[e].faceNormals){t.faceNormals=[];for(let n=0,i=a[e].faceNormals.length;n<i;n++)t.faceNormals.push(a[e].faceNormals[n].clone())}this.morphNormals.push(t)}const o=e.skinWeights;for(let e=0,t=o.length;e<t;e++)this.skinWeights.push(o[e].clone());const s=e.skinIndices;for(let e=0,t=s.length;e<t;e++)this.skinIndices.push(s[e].clone());const l=e.lineDistances;for(let e=0,t=l.length;e<t;e++)this.lineDistances.push(l[e]);const u=e.boundingBox;null!==u&&(this.boundingBox=u.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Sn extends An{constructor(e,t,n,i,r,a){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new Mn(e,t,n,i,r,a)),this.mergeVertices()}}class Mn extends $t{constructor(e=1,t=1,n=1,i=1,r=1,a=1){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};const o=this;i=Math.floor(i),r=Math.floor(r),a=Math.floor(a);const s=[],l=[],u=[],c=[];let h=0,d=0;function f(e,t,n,i,r,a,f,p,m,g,v){const y=a/m,_=f/g,b=a/2,E=f/2,T=p/2,w=m+1,x=g+1;let A=0,S=0;const M=new se;for(let a=0;a<x;a++){const o=a*_-E;for(let s=0;s<w;s++){const h=s*y-b;M[e]=h*i,M[t]=o*r,M[n]=T,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[n]=p>0?1:-1,u.push(M.x,M.y,M.z),c.push(s/m),c.push(1-a/g),A+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+w*e,i=h+t+w*(e+1),r=h+(t+1)+w*(e+1),a=h+(t+1)+w*e;s.push(n,i,a),s.push(i,r,a),S+=6}o.addGroup(d,S,v),d+=S,h+=A}f("z","y","x",-1,-1,n,t,e,a,r,0),f("z","y","x",1,-1,n,t,-e,a,r,1),f("x","z","y",1,1,e,n,t,i,a,2),f("x","z","y",1,-1,e,n,-t,i,a,3),f("x","y","z",1,-1,e,t,n,i,r,4),f("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new zt(l,3)),this.setAttribute("normal",new zt(u,3)),this.setAttribute("uv",new zt(c,2))}}function Cn(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Rn(e){const t={};for(let n=0;n<e.length;n++){const i=Cn(e[n]);for(const e in i)t[e]=i[e]}return t}const In={clone:Cn,merge:Rn};function Pn(e){It.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ln(){De.call(this),this.type="Camera",this.matrixWorldInverse=new me,this.projectionMatrix=new me,this.projectionMatrixInverse=new me}function Dn(e,t,n,i){Ln.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Pn.prototype=Object.create(It.prototype),Pn.prototype.constructor=Pn,Pn.prototype.isShaderMaterial=!0,Pn.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this},Pn.prototype.toJSON=function(e){const t=It.prototype.toJSON.call(this,e);t.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t},Ln.prototype=Object.assign(Object.create(De.prototype),{constructor:Ln,isCamera:!0,copy:function(e,t){return De.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new se),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){De.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){De.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Dn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Dn,isPerspectiveCamera:!0,copy:function(e,t){return Ln.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){const t=.5*this.getFilmHeight()/e;this.fov=2*X.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){const e=Math.tan(.5*X.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*X.RAD2DEG*Math.atan(Math.tan(.5*X.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let e=this.near,t=e*Math.tan(.5*X.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,o=a.fullHeight;r+=a.offsetX*i/e,t-=a.offsetY*n/o,i*=a.width/e,n*=a.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=De.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});function On(e,t,n){if(De.call(this),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new Dn(90,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new se(1,0,0)),this.add(i);const r=new Dn(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new se(-1,0,0)),this.add(r);const a=new Dn(90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new se(0,1,0)),this.add(a);const o=new Dn(90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new se(0,-1,0)),this.add(o);const s=new Dn(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new se(0,0,1)),this.add(s);const l=new Dn(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new se(0,0,-1)),this.add(l),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();const u=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.xr.enabled=u},this.clear=function(e,t,i,r){const a=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(n,a),e.clear(t,i,r);e.setRenderTarget(a)}}function Nn(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),ne.call(this,e,e,t)}function kn(e,t,n,i,r,a,o,s,l,u,c,h){ee.call(this,null,a,o,s,l,u,i,r,c,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==u?u:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}On.prototype=Object.create(De.prototype),On.prototype.constructor=On,Nn.prototype=Object.create(ne.prototype),Nn.prototype.constructor=Nn,Nn.prototype.isWebGLCubeRenderTarget=!0,Nn.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=1023,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n=new Oe,i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t"},r=new Pn({name:"CubemapFromEquirect",uniforms:Cn(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;const a=new yn(new Mn(5,5,5),r);n.add(a);return new On(1,10,this).update(e,n),a.geometry.dispose(),a.material.dispose(),this},kn.prototype=Object.create(ee.prototype),kn.prototype.constructor=kn,kn.prototype.isDataTexture=!0;const Fn=new Ze,Bn=new se;function Un(e,t,n,i,r,a){this.planes=[void 0!==e?e:new ut,void 0!==t?t:new ut,void 0!==n?n:new ut,void 0!==i?i:new ut,void 0!==r?r:new ut,void 0!==a?a:new ut]}Object.assign(Un.prototype,{set:function(e,t,n,i,r,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){const t=this.planes,n=e.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-i,c-s,p-h,y-m).normalize(),t[1].setComponents(o+i,c+s,p+h,y+m).normalize(),t[2].setComponents(o+r,c+l,p+d,y+g).normalize(),t[3].setComponents(o-r,c-l,p-d,y-g).normalize(),t[4].setComponents(o-a,c-u,p-f,y-v).normalize(),t[5].setComponents(o+a,c+u,p+f,y+v).normalize(),this},intersectsObject:function(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Fn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Fn)},intersectsSprite:function(e){return Fn.center.set(0,0,0),Fn.radius=.7071067811865476,Fn.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fn)},intersectsSphere:function(e){const t=this.planes,n=e.center,i=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<i)return!1}return!0},intersectsBox:function(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Bn.x=i.normal.x>0?e.max.x:e.min.x,Bn.y=i.normal.y>0?e.max.y:e.min.y,Bn.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Bn)<0)return!1}return!0},containsPoint:function(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});const jn={common:{diffuse:{value:new xt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Q},uv2Transform:{value:new Q},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new K(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new xt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Q}},sprite:{diffuse:{value:new xt(15658734)},opacity:{value:1},center:{value:new K(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Q}}};function Gn(){let e=null,t=!1,n=null,i=null;function r(t,a){n(t,a),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function zn(e,t){const n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){t.isInterleavedBufferAttribute&&(t=t.data);const a=i.get(t);void 0===a?i.set(t,function(t,n){const i=t.array,r=t.usage,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,i,r),t.onUploadCallback();let o=5126;return i instanceof Float32Array?o=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?o=5123:i instanceof Int16Array?o=5122:i instanceof Uint32Array?o=5125:i instanceof Int32Array?o=5124:i instanceof Int8Array?o=5120:i instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,r)):a.version<t.version&&(!function(t,i,r){const a=i.array,o=i.updateRange;e.bindBuffer(r,t),-1===o.count?e.bufferSubData(r,0,a):(n?e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,t,r),a.version=t.version)}}}function Hn(e,t,n,i){An.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Vn(e,t,n,i)),this.mergeVertices()}function Vn(e,t,n,i){$t.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=(e=e||1)/2,a=(t=t||1)/2,o=Math.floor(n)||1,s=Math.floor(i)||1,l=o+1,u=s+1,c=e/o,h=t/s,d=[],f=[],p=[],m=[];for(let e=0;e<u;e++){const t=e*h-a;for(let n=0;n<l;n++){const i=n*c-r;f.push(i,-t,0),p.push(0,0,1),m.push(n/o),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){const n=t+l*e,i=t+l*(e+1),r=t+1+l*(e+1),a=t+1+l*e;d.push(n,i,a),d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new zt(f,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(m,2))}Hn.prototype=Object.create(An.prototype),Hn.prototype.constructor=Hn,Vn.prototype=Object.create($t.prototype),Vn.prototype.constructor=Vn;const Wn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},qn={basic:{uniforms:Rn([jn.common,jn.specularmap,jn.envmap,jn.aomap,jn.lightmap,jn.fog]),vertexShader:Wn.meshbasic_vert,fragmentShader:Wn.meshbasic_frag},lambert:{uniforms:Rn([jn.common,jn.specularmap,jn.envmap,jn.aomap,jn.lightmap,jn.emissivemap,jn.fog,jn.lights,{emissive:{value:new xt(0)}}]),vertexShader:Wn.meshlambert_vert,fragmentShader:Wn.meshlambert_frag},phong:{uniforms:Rn([jn.common,jn.specularmap,jn.envmap,jn.aomap,jn.lightmap,jn.emissivemap,jn.bumpmap,jn.normalmap,jn.displacementmap,jn.fog,jn.lights,{emissive:{value:new xt(0)},specular:{value:new xt(1118481)},shininess:{value:30}}]),vertexShader:Wn.meshphong_vert,fragmentShader:Wn.meshphong_frag},standard:{uniforms:Rn([jn.common,jn.envmap,jn.aomap,jn.lightmap,jn.emissivemap,jn.bumpmap,jn.normalmap,jn.displacementmap,jn.roughnessmap,jn.metalnessmap,jn.fog,jn.lights,{emissive:{value:new xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wn.meshphysical_vert,fragmentShader:Wn.meshphysical_frag},toon:{uniforms:Rn([jn.common,jn.aomap,jn.lightmap,jn.emissivemap,jn.bumpmap,jn.normalmap,jn.displacementmap,jn.gradientmap,jn.fog,jn.lights,{emissive:{value:new xt(0)}}]),vertexShader:Wn.meshtoon_vert,fragmentShader:Wn.meshtoon_frag},matcap:{uniforms:Rn([jn.common,jn.bumpmap,jn.normalmap,jn.displacementmap,jn.fog,{matcap:{value:null}}]),vertexShader:Wn.meshmatcap_vert,fragmentShader:Wn.meshmatcap_frag},points:{uniforms:Rn([jn.points,jn.fog]),vertexShader:Wn.points_vert,fragmentShader:Wn.points_frag},dashed:{uniforms:Rn([jn.common,jn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wn.linedashed_vert,fragmentShader:Wn.linedashed_frag},depth:{uniforms:Rn([jn.common,jn.displacementmap]),vertexShader:Wn.depth_vert,fragmentShader:Wn.depth_frag},normal:{uniforms:Rn([jn.common,jn.bumpmap,jn.normalmap,jn.displacementmap,{opacity:{value:1}}]),vertexShader:Wn.normal_vert,fragmentShader:Wn.normal_frag},sprite:{uniforms:Rn([jn.sprite,jn.fog]),vertexShader:Wn.sprite_vert,fragmentShader:Wn.sprite_frag},background:{uniforms:{uvTransform:{value:new Q},t2D:{value:null}},vertexShader:Wn.background_vert,fragmentShader:Wn.background_frag},cube:{uniforms:Rn([jn.envmap,{opacity:{value:1}}]),vertexShader:Wn.cube_vert,fragmentShader:Wn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wn.equirect_vert,fragmentShader:Wn.equirect_frag},distanceRGBA:{uniforms:Rn([jn.common,jn.displacementmap,{referencePosition:{value:new se},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wn.distanceRGBA_vert,fragmentShader:Wn.distanceRGBA_frag},shadow:{uniforms:Rn([jn.lights,jn.fog,{color:{value:new xt(0)},opacity:{value:1}}]),vertexShader:Wn.shadow_vert,fragmentShader:Wn.shadow_frag}};function Yn(e,t,n,i){const r=new xt(0);let a,o,s=0,l=null,u=0,c=null;function h(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,i)}return{getClearColor:function(){return r},setClearColor:function(e,t){r.set(e),s=void 0!==t?t:1,h(r,s)},getClearAlpha:function(){return s},setClearAlpha:function(e){s=e,h(r,s)},render:function(t,i,d,f){let p=!0===i.isScene?i.background:null;const m=e.xr,g=m.getSession&&m.getSession();if(g&&"additive"===g.environmentBlendMode&&(p=null),null===p?h(r,s):p&&p.isColor&&(h(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||306===p.mapping)){void 0===o&&(o=new yn(new Mn(1,1,1),new Pn({name:"BackgroundCubeMaterial",uniforms:Cn(qn.cube.uniforms),vertexShader:qn.cube.vertexShader,fragmentShader:qn.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));const i=p.isWebGLCubeRenderTarget?p.texture:p;o.material.uniforms.envMap.value=i,o.material.uniforms.flipEnvMap.value=i.isCubeTexture?-1:1,l===p&&u===i.version&&c===e.toneMapping||(o.material.needsUpdate=!0,l=p,u=i.version,c=e.toneMapping),t.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===a&&(a=new yn(new Vn(2,2),new Pn({name:"BackgroundMaterial",uniforms:Cn(qn.background.uniforms),vertexShader:qn.background.vertexShader,fragmentShader:qn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),a.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&u===p.version&&c===e.toneMapping||(a.material.needsUpdate=!0,l=p,u=p.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null))}}}function Xn(e,t,n,i){const r=e.getParameter(34921),a=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||null!==a,s={},l=d(null);let u=l;function c(t){return i.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return i.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){const t=[],n=[],i=[];for(let e=0;e<r;e++)t[e]=0,n[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{}}}function f(){const e=u.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function p(e){m(e,0)}function m(n,r){const a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;if(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==r){(i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),s[n]=r}}function g(){const t=u.newAttributes,n=u.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function v(t,n,r,a,o,s){!0!==i.isWebGL2||5124!==r&&5125!==r?e.vertexAttribPointer(t,n,r,a,o,s):e.vertexAttribIPointer(t,n,r,o,s)}function y(){_(),u!==l&&(u=l,c(u.object))}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,y,_){let b=!1;if(o){const t=function(t,n,r){const o=!0===r.wireframe;let l=s[t.id];void 0===l&&(l={},s[t.id]=l);let u=l[n.id];void 0===u&&(u={},l[n.id]=u);let c=u[o];void 0===c&&(c=d(i.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[o]=c);return c}(y,h,l);u!==t&&(u=t,c(u.object)),b=function(e){const t=u.attributes,n=e.attributes;if(Object.keys(t).length!==Object.keys(n).length)return!0;for(const e in n){const i=t[e],r=n[e];if(i.attribute!==r)return!0;if(i.data!==r.data)return!0}return!1}(y),b&&function(e){const t={},n=e.attributes;for(const e in n){const i=n[e],r={};r.attribute=i,i.data&&(r.data=i.data),t[e]=r}u.attributes=t}(y)}else{const e=!0===l.wireframe;u.geometry===y.id&&u.program===h.id&&u.wireframe===e||(u.geometry=y.id,u.program=h.id,u.wireframe=e,b=!0)}!0===r.isInstancedMesh&&(b=!0),null!==_&&n.update(_,34963),b&&(!function(r,a,o,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=s.attributes,u=o.getAttributes(),c=a.defaultAttributeValues;for(const t in u){const i=u[t];if(i>=0){const a=l[t];if(void 0!==a){const t=a.normalized,r=a.itemSize,o=n.get(a);if(void 0===o)continue;const l=o.buffer,u=o.type,c=o.bytesPerElement;if(a.isInterleavedBufferAttribute){const n=a.data,o=n.stride,h=a.offset;n&&n.isInstancedInterleavedBuffer?(m(i,n.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)):p(i),e.bindBuffer(34962,l),v(i,r,u,t,o*c,h*c)}else a.isInstancedBufferAttribute?(m(i,a.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=a.meshPerAttribute*a.count)):p(i),e.bindBuffer(34962,l),v(i,r,u,t,0,0)}else if("instanceMatrix"===t){const t=n.get(r.instanceMatrix);if(void 0===t)continue;const a=t.buffer,o=t.type;m(i+0,1),m(i+1,1),m(i+2,1),m(i+3,1),e.bindBuffer(34962,a),e.vertexAttribPointer(i+0,4,o,!1,64,0),e.vertexAttribPointer(i+1,4,o,!1,64,16),e.vertexAttribPointer(i+2,4,o,!1,64,32),e.vertexAttribPointer(i+3,4,o,!1,64,48)}else if(void 0!==c){const n=c[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i,n);break;case 3:e.vertexAttrib3fv(i,n);break;case 4:e.vertexAttrib4fv(i,n);break;default:e.vertexAttrib1fv(i,n)}}}}g()}(r,l,h,y),null!==_&&e.bindBuffer(34963,n.get(_).buffer))},reset:y,resetDefaultState:_,dispose:function(){y();for(const e in s){const t=s[e];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;const t=s[e.id];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete s[e.id]},releaseStatesOfProgram:function(e){for(const t in s){const n=s[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)h(i[e].object),delete i[e];delete n[e.id]}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:g}}function Kn(e,t,n,i){const r=i.isWebGL2;let a;this.setMode=function(e){a=e},this.render=function(t,i){e.drawArrays(a,t,i),n.update(i,a,1)},this.renderInstances=function(i,o,s){if(0===s)return;let l,u;if(r)l=e,u="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](a,i,o,s),n.update(o,a,s)}}function Qn(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);const l=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),c=e.getParameter(35660),h=e.getParameter(3379),d=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=c>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;const n=t.get("EXT_texture_filter_anisotropic");return i=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function Zn(){const e=this;let t=null,n=0,i=!1,r=!1;const a=new ut,o=new Q,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,i,r){let l=null!==t?t.length:0,u=null;if(0!==l){if(u=s.value,!0!==r||null===u){const e=i+4*l,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===u||u.length<e)&&(u=new Float32Array(e));for(let e=0,n=i;e!==l;++e,n+=4)a.copy(t[e]).applyMatrix4(r,o),a.normal.toArray(u,n),u[n+3]=a.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=l,e.numIntersection=0,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,a){const o=0!==e.length||r||0!==n||i;return i=r,t=u(e,a,0),n=e.length,o},this.beginShadows=function(){r=!0,u(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,a,o,c,h,d){if(!i||null===e||0===e.length||r&&!o)r?u(null):l();else{const i=r?0:n,o=4*i;let l=h.clippingState||null;s.value=l,l=u(e,c,o,d);for(let e=0;e!==o;++e)l[e]=t[e];h.clippingState=l,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=i}}}function Jn(e){const t={};return{has:function(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,!!i},get:function(e){return this.has(e)||console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t[e]}}}function $n(e,t,n,i){const r=new WeakMap,a=new WeakMap;function o(e){const s=e.target,l=r.get(s);null!==l.index&&t.remove(l.index);for(const e in l.attributes)t.remove(l.attributes[e]);s.removeEventListener("dispose",o),r.delete(s);const u=a.get(l);u&&(t.remove(u),a.delete(l)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){const n=[],i=e.index,r=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],a=e[t+2];n.push(i,r,r,a,a,i)}}else{const e=r.array;o=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}const s=new(Wt(n)>65535?Gt:Ut)(n,1);s.version=o;const l=a.get(e);l&&t.remove(l),a.set(e,s)}return{get:function(e,t){let i=r.get(t);return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new $t).setFromObject(e)),i=t._bufferGeometry),r.set(t,i),n.memory.geometries++,i)},update:function(e){const n=e.attributes;for(const e in n)t.update(n[e],34962);const i=e.morphAttributes;for(const e in i){const n=i[e];for(let e=0,i=n.length;e<i;e++)t.update(n[e],34962)}},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function ei(e,t,n,i){const r=i.isWebGL2;let a,o,s;this.setMode=function(e){a=e},this.setIndex=function(e){o=e.type,s=e.bytesPerElement},this.render=function(t,i){e.drawElements(a,i,o,t*s),n.update(i,a,1)},this.renderInstances=function(i,l,u){if(0===u)return;let c,h;if(r)c=e,h="drawElementsInstanced";else if(c=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===c)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](a,l,o,i*s,u),n.update(l,a,u)}}function ti(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function ni(e,t){return e[0]-t[0]}function ii(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ri(e){const t={},n=new Float32Array(8),i=[];for(let e=0;e<8;e++)i[e]=[e,0];return{update:function(r,a,o,s){const l=r.morphTargetInfluences,u=void 0===l?0:l.length;let c=t[a.id];if(void 0===c){c=[];for(let e=0;e<u;e++)c[e]=[e,0];t[a.id]=c}for(let e=0;e<u;e++){const t=c[e];t[0]=e,t[1]=l[e]}c.sort(ii);for(let e=0;e<8;e++)e<u&&c[e][1]?(i[e][0]=c[e][0],i[e][1]=c[e][1]):(i[e][0]=Number.MAX_SAFE_INTEGER,i[e][1]=0);i.sort(ni);const h=o.morphTargets&&a.morphAttributes.position,d=o.morphNormals&&a.morphAttributes.normal;let f=0;for(let e=0;e<8;e++){const t=i[e],r=t[0],o=t[1];r!==Number.MAX_SAFE_INTEGER&&o?(h&&a.getAttribute("morphTarget"+e)!==h[r]&&a.setAttribute("morphTarget"+e,h[r]),d&&a.getAttribute("morphNormal"+e)!==d[r]&&a.setAttribute("morphNormal"+e,d[r]),n[e]=o,f+=o):(h&&void 0!==a.getAttribute("morphTarget"+e)&&a.deleteAttribute("morphTarget"+e),d&&void 0!==a.getAttribute("morphNormal"+e)&&a.deleteAttribute("morphNormal"+e),n[e]=0)}const p=a.morphTargetsRelative?1:1-f;s.getUniforms().setValue(e,"morphTargetBaseInfluence",p),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function ai(e,t,n,i){let r=new WeakMap;return{update:function(e){const a=i.render.frame,o=e.geometry,s=t.get(e,o);return r.get(s)!==a&&(o.isGeometry&&s.updateFromObject(e),t.update(s),r.set(s,a)),e.isInstancedMesh&&n.update(e.instanceMatrix,34962),s},dispose:function(){r=new WeakMap}}}function oi(e,t,n,i,r,a,o,s,l,u){e=void 0!==e?e:[],t=void 0!==t?t:301,o=void 0!==o?o:1022,ee.call(this,e,t,n,i,r,a,o,s,l,u),this.flipY=!1}function si(e,t,n,i){ee.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function li(e,t,n,i){ee.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}qn.physical={uniforms:Rn([qn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new K(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new xt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Wn.meshphysical_vert,fragmentShader:Wn.meshphysical_frag},oi.prototype=Object.create(ee.prototype),oi.prototype.constructor=oi,oi.prototype.isCubeTexture=!0,Object.defineProperty(oi.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),si.prototype=Object.create(ee.prototype),si.prototype.constructor=si,si.prototype.isDataTexture2DArray=!0,li.prototype=Object.create(ee.prototype),li.prototype.constructor=li,li.prototype.isDataTexture3D=!0;const ui=new ee,ci=new si,hi=new li,di=new oi,fi=[],pi=[],mi=new Float32Array(16),gi=new Float32Array(9),vi=new Float32Array(4);function yi(e,t,n){const i=e[0];if(i<=0||i>0)return e;let r=t*n,a=fi[r];if(void 0===a&&(a=new Float32Array(r),fi[r]=a),0!==t){i.toArray(a,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(a,r)}return a}function _i(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function bi(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function Ei(e,t){let n=pi[t];void 0===n&&(n=new Int32Array(t),pi[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Ti(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function wi(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(_i(n,t))return;e.uniform2fv(this.addr,t),bi(n,t)}}function xi(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(_i(n,t))return;e.uniform3fv(this.addr,t),bi(n,t)}}function Ai(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(_i(n,t))return;e.uniform4fv(this.addr,t),bi(n,t)}}function Si(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(_i(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),bi(n,t)}else{if(_i(n,i))return;vi.set(i),e.uniformMatrix2fv(this.addr,!1,vi),bi(n,i)}}function Mi(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(_i(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),bi(n,t)}else{if(_i(n,i))return;gi.set(i),e.uniformMatrix3fv(this.addr,!1,gi),bi(n,i)}}function Ci(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(_i(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),bi(n,t)}else{if(_i(n,i))return;mi.set(i),e.uniformMatrix4fv(this.addr,!1,mi),bi(n,i)}}function Ri(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(t||ui,r)}function Ii(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||ci,r)}function Pi(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||hi,r)}function Li(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(t||di,r)}function Di(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Oi(e,t){const n=this.cache;_i(n,t)||(e.uniform2iv(this.addr,t),bi(n,t))}function Ni(e,t){const n=this.cache;_i(n,t)||(e.uniform3iv(this.addr,t),bi(n,t))}function ki(e,t){const n=this.cache;_i(n,t)||(e.uniform4iv(this.addr,t),bi(n,t))}function Fi(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Bi(e,t){e.uniform1fv(this.addr,t)}function Ui(e,t){e.uniform1iv(this.addr,t)}function ji(e,t){e.uniform2iv(this.addr,t)}function Gi(e,t){e.uniform3iv(this.addr,t)}function zi(e,t){e.uniform4iv(this.addr,t)}function Hi(e,t){const n=yi(t,this.size,2);e.uniform2fv(this.addr,n)}function Vi(e,t){const n=yi(t,this.size,3);e.uniform3fv(this.addr,n)}function Wi(e,t){const n=yi(t,this.size,4);e.uniform4fv(this.addr,n)}function qi(e,t){const n=yi(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Yi(e,t){const n=yi(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Xi(e,t){const n=yi(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Ki(e,t,n){const i=t.length,r=Ei(n,i);e.uniform1iv(this.addr,r);for(let e=0;e!==i;++e)n.safeSetTexture2D(t[e]||ui,r[e])}function Qi(e,t,n){const i=t.length,r=Ei(n,i);e.uniform1iv(this.addr,r);for(let e=0;e!==i;++e)n.safeSetTextureCube(t[e]||di,r[e])}function Zi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Ti;case 35664:return wi;case 35665:return xi;case 35666:return Ai;case 35674:return Si;case 35675:return Mi;case 35676:return Ci;case 5124:case 35670:return Di;case 35667:case 35671:return Oi;case 35668:case 35672:return Ni;case 35669:case 35673:return ki;case 5125:return Fi;case 35678:case 36198:case 36298:case 36306:case 35682:return Ri;case 35679:case 36299:case 36307:return Pi;case 35680:case 36300:case 36308:case 36293:return Li;case 36289:case 36303:case 36311:case 36292:return Ii}}(t.type)}function Ji(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Bi;case 35664:return Hi;case 35665:return Vi;case 35666:return Wi;case 35674:return qi;case 35675:return Yi;case 35676:return Xi;case 5124:case 35670:return Ui;case 35667:case 35671:return ji;case 35668:case 35672:return Gi;case 35669:case 35673:return zi;case 35678:case 36198:case 36298:case 36306:case 35682:return Ki;case 35680:case 36300:case 36308:case 36293:return Qi}}(t.type)}function $i(e){this.id=e,this.seq=[],this.map={}}Ji.prototype.updateCache=function(e){let t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),bi(t,e)},$i.prototype.setValue=function(e,t,n){const i=this.seq;for(let r=0,a=i.length;r!==a;++r){const a=i[r];a.setValue(e,t[a.id],n)}};const er=/([\w\d_]+)(\])?(\[|\.)?/g;function tr(e,t){e.seq.push(t),e.map[t.id]=t}function nr(e,t,n){const i=e.name,r=i.length;for(er.lastIndex=0;;){const a=er.exec(i),o=er.lastIndex;let s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===r){tr(n,void 0===u?new Zi(s,e,t):new Ji(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new $i(s),tr(n,e)),n=e}}}function ir(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);nr(n,e.getUniformLocation(t,n.name),this)}}function rr(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}ir.prototype.setValue=function(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)},ir.prototype.setOptional=function(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)},ir.upload=function(e,t,n,i){for(let r=0,a=t.length;r!==a;++r){const a=t[r],o=n[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,i)}},ir.seqWithValue=function(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n};let ar=0;function or(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function sr(e,t,n){const i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+r+function(e){const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function lr(e,t){const n=or(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ur(e,t){const n=or(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function cr(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function hr(e){return""!==e}function dr(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function fr(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const pr=/^[ \t]*#include +<([\w\d./]+)>/gm;function mr(e){return e.replace(pr,gr)}function gr(e,t){const n=Wn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return mr(n)}const vr=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,yr=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function _r(e){return e.replace(yr,Er).replace(vr,br)}function br(e,t,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Er(e,t,n,i)}function Er(e,t,n,i){let r="";for(let e=parseInt(t);e<parseInt(n);e++)r+=i.replace(/\[ i \]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return r}function Tr(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function wr(e,t,n,i){const r=e.getContext(),a=n.defines;let o=n.vertexShader,s=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),u=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC"}return t}(n),c=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:case 307:t="ENVMAP_MODE_REFRACTION"}return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),d=e.gammaFactor>0?e.gammaFactor:1,f=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(hr).join("\n")}(n),p=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(a),m=r.createProgram();let g,v;n.isRawShaderMaterial?(g=[p].filter(hr).join("\n"),g.length>0&&(g+="\n"),v=[f,p].filter(hr).join("\n"),v.length>0&&(v+="\n")):(g=[Tr(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(hr).join("\n"),v=[f,Tr(n),"#define SHADER_NAME "+n.shaderName,p,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Wn.tonemapping_pars_fragment:"",0!==n.toneMapping?cr("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Wn.encodings_pars_fragment,n.map?lr("mapTexelToLinear",n.mapEncoding):"",n.matcap?lr("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?lr("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?lr("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?lr("lightMapTexelToLinear",n.lightMapEncoding):"",ur("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(hr).join("\n")),o=mr(o),o=dr(o,n),o=fr(o,n),s=mr(s),s=dr(s,n),s=fr(s,n),o=_r(o),s=_r(s),n.isWebGL2&&!n.isRawShaderMaterial&&(g=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const y=v+s,_=rr(r,35633,g+o),b=rr(r,35632,y);if(r.attachShader(m,_),r.attachShader(m,b),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),e.debug.checkShaderErrors){const e=r.getProgramInfoLog(m).trim(),t=r.getShaderInfoLog(_).trim(),n=r.getShaderInfoLog(b).trim();let i=!0,a=!0;if(!1===r.getProgramParameter(m,35714)){i=!1;const t=sr(r,_,"vertex"),n=sr(r,b,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(m,35715),"gl.getProgramInfoLog",e,t,n)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):""!==t&&""!==n||(a=!1);a&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:g},fragmentShader:{log:n,prefix:v}})}let E,T;return r.deleteShader(_),r.deleteShader(b),this.getUniforms=function(){return void 0===E&&(E=new ir(r,m)),E},this.getAttributes=function(){return void 0===T&&(T=function(e,t){const n={},i=e.getProgramParameter(t,35721);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r).name;n[i]=e.getAttribLocation(t,i)}return n}(r,m)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=ar++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=b,this}function xr(e,t,n,i){const r=[],a=n.isWebGL2,o=n.logarithmicDepthBuffer,s=n.floatVertexTextures,l=n.maxVertexUniforms,u=n.vertexTextures;let c=n.precision;const h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function f(e){let t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=3e3,t}return{getParameters:function(i,r,d,p,m,g,v){const y=p.fog,_=i.isMeshStandardMaterial?p.environment:null,b=i.envMap||_,E=h[i.type],T=v.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(s)return 1024;{const e=l,n=Math.floor((e-20)/4),i=Math.min(n,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}}(v):0;let w,x;if(null!==i.precision&&(c=n.getMaxPrecision(i.precision),c!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",c,"instead.")),E){const e=qn[E];w=e.vertexShader,x=e.fragmentShader}else w=i.vertexShader,x=i.fragmentShader;const A=e.getRenderTarget();return{isWebGL2:a,shaderID:E,shaderName:i.type,vertexShader:w,fragmentShader:x,defines:i.defines,isRawShaderMaterial:i.isRawShaderMaterial,isShaderMaterial:i.isShaderMaterial,precision:c,instancing:!0===v.isInstancedMesh,supportsVertexTextures:u,outputEncoding:null!==A?f(A.texture):e.outputEncoding,map:!!i.map,mapEncoding:f(i.map),matcap:!!i.matcap,matcapEncoding:f(i.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:f(b),envMapCubeUV:!!b&&(306===b.mapping||307===b.mapping),lightMap:!!i.lightMap,lightMapEncoding:f(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:f(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!y,useFog:i.fog,fogExp2:y&&y.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:o,skinning:i.skinning&&T>0,maxBones:T,useVertexTexture:s,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numDirLightShadows:r.directionalShadowMap.length,numPointLightShadows:r.pointShadowMap.length,numSpotLightShadows:r.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:a||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||null!==t.get("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);if(void 0===t.isRawShaderMaterial){for(let e=0;e<d.length;e++)n.push(t[d[e]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=h[e.type];let n;if(t){const e=qn[t];n=In.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let a;for(let e=0,t=r.length;e<t;e++){const t=r[e];if(t.cacheKey===n){a=t,++a.usedTimes;break}}return void 0===a&&(a=new wr(e,n,t,i),r.push(a)),a},releaseProgram:function(e){if(0==--e.usedTimes){const t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},programs:r}}function Ar(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function Sr(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Mr(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Cr(e){const t=[];let n=0;const i=[],r=[],a={id:-1};function o(i,r,o,s,l,u){let c=t[n];const h=e.get(o);return void 0===c?(c={id:i.id,object:i,geometry:r,material:o,program:h.program||a,groupOrder:s,renderOrder:i.renderOrder,z:l,group:u},t[n]=c):(c.id=i.id,c.object=i,c.geometry=r,c.material=o,c.program=h.program||a,c.groupOrder=s,c.renderOrder=i.renderOrder,c.z=l,c.group=u),n++,c}return{opaque:i,transparent:r,init:function(){n=0,i.length=0,r.length=0},push:function(e,t,n,a,s,l){const u=o(e,t,n,a,s,l);(!0===n.transparent?r:i).push(u)},unshift:function(e,t,n,a,s,l){const u=o(e,t,n,a,s,l);(!0===n.transparent?r:i).unshift(u)},finish:function(){for(let e=n,i=t.length;e<i;e++){const n=t[e];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(e,t){i.length>1&&i.sort(e||Sr),r.length>1&&r.sort(t||Mr)}}}function Rr(e){let t=new WeakMap;function n(e){const i=e.target;i.removeEventListener("dispose",n),t.delete(i)}return{get:function(i,r){const a=t.get(i);let o;return void 0===a?(o=new Cr(e),t.set(i,new WeakMap),t.get(i).set(r,o),i.addEventListener("dispose",n)):(o=a.get(r),void 0===o&&(o=new Cr(e),a.set(r,o))),o},dispose:function(){t=new WeakMap}}}function Ir(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new se,color:new xt};break;case"SpotLight":n={position:new se,direction:new se,color:new xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new se,color:new xt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new se,skyColor:new xt,groundColor:new xt};break;case"RectAreaLight":n={color:new xt,position:new se,halfWidth:new se,halfHeight:new se}}return e[t.id]=n,n}}}let Pr=0;function Lr(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Dr(){const e=new Ir,t=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)n.probe.push(new se);const i=new se,r=new me,a=new me;return{setup:function(o,s,l){let u=0,c=0,h=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let d=0,f=0,p=0,m=0,g=0,v=0,y=0,_=0;const b=l.matrixWorldInverse;o.sort(Lr);for(let s=0,l=o.length;s<l;s++){const l=o[s],E=l.color,T=l.intensity,w=l.distance,x=l.shadow&&l.shadow.map?l.shadow.map.texture:null;if(l.isAmbientLight)u+=E.r*T,c+=E.g*T,h+=E.b*T;else if(l.isLightProbe)for(let e=0;e<9;e++)n.probe[e].addScaledVector(l.sh.coefficients[e],T);else if(l.isDirectionalLight){const r=e.get(l);if(r.color.copy(l.color).multiplyScalar(l.intensity),r.direction.setFromMatrixPosition(l.matrixWorld),i.setFromMatrixPosition(l.target.matrixWorld),r.direction.sub(i),r.direction.transformDirection(b),l.castShadow){const e=l.shadow,i=t.get(l);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,n.directionalShadow[d]=i,n.directionalShadowMap[d]=x,n.directionalShadowMatrix[d]=l.shadow.matrix,v++}n.directional[d]=r,d++}else if(l.isSpotLight){const r=e.get(l);if(r.position.setFromMatrixPosition(l.matrixWorld),r.position.applyMatrix4(b),r.color.copy(E).multiplyScalar(T),r.distance=w,r.direction.setFromMatrixPosition(l.matrixWorld),i.setFromMatrixPosition(l.target.matrixWorld),r.direction.sub(i),r.direction.transformDirection(b),r.coneCos=Math.cos(l.angle),r.penumbraCos=Math.cos(l.angle*(1-l.penumbra)),r.decay=l.decay,l.castShadow){const e=l.shadow,i=t.get(l);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,n.spotShadow[p]=i,n.spotShadowMap[p]=x,n.spotShadowMatrix[p]=l.shadow.matrix,_++}n.spot[p]=r,p++}else if(l.isRectAreaLight){const t=e.get(l);t.color.copy(E).multiplyScalar(T),t.position.setFromMatrixPosition(l.matrixWorld),t.position.applyMatrix4(b),a.identity(),r.copy(l.matrixWorld),r.premultiply(b),a.extractRotation(r),t.halfWidth.set(.5*l.width,0,0),t.halfHeight.set(0,.5*l.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),n.rectArea[m]=t,m++}else if(l.isPointLight){const i=e.get(l);if(i.position.setFromMatrixPosition(l.matrixWorld),i.position.applyMatrix4(b),i.color.copy(l.color).multiplyScalar(l.intensity),i.distance=l.distance,i.decay=l.decay,l.castShadow){const e=l.shadow,i=t.get(l);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,i.shadowCameraNear=e.camera.near,i.shadowCameraFar=e.camera.far,n.pointShadow[f]=i,n.pointShadowMap[f]=x,n.pointShadowMatrix[f]=l.shadow.matrix,y++}n.point[f]=i,f++}else if(l.isHemisphereLight){const t=e.get(l);t.direction.setFromMatrixPosition(l.matrixWorld),t.direction.transformDirection(b),t.direction.normalize(),t.skyColor.copy(l.color).multiplyScalar(T),t.groundColor.copy(l.groundColor).multiplyScalar(T),n.hemi[g]=t,g++}}n.ambient[0]=u,n.ambient[1]=c,n.ambient[2]=h;const E=n.hash;E.directionalLength===d&&E.pointLength===f&&E.spotLength===p&&E.rectAreaLength===m&&E.hemiLength===g&&E.numDirectionalShadows===v&&E.numPointShadows===y&&E.numSpotShadows===_||(n.directional.length=d,n.spot.length=p,n.rectArea.length=m,n.point.length=f,n.hemi.length=g,n.directionalShadow.length=v,n.directionalShadowMap.length=v,n.pointShadow.length=y,n.pointShadowMap.length=y,n.spotShadow.length=_,n.spotShadowMap.length=_,n.directionalShadowMatrix.length=v,n.pointShadowMatrix.length=y,n.spotShadowMatrix.length=_,E.directionalLength=d,E.pointLength=f,E.spotLength=p,E.rectAreaLength=m,E.hemiLength=g,E.numDirectionalShadows=v,E.numPointShadows=y,E.numSpotShadows=_,n.version=Pr++)},state:n}}function Or(){const e=new Dr,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(i){e.setup(t,n,i)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function Nr(){let e=new WeakMap;function t(n){const i=n.target;i.removeEventListener("dispose",t),e.delete(i)}return{get:function(n,i){let r;return!1===e.has(n)?(r=new Or,e.set(n,new WeakMap),e.get(n).set(i,r),n.addEventListener("dispose",t)):!1===e.get(n).has(i)?(r=new Or,e.get(n).set(i,r)):r=e.get(n).get(i),r},dispose:function(){e=new WeakMap}}}function kr(e){It.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Fr(e){It.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new se,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}kr.prototype=Object.create(It.prototype),kr.prototype.constructor=kr,kr.prototype.isMeshDepthMaterial=!0,kr.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Fr.prototype=Object.create(It.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isMeshDistanceMaterial=!0,Fr.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function Br(e,t,n){let i=new Un;const r=new K,a=new K,o=new te,s=[],l=[],u={},c={0:1,1:0,2:2},h=new Pn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new K},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONAL_PASS=1;const f=new $t;f.setAttribute("position",new Ot(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new yn(f,h),m=this;function g(n,i){const r=t.update(p);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,r,h,p,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,r,d,p,null)}function v(e,t,n){const i=e<<0|t<<1|n<<2;let r=s[i];return void 0===r&&(r=new kr({depthPacking:3201,morphTargets:e,skinning:t}),s[i]=r),r}function y(e,t,n){const i=e<<0|t<<1|n<<2;let r=l[i];return void 0===r&&(r=new Fr({morphTargets:e,skinning:t}),l[i]=r),r}function _(t,n,i,r,a,o,s){let l=null,h=v,d=t.customDepthMaterial;if(!0===r.isPointLight&&(h=y,d=t.customDistanceMaterial),void 0===d){let e=!1;!0===i.morphTargets&&(e=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);let r=!1;!0===t.isSkinnedMesh&&(!0===i.skinning?r=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t));l=h(e,r,!0===t.isInstancedMesh)}else l=d;if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){const e=l.uuid,t=i.uuid;let n=u[e];void 0===n&&(n={},u[e]=n);let r=n[t];void 0===r&&(r=l.clone(),n[t]=r),l=r}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=3===s?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:c[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===r.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(r.matrixWorld),l.nearDistance=a,l.farDistance=o),l}function b(n,r,a,o,s){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const i=t.update(n),r=n.material;if(Array.isArray(r)){const t=i.groups;for(let l=0,u=t.length;l<u;l++){const u=t[l],c=r[u.materialIndex];if(c&&c.visible){const t=_(n,i,c,o,a.near,a.far,s);e.renderBufferDirect(a,null,i,t,n,u)}}}else if(r.visible){const t=_(n,i,r,o,a.near,a.far,s);e.renderBufferDirect(a,null,i,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,a,o,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,l){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===t.length)return;const u=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let u=0,c=t.length;u<c;u++){const c=t[u],h=c.shadow;if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}r.copy(h.mapSize);const f=h.getFrameExtents();if(r.multiply(f),a.copy(h.mapSize),(r.x>n||r.y>n)&&(r.x>n&&(a.x=Math.floor(n/f.x),r.x=a.x*f.x,h.mapSize.x=a.x),r.y>n&&(a.y=Math.floor(n/f.y),r.y=a.y*f.y,h.mapSize.y=a.y)),null===h.map&&!h.isPointLightShadow&&3===this.type){const e={minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1};h.map=new ne(r.x,r.y,e),h.map.texture.name=c.name+".shadowMap",h.mapPass=new ne(r.x,r.y,e),h.camera.updateProjectionMatrix()}if(null===h.map){const e={minFilter:1003,magFilter:1003,format:1023,stencilBuffer:!1};h.map=new ne(r.x,r.y,e),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const p=h.getViewportCount();for(let e=0;e<p;e++){const t=h.getViewport(e);o.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),d.viewport(o),h.updateMatrices(c,e),i=h.getFrustum(),b(s,l,h.camera,c,this.type)}h.isPointLightShadow||3!==this.type||g(h,l),h.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(u,c,h)}}function Ur(e,t,n){const i=n.isWebGL2;const r=new function(){let t=!1;const n=new te;let i=null;const r=new te(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,a,o,s){!0===s&&(t*=o,i*=o,a*=o),n.set(t,i,a,o),!1===r.equals(n)&&(e.clearColor(t,i,a,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},a=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(e){e?D(2929):O(2929)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},o=new function(){let t=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(e){t||(e?D(2960):O(2960))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&r===n&&a===o||(e.stencilFunc(t,n,o),i=t,r=n,a=o)},setOp:function(t,n,i){o===t&&s===n&&l===i||(e.stencilOp(t,n,i),o=t,s=n,l=i)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null}}};let s={},l=null,u=null,c=null,h=null,d=null,f=null,p=null,m=null,g=null,v=!1,y=null,_=null,b=null,E=null,T=null;const w=e.getParameter(35661);let x=!1,A=0;const S=e.getParameter(7938);-1!==S.indexOf("WebGL")?(A=parseFloat(/^WebGL\ ([0-9])/.exec(S)[1]),x=A>=1):-1!==S.indexOf("OpenGL ES")&&(A=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(S)[1]),x=A>=2);let M=null,C={};const R=new te,I=new te;function P(t,n,i){const r=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<i;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,r);return a}const L={};function D(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function O(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}L[3553]=P(3553,3553,1),L[34067]=P(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),D(2929),a.setFunc(3),B(!1),U(1),D(2884),F(0);const N={100:32774,101:32778,102:32779};if(i)N[103]=32775,N[104]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(N[103]=e.MIN_EXT,N[104]=e.MAX_EXT)}const k={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function F(t,n,i,r,a,o,s,l){if(0!==t){if(u||(D(3042),u=!0),5===t)a=a||n,o=o||i,s=s||r,n===h&&a===p||(e.blendEquationSeparate(N[n],N[a]),h=n,p=a),i===d&&r===f&&o===m&&s===g||(e.blendFuncSeparate(k[i],k[r],k[o],k[s]),d=i,f=r,m=o,g=s),c=t,v=null;else if(t!==c||l!==v){if(100===h&&100===p||(e.blendEquation(32774),h=100,p=100),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}d=null,f=null,m=null,g=null,c=t,v=l}}else u&&(O(3042),u=!1)}function B(t){y!==t&&(t?e.frontFace(2304):e.frontFace(2305),y=t)}function U(t){0!==t?(D(2884),t!==_&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):O(2884),_=t}function j(t,n,i){t?(D(32823),E===n&&T===i||(e.polygonOffset(n,i),E=n,T=i)):O(32823)}function G(t){void 0===t&&(t=33984+w-1),M!==t&&(e.activeTexture(t),M=t)}return{buffers:{color:r,depth:a,stencil:o},enable:D,disable:O,useProgram:function(t){return l!==t&&(e.useProgram(t),l=t,!0)},setBlending:F,setMaterial:function(e,t){2===e.side?O(2884):D(2884);let n=1===e.side;t&&(n=!n),B(n),1===e.blending&&!1===e.transparent?F(0):F(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),r.setMask(e.colorWrite);const i=e.stencilWrite;o.setTest(i),i&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),j(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:B,setCullFace:U,setLineWidth:function(t){t!==b&&(x&&e.lineWidth(t),b=t)},setPolygonOffset:j,setScissorTest:function(e){e?D(3089):O(3089)},activeTexture:G,bindTexture:function(t,n){null===M&&G();let i=C[M];void 0===i&&(i={type:void 0,texture:void 0},C[M]=i),i.type===t&&i.texture===n||(e.bindTexture(t,n||L[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=C[M];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===R.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),R.copy(t))},viewport:function(t){!1===I.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),I.copy(t))},reset:function(){s={},M=null,C={},l=null,c=null,y=null,_=null,r.reset(),a.reset(),o.reset()}}}function jr(e,t,n,i,r,a,o){const s=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,c=r.maxTextureSize,h=r.maxSamples,d=new WeakMap;let f,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return p?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const i=t?X.floorPowerOfTwo:Math.floor,a=i(r*e.width),o=i(r*e.height);void 0===f&&(f=m(a,o));const s=n?m(a,o):f;s.width=a,s.height=o;return s.getContext("2d").drawImage(e,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+o+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return X.isPowerOfTwo(e.width)&&X.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function _(t,n,r,a){e.generateMipmap(t);i.get(n).__maxMipLevel=Math.log(Math.max(r,a))*Math.LOG2E}function b(n,i,r){if(!1===s)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===i&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function E(e){return 1003===e||1004===e||1005===e?9728:9729}function T(t){const n=t.target;n.removeEventListener("dispose",T),function(t){const n=i.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),i.remove(t)}(n),n.isVideoTexture&&d.delete(n),o.memory.textures--}function w(t){const n=t.target;n.removeEventListener("dispose",w),function(t){const n=i.get(t),r=i.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);i.remove(t.texture),i.remove(t)}(n),o.memory.textures--}let x=0;function A(e,t){const r=i.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}(e),e.version>0&&r.__version!==e.version){const n=e.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void L(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,r.__webglTexture)}function S(t,r){if(6!==t.image.length)return;const o=i.get(t);if(t.version>0&&o.__version!==t.version){P(o,t),n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture),e.pixelStorei(37440,t.flipY);const i=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),l=t.image[0]&&t.image[0].isDataTexture,c=[];for(let e=0;e<6;e++)c[e]=i||l?l?t.image[e].image:t.image[e]:g(t.image[e],!1,!0,u);const h=c[0],d=v(h)||s,f=a.convert(t.format),p=a.convert(t.type),m=b(t.internalFormat,f,p);let E;if(I(34067,t,d),i){for(let e=0;e<6;e++){E=c[e].mipmaps;for(let i=0;i<E.length;i++){const r=E[i];1023!==t.format&&1022!==t.format?null!==f?n.compressedTexImage2D(34069+e,i,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+e,i,m,r.width,r.height,0,f,p,r.data)}}o.__maxMipLevel=E.length-1}else{E=t.mipmaps;for(let e=0;e<6;e++)if(l){n.texImage2D(34069+e,0,m,c[e].width,c[e].height,0,f,p,c[e].data);for(let t=0;t<E.length;t++){const i=E[t].image[e].image;n.texImage2D(34069+e,t+1,m,i.width,i.height,0,f,p,i.data)}}else{n.texImage2D(34069+e,0,m,f,p,c[e]);for(let t=0;t<E.length;t++){const i=E[t];n.texImage2D(34069+e,t+1,m,f,p,i.image[e])}}o.__maxMipLevel=E.length}y(t,d)&&_(34067,t,h.width,h.height),o.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture)}function M(e,t){n.activeTexture(33984+t),n.bindTexture(34067,i.get(e).__webglTexture)}const C={1e3:10497,1001:33071,1002:33648},R={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function I(n,a,o){o?(e.texParameteri(n,10242,C[a.wrapS]),e.texParameteri(n,10243,C[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[a.wrapR]),e.texParameteri(n,10240,R[a.magFilter]),e.texParameteri(n,10241,R[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(a.magFilter)),e.texParameteri(n,10241,E(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const l=t.get("EXT_texture_filter_anisotropic");if(l){if(1015===a.type&&null===t.get("OES_texture_float_linear"))return;if(1016===a.type&&null===(s||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(e.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function P(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",T),t.__webglTexture=e.createTexture(),o.memory.textures++)}function L(t,i,r){let o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),P(t,i),n.activeTexture(33984+r),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment);const l=function(e){return!s&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)}(i)&&!1===v(i.image),u=g(i.image,l,!1,c),h=v(u)||s,d=a.convert(i.format);let f,p=a.convert(i.type),m=b(i.internalFormat,d,p);I(o,i,h);const E=i.mipmaps;if(i.isDepthTexture)m=6402,s?m=1015===i.type?36012:1014===i.type?33190:1020===i.type?35056:33189:1015===i.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===i.format&&6402===m&&1012!==i.type&&1014!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=1012,p=a.convert(i.type)),1027===i.format&&6402===m&&(m=34041,1020!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=1020,p=a.convert(i.type))),n.texImage2D(3553,0,m,u.width,u.height,0,d,p,null);else if(i.isDataTexture)if(E.length>0&&h){for(let e=0,t=E.length;e<t;e++)f=E[e],n.texImage2D(3553,e,m,f.width,f.height,0,d,p,f.data);i.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,m,u.width,u.height,0,d,p,u.data),t.__maxMipLevel=0;else if(i.isCompressedTexture){for(let e=0,t=E.length;e<t;e++)f=E[e],1023!==i.format&&1022!==i.format?null!==d?n.compressedTexImage2D(3553,e,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,e,m,f.width,f.height,0,d,p,f.data);t.__maxMipLevel=E.length-1}else if(i.isDataTexture2DArray)n.texImage3D(35866,0,m,u.width,u.height,u.depth,0,d,p,u.data),t.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(32879,0,m,u.width,u.height,u.depth,0,d,p,u.data),t.__maxMipLevel=0;else if(E.length>0&&h){for(let e=0,t=E.length;e<t;e++)f=E[e],n.texImage2D(3553,e,m,d,p,f);i.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,m,d,p,u),t.__maxMipLevel=0;y(i,h)&&_(o,i,u.width,u.height),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}function D(t,r,o,s){const l=a.convert(r.texture.format),u=a.convert(r.texture.type),c=b(r.texture.internalFormat,l,u);n.texImage2D(s,0,c,r.width,r.height,0,l,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,i.get(r.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function O(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i){const t=n.depthTexture;t&&t.isDepthTexture&&(1015===t.type?r=36012:1014===t.type&&(r=33190));const i=k(n);e.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else e.renderbufferStorage(36161,r,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(i){const t=k(n);e.renderbufferStorageMultisample(36161,t,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=a.convert(n.texture.format),r=a.convert(n.texture.type),o=b(n.texture.internalFormat,t,r);if(i){const t=k(n);e.renderbufferStorageMultisample(36161,t,o,n.width,n.height)}else e.renderbufferStorage(36161,o,n.width,n.height)}e.bindRenderbuffer(36161,null)}function N(t){const n=i.get(t),r=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),A(n.depthTexture,0);const r=i.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)e.framebufferTexture2D(36160,36096,3553,r,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,r,0)}}(n.__webglFramebuffer,t)}else if(r){n.__webglDepthbuffer=[];for(let i=0;i<6;i++)e.bindFramebuffer(36160,n.__webglFramebuffer[i]),n.__webglDepthbuffer[i]=e.createRenderbuffer(),O(n.__webglDepthbuffer[i],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),O(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function k(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(h,e.samples):0}let F=!1,B=!1;this.allocateTextureUnit=function(){const e=x;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),x+=1,e},this.resetTextureUnits=function(){x=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){const r=i.get(e);e.version>0&&r.__version!==e.version?L(r,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(e,t){const r=i.get(e);e.version>0&&r.__version!==e.version?L(r,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=S,this.setTextureCubeDynamic=M,this.setupRenderTarget=function(t){const r=i.get(t),l=i.get(t.texture);t.addEventListener("dispose",w),l.__webglTexture=e.createTexture(),o.memory.textures++;const u=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,h=v(t)||s;if(!s||1022!==t.texture.format||1015!==t.texture.type&&1016!==t.texture.type||(t.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){r.__webglFramebuffer=[];for(let t=0;t<6;t++)r.__webglFramebuffer[t]=e.createFramebuffer()}else if(r.__webglFramebuffer=e.createFramebuffer(),c)if(s){r.__webglMultisampledFramebuffer=e.createFramebuffer(),r.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,r.__webglColorRenderbuffer);const n=a.convert(t.texture.format),i=a.convert(t.texture.type),o=b(t.texture.internalFormat,n,i),s=k(t);e.renderbufferStorageMultisample(36161,s,o,t.width,t.height),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(r.__webglDepthRenderbuffer=e.createRenderbuffer(),O(r.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,l.__webglTexture),I(34067,t.texture,h);for(let e=0;e<6;e++)D(r.__webglFramebuffer[e],t,36064,34069+e);y(t.texture,h)&&_(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,l.__webglTexture),I(3553,t.texture,h),D(r.__webglFramebuffer,t,36064,3553),y(t.texture,h)&&_(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){const t=e.texture;if(y(t,v(e)||s)){const r=e.isWebGLCubeRenderTarget?34067:3553,a=i.get(t).__webglTexture;n.bindTexture(r,a),_(r,t,e.width,e.height),n.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){const n=i.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);const r=t.width,a=t.height;let o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,r,a,0,0,r,a,o,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?S(e,t):M(e,t)}}function Gr(e,t,n){const i=n.isWebGL2;return{convert:function(e){let n;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(1015===e)return 5126;if(1016===e)return i?5131:(n=t.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(1021===e)return 6406;if(1022===e)return 6407;if(1023===e)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(1026===e)return 6402;if(1027===e)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(33776===e||33777===e||33778===e||33779===e){if(n=t.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(33776===e)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(n=t.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(35840===e)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return n=t.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===e||37496===e)&&(n=t.get("WEBGL_compressed_texture_etc"),null!==n)){if(37492===e)return n.COMPRESSED_RGB8_ETC2;if(37496===e)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?(n=t.get("WEBGL_compressed_texture_astc"),null!==n?e:null):36492===e?(n=t.get("EXT_texture_compression_bptc"),null!==n?e:null):1020===e?i?34042:(n=t.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function zr(e){Dn.call(this),this.cameras=e||[]}function Hr(){De.call(this),this.type="Group"}function Vr(){this._targetRay=null,this._grip=null,this._hand=null}function Wr(e,t){const n=this;let i=null,r=1,a=null,o="local-floor",s=null;const l=[],u=new Map,c=new Dn;c.layers.enable(1),c.viewport=new te;const h=new Dn;h.layers.enable(2),h.viewport=new te;const d=[c,h],f=new zr;f.layers.enable(1),f.layers.enable(2);let p=null,m=null;function g(e){const t=u.get(e.inputSource);t&&t.dispatchEvent({type:e.type})}function v(){u.forEach((function(e,t){e.disconnect(t)})),u.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),x.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(e){a=e,x.setContext(i),x.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function _(e){const t=i.inputSources;for(let e=0;e<l.length;e++)u.set(t[e],l[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=u.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),u.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],i=u.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=l[e];return void 0===t&&(t=new Vr,l[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=l[e];return void 0===t&&(t=new Vr,l[e]=t),t.getGripSpace()},this.getHand=function(e){let t=l[e];return void 0===t&&(t=new Vr,l[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return i},this.setSession=function(e){if(i=e,null!==i){i.addEventListener("select",g),i.addEventListener("selectstart",g),i.addEventListener("selectend",g),i.addEventListener("squeeze",g),i.addEventListener("squeezestart",g),i.addEventListener("squeezeend",g),i.addEventListener("end",v);const e=t.getContextAttributes();!0!==e.xrCompatible&&t.makeXRCompatible();const n={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:r},a=new XRWebGLLayer(i,t,n);i.updateRenderState({baseLayer:a}),i.requestReferenceSpace(o).then(y),i.addEventListener("inputsourceschange",_)}};const b=new se,E=new se;function T(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){f.near=h.near=c.near=e.near,f.far=h.far=c.far=e.far,p===f.near&&m===f.far||(i.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,m=f.far);const t=e.parent,n=f.cameras;T(f,t);for(let e=0;e<n.length;e++)T(n[e],t);e.matrixWorld.copy(f.matrixWorld);const r=e.children;for(let e=0,t=r.length;e<t;e++)r[e].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){b.setFromMatrixPosition(t.matrixWorld),E.setFromMatrixPosition(n.matrixWorld);const i=b.distanceTo(E),r=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],c=(r[8]-1)/r[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=i/(-c+h),m=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);const g=o+p,v=s+p,y=d-m,_=f+(i-m),T=l*s/v*g,w=u*s/v*g;e.projectionMatrix.makePerspective(y,_,T,w,g,v)}(f,c,h):f.projectionMatrix.copy(c.projectionMatrix),f};let w=null;const x=new Gn;x.setAnimationLoop((function(t,n){if(s=n.getViewerPose(a),null!==s){const t=s.views,n=i.renderState.baseLayer;e.setFramebuffer(n.framebuffer);let r=!1;t.length!==f.cameras.length&&(f.cameras.length=0,r=!0);for(let e=0;e<t.length;e++){const i=t[e],a=n.getViewport(i),o=d[e];o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(a.x,a.y,a.width,a.height),0===e&&f.matrix.copy(o.matrix),!0===r&&f.cameras.push(o)}}const r=i.inputSources;for(let e=0;e<l.length;e++){const t=l[e],i=r[e];t.update(i,n,a)}w&&w(t,n)})),this.setAnimationLoop=function(e){w=e},this.dispose=function(){}}function qr(e){function t(t,n,i){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);const r=n.envMap||i;if(r){t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var a=e.get(r).__maxMipLevel;void 0!==a&&(t.maxMipLevel.value=a)}let o,s;n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?o=n.map:n.specularMap?o=n.specularMap:n.displacementMap?o=n.displacementMap:n.normalMap?o=n.normalMap:n.bumpMap?o=n.bumpMap:n.roughnessMap?o=n.roughnessMap:n.metalnessMap?o=n.metalnessMap:n.alphaMap?o=n.alphaMap:n.emissiveMap&&(o=n.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uvTransform.value.copy(o.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),t.uv2Transform.value.copy(s.matrix))}function n(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,i,r,a,o){i.isMeshBasicMaterial?t(e,i):i.isMeshLambertMaterial?(t(e,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,i)):i.isMeshToonMaterial?(t(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshPhongMaterial?(t(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshStandardMaterial?(t(e,i,r),i.isMeshPhysicalMaterial?function(e,t,i){n(e,t,i),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,i,r):n(e,i,r)):i.isMeshMatcapMaterial?(t(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDepthMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDistanceMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?(t(e,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Yr(e){const t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h=null,d=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const f=this;let p=!1,m=null,g=0,v=0,y=null,_=null,b=-1,E=null,T=null;const w=new te,x=new te;let A=null,S=t.width,M=t.height,C=1,R=null,I=null;const P=new te(0,0,S,M),L=new te(0,0,S,M);let D=!1;const O=new Un,N=new Zn;let k=!1,F=!1;const B=new me,U=new se,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return null===y?C:1}let z,H,V,W,q,Y,Q,Z,J,$,ee,ne,ie,re,ae,oe,le,ue,ce,he=n;function de(e,n){for(let i=0;i<e.length;i++){const r=e[i],a=t.getContext(r,n);if(null!==a)return a}return null}try{const e={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",ve,!1),t.addEventListener("webglcontextrestored",ye,!1),null===he){const t=["webgl2","webgl","experimental-webgl"];if(!0===f.isWebGL1Renderer&&t.shift(),he=de(t,e),null===he)throw de(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===he.getShaderPrecisionFormat&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function fe(){z=new Jn(he),H=new Qn(he,z,e),!1===H.isWebGL2&&(z.get("WEBGL_depth_texture"),z.get("OES_texture_float"),z.get("OES_texture_half_float"),z.get("OES_texture_half_float_linear"),z.get("OES_standard_derivatives"),z.get("OES_element_index_uint"),z.get("OES_vertex_array_object"),z.get("ANGLE_instanced_arrays")),z.get("OES_texture_float_linear"),ue=new Gr(he,z,H),V=new Ur(he,z,H),V.scissor(x.copy(L).multiplyScalar(C).floor()),V.viewport(w.copy(P).multiplyScalar(C).floor()),W=new ti(he),q=new Ar,Y=new jr(he,z,V,q,H,ue,W),Q=new zn(he,H),ce=new Xn(he,z,Q,H),Z=new $n(he,Q,W,ce),J=new ai(he,Z,Q,W),ae=new ri(he),$=new xr(f,z,H,ce),ee=new qr(q),ne=new Rr(q),ie=new Nr,re=new Yn(f,V,J,s),oe=new Kn(he,z,W,H),le=new ei(he,z,W,H),W.programs=$.programs,f.capabilities=H,f.extensions=z,f.properties=q,f.renderLists=ne,f.state=V,f.info=W}fe();const pe=new Wr(f,he);this.xr=pe;const ge=new Br(f,J,H.maxTextureSize);function ve(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function ye(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,fe()}function _e(e){const t=e.target;t.removeEventListener("dispose",_e),function(e){be(e),q.remove(e)}(t)}function be(e){const t=q.get(e).program;void 0!==t&&$.releaseProgram(t)}this.shadowMap=ge,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){const e=z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(e){void 0!==e&&(C=e,this.setSize(S,M,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new K),e.set(S,M)},this.setSize=function(e,n,i){pe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=e,M=n,t.width=Math.floor(e*C),t.height=Math.floor(n*C),!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new K),e.set(S*C,M*C).floor()},this.setDrawingBufferSize=function(e,n,i){S=e,M=n,C=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new te),e.copy(w)},this.getViewport=function(e){return e.copy(P)},this.setViewport=function(e,t,n,i){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,i),V.viewport(w.copy(P).multiplyScalar(C).floor())},this.getScissor=function(e){return e.copy(L)},this.setScissor=function(e,t,n,i){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,n,i),V.scissor(x.copy(L).multiplyScalar(C).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(e){V.setScissorTest(D=e)},this.setOpaqueSort=function(e){R=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(){return re.getClearColor()},this.setClearColor=function(){re.setClearColor.apply(re,arguments)},this.getClearAlpha=function(){return re.getClearAlpha()},this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)},this.clear=function(e,t,n){let i=0;(void 0===e||e)&&(i|=16384),(void 0===t||t)&&(i|=256),(void 0===n||n)&&(i|=1024),he.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ve,!1),t.removeEventListener("webglcontextrestored",ye,!1),ne.dispose(),ie.dispose(),q.dispose(),J.dispose(),ce.dispose(),pe.dispose(),Te.stop()},this.renderBufferImmediate=function(e,t){ce.initAttributes();const n=q.get(e);e.hasPositions&&!n.position&&(n.position=he.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=he.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=he.createBuffer()),e.hasColors&&!n.color&&(n.color=he.createBuffer());const i=t.getAttributes();e.hasPositions&&(he.bindBuffer(34962,n.position),he.bufferData(34962,e.positionArray,35048),ce.enableAttribute(i.position),he.vertexAttribPointer(i.position,3,5126,!1,0,0)),e.hasNormals&&(he.bindBuffer(34962,n.normal),he.bufferData(34962,e.normalArray,35048),ce.enableAttribute(i.normal),he.vertexAttribPointer(i.normal,3,5126,!1,0,0)),e.hasUvs&&(he.bindBuffer(34962,n.uv),he.bufferData(34962,e.uvArray,35048),ce.enableAttribute(i.uv),he.vertexAttribPointer(i.uv,2,5126,!1,0,0)),e.hasColors&&(he.bindBuffer(34962,n.color),he.bufferData(34962,e.colorArray,35048),ce.enableAttribute(i.color),he.vertexAttribPointer(i.color,3,5126,!1,0,0)),ce.disableUnusedAttributes(),he.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,a){null===t&&(t=j);const o=r.isMesh&&r.matrixWorld.determinant()<0,s=Me(e,t,i,r);V.setMaterial(i,o);let l=n.index;const u=n.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;let c,h=1;!0===i.wireframe&&(l=Z.getWireframeAttribute(n),h=2),(i.morphTargets||i.morphNormals)&&ae.update(r,n,i,s),ce.setup(r,i,s,n,l);let d=oe;null!==l&&(c=Q.get(l),d=le,d.setIndex(c));const f=null!==l?l.count:u.count,p=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==a?a.start*h:0,v=null!==a?a.count*h:1/0,y=Math.max(p,g),_=Math.min(f,p+m,g+v)-1,b=Math.max(0,_-y+1);if(0!==b){if(r.isMesh)!0===i.wireframe?(V.setLineWidth(i.wireframeLinewidth*G()),d.setMode(1)):d.setMode(4);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),V.setLineWidth(e*G()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(y,b,r.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,b,e)}else d.render(y,b)}},this.compile=function(e,t){d=ie.get(e,t),d.init(),e.traverse((function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t);const n=new WeakMap;e.traverse((function(t){let i=t.material;if(i)if(Array.isArray(i))for(let r=0;r<i.length;r++){let a=i[r];!1===n.has(a)&&(Se(a,e,t),n.set(a))}else!1===n.has(i)&&(Se(i,e,t),n.set(i))}))};let Ee=null;const Te=new Gn;function we(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||O.intersectsSprite(e)){i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=J.update(e),r=e.material;r.visible&&h.push(e,t,r,n,U.z,null)}}else if(e.isImmediateRenderObject)i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B),h.push(e,null,e.material,n,U.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==W.render.frame&&(e.skeleton.update(),e.skeleton.frame=W.render.frame),!e.frustumCulled||O.intersectsObject(e))){i&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=J.update(e),r=e.material;if(Array.isArray(r)){const i=t.groups;for(let a=0,o=i.length;a<o;a++){const o=i[a],s=r[o.materialIndex];s&&s.visible&&h.push(e,t,s,n,U.z,o)}}else r.visible&&h.push(e,t,r,n,U.z,null)}const r=e.children;for(let e=0,a=r.length;e<a;e++)we(r[e],t,n,i)}function xe(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,a=e.length;r<a;r++){const a=e[r],o=a.object,s=a.geometry,l=null===i?a.material:i,u=a.group;if(n.isArrayCamera){T=n;const e=n.cameras;for(let n=0,i=e.length;n<i;n++){const i=e[n];o.layers.test(i.layers)&&(V.viewport(w.copy(i.viewport)),d.setupLights(i),Ae(o,t,i,s,l,u))}}else T=null,Ae(o,t,n,s,l,u)}}function Ae(e,t,n,i,r,a){if(e.onBeforeRender(f,t,n,i,r,a),d=ie.get(t,T||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){const i=Me(n,t,r,e);V.setMaterial(r),ce.reset(),function(e,t){e.render((function(e){f.renderBufferImmediate(e,t)}))}(e,i)}else f.renderBufferDirect(n,t,i,r,e,a);e.onAfterRender(f,t,n,i,r,a),d=ie.get(t,T||n)}function Se(e,t,n){!0!==t.isScene&&(t=j);const i=q.get(e),r=d.state.lights,a=d.state.shadowsArray,o=r.state.version,s=$.getParameters(e,r.state,a,t,N.numPlanes,N.numIntersection,n),l=$.getProgramCacheKey(s);let u=i.program,c=!0;if(void 0===u)e.addEventListener("dispose",_e);else if(u.cacheKey!==l)be(e);else if(i.lightsStateVersion!==o)i.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(s.uniforms=$.getUniforms(e,s),e.onBeforeCompile(s,f),u=$.acquireProgram(s,l),i.program=u,i.uniforms=s.uniforms,i.outputEncoding=s.outputEncoding);const h=u.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(let t=0;t<f.maxMorphTargets;t++)h["morphTarget"+t]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(let t=0;t<f.maxMorphNormals;t++)h["morphNormal"+t]>=0&&e.numSupportedMorphNormals++}const p=i.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=N.numPlanes,i.numIntersection=N.numIntersection,p.clippingPlanes=N.uniform),i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(p.ambientLightColor.value=r.state.ambient,p.lightProbe.value=r.state.probe,p.directionalLights.value=r.state.directional,p.directionalLightShadows.value=r.state.directionalShadow,p.spotLights.value=r.state.spot,p.spotLightShadows.value=r.state.spotShadow,p.rectAreaLights.value=r.state.rectArea,p.pointLights.value=r.state.point,p.pointLightShadows.value=r.state.pointShadow,p.hemisphereLights.value=r.state.hemi,p.directionalShadowMap.value=r.state.directionalShadowMap,p.directionalShadowMatrix.value=r.state.directionalShadowMatrix,p.spotShadowMap.value=r.state.spotShadowMap,p.spotShadowMatrix.value=r.state.spotShadowMatrix,p.pointShadowMap.value=r.state.pointShadowMap,p.pointShadowMatrix.value=r.state.pointShadowMatrix);const m=i.program.getUniforms(),g=ir.seqWithValue(m.seq,p);i.uniformsList=g}function Me(e,t,n,i){!0!==t.isScene&&(t=j),Y.resetTextureUnits();const r=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===y?f.outputEncoding:y.texture.encoding,s=q.get(n),l=d.state.lights;if(!0===k&&(!0===F||e!==E)){const t=e===E&&n.id===b;N.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,s,t)}n.version===s.__version?void 0===s.program||n.fog&&s.fog!==r||s.environment!==a||s.needsLights&&s.lightsStateVersion!==l.state.version?Se(n,t,i):void 0===s.numClippingPlanes||s.numClippingPlanes===N.numPlanes&&s.numIntersection===N.numIntersection?s.outputEncoding!==o&&Se(n,t,i):Se(n,t,i):(Se(n,t,i),s.__version=n.version);let u=!1,c=!1,h=!1;const p=s.program,m=p.getUniforms(),g=s.uniforms;if(V.useProgram(p.program)&&(u=!0,c=!0,h=!0),n.id!==b&&(b=n.id,c=!0),u||E!==e){if(m.setValue(he,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&m.setValue(he,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),E!==e&&(E=e,c=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const t=m.map.cameraPosition;void 0!==t&&t.setValue(he,U.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&m.setValue(he,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&m.setValue(he,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){m.setOptional(he,i,"bindMatrix"),m.setOptional(he,i,"bindMatrixInverse");const e=i.skeleton;if(e){const t=e.bones;if(H.floatVertexTextures){if(void 0===e.boneTexture){let n=Math.sqrt(4*t.length);n=X.ceilPowerOfTwo(n),n=Math.max(n,4);const i=new Float32Array(n*n*4);i.set(e.boneMatrices);const r=new kn(i,n,n,1023,1015);e.boneMatrices=i,e.boneTexture=r,e.boneTextureSize=n}m.setValue(he,"boneTexture",e.boneTexture,Y),m.setValue(he,"boneTextureSize",e.boneTextureSize)}else m.setOptional(he,e,"boneMatrices")}}var v,_;return(c||s.receiveShadow!==i.receiveShadow)&&(s.receiveShadow=i.receiveShadow,m.setValue(he,"receiveShadow",i.receiveShadow)),c&&(m.setValue(he,"toneMappingExposure",f.toneMappingExposure),s.needsLights&&(_=h,(v=g).ambientLightColor.needsUpdate=_,v.lightProbe.needsUpdate=_,v.directionalLights.needsUpdate=_,v.directionalLightShadows.needsUpdate=_,v.pointLights.needsUpdate=_,v.pointLightShadows.needsUpdate=_,v.spotLights.needsUpdate=_,v.spotLightShadows.needsUpdate=_,v.rectAreaLights.needsUpdate=_,v.hemisphereLights.needsUpdate=_),r&&n.fog&&ee.refreshFogUniforms(g,r),ee.refreshMaterialUniforms(g,n,a,C,M),void 0!==g.ltc_1&&(g.ltc_1.value=jn.LTC_1),void 0!==g.ltc_2&&(g.ltc_2.value=jn.LTC_2),ir.upload(he,s.uniformsList,g,Y)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ir.upload(he,s.uniformsList,g,Y),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&m.setValue(he,"center",i.center),m.setValue(he,"modelViewMatrix",i.modelViewMatrix),m.setValue(he,"normalMatrix",i.normalMatrix),m.setValue(he,"modelMatrix",i.matrixWorld),p}Te.setAnimationLoop((function(e){pe.isPresenting||Ee&&Ee(e)})),"undefined"!=typeof window&&Te.setContext(window),this.setAnimationLoop=function(e){Ee=e,pe.setAnimationLoop(e),null===e?Te.stop():Te.start()},this.render=function(e,t){let n,i;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===p)return;ce.resetDefaultState(),b=-1,E=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===pe.enabled&&!0===pe.isPresenting&&(t=pe.getCamera(t)),!0===e.isScene&&e.onBeforeRender(f,e,t,n||y),d=ie.get(e,t),d.init(),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),O.setFromProjectionMatrix(B),F=this.localClippingEnabled,k=N.init(this.clippingPlanes,F,t),h=ne.get(e,t),h.init(),we(e,t,0,f.sortObjects),h.finish(),!0===f.sortObjects&&h.sort(R,I),!0===k&&N.beginShadows();const r=d.state.shadowsArray;ge.render(r,e,t),d.setupLights(t),!0===k&&N.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),re.render(h,e,t,i);const a=h.opaque,o=h.transparent;a.length>0&&xe(a,e,t),o.length>0&&xe(o,e,t),!0===e.isScene&&e.onAfterRender(f,e,t),null!==y&&(Y.updateRenderTargetMipmap(y),Y.updateMultisampleRenderTarget(y)),V.buffers.depth.setTest(!0),V.buffers.depth.setMask(!0),V.buffers.color.setMask(!0),V.setPolygonOffset(!1),h=null,d=null},this.setFramebuffer=function(e){m!==e&&null===y&&he.bindFramebuffer(36160,e),m=e},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTarget=function(e,t,n){y=e,g=t,v=n,e&&void 0===q.get(e).__webglFramebuffer&&Y.setupRenderTarget(e);let i=m,r=!1;if(e){const n=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=n[t||0],r=!0):i=e.isWebGLMultisampleRenderTarget?q.get(e).__webglMultisampledFramebuffer:n,w.copy(e.viewport),x.copy(e.scissor),A=e.scissorTest}else w.copy(P).multiplyScalar(C).floor(),x.copy(L).multiplyScalar(C).floor(),A=D;if(_!==i&&(he.bindFramebuffer(36160,i),_=i),V.viewport(w),V.scissor(x),V.setScissorTest(A),r){const i=q.get(e.texture);he.framebufferTexture2D(36160,36064,34069+(t||0),i.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,i,r,a,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){let o=!1;s!==_&&(he.bindFramebuffer(36160,s),o=!0);try{const s=e.texture,l=s.format,u=s.type;if(1023!==l&&ue.convert(l)!==he.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===u||ue.convert(u)===he.getParameter(35738)||1015===u&&(H.isWebGL2||z.get("OES_texture_float")||z.get("WEBGL_color_buffer_float"))||1016===u&&(H.isWebGL2?z.get("EXT_color_buffer_float"):z.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===he.checkFramebufferStatus(36160)?t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&he.readPixels(t,n,i,r,ue.convert(l),ue.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{o&&he.bindFramebuffer(36160,_)}}},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),a=Math.floor(t.image.height*i),o=ue.convert(t.format);Y.setTexture2D(t,0),he.copyTexImage2D(3553,n,o,e.x,e.y,r,a,0),V.unbindTexture()},this.copyTextureToTexture=function(e,t,n,i){void 0===i&&(i=0);const r=t.image.width,a=t.image.height,o=ue.convert(n.format),s=ue.convert(n.type);Y.setTexture2D(n,0),he.pixelStorei(37440,n.flipY),he.pixelStorei(37441,n.premultiplyAlpha),he.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?he.texSubImage2D(3553,i,e.x,e.y,r,a,o,s,t.image.data):t.isCompressedTexture?he.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):he.texSubImage2D(3553,i,e.x,e.y,o,s,t.image),0===i&&n.generateMipmaps&&he.generateMipmap(3553),V.unbindTexture()},this.initTexture=function(e){Y.setTexture2D(e,0),V.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Xr(e){Yr.call(this,e)}function Kr(e,t){this.name="",this.color=new xt(e),this.density=void 0!==t?t:25e-5}function Qr(e,t,n){this.name="",this.color=new xt(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Zr(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=X.generateUUID()}zr.prototype=Object.assign(Object.create(Dn.prototype),{constructor:zr,isArrayCamera:!0}),Hr.prototype=Object.assign(Object.create(De.prototype),{constructor:Hr,isGroup:!0}),Object.assign(Vr.prototype,{constructor:Vr,getHandSpace:function(){if(null===this._hand&&(this._hand=new Hr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){let e=new Hr;e.matrixAutoUpdate=!1,e.visible=!1,this._hand.joints.push(e),this._hand.add(e)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Hr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Hr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){let i=null,r=null,a=null;const o=this._targetRay,s=this._grip,l=this._hand;if(e)if(e.hand){a=!0;for(let i=0;i<=window.XRHand.LITTLE_PHALANX_TIP;i++)if(e.hand[i]){let r=t.getJointPose(e.hand[i],n);const a=l.joints[i];null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.jointRadius=r.radius),a.visible=null!==r;const o=l.joints[window.XRHand.INDEX_PHALANX_TIP],s=l.joints[window.XRHand.THUMB_PHALANX_TIP],u=o.position.distanceTo(s.position),c=.02,h=.005;l.inputState.pinching&&u>c+h?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&u<=c-h&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else null!==o&&(i=t.getPose(e.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==s&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)));return null!==o&&(o.visible=null!==i),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==a),this}}),Object.assign(Wr.prototype,W.prototype),Xr.prototype=Object.assign(Object.create(Yr.prototype),{constructor:Xr,isWebGL1Renderer:!0}),Object.assign(Kr.prototype,{isFogExp2:!0,clone:function(){return new Kr(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Qr.prototype,{isFog:!0,clone:function(){return new Qr(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Zr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Zr.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=X.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new Zr(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=X.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Jr=new se;function $r(e,t,n,i){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}function ea(e){It.call(this),this.type="SpriteMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}let ta;Object.defineProperties($r.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign($r.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,n=this.data.count;t<n;t++)Jr.x=this.getX(t),Jr.y=this.getY(t),Jr.z=this.getZ(t),Jr.applyMatrix4(e),this.setXYZ(t,Jr.x,Jr.y,Jr.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Ot(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new $r(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),ea.prototype=Object.create(It.prototype),ea.prototype.constructor=ea,ea.prototype.isSpriteMaterial=!0,ea.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};const na=new se,ia=new se,ra=new se,aa=new K,oa=new K,sa=new me,la=new se,ua=new se,ca=new se,ha=new K,da=new K,fa=new K;function pa(e){if(De.call(this),this.type="Sprite",void 0===ta){ta=new $t;const e=new Zr(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);ta.setIndex([0,1,2,0,2,3]),ta.setAttribute("position",new $r(e,3,0,!1)),ta.setAttribute("uv",new $r(e,2,3,!1))}this.geometry=ta,this.material=void 0!==e?e:new ea,this.center=new K(.5,.5)}function ma(e,t,n,i,r,a){aa.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(oa.x=a*aa.x-r*aa.y,oa.y=r*aa.x+a*aa.y):oa.copy(aa),e.copy(t),e.x+=oa.x,e.y+=oa.y,e.applyMatrix4(sa)}pa.prototype=Object.assign(Object.create(De.prototype),{constructor:pa,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ia.setFromMatrixScale(this.matrixWorld),sa.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ra.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ia.multiplyScalar(-ra.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const a=this.center;ma(la.set(-.5,-.5,0),ra,a,ia,i,r),ma(ua.set(.5,-.5,0),ra,a,ia,i,r),ma(ca.set(.5,.5,0),ra,a,ia,i,r),ha.set(0,0),da.set(1,0),fa.set(1,1);let o=e.ray.intersectTriangle(la,ua,ca,!1,na);if(null===o&&(ma(ua.set(-.5,.5,0),ra,a,ia,i,r),da.set(0,1),o=e.ray.intersectTriangle(la,ca,ua,!1,na),null===o))return;const s=e.ray.origin.distanceTo(na);s<e.near||s>e.far||t.push({distance:s,point:na.clone(),uv:bt.getUV(na,la,ua,ca,ha,da,fa,new K),face:null,object:this})},copy:function(e){return De.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});const ga=new se,va=new se;function ya(){De.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function _a(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),yn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new me,this.bindMatrixInverse=new me}ya.prototype=Object.assign(Object.create(De.prototype),{constructor:ya,isLOD:!0,copy:function(e){De.prototype.copy.call(this,e,!1);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){ga.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(ga);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){const t=this.levels;if(t.length>1){ga.setFromMatrixPosition(e.matrixWorld),va.setFromMatrixPosition(this.matrixWorld);const n=ga.distanceTo(va)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}},toJSON:function(e){const t=De.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let e=0,i=n.length;e<i;e++){const i=n[e];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),_a.prototype=Object.assign(Object.create(yn.prototype),{constructor:_a,isSkinnedMesh:!0,copy:function(e){return yn.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const e=new te,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){yn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const e=new se,t=new te,n=new te,i=new se,r=new me;return function(a,o){const s=this.skeleton,l=this.geometry;t.fromBufferAttribute(l.attributes.skinIndex,a),n.fromBufferAttribute(l.attributes.skinWeight,a),e.fromBufferAttribute(l.attributes.position,a).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let a=0;a<4;a++){const l=n.getComponent(a);if(0!==l){const n=t.getComponent(a);r.multiplyMatrices(s.bones[n].matrixWorld,s.boneInverses[n]),o.addScaledVector(i.copy(e).applyMatrix4(r),l)}}return o.applyMatrix4(this.bindMatrixInverse)}}()});const ba=new me,Ea=new me;function Ta(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new me)}}function wa(){De.call(this),this.type="Bone"}Object.assign(Ta.prototype,{calculateInverses:function(){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++){const t=new me;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}},update:function(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let i=0,r=e.length;i<r;i++){const r=e[i]?e[i].matrixWorld:Ea;ba.multiplyMatrices(r,t[i]),ba.toArray(n,16*i)}void 0!==i&&(i.needsUpdate=!0)},clone:function(){return new Ta(this.bones,this.boneInverses)},getBoneByName:function(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),wa.prototype=Object.assign(Object.create(De.prototype),{constructor:wa,isBone:!0});const xa=new me,Aa=new me,Sa=[],Ma=new yn;function Ca(e,t,n){yn.call(this,e,t),this.instanceMatrix=new Ot(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Ra(e){It.call(this),this.type="LineBasicMaterial",this.color=new xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Ca.prototype=Object.assign(Object.create(yn.prototype),{constructor:Ca,isInstancedMesh:!0,copy:function(e){return yn.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){const n=this.matrixWorld,i=this.count;if(Ma.geometry=this.geometry,Ma.material=this.material,void 0!==Ma.material)for(let r=0;r<i;r++){this.getMatrixAt(r,xa),Aa.multiplyMatrices(n,xa),Ma.matrixWorld=Aa,Ma.raycast(e,Sa);for(let e=0,n=Sa.length;e<n;e++){const n=Sa[e];n.instanceId=r,n.object=this,t.push(n)}Sa.length=0}},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Ra.prototype=Object.create(It.prototype),Ra.prototype.constructor=Ra,Ra.prototype.isLineBasicMaterial=!0,Ra.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};const Ia=new se,Pa=new se,La=new me,Da=new at,Oa=new Ze;function Na(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),De.call(this),this.type="Line",this.geometry=void 0!==e?e:new $t,this.material=void 0!==t?t:new Ra,this.updateMorphTargets()}Na.prototype=Object.assign(Object.create(De.prototype),{constructor:Na,isLine:!0,copy:function(e){return De.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)Ia.fromBufferAttribute(t,e-1),Pa.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Ia.distanceTo(Pa);e.setAttribute("lineDistance",new zt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){const t=e.vertices,n=e.lineDistances;n[0]=0;for(let e=1,i=t.length;e<i;e++)n[e]=n[e-1],n[e]+=t[e-1].distanceTo(t[e])}return this},raycast:function(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Oa.copy(n.boundingSphere),Oa.applyMatrix4(i),Oa.radius+=r,!1===e.ray.intersectsSphere(Oa))return;La.getInverse(i),Da.copy(e.ray).applyMatrix4(La);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new se,l=new se,u=new se,c=new se,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position.array;if(null!==i){const n=i.array;for(let i=0,a=n.length-1;i<a;i+=h){const a=n[i],h=n[i+1];s.fromArray(r,3*a),l.fromArray(r,3*h);if(Da.distanceSqToSegment(s,l,c,u)>o)continue;c.applyMatrix4(this.matrixWorld);const d=e.ray.origin.distanceTo(c);d<e.near||d>e.far||t.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else for(let n=0,i=r.length/3-1;n<i;n+=h){s.fromArray(r,3*n),l.fromArray(r,3*n+3);if(Da.distanceSqToSegment(s,l,c,u)>o)continue;c.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(c);i<e.near||i>e.far||t.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const i=n.vertices,r=i.length;for(let n=0;n<r-1;n+=h){if(Da.distanceSqToSegment(i[n],i[n+1],c,u)>o)continue;c.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(c);r<e.near||r>e.far||t.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const ka=new se,Fa=new se;function Ba(e,t){Na.call(this,e,t),this.type="LineSegments"}function Ua(e,t){Na.call(this,e,t),this.type="LineLoop"}function ja(e){It.call(this),this.type="PointsMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Ba.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ba,isLineSegments:!0,computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)ka.fromBufferAttribute(t,e),Fa.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+ka.distanceTo(Fa);e.setAttribute("lineDistance",new zt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){const t=e.vertices,n=e.lineDistances;for(let e=0,i=t.length;e<i;e+=2)ka.copy(t[e]),Fa.copy(t[e+1]),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+ka.distanceTo(Fa)}return this}}),Ua.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ua,isLineLoop:!0}),ja.prototype=Object.create(It.prototype),ja.prototype.constructor=ja,ja.prototype.isPointsMaterial=!0,ja.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};const Ga=new me,za=new at,Ha=new Ze,Va=new se;function Wa(e,t){De.call(this),this.type="Points",this.geometry=void 0!==e?e:new $t,this.material=void 0!==t?t:new ja,this.updateMorphTargets()}function qa(e,t,n,i,r,a,o){const s=za.distanceSqToPoint(e);if(s<n){const n=new se;za.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:o})}}function Ya(e,t,n,i,r,a,o,s,l){ee.call(this,e,t,n,i,r,a,o,s,l),this.format=void 0!==o?o:1022,this.minFilter=void 0!==a?a:1006,this.magFilter=void 0!==r?r:1006,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){u.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}function Xa(e,t,n,i,r,a,o,s,l,u,c,h){ee.call(this,null,a,o,s,l,u,i,r,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Ka(e,t,n,i,r,a,o,s,l){ee.call(this,e,t,n,i,r,a,o,s,l),this.needsUpdate=!0}function Qa(e,t,n,i,r,a,o,s,l,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===u&&(n=1012),void 0===n&&1027===u&&(n=1020),ee.call(this,null,i,r,a,o,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function Za(e){$t.call(this),this.type="WireframeGeometry";const t=[],n=[0,0],i={},r=["a","b","c"];if(e&&e.isGeometry){const a=e.faces;for(let e=0,t=a.length;e<t;e++){const t=a[e];for(let e=0;e<3;e++){const a=t[r[e]],o=t[r[(e+1)%3]];n[0]=Math.min(a,o),n[1]=Math.max(a,o);const s=n[0]+","+n[1];void 0===i[s]&&(i[s]={index1:n[0],index2:n[1]})}}for(const n in i){const r=i[n];let a=e.vertices[r.index1];t.push(a.x,a.y,a.z),a=e.vertices[r.index2],t.push(a.x,a.y,a.z)}}else if(e&&e.isBufferGeometry){let r=new se;if(null!==e.index){const a=e.attributes.position,o=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,t=s.length;e<t;++e){const t=s[e],r=t.start;for(let e=r,a=r+t.count;e<a;e+=3)for(let t=0;t<3;t++){const r=o.getX(e+t),a=o.getX(e+(t+1)%3);n[0]=Math.min(r,a),n[1]=Math.max(r,a);const s=n[0]+","+n[1];void 0===i[s]&&(i[s]={index1:n[0],index2:n[1]})}}for(const e in i){const n=i[e];r.fromBufferAttribute(a,n.index1),t.push(r.x,r.y,r.z),r.fromBufferAttribute(a,n.index2),t.push(r.x,r.y,r.z)}}else{const n=e.attributes.position;for(let e=0,i=n.count/3;e<i;e++)for(let i=0;i<3;i++){const a=3*e+i;r.fromBufferAttribute(n,a),t.push(r.x,r.y,r.z);const o=3*e+(i+1)%3;r.fromBufferAttribute(n,o),t.push(r.x,r.y,r.z)}}}this.setAttribute("position",new zt(t,3))}function Ja(e,t,n){An.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new $a(e,t,n)),this.mergeVertices()}function $a(e,t,n){$t.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};const i=[],r=[],a=[],o=[],s=1e-5,l=new se,u=new se,c=new se,h=new se,d=new se;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const f=t+1;for(let i=0;i<=n;i++){const f=i/n;for(let n=0;n<=t;n++){const i=n/t;e(i,f,u),r.push(u.x,u.y,u.z),i-s>=0?(e(i-s,f,c),h.subVectors(u,c)):(e(i+s,f,c),h.subVectors(c,u)),f-s>=0?(e(i,f-s,c),d.subVectors(u,c)):(e(i,f+s,c),d.subVectors(c,u)),l.crossVectors(h,d).normalize(),a.push(l.x,l.y,l.z),o.push(i,f)}}for(let e=0;e<n;e++)for(let n=0;n<t;n++){const t=e*f+n,r=e*f+n+1,a=(e+1)*f+n+1,o=(e+1)*f+n;i.push(t,r,o),i.push(r,a,o)}this.setIndex(i),this.setAttribute("position",new zt(r,3)),this.setAttribute("normal",new zt(a,3)),this.setAttribute("uv",new zt(o,2))}function eo(e,t,n,i){An.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new to(e,t,n,i)),this.mergeVertices()}function to(e,t,n,i){$t.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1;const r=[],a=[];function o(e,t,n,i){const r=Math.pow(2,i),a=[];for(let i=0;i<=r;i++){a[i]=[];const o=e.clone().lerp(n,i/r),s=t.clone().lerp(n,i/r),l=r-i;for(let e=0;e<=l;e++)a[i][e]=0===e&&i===r?o:o.clone().lerp(s,e/l)}for(let e=0;e<r;e++)for(let t=0;t<2*(r-e)-1;t++){const n=Math.floor(t/2);t%2==0?(s(a[e][n+1]),s(a[e+1][n]),s(a[e][n])):(s(a[e][n+1]),s(a[e+1][n+1]),s(a[e+1][n]))}}function s(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function u(e,t,n,i){i<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=i/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new se,i=new se,r=new se;for(let a=0;a<t.length;a+=3)l(t[a+0],n),l(t[a+1],i),l(t[a+2],r),o(n,i,r,e)}(i=i||0),function(e){const t=new se;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new se;for(let n=0;n<r.length;n+=3){e.x=r[n+0],e.y=r[n+1],e.z=r[n+2];const i=c(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);a.push(i,1-o)}var t;(function(){const e=new se,t=new se,n=new se,i=new se,o=new K,s=new K,l=new K;for(let h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),i.copy(e).add(t).add(n).divideScalar(3);const f=c(i);u(o,d+0,e,f),u(s,d+2,t,f),u(l,d+4,n,f)}})(),function(){for(let e=0;e<a.length;e+=6){const t=a[e+0],n=a[e+2],i=a[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);r>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),i<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new zt(r,3)),this.setAttribute("normal",new zt(r.slice(),3)),this.setAttribute("uv",new zt(a,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function no(e,t){An.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new io(e,t)),this.mergeVertices()}function io(e,t){to.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ro(e,t){An.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ao(e,t)),this.mergeVertices()}function ao(e,t){to.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function oo(e,t){An.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new so(e,t)),this.mergeVertices()}function so(e,t){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];to.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function lo(e,t){An.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new uo(e,t)),this.mergeVertices()}function uo(e,t){const n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];to.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function co(e,t,n,i,r,a){An.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");const o=new ho(e,t,n,i,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function ho(e,t,n,i,r){$t.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1;const a=e.computeFrenetFrames(t,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new se,s=new se,l=new K;let u=new se;const c=[],h=[],d=[],f=[];function p(r){u=e.getPointAt(r/t,u);const l=a.normals[r],d=a.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),a=-Math.cos(t);s.x=a*l.x+r*d.x,s.y=a*l.y+r*d.y,s.z=a*l.z+r*d.z,s.normalize(),h.push(s.x,s.y,s.z),o.x=u.x+n*s.x,o.y=u.y+n*s.y,o.z=u.z+n*s.z,c.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),a=(i+1)*e+t,o=(i+1)*(e-1)+t;f.push(n,r,o),f.push(r,a,o)}}()}(),this.setIndex(f),this.setAttribute("position",new zt(c,3)),this.setAttribute("normal",new zt(h,3)),this.setAttribute("uv",new zt(d,2))}function fo(e,t,n,i,r,a,o){An.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new po(e,t,n,i,r,a)),this.mergeVertices()}function po(e,t,n,i,r,a){$t.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,a=a||3;const o=[],s=[],l=[],u=[],c=new se,h=new se,d=new se,f=new se,p=new se,m=new se,g=new se;for(let o=0;o<=n;++o){const y=o/n*r*Math.PI*2;v(y,r,a,e,d),v(y+.01,r,a,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,a=-t*Math.cos(r),f=t*Math.sin(r);c.x=d.x+(a*g.x+f*p.x),c.y=d.y+(a*g.y+f*p.y),c.z=d.z+(a*g.z+f*p.z),s.push(c.x,c.y,c.z),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(o/n),u.push(e/i)}}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),a=(i+1)*e+t,s=(i+1)*(e-1)+t;o.push(n,r,s),o.push(r,a,s)}function v(e,t,n,i,r){const a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);r.x=i*(2+l)*.5*a,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new zt(s,3)),this.setAttribute("normal",new zt(l,3)),this.setAttribute("uv",new zt(u,2))}function mo(e,t,n,i,r){An.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new go(e,t,n,i,r)),this.mergeVertices()}function go(e,t,n,i,r){$t.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;const a=[],o=[],s=[],l=[],u=new se,c=new se,h=new se;for(let a=0;a<=n;a++)for(let d=0;d<=i;d++){const f=d/i*r,p=a/n*Math.PI*2;c.x=(e+t*Math.cos(p))*Math.cos(f),c.y=(e+t*Math.cos(p))*Math.sin(f),c.z=t*Math.sin(p),o.push(c.x,c.y,c.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),h.subVectors(c,u).normalize(),s.push(h.x,h.y,h.z),l.push(d/i),l.push(a/n)}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*e+t-1,r=(i+1)*(e-1)+t-1,o=(i+1)*(e-1)+t,s=(i+1)*e+t;a.push(n,r,s),a.push(r,o,s)}this.setIndex(a),this.setAttribute("position",new zt(o,3)),this.setAttribute("normal",new zt(s,3)),this.setAttribute("uv",new zt(l,2))}Wa.prototype=Object.assign(Object.create(De.prototype),{constructor:Wa,isPoints:!0,copy:function(e){return De.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ha.copy(n.boundingSphere),Ha.applyMatrix4(i),Ha.radius+=r,!1===e.ray.intersectsSphere(Ha))return;Ga.getInverse(i),za.copy(e.ray).applyMatrix4(Ga);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){const r=n.index,a=n.attributes.position.array;if(null!==r){const n=r.array;for(let r=0,s=n.length;r<s;r++){const s=n[r];Va.fromArray(a,3*s),qa(Va,s,o,i,e,t,this)}}else for(let n=0,r=a.length/3;n<r;n++)Va.fromArray(a,3*n),qa(Va,n,o,i,e,t,this)}else{const r=n.vertices;for(let n=0,a=r.length;n<a;n++)qa(r[n],n,o,i,e,t,this)}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),Ya.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ya,isVideoTexture:!0,update:function(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Xa.prototype=Object.create(ee.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isCompressedTexture=!0,Ka.prototype=Object.create(ee.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isCanvasTexture=!0,Qa.prototype=Object.create(ee.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isDepthTexture=!0,Za.prototype=Object.create($t.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(An.prototype),Ja.prototype.constructor=Ja,$a.prototype=Object.create($t.prototype),$a.prototype.constructor=$a,eo.prototype=Object.create(An.prototype),eo.prototype.constructor=eo,to.prototype=Object.create($t.prototype),to.prototype.constructor=to,no.prototype=Object.create(An.prototype),no.prototype.constructor=no,io.prototype=Object.create(to.prototype),io.prototype.constructor=io,ro.prototype=Object.create(An.prototype),ro.prototype.constructor=ro,ao.prototype=Object.create(to.prototype),ao.prototype.constructor=ao,oo.prototype=Object.create(An.prototype),oo.prototype.constructor=oo,so.prototype=Object.create(to.prototype),so.prototype.constructor=so,lo.prototype=Object.create(An.prototype),lo.prototype.constructor=lo,uo.prototype=Object.create(to.prototype),uo.prototype.constructor=uo,co.prototype=Object.create(An.prototype),co.prototype.constructor=co,ho.prototype=Object.create($t.prototype),ho.prototype.constructor=ho,ho.prototype.toJSON=function(){const e=$t.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},fo.prototype=Object.create(An.prototype),fo.prototype.constructor=fo,po.prototype=Object.create($t.prototype),po.prototype.constructor=po,mo.prototype=Object.create(An.prototype),mo.prototype.constructor=mo,go.prototype=Object.create($t.prototype),go.prototype.constructor=go;const vo=function(e,t,n){n=n||2;let i,r,a,o,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=yo(e,0,h,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(e,t,n,i){let r,a,o,s,l,u=[];for(r=0,a=t.length;r<a;r++)o=t[r]*i,s=r<a-1?t[r+1]*i:e.length,l=yo(e,o,s,i,!1),l===l.next&&(l.steiner=!0),u.push(Ro(l));for(u.sort(Ao),r=0;r<u.length;r++)So(u[r],n),n=_o(n,n.next);return n}(e,t,d,n)),e.length>80*n){i=a=e[0],r=o=e[1];for(let t=n;t<h;t+=n)s=e[t],l=e[t+1],s<i&&(i=s),l<r&&(r=l),s>a&&(a=s),l>o&&(o=l);u=Math.max(a-i,o-r),u=0!==u?1/u:0}return bo(d,f,n,i,r,u),f};function yo(e,t,n,i,r){let a,o;if(r===function(e,t,n,i){let r=0;for(let a=t,o=n-i;a<n;a+=i)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}(e,t,n,i)>0)for(a=t;a<n;a+=i)o=Uo(a,e[a],e[a+1],o);else for(a=n-i;a>=t;a-=i)o=Uo(a,e[a],e[a+1],o);return o&&Do(o,o.next)&&(jo(o),o=o.next),o}function _o(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Do(i,i.next)&&0!==Lo(i.prev,i,i.next))i=i.next;else{if(jo(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function bo(e,t,n,i,r,a,o){if(!e)return;!o&&a&&function(e,t,n,i){let r=e;do{null===r.z&&(r.z=Co(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,i=n,s=0,t=0;t<u&&(s++,i=i.nextZ,i);t++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(e,i,r,a);let s,l,u=e;for(;e.prev!==e.next;)if(s=e.prev,l=e.next,a?To(e,i,r,a):Eo(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),jo(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?bo(e=wo(_o(e),t,n),t,n,i,r,a,2):2===o&&xo(e,t,n,i,r,a):bo(_o(e),t,n,i,r,a,1);break}}function Eo(e){let t=e.prev,n=e,i=e.next;if(Lo(t,n,i)>=0)return!1;let r=e.next.next;for(;r!==e.prev;){if(Io(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Lo(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function To(e,t,n,i){let r=e.prev,a=e,o=e.next;if(Lo(r,a,o)>=0)return!1;let s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,u=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,c=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=Co(s,l,t,n,i),d=Co(u,c,t,n,i),f=e.prevZ,p=e.nextZ;for(;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&Io(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Lo(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&Io(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Lo(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&Io(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Lo(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&Io(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Lo(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function wo(e,t,n){let i=e;do{let r=i.prev,a=i.next.next;!Do(r,a)&&Oo(r,i,i.next,a)&&Fo(r,a)&&Fo(a,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(a.i/n),jo(i),jo(i.next),i=e=a),i=i.next}while(i!==e);return _o(i)}function xo(e,t,n,i,r,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Po(o,e)){let s=Bo(o,e);return o=_o(o,o.next),s=_o(s,s.next),bo(o,t,n,i,r,a),void bo(s,t,n,i,r,a)}e=e.next}o=o.next}while(o!==e)}function Ao(e,t){return e.x-t.x}function So(e,t){if(t=function(e,t){let n,i=t,r=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){let e=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=r&&e>o){if(o=e,e===r){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===o)return n;let s,l=n,u=n.x,c=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&Io(a<c?r:o,a,u,c,a<c?o:r,a,i.x,i.y)&&(s=Math.abs(a-i.y)/(r-i.x),Fo(i,e)&&(s<h||s===h&&(i.x>n.x||i.x===n.x&&Mo(n,i)))&&(n=i,h=s)),i=i.next}while(i!==l);return n}(e,t)){const n=Bo(t,e);_o(t,t.next),_o(n,n.next)}}function Mo(e,t){return Lo(e.prev,e,t.prev)<0&&Lo(t.next,e,e.next)<0}function Co(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ro(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Io(e,t,n,i,r,a,o,s){return(r-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function Po(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Oo(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Fo(e,t)&&Fo(t,e)&&function(e,t){let n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Lo(e.prev,e,t.prev)||Lo(e,t.prev,t))||Do(e,t)&&Lo(e.prev,e,e.next)>0&&Lo(t.prev,t,t.next)>0)}function Lo(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Do(e,t){return e.x===t.x&&e.y===t.y}function Oo(e,t,n,i){const r=ko(Lo(e,t,n)),a=ko(Lo(e,t,i)),o=ko(Lo(n,i,e)),s=ko(Lo(n,i,t));return r!==a&&o!==s||(!(0!==r||!No(e,n,t))||(!(0!==a||!No(e,i,t))||(!(0!==o||!No(n,e,i))||!(0!==s||!No(n,t,i)))))}function No(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function ko(e){return e>0?1:e<0?-1:0}function Fo(e,t){return Lo(e.prev,e,e.next)<0?Lo(e,t,e.next)>=0&&Lo(e,e.prev,t)>=0:Lo(e,t,e.prev)<0||Lo(e,e.next,t)<0}function Bo(e,t){let n=new Go(e.i,e.x,e.y),i=new Go(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function Uo(e,t,n,i){const r=new Go(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function jo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Go(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const zo={area:function(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},isClockWise:function(e){return zo.area(e)<0},triangulateShape:function(e,t){const n=[],i=[],r=[];Ho(e),Vo(n,e);let a=e.length;t.forEach(Ho);for(let e=0;e<t.length;e++)i.push(a),a+=t[e].length,Vo(n,t[e]);const o=vo(n,i);for(let e=0;e<o.length;e+=3)r.push(o.slice(e,e+3));return r}};function Ho(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Vo(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Wo(e,t){An.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new qo(e,t)),this.mergeVertices()}function qo(e,t){$t.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let t=0,n=e.length;t<n;t++){a(e[t])}function a(e){const a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:c-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Yo;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let g,v,y,_,b,E=!1;p&&(g=p.getSpacedPoints(s),E=!0,u=!1,v=p.computeFrenetFrames(s,!1),y=new se,_=new se,b=new se),u||(f=0,c=0,h=0,d=0);const T=e.extractPoints(o);let w=T.shape;const x=T.holes;if(!zo.isClockWise(w)){w=w.reverse();for(let e=0,t=x.length;e<t;e++){const t=x[e];zo.isClockWise(t)&&(x[e]=t.reverse())}}const A=zo.triangulateShape(w,x),S=w;for(let e=0,t=x.length;e<t;e++){const t=x[e];w=w.concat(t)}function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const C=w.length,R=A.length;function I(e,t,n){let i,r,a;const o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(c),d=Math.sqrt(l*l+u*u),f=t.x-s/h,p=t.y+o/h,m=((n.x-u/d-f)*u-(n.y+l/d-p)*l)/(o*u-s*l);i=f+o*m-e.x,r=p+s*m-e.y;const g=i*i+r*r;if(g<=2)return new K(i,r);a=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(u)&&(e=!0),e?(i=-s,r=o,a=Math.sqrt(c)):(i=o,r=s,a=Math.sqrt(c/2))}return new K(i/a,r/a)}const P=[];for(let e=0,t=S.length,n=t-1,i=e+1;e<t;e++,n++,i++)n===t&&(n=0),i===t&&(i=0),P[e]=I(S[e],S[n],S[i]);const L=[];let D,O=P.concat();for(let e=0,t=x.length;e<t;e++){const t=x[e];D=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),D[e]=I(t[e],t[i],t[r]);L.push(D),O=O.concat(D)}for(let e=0;e<f;e++){const t=e/f,n=c*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=S.length;e<t;e++){const t=M(S[e],P[e],i);F(t.x,t.y,-n)}for(let e=0,t=x.length;e<t;e++){const t=x[e];D=L[e];for(let e=0,r=t.length;e<r;e++){const r=M(t[e],D[e],i);F(r.x,r.y,-n)}}}const N=h+d;for(let e=0;e<C;e++){const t=u?M(w[e],O[e],N):w[e];E?(_.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),b.copy(g[0]).add(_).add(y),F(b.x,b.y,b.z)):F(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<C;t++){const n=u?M(w[t],O[t],N):w[t];E?(_.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),b.copy(g[e]).add(_).add(y),F(b.x,b.y,b.z)):F(n.x,n.y,l/s*e)}for(let e=f-1;e>=0;e--){const t=e/f,n=c*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=S.length;e<t;e++){const t=M(S[e],P[e],i);F(t.x,t.y,l+n)}for(let e=0,t=x.length;e<t;e++){const t=x[e];D=L[e];for(let e=0,r=t.length;e<r;e++){const r=M(t[e],D[e],i);E?F(r.x,r.y+g[s-1].y,g[s-1].x+n):F(r.x,r.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=s+2*f;e<n;e++){const n=C*e,a=C*(e+1);U(t+i+n,t+r+n,t+r+a,t+i+a)}}}function F(e,t,n){a.push(e),a.push(t),a.push(n)}function B(e,t,r){j(e),j(t),j(r);const a=i.length/3,o=m.generateTopUV(n,i,a-3,a-2,a-1);G(o[0]),G(o[1]),G(o[2])}function U(e,t,r,a){j(e),j(t),j(a),j(t),j(r),j(a);const o=i.length/3,s=m.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);G(s[0]),G(s[1]),G(s[3]),G(s[1]),G(s[2]),G(s[3])}function j(e){i.push(a[3*e+0]),i.push(a[3*e+1]),i.push(a[3*e+2])}function G(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(u){let e=0,t=C*e;for(let e=0;e<R;e++){const n=A[e];B(n[2]+t,n[1]+t,n[0]+t)}e=s+2*f,t=C*e;for(let e=0;e<R;e++){const n=A[e];B(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<R;e++){const t=A[e];B(t[2],t[1],t[0])}for(let e=0;e<R;e++){const t=A[e];B(t[0]+C*s,t[1]+C*s,t[2]+C*s)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;k(S,t),t+=S.length;for(let e=0,n=x.length;e<n;e++){const n=x[e];k(n,t),t+=n.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new zt(i,3)),this.setAttribute("uv",new zt(r,2)),this.computeVertexNormals()}Wo.prototype=Object.create(An.prototype),Wo.prototype.constructor=Wo,Wo.prototype.toJSON=function(){const e=An.prototype.toJSON.call(this);return Xo(this.parameters.shapes,this.parameters.options,e)},qo.prototype=Object.create($t.prototype),qo.prototype.constructor=qo,qo.prototype.toJSON=function(){const e=$t.prototype.toJSON.call(this);return Xo(this.parameters.shapes,this.parameters.options,e)};const Yo={generateTopUV:function(e,t,n,i,r){const a=t[3*n],o=t[3*n+1],s=t[3*i],l=t[3*i+1],u=t[3*r],c=t[3*r+1];return[new K(a,o),new K(s,l),new K(u,c)]},generateSideWallUV:function(e,t,n,i,r,a){const o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*i],c=t[3*i+1],h=t[3*i+2],d=t[3*r],f=t[3*r+1],p=t[3*r+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-c)<.01?[new K(o,1-l),new K(u,1-h),new K(d,1-p),new K(m,1-v)]:[new K(s,1-l),new K(c,1-h),new K(f,1-p),new K(g,1-v)]}};function Xo(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,i=e.length;t<i;t++){const i=e[t];n.shapes.push(i.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Ko(e,t){An.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Qo(e,t)),this.mergeVertices()}function Qo(e,t){const n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new An;const i=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),qo.call(this,i,t),this.type="TextBufferGeometry"}function Zo(e,t,n,i,r,a,o){An.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Jo(e,t,n,i,r,a,o)),this.mergeVertices()}function Jo(e,t,n,i,r,a,o){$t.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;const s=Math.min(a+o,Math.PI);let l=0;const u=[],c=new se,h=new se,d=[],f=[],p=[],m=[];for(let d=0;d<=n;d++){const g=[],v=d/n;let y=0;0==d&&0==a?y=.5/t:d==n&&s==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const s=n/t;c.x=-e*Math.cos(i+s*r)*Math.sin(a+v*o),c.y=e*Math.cos(a+v*o),c.z=e*Math.sin(i+s*r)*Math.sin(a+v*o),f.push(c.x,c.y,c.z),h.copy(c).normalize(),p.push(h.x,h.y,h.z),m.push(s+y,1-v),g.push(l++)}u.push(g)}for(let e=0;e<n;e++)for(let i=0;i<t;i++){const t=u[e][i+1],r=u[e][i],o=u[e+1][i],l=u[e+1][i+1];(0!==e||a>0)&&d.push(t,r,l),(e!==n-1||s<Math.PI)&&d.push(r,o,l)}this.setIndex(d),this.setAttribute("position",new zt(f,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(m,2))}function $o(e,t,n,i,r,a){An.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new es(e,t,n,i,r,a)),this.mergeVertices()}function es(e,t,n,i,r,a){$t.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},e=e||.5,t=t||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;const o=[],s=[],l=[],u=[];let c=e;const h=(t-e)/(i=void 0!==i?Math.max(1,i):1),d=new se,f=new K;for(let e=0;e<=i;e++){for(let e=0;e<=n;e++){const i=r+e/n*a;d.x=c*Math.cos(i),d.y=c*Math.sin(i),s.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/t+1)/2,f.y=(d.y/t+1)/2,u.push(f.x,f.y)}c+=h}for(let e=0;e<i;e++){const t=e*(n+1);for(let e=0;e<n;e++){const i=e+t,r=i,a=i+n+1,s=i+n+2,l=i+1;o.push(r,a,l),o.push(a,s,l)}}this.setIndex(o),this.setAttribute("position",new zt(s,3)),this.setAttribute("normal",new zt(l,3)),this.setAttribute("uv",new zt(u,2))}function ts(e,t,n,i){An.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new ns(e,t,n,i)),this.mergeVertices()}function ns(e,t,n,i){$t.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=X.clamp(i,0,2*Math.PI);const r=[],a=[],o=[],s=1/t,l=new se,u=new K;for(let r=0;r<=t;r++){const c=n+r*s*i,h=Math.sin(c),d=Math.cos(c);for(let n=0;n<=e.length-1;n++)l.x=e[n].x*h,l.y=e[n].y,l.z=e[n].x*d,a.push(l.x,l.y,l.z),u.x=r/t,u.y=n/(e.length-1),o.push(u.x,u.y)}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const i=t+n*e.length,a=i,o=i+e.length,s=i+e.length+1,l=i+1;r.push(a,o,l),r.push(o,s,l)}if(this.setIndex(r),this.setAttribute("position",new zt(a,3)),this.setAttribute("uv",new zt(o,2)),this.computeVertexNormals(),i===2*Math.PI){const n=this.attributes.normal.array,i=new se,r=new se,a=new se,o=t*e.length*3;for(let t=0,s=0;t<e.length;t++,s+=3)i.x=n[s+0],i.y=n[s+1],i.z=n[s+2],r.x=n[o+s+0],r.y=n[o+s+1],r.z=n[o+s+2],a.addVectors(i,r).normalize(),n[s+0]=n[o+s+0]=a.x,n[s+1]=n[o+s+1]=a.y,n[s+2]=n[o+s+2]=a.z}}function is(e,t){An.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new rs(e,t)),this.mergeVertices()}function rs(e,t){$t.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;const n=[],i=[],r=[],a=[];let o=0,s=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,s,t),o+=s,s=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let u=l.shape;const c=l.holes;!1===zo.isClockWise(u)&&(u=u.reverse());for(let e=0,t=c.length;e<t;e++){const t=c[e];!0===zo.isClockWise(t)&&(c[e]=t.reverse())}const h=zo.triangulateShape(u,c);for(let e=0,t=c.length;e<t;e++){const t=c[e];u=u.concat(t)}for(let e=0,t=u.length;e<t;e++){const t=u[e];i.push(t.x,t.y,0),r.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){const t=h[e],i=t[0]+o,r=t[1]+o,a=t[2]+o;n.push(i,r,a),s+=3}}this.setIndex(n),this.setAttribute("position",new zt(i,3)),this.setAttribute("normal",new zt(r,3)),this.setAttribute("uv",new zt(a,2))}function as(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function os(e,t){$t.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;const n=[],i=Math.cos(X.DEG2RAD*t),r=[0,0],a={};let o,s,l;const u=["a","b","c"];let c;e.isBufferGeometry?(c=new An,c.fromBufferGeometry(e)):c=e.clone(),c.mergeVertices(),c.computeFaceNormals();const h=c.vertices,d=c.faces;for(let e=0,t=d.length;e<t;e++){const t=d[e];for(let n=0;n<3;n++)o=t[u[n]],s=t[u[(n+1)%3]],r[0]=Math.min(o,s),r[1]=Math.max(o,s),l=r[0]+","+r[1],void 0===a[l]?a[l]={index1:r[0],index2:r[1],face1:e,face2:void 0}:a[l].face2=e}for(l in a){const e=a[l];if(void 0===e.face2||d[e.face1].normal.dot(d[e.face2].normal)<=i){let t=h[e.index1];n.push(t.x,t.y,t.z),t=h[e.index2],n.push(t.x,t.y,t.z)}}this.setAttribute("position",new zt(n,3))}function ss(e,t,n,i,r,a,o,s){An.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new ls(e,t,n,i,r,a,o,s)),this.mergeVertices()}function ls(e,t,n,i,r,a,o,s){$t.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};const l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;const u=[],c=[],h=[],d=[];let f=0;const p=[],m=n/2;let g=0;function v(n){let r,a;const p=new K,v=new se;let y=0;const _=!0===n?e:t,b=!0===n?1:-1;r=f;for(let e=1;e<=i;e++)c.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),f++;a=f;for(let e=0;e<=i;e++){const t=e/i*s+o,n=Math.cos(t),r=Math.sin(t);v.x=_*r,v.y=m*b,v.z=_*n,c.push(v.x,v.y,v.z),h.push(0,b,0),p.x=.5*n+.5,p.y=.5*r*b+.5,d.push(p.x,p.y),f++}for(let e=0;e<i;e++){const t=r+e,i=a+e;!0===n?u.push(i,i+1,t):u.push(i+1,i,t),y+=3}l.addGroup(g,y,!0===n?1:2),g+=y}!function(){const a=new se,v=new se;let y=0;const _=(t-e)/n;for(let l=0;l<=r;l++){const u=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*s+o,l=Math.sin(r),p=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*p,c.push(v.x,v.y,v.z),a.set(l,_,p).normalize(),h.push(a.x,a.y,a.z),d.push(t,1-g),u.push(f++)}p.push(u)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=p[t][e],i=p[t+1][e],r=p[t+1][e+1],a=p[t][e+1];u.push(n,i,a),u.push(i,r,a),y+=6}l.addGroup(g,y,0),g+=y}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new zt(c,3)),this.setAttribute("normal",new zt(h,3)),this.setAttribute("uv",new zt(d,2))}function us(e,t,n,i,r,a,o){ss.call(this,0,e,t,n,i,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function cs(e,t,n,i,r,a,o){ls.call(this,0,e,t,n,i,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}function hs(e,t,n,i){An.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new ds(e,t,n,i)),this.mergeVertices()}function ds(e,t,n,i){$t.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;const r=[],a=[],o=[],s=[],l=new se,u=new K;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(let r=0,c=3;r<=t;r++,c+=3){const h=n+r/t*i;l.x=e*Math.cos(h),l.y=e*Math.sin(h),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[c]/e+1)/2,u.y=(a[c+1]/e+1)/2,s.push(u.x,u.y)}for(let e=1;e<=t;e++)r.push(e,e+1,0);this.setIndex(r),this.setAttribute("position",new zt(a,3)),this.setAttribute("normal",new zt(o,3)),this.setAttribute("uv",new zt(s,2))}Ko.prototype=Object.create(An.prototype),Ko.prototype.constructor=Ko,Qo.prototype=Object.create(qo.prototype),Qo.prototype.constructor=Qo,Zo.prototype=Object.create(An.prototype),Zo.prototype.constructor=Zo,Jo.prototype=Object.create($t.prototype),Jo.prototype.constructor=Jo,$o.prototype=Object.create(An.prototype),$o.prototype.constructor=$o,es.prototype=Object.create($t.prototype),es.prototype.constructor=es,ts.prototype=Object.create(An.prototype),ts.prototype.constructor=ts,ns.prototype=Object.create($t.prototype),ns.prototype.constructor=ns,is.prototype=Object.create(An.prototype),is.prototype.constructor=is,is.prototype.toJSON=function(){const e=An.prototype.toJSON.call(this);return as(this.parameters.shapes,e)},rs.prototype=Object.create($t.prototype),rs.prototype.constructor=rs,rs.prototype.toJSON=function(){const e=$t.prototype.toJSON.call(this);return as(this.parameters.shapes,e)},os.prototype=Object.create($t.prototype),os.prototype.constructor=os,ss.prototype=Object.create(An.prototype),ss.prototype.constructor=ss,ls.prototype=Object.create($t.prototype),ls.prototype.constructor=ls,us.prototype=Object.create(ss.prototype),us.prototype.constructor=us,cs.prototype=Object.create(ls.prototype),cs.prototype.constructor=cs,hs.prototype=Object.create(An.prototype),hs.prototype.constructor=hs,ds.prototype=Object.create($t.prototype),ds.prototype.constructor=ds;var fs=Object.freeze({__proto__:null,WireframeGeometry:Za,ParametricGeometry:Ja,ParametricBufferGeometry:$a,TetrahedronGeometry:no,TetrahedronBufferGeometry:io,OctahedronGeometry:ro,OctahedronBufferGeometry:ao,IcosahedronGeometry:oo,IcosahedronBufferGeometry:so,DodecahedronGeometry:lo,DodecahedronBufferGeometry:uo,PolyhedronGeometry:eo,PolyhedronBufferGeometry:to,TubeGeometry:co,TubeBufferGeometry:ho,TorusKnotGeometry:fo,TorusKnotBufferGeometry:po,TorusGeometry:mo,TorusBufferGeometry:go,TextGeometry:Ko,TextBufferGeometry:Qo,SphereGeometry:Zo,SphereBufferGeometry:Jo,RingGeometry:$o,RingBufferGeometry:es,PlaneGeometry:Hn,PlaneBufferGeometry:Vn,LatheGeometry:ts,LatheBufferGeometry:ns,ShapeGeometry:is,ShapeBufferGeometry:rs,ExtrudeGeometry:Wo,ExtrudeBufferGeometry:qo,EdgesGeometry:os,ConeGeometry:us,ConeBufferGeometry:cs,CylinderGeometry:ss,CylinderBufferGeometry:ls,CircleGeometry:hs,CircleBufferGeometry:ds,BoxGeometry:Sn,BoxBufferGeometry:Mn});function ps(e){It.call(this),this.type="ShadowMaterial",this.color=new xt(0),this.transparent=!0,this.setValues(e)}function ms(e){Pn.call(this,e),this.type="RawShaderMaterial"}function gs(e){It.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function vs(e){gs.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new K(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}function ys(e){It.call(this),this.type="MeshPhongMaterial",this.color=new xt(16777215),this.specular=new xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function _s(e){It.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function bs(e){It.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Es(e){It.call(this),this.type="MeshLambertMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ts(e){It.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new xt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ws(e){Ra.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}ps.prototype=Object.create(It.prototype),ps.prototype.constructor=ps,ps.prototype.isShadowMaterial=!0,ps.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this},ms.prototype=Object.create(Pn.prototype),ms.prototype.constructor=ms,ms.prototype.isRawShaderMaterial=!0,gs.prototype=Object.create(It.prototype),gs.prototype.constructor=gs,gs.prototype.isMeshStandardMaterial=!0,gs.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},vs.prototype=Object.create(gs.prototype),vs.prototype.constructor=vs,vs.prototype.isMeshPhysicalMaterial=!0,vs.prototype.copy=function(e){return gs.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new xt).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this},ys.prototype=Object.create(It.prototype),ys.prototype.constructor=ys,ys.prototype.isMeshPhongMaterial=!0,ys.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},_s.prototype=Object.create(It.prototype),_s.prototype.constructor=_s,_s.prototype.isMeshToonMaterial=!0,_s.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},bs.prototype=Object.create(It.prototype),bs.prototype.constructor=bs,bs.prototype.isMeshNormalMaterial=!0,bs.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Es.prototype=Object.create(It.prototype),Es.prototype.constructor=Es,Es.prototype.isMeshLambertMaterial=!0,Es.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ts.prototype=Object.create(It.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isMeshMatcapMaterial=!0,Ts.prototype.copy=function(e){return It.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ws.prototype=Object.create(Ra.prototype),ws.prototype.constructor=ws,ws.prototype.isLineDashedMaterial=!0,ws.prototype.copy=function(e){return Ra.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var xs=Object.freeze({__proto__:null,ShadowMaterial:ps,SpriteMaterial:ea,RawShaderMaterial:ms,ShaderMaterial:Pn,PointsMaterial:ja,MeshPhysicalMaterial:vs,MeshStandardMaterial:gs,MeshPhongMaterial:ys,MeshToonMaterial:_s,MeshNormalMaterial:bs,MeshLambertMaterial:Es,MeshDepthMaterial:kr,MeshDistanceMaterial:Fr,MeshBasicMaterial:Pt,MeshMatcapMaterial:Ts,LineDashedMaterial:ws,LineBasicMaterial:Ra,Material:It});const As={arraySlice:function(e,t,n){return As.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){const i=e.length,r=new e.constructor(i);for(let a=0,o=0;o!==i;++a){const i=n[a]*t;for(let n=0;n!==t;++n)r[o++]=e[i+n]}return r},flattenJSON:function(e,t,n,i){let r=1,a=e[0];for(;void 0!==a&&void 0===a[i];)a=e[r++];if(void 0===a)return;let o=a[i];if(void 0!==o)if(Array.isArray(o))do{o=a[i],void 0!==o&&(t.push(a.time),n.push.apply(n,o)),a=e[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[i],void 0!==o&&(t.push(a.time),o.toArray(n,n.length)),a=e[r++]}while(void 0!==a);else do{o=a[i],void 0!==o&&(t.push(a.time),n.push(o)),a=e[r++]}while(void 0!==a)},subclip:function(e,t,n,i,r){r=r||30;const a=e.clone();a.name=t;const o=[];for(let e=0;e<a.tracks.length;++e){const t=a.tracks[e],s=t.getValueSize(),l=[],u=[];for(let e=0;e<t.times.length;++e){const a=t.times[e]*r;if(!(a<n||a>=i)){l.push(t.times[e]);for(let n=0;n<s;++n)u.push(t.values[e*s+n])}}0!==l.length&&(t.times=As.convertArray(l,t.times.constructor),t.values=As.convertArray(u,t.values.constructor),o.push(t))}a.tracks=o;let s=1/0;for(let e=0;e<a.tracks.length;++e)s>a.tracks[e].times[0]&&(s=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*s);return a.resetDuration(),a},makeClipAdditive:function(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=e),(void 0===i||i<=0)&&(i=30);const r=e.tracks.length,a=t/i;for(let t=0;t<r;++t){const i=n.tracks[t],r=i.ValueTypeName;if("bool"===r||"string"===r)continue;const o=e.tracks.find((function(e){return e.name===i.name&&e.ValueTypeName===r}));if(void 0===o)continue;const s=i.getValueSize(),l=i.times.length-1;let u;if(a<=i.times[0])u=As.arraySlice(i.values,0,i.valueSize);else if(a>=i.times[l]){const e=l*s;u=As.arraySlice(i.values,e)}else{const e=i.createInterpolant();e.evaluate(a),u=e.resultBuffer}if("quaternion"===r){new re(u[0],u[1],u[2],u[3]).normalize().conjugate().toArray(u)}const c=o.times.length;for(let e=0;e<c;++e){const t=e*s;if("quaternion"===r)re.multiplyQuaternionsFlat(o.values,t,u,0,o.values,t);else for(let e=0;e<s;++e)o.values[t+e]-=u[e]}}return e.blendMode=2501,e}};function Ss(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ms(e,t,n,i){Ss.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Cs(e,t,n,i){Ss.call(this,e,t,n,i)}function Rs(e,t,n,i){Ss.call(this,e,t,n,i)}function Is(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=As.convertArray(t,this.TimeBufferType),this.values=As.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function Ps(e,t,n){Is.call(this,e,t,n)}function Ls(e,t,n,i){Is.call(this,e,t,n,i)}function Ds(e,t,n,i){Is.call(this,e,t,n,i)}function Os(e,t,n,i){Ss.call(this,e,t,n,i)}function Ns(e,t,n,i){Is.call(this,e,t,n,i)}function ks(e,t,n,i){Is.call(this,e,t,n,i)}function Fs(e,t,n,i){Is.call(this,e,t,n,i)}function Bs(e,t,n,i){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.blendMode=void 0!==i?i:2500,this.uuid=X.generateUUID(),this.duration<0&&this.resetDuration()}function Us(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ds;case"vector":case"vector2":case"vector3":case"vector4":return Fs;case"color":return Ls;case"quaternion":return Ns;case"bool":case"boolean":return Ps;case"string":return ks}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];As.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Ss.prototype,{evaluate:function(e){let t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let a;n:{i:if(!(e<i)){for(let a=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===a)break;if(r=i,i=t[++n],e<i)break t}a=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===a)break;if(i=r,r=t[--n-1],e>=r)break t}a=n,n=0}}for(;n<a;){const i=n+a>>>1;e<t[i]?a=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let e=0;e!==i;++e)t[e]=n[r+e];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ss.prototype,{beforeStart_:Ss.prototype.copySampleValue_,afterEnd_:Ss.prototype.copySampleValue_}),Ms.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ms,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){let i=this.parameterPositions,r=e-2,a=e+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=e,o=2*t-n;break;case 2402:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=e,s=2*n-t;break;case 2402:a=1,s=n+i[1]-i[0];break;default:a=e-1,s=t}const l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=r*u,this._offsetNext=a*u},interpolate_:function(e,t,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(i-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p;for(let e=0;e!==o;++e)r[e]=g*a[u+e]+v*a[l+e]+y*a[s+e]+_*a[c+e];return r}}),Cs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Cs,interpolate_:function(e,t,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(i-t),c=1-u;for(let e=0;e!==o;++e)r[e]=a[l+e]*c+a[s+e]*u;return r}}),Rs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Rs,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Is,{toJSON:function(e){const t=e.constructor;let n;if(void 0!==t.toJSON)n=t.toJSON(e);else{n={name:e.name,times:As.convertArray(e.times,Array),values:As.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}}),Object.assign(Is.prototype,{constructor:Is,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Rs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Cs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ms(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this},scale:function(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this},trim:function(e,t){const n=this.times,i=n.length;let r=0,a=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==r||a!==i){r>=a&&(a=Math.max(a,1),r=a-1);const e=this.getValueSize();this.times=As.arraySlice(n,r,a),this.values=As.arraySlice(this.values,r*e,a*e)}return this},validate:function(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==r;t++){const i=n[t];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,i),e=!1;break}if(null!==a&&a>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,i,a),e=!1;break}a=i}if(void 0!==i&&As.isTypedArray(i))for(let t=0,n=i.length;t!==n;++t){const n=i[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e},optimize:function(){const e=As.arraySlice(this.times),t=As.arraySlice(this.values),n=this.getValueSize(),i=2302===this.getInterpolation(),r=e.length-1;let a=1;for(let o=1;o<r;++o){let r=!1;const s=e[o];if(s!==e[o+1]&&(1!==o||s!==s[0]))if(i)r=!0;else{const e=o*n,i=e-n,a=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[a+o]){r=!0;break}}}if(r){if(o!==a){e[a]=e[o];const i=o*n,r=a*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++a}}if(r>0){e[a]=e[r];for(let e=r*n,i=a*n,o=0;o!==n;++o)t[i+o]=t[e+o];++a}return a!==e.length?(this.times=As.arraySlice(e,0,a),this.values=As.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this},clone:function(){const e=As.arraySlice(this.times,0),t=As.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Ps.prototype=Object.assign(Object.create(Is.prototype),{constructor:Ps,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ls.prototype=Object.assign(Object.create(Is.prototype),{constructor:Ls,ValueTypeName:"color"}),Ds.prototype=Object.assign(Object.create(Is.prototype),{constructor:Ds,ValueTypeName:"number"}),Os.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Os,interpolate_:function(e,t,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(i-t);let l=e*o;for(let e=l+o;l!==e;l+=4)re.slerpFlat(r,0,a,l-o,a,l,s);return r}}),Ns.prototype=Object.assign(Object.create(Is.prototype),{constructor:Ns,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Os(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),ks.prototype=Object.assign(Object.create(Is.prototype),{constructor:ks,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Fs.prototype=Object.assign(Object.create(Is.prototype),{constructor:Fs,ValueTypeName:"vector"}),Object.assign(Bs,{parse:function(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let e=0,r=n.length;e!==r;++e)t.push(Us(n[e]).scale(i));return new Bs(e.name,e.duration,t,e.blendMode)},toJSON:function(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,i=n.length;e!==i;++e)t.push(Is.toJSON(n[e]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){const r=t.length,a=[];for(let e=0;e<r;e++){let o=[],s=[];o.push((e+r-1)%r,e,(e+1)%r),s.push(0,1,0);const l=As.getKeyframeOrder(o);o=As.sortedArray(o,1,l),s=As.sortedArray(s,1,l),i||0!==o[0]||(o.push(r),s.push(s[0])),a.push(new Ds(".morphTargetInfluences["+t[e].name+"]",o,s).scale(1/n))}return new Bs(e,-1,a)},findByName:function(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],a=n.name.match(r);if(a&&a.length>1){const e=a[1];let t=i[e];t||(i[e]=t=[]),t.push(n)}}const a=[];for(const e in i)a.push(Bs.CreateFromMorphTargetSequence(e,i[e],t,n));return a},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const a=[],o=[];As.flattenJSON(n,a,o,i),0!==a.length&&r.push(new e(t,a,o))}},i=[],r=e.name||"default",a=e.fps||30,o=e.blendMode;let s=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const r=l[e].keys;if(r&&0!==r.length)if(r[0].morphTargets){const e={};let t;for(t=0;t<r.length;t++)if(r[t].morphTargets)for(let n=0;n<r[t].morphTargets.length;n++)e[r[t].morphTargets[n]]=-1;for(const n in e){const e=[],a=[];for(let i=0;i!==r[t].morphTargets.length;++i){const i=r[t];e.push(i.time),a.push(i.morphTarget===n?1:0)}i.push(new Ds(".morphTargetInfluence["+n+"]",e,a))}s=e.length*(a||1)}else{const a=".bones["+t[e].name+"]";n(Fs,a+".position",r,"pos",i),n(Ns,a+".quaternion",r,"rot",i),n(Fs,a+".scale",r,"scl",i)}}if(0===i.length)return null;return new Bs(r,s,i,o)}}),Object.assign(Bs.prototype,{resetDuration:function(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Bs(this.name,this.duration,e,this.blendMode)}});const js={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Gs(e,t,n){const i=this;let r=!1,a=0,o=0,s=void 0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===r&&void 0!==i.onStart&&i.onStart(e,a,o),r=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}const zs=new Gs;function Hs(e){this.manager=void 0!==e?e:zs,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Hs.prototype,{load:function(){},loadAsync:function(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});const Vs={};function Ws(e){Hs.call(this,e)}function qs(e){Hs.call(this,e)}function Ys(e){Hs.call(this,e)}function Xs(e){Hs.call(this,e)}function Ks(e){Hs.call(this,e)}function Qs(e){Hs.call(this,e)}function Zs(e){Hs.call(this,e)}function Js(){this.type="Curve",this.arcLengthDivisions=200}function $s(e,t,n,i,r,a,o,s){Js.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function el(e,t,n,i,r,a){$s.call(this,e,t,n,n,i,r,a),this.type="ArcCurve"}function tl(){let e=0,t=0,n=0,i=0;function r(r,a,o,s){e=r,t=o,n=-3*r+3*a-2*o-s,i=2*r-2*a+o+s}return{initCatmullRom:function(e,t,n,i,a){r(t,n,a*(n-e),a*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,a,o,s){let l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(i-t)/(o+s)+(i-n)/s;l*=o,u*=o,r(t,n,l,u)},calc:function(r){const a=r*r;return e+t*r+n*a+i*(a*r)}}}Ws.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Ws,load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=js.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;if(void 0!==Vs[e])return void Vs[e].push({onLoad:t,onProgress:n,onError:i});const o=e.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(o){const n=o[1],a=!!o[2];let s=o[3];s=decodeURIComponent(s),a&&(s=atob(s));try{let i;const a=(this.responseType||"").toLowerCase();switch(a){case"arraybuffer":case"blob":const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);i="blob"===a?new Blob([e.buffer],{type:n}):e.buffer;break;case"document":const t=new DOMParser;i=t.parseFromString(s,n);break;case"json":i=JSON.parse(s);break;default:i=s}setTimeout((function(){t&&t(i),r.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}),0)}}else{Vs[e]=[],Vs[e].push({onLoad:t,onProgress:n,onError:i}),s=new XMLHttpRequest,s.open("GET",e,!0),s.addEventListener("load",(function(t){const n=this.response,i=Vs[e];if(delete Vs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),js.add(e,n);for(let e=0,t=i.length;e<t;e++){const t=i[e];t.onLoad&&t.onLoad(n)}r.manager.itemEnd(e)}else{for(let e=0,n=i.length;e<n;e++){const n=i[e];n.onError&&n.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}}),!1),s.addEventListener("progress",(function(t){const n=Vs[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onProgress&&i.onProgress(t)}}),!1),s.addEventListener("error",(function(t){const n=Vs[e];delete Vs[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),s.addEventListener("abort",(function(t){const n=Vs[e];delete Vs[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)s.setRequestHeader(e,this.requestHeader[e]);s.send(null)}return r.manager.itemStart(e),s},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),qs.prototype=Object.assign(Object.create(Hs.prototype),{constructor:qs,load:function(e,t,n,i){const r=this,a=new Ws(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)},parse:function(e){const t=[];for(let n=0;n<e.length;n++){const i=Bs.parse(e[n]);t.push(i)}return t}}),Ys.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Ys,load:function(e,t,n,i){const r=this,a=[],o=new Xa;o.image=a;const s=new Ws(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader);let l=0;function u(u){s.load(e[u],(function(e){const n=r.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=1006),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)u(t);else s.load(e,(function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),a[t].format=n.format,a[t].width=n.width,a[t].height=n.height}}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=1006),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}}),Xs.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Xs,load:function(e,t,n,i){const r=this,a=new kn,o=new Ws(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.load(e,(function(e){const n=r.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:1001,a.wrapT=void 0!==n.wrapT?n.wrapT:1001,a.magFilter=void 0!==n.magFilter?n.magFilter:1006,a.minFilter=void 0!==n.minFilter?n.minFilter:1006,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=1008),1===n.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,t&&t(a,n))}),n,i),a}}),Ks.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Ks,load:function(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=js.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),js.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}),Qs.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Qs,load:function(e,t,n,i){const r=new oi,a=new Ks(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(n){a.load(e[n],(function(e){r.images[n]=e,o++,6===o&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(let t=0;t<e.length;++t)s(t);return r}}),Zs.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Zs,load:function(e,t,n,i){const r=new ee,a=new Ks(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){r.image=n;const i=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);r.format=i?1022:1023,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}),Object.assign(Js.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){const e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){const n=this.getLengths();let i,r=0,a=n.length;i=t||e*n[a-1];let o,s=0,l=a-1;for(;s<=l;)if(r=Math.floor(s+(l-s)/2),o=n[r]-i,o<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(r=l,n[r]===i)return r/(a-1);const u=n[r];return(r+(i-u)/(n[r+1]-u))/(a-1)},getTangent:function(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);const r=this.getPoint(n),a=this.getPoint(i),o=t||(r.isVector2?new K:new se);return o.copy(a).sub(r).normalize(),o},getTangentAt:function(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){const n=new se,i=[],r=[],a=[],o=new se,s=new me;for(let t=0;t<=e;t++){const n=t/e;i[t]=this.getTangentAt(n,new se),i[t].normalize()}r[0]=new se,a[0]=new se;let l=Number.MAX_VALUE;const u=Math.abs(i[0].x),c=Math.abs(i[0].y),h=Math.abs(i[0].z);u<=l&&(l=u,n.set(1,0,0)),c<=l&&(l=c,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),a[0].crossVectors(i[0],r[0]);for(let t=1;t<=e;t++){if(r[t]=r[t-1].clone(),a[t]=a[t-1].clone(),o.crossVectors(i[t-1],i[t]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(X.clamp(i[t-1].dot(i[t]),-1,1));r[t].applyMatrix4(s.makeRotationAxis(o,e))}a[t].crossVectors(i[t],r[t])}if(!0===t){let t=Math.acos(X.clamp(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(s.makeRotationAxis(i[n],t*n)),a[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),$s.prototype=Object.create(Js.prototype),$s.prototype.constructor=$s,$s.prototype.isEllipseCurve=!0,$s.prototype.getPoint=function(e,t){const n=t||new K,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const a=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=a?0:i),!0!==this.aClockwise||a||(r===i?r=-i:r-=i);const o=this.aStartAngle+e*r;let s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=s-this.aX,i=l-this.aY;s=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(s,l)},$s.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},$s.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},$s.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},el.prototype=Object.create($s.prototype),el.prototype.constructor=el,el.prototype.isArcCurve=!0;const nl=new se,il=new tl,rl=new tl,al=new tl;function ol(e,t,n,i){Js.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=void 0!==i?i:.5}function sl(e,t,n,i,r){const a=.5*(i-t),o=.5*(r-n),s=e*e;return(2*n-2*i+a+o)*(e*s)+(-3*n+3*i-2*a-o)*s+a*e+n}function ll(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function ul(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}function cl(e,t,n,i){Js.call(this),this.type="CubicBezierCurve",this.v0=e||new K,this.v1=t||new K,this.v2=n||new K,this.v3=i||new K}function hl(e,t,n,i){Js.call(this),this.type="CubicBezierCurve3",this.v0=e||new se,this.v1=t||new se,this.v2=n||new se,this.v3=i||new se}function dl(e,t){Js.call(this),this.type="LineCurve",this.v1=e||new K,this.v2=t||new K}function fl(e,t){Js.call(this),this.type="LineCurve3",this.v1=e||new se,this.v2=t||new se}function pl(e,t,n){Js.call(this),this.type="QuadraticBezierCurve",this.v0=e||new K,this.v1=t||new K,this.v2=n||new K}function ml(e,t,n){Js.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new se,this.v1=t||new se,this.v2=n||new se}function gl(e){Js.call(this),this.type="SplineCurve",this.points=e||[]}ol.prototype=Object.create(Js.prototype),ol.prototype.constructor=ol,ol.prototype.isCatmullRomCurve3=!0,ol.prototype.getPoint=function(e,t){const n=t||new se,i=this.points,r=i.length,a=(r-(this.closed?0:1))*e;let o,s,l,u,c=Math.floor(a),h=a-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:0===h&&c===r-1&&(c=r-2,h=1),this.closed||c>0?o=i[(c-1)%r]:(nl.subVectors(i[0],i[1]).add(i[0]),o=nl),s=i[c%r],l=i[(c+1)%r],this.closed||c+2<r?u=i[(c+2)%r]:(nl.subVectors(i[r-1],i[r-2]).add(i[r-1]),u=nl),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(s),e),n=Math.pow(s.distanceToSquared(l),e),i=Math.pow(l.distanceToSquared(u),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),il.initNonuniformCatmullRom(o.x,s.x,l.x,u.x,t,n,i),rl.initNonuniformCatmullRom(o.y,s.y,l.y,u.y,t,n,i),al.initNonuniformCatmullRom(o.z,s.z,l.z,u.z,t,n,i)}else"catmullrom"===this.curveType&&(il.initCatmullRom(o.x,s.x,l.x,u.x,this.tension),rl.initCatmullRom(o.y,s.y,l.y,u.y,this.tension),al.initCatmullRom(o.z,s.z,l.z,u.z,this.tension));return n.set(il.calc(h),rl.calc(h),al.calc(h)),n},ol.prototype.copy=function(e){Js.prototype.copy.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ol.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ol.prototype.fromJSON=function(e){Js.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new se).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},cl.prototype=Object.create(Js.prototype),cl.prototype.constructor=cl,cl.prototype.isCubicBezierCurve=!0,cl.prototype.getPoint=function(e,t){const n=t||new K,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(ul(e,i.x,r.x,a.x,o.x),ul(e,i.y,r.y,a.y,o.y)),n},cl.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},cl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},cl.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},hl.prototype=Object.create(Js.prototype),hl.prototype.constructor=hl,hl.prototype.isCubicBezierCurve3=!0,hl.prototype.getPoint=function(e,t){const n=t||new se,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(ul(e,i.x,r.x,a.x,o.x),ul(e,i.y,r.y,a.y,o.y),ul(e,i.z,r.z,a.z,o.z)),n},hl.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},hl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},hl.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},dl.prototype=Object.create(Js.prototype),dl.prototype.constructor=dl,dl.prototype.isLineCurve=!0,dl.prototype.getPoint=function(e,t){const n=t||new K;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},dl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},dl.prototype.getTangent=function(e,t){const n=t||new K;return n.copy(this.v2).sub(this.v1).normalize(),n},dl.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},dl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},dl.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},fl.prototype=Object.create(Js.prototype),fl.prototype.constructor=fl,fl.prototype.isLineCurve3=!0,fl.prototype.getPoint=function(e,t){const n=t||new se;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},fl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},fl.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},fl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},fl.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},pl.prototype=Object.create(Js.prototype),pl.prototype.constructor=pl,pl.prototype.isQuadraticBezierCurve=!0,pl.prototype.getPoint=function(e,t){const n=t||new K,i=this.v0,r=this.v1,a=this.v2;return n.set(ll(e,i.x,r.x,a.x),ll(e,i.y,r.y,a.y)),n},pl.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},pl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},pl.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ml.prototype=Object.create(Js.prototype),ml.prototype.constructor=ml,ml.prototype.isQuadraticBezierCurve3=!0,ml.prototype.getPoint=function(e,t){const n=t||new se,i=this.v0,r=this.v1,a=this.v2;return n.set(ll(e,i.x,r.x,a.x),ll(e,i.y,r.y,a.y),ll(e,i.z,r.z,a.z)),n},ml.prototype.copy=function(e){return Js.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ml.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ml.prototype.fromJSON=function(e){return Js.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},gl.prototype=Object.create(Js.prototype),gl.prototype.constructor=gl,gl.prototype.isSplineCurve=!0,gl.prototype.getPoint=function(e,t){const n=t||new K,i=this.points,r=(i.length-1)*e,a=Math.floor(r),o=r-a,s=i[0===a?a:a-1],l=i[a],u=i[a>i.length-2?i.length-1:a+1],c=i[a>i.length-3?i.length-1:a+2];return n.set(sl(o,s.x,l.x,u.x,c.x),sl(o,s.y,l.y,u.y,c.y)),n},gl.prototype.copy=function(e){Js.prototype.copy.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this},gl.prototype.toJSON=function(){const e=Js.prototype.toJSON.call(this);e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e},gl.prototype.fromJSON=function(e){Js.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new K).fromArray(n))}return this};var vl=Object.freeze({__proto__:null,ArcCurve:el,CatmullRomCurve3:ol,CubicBezierCurve:cl,CubicBezierCurve3:hl,EllipseCurve:$s,LineCurve:dl,LineCurve3:fl,QuadraticBezierCurve:pl,QuadraticBezierCurve3:ml,SplineCurve:gl});function yl(){Js.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function _l(e){yl.call(this),this.type="Path",this.currentPoint=new K,e&&this.setFromPoints(e)}function bl(e){_l.call(this,e),this.uuid=X.generateUUID(),this.type="Shape",this.holes=[]}function El(e,t){De.call(this),this.type="Light",this.color=new xt(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Tl(e,t,n){El.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(De.DefaultUp),this.updateMatrix(),this.groundColor=new xt(t)}function wl(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new K(512,512),this.map=null,this.mapPass=null,this.matrix=new me,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Un,this._frameExtents=new K(1,1),this._viewportCount=1,this._viewports=[new te(0,0,1,1)]}function xl(){wl.call(this,new Dn(50,1,.5,500))}function Al(e,t,n,i,r,a){El.call(this,e,t),this.type="SpotLight",this.position.copy(De.DefaultUp),this.updateMatrix(),this.target=new De,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new xl}function Sl(){wl.call(this,new Dn(90,1,.5,500)),this._frameExtents=new K(4,2),this._viewportCount=6,this._viewports=[new te(2,1,1,1),new te(0,1,1,1),new te(3,1,1,1),new te(1,1,1,1),new te(3,0,1,1),new te(1,0,1,1)],this._cubeDirections=[new se(1,0,0),new se(-1,0,0),new se(0,0,1),new se(0,0,-1),new se(0,1,0),new se(0,-1,0)],this._cubeUps=[new se(0,1,0),new se(0,1,0),new se(0,1,0),new se(0,1,0),new se(0,0,1),new se(0,0,-1)]}function Ml(e,t,n,i){El.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Sl}function Cl(e,t,n,i,r,a){Ln.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Rl(){wl.call(this,new Cl(-5,5,5,-5,.5,500))}function Il(e,t){El.call(this,e,t),this.type="DirectionalLight",this.position.copy(De.DefaultUp),this.updateMatrix(),this.target=new De,this.shadow=new Rl}function Pl(e,t){El.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ll(e,t,n,i){El.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function Dl(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new se)}function Ol(e,t){El.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new Dl}function Nl(e){Hs.call(this,e),this.textures={}}yl.prototype=Object.assign(Object.create(Js.prototype),{constructor:yl,add:function(e){this.curves.push(e)},closePath:function(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new dl(t,e))},getPoint:function(e){const t=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=t){const e=n[i]-t,r=this.curves[i],a=r.getLength(),o=0===a?0:1-e/a;return r.getPointAt(o)}i++}return null},getLength:function(){const e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const a=r[i],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let e=0;e<s.length;e++){const i=s[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){Js.prototype.copy.call(this,e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){const e=Js.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){Js.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new vl[n.type]).fromJSON(n))}return this}}),_l.prototype=Object.assign(Object.create(yl.prototype),{constructor:_l,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){const n=new dl(this.currentPoint.clone(),new K(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,i){const r=new pl(this.currentPoint.clone(),new K(e,t),new K(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(e,t,n,i,r,a){const o=new cl(this.currentPoint.clone(),new K(e,t),new K(n,i),new K(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this},splineThru:function(e){const t=new gl([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,i,r,a){const o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,i,r,a),this},absarc:function(e,t,n,i,r,a){return this.absellipse(e,t,n,n,i,r,a),this},ellipse:function(e,t,n,i,r,a,o,s){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,i,r,a,o,s),this},absellipse:function(e,t,n,i,r,a,o,s){const l=new $s(e,t,n,i,r,a,o,s);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this},copy:function(e){return yl.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){const e=yl.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return yl.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),bl.prototype=Object.assign(Object.create(_l.prototype),{constructor:bl,getPointsHoles:function(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){_l.prototype.copy.call(this,e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){const e=_l.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){_l.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new _l).fromJSON(n))}return this}}),El.prototype=Object.assign(Object.create(De.prototype),{constructor:El,isLight:!0,copy:function(e){return De.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){const t=De.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Tl.prototype=Object.assign(Object.create(El.prototype),{constructor:Tl,isHemisphereLight:!0,copy:function(e){return El.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(wl.prototype,{_projScreenMatrix:new me,_lightPositionWorld:new se,_lookTarget:new se,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){const t=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),xl.prototype=Object.assign(Object.create(wl.prototype),{constructor:xl,isSpotLightShadow:!0,updateMatrices:function(e){const t=this.camera,n=2*X.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),wl.prototype.updateMatrices.call(this,e)}}),Al.prototype=Object.assign(Object.create(El.prototype),{constructor:Al,isSpotLight:!0,copy:function(e){return El.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Sl.prototype=Object.assign(Object.create(wl.prototype),{constructor:Sl,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);const n=this.camera,i=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(e.matrixWorld),n.position.copy(r),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),Ml.prototype=Object.assign(Object.create(El.prototype),{constructor:Ml,isPointLight:!0,copy:function(e){return El.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Cl.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Cl,isOrthographicCamera:!0,copy:function(e,t){return Ln.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,a=n+e,o=i+t,s=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,a=r+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=De.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Rl.prototype=Object.assign(Object.create(wl.prototype),{constructor:Rl,isDirectionalLightShadow:!0,updateMatrices:function(e){wl.prototype.updateMatrices.call(this,e)}}),Il.prototype=Object.assign(Object.create(El.prototype),{constructor:Il,isDirectionalLight:!0,copy:function(e){return El.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Pl.prototype=Object.assign(Object.create(El.prototype),{constructor:Pl,isAmbientLight:!0}),Ll.prototype=Object.assign(Object.create(El.prototype),{constructor:Ll,isRectAreaLight:!0,copy:function(e){return El.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){const t=El.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(Dl.prototype,{isSphericalHarmonics3:!0,set:function(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){const n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*r),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*i*1.092548),t.addScaledVector(a[5],i*r*1.092548),t.addScaledVector(a[6],.315392*(3*r*r-1)),t.addScaledVector(a[7],n*r*1.092548),t.addScaledVector(a[8],.546274*(n*n-i*i)),t},getIrradianceAt:function(e,t){const n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*i),t.addScaledVector(a[2],1.023328*r),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*i),t.addScaledVector(a[5],.858086*i*r),t.addScaledVector(a[6],.743125*r*r-.247708),t.addScaledVector(a[7],.858086*n*r),t.addScaledVector(a[8],.429043*(n*n-i*i)),t},add:function(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},scale:function(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}}),Object.assign(Dl,{getBasisAt:function(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}),Ol.prototype=Object.assign(Object.create(El.prototype),{constructor:Ol,isLightProbe:!0,copy:function(e){return El.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){const t=El.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),Nl.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Nl,load:function(e,t,n,i){const r=this,a=new Ws(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)},parse:function(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=new xs[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=(new xt).setHex(e.sheen)),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(i.morphNormals=e.morphNormals),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.vertexTangents&&(i.vertexTangents=e.vertexTangents),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const r=e.uniforms[t];switch(i.uniforms[t]={},r.type){case"t":i.uniforms[t].value=n(r.value);break;case"c":i.uniforms[t].value=(new xt).setHex(r.value);break;case"v2":i.uniforms[t].value=(new K).fromArray(r.value);break;case"v3":i.uniforms[t].value=(new se).fromArray(r.value);break;case"v4":i.uniforms[t].value=(new te).fromArray(r.value);break;case"m3":i.uniforms[t].value=(new Q).fromArray(r.value);case"m4":i.uniforms[t].value=(new me).fromArray(r.value);break;default:i.uniforms[t].value=r.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)i.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new K).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new K).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),i},setTextures:function(e){return this.textures=e,this}});const kl=function(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function Fl(){$t.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Bl(e,t,n,i){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ot.call(this,e,t,n),this.meshPerAttribute=i||1}function Ul(e){Hs.call(this,e)}Fl.prototype=Object.assign(Object.create($t.prototype),{constructor:Fl,isInstancedBufferGeometry:!0,copy:function(e){return $t.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const e=$t.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Bl.prototype=Object.assign(Object.create(Ot.prototype),{constructor:Bl,isInstancedBufferAttribute:!0,copy:function(e){return Ot.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){const e=Ot.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Ul.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Ul,load:function(e,t,n,i){const r=this,a=new Ws(r.manager);a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)},parse:function(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],a=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers[t],r=new Uint32Array(i).buffer;return n[t]=r,r}(e,r.buffer),o=new Zr(new jl[r.type](a),r.stride);return o.uuid=r.uuid,t[i]=o,o}const r=e.isInstancedBufferGeometry?new Fl:new $t,a=e.data.index;if(void 0!==a){const e=new jl[a.type](a.array);r.setIndex(new Ot(e,1))}const o=e.data.attributes;for(const t in o){const n=o[t];let a;if(n.isInterleavedBufferAttribute){a=new $r(i(e.data,n.data),n.itemSize,n.offset,n.normalized)}else{const e=new jl[n.type](n.array);a=new(n.isInstancedBufferAttribute?Bl:Ot)(e,n.itemSize,n.normalized)}void 0!==n.name&&(a.name=n.name),r.setAttribute(t,a)}const s=e.data.morphAttributes;if(s)for(const t in s){const n=s[t],a=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];let o;if(r.isInterleavedBufferAttribute){o=new $r(i(e.data,r.data),r.itemSize,r.offset,r.normalized)}else{o=new Ot(new jl[r.type](r.array),r.itemSize,r.normalized)}void 0!==r.name&&(o.name=r.name),a.push(o)}r.morphAttributes[t]=a}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];r.addGroup(t.start,t.count,t.materialIndex)}const u=e.data.boundingSphere;if(void 0!==u){const e=new se;void 0!==u.center&&e.fromArray(u.center),r.boundingSphere=new Ze(e,u.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}});const jl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Gl(e){Hs.call(this,e)}Gl.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Gl,load:function(e,t,n,i){const r=this,a=""===this.path?kl(e):this.path;this.resourcePath=this.resourcePath||a;const o=new Ws(r.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.load(e,(function(n){let a=null;try{a=JSON.parse(n)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,i)},parse:function(e,t){const n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,i,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new bl).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){const n={};let i;if(void 0!==e){const r=new Ul;for(let a=0,o=e.length;a<o;a++){let o;const s=e[a];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new fs[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new fs[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new fs[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new fs[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new fs[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new fs[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new fs[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new fs[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new fs[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new fs[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new fs[s.type]((new vl[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new fs[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new fs[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":i=[];for(let e=0,n=s.shapes.length;e<n;e++){const n=t[s.shapes[e]];i.push(n)}o=new fs[s.type](i,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":i=[];for(let e=0,n=s.shapes.length;e<n;e++){const n=t[s.shapes[e]];i.push(n)}const e=s.options.extrudePath;void 0!==e&&(s.options.extrudePath=(new vl[e.type]).fromJSON(e)),o=new fs[s.type](i,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n},parseMaterials:function(e,t){const n={},i={};if(void 0!==e){const r=new Nl;r.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];if("MultiMaterial"===a.type){const e=[];for(let t=0;t<a.materials.length;t++){const i=a.materials[t];void 0===n[i.uuid]&&(n[i.uuid]=r.parse(i)),e.push(n[i.uuid])}i[a.uuid]=e}else void 0===n[a.uuid]&&(n[a.uuid]=r.parse(a)),i[a.uuid]=n[a.uuid]}}return i},parseAnimations:function(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n],r=Bs.parse(i);void 0!==i.uuid&&(r.uuid=i.uuid),t.push(r)}return t},parseImages:function(e,t){const n=this,i={};let r;function a(e){return n.manager.itemStart(e),r.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){const o=new Gs(t);r=new Ks(o),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],o=r.url;if(Array.isArray(o)){i[r.uuid]=[];for(let e=0,t=o.length;e<t;e++){const t=o[e],s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t;i[r.uuid].push(a(s))}}else{const e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r.url)?r.url:n.resourcePath+r.url;i[r.uuid]=a(e)}}}return i},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,a=e.length;r<a;r++){const a=e[r];let o;void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image),o=Array.isArray(t[a.image])?new oi(t[a.image]):new ee(t[a.image]),o.needsUpdate=!0,o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),void 0!==a.mapping&&(o.mapping=n(a.mapping,zl)),void 0!==a.offset&&o.offset.fromArray(a.offset),void 0!==a.repeat&&o.repeat.fromArray(a.repeat),void 0!==a.center&&o.center.fromArray(a.center),void 0!==a.rotation&&(o.rotation=a.rotation),void 0!==a.wrap&&(o.wrapS=n(a.wrap[0],Hl),o.wrapT=n(a.wrap[1],Hl)),void 0!==a.format&&(o.format=a.format),void 0!==a.type&&(o.type=a.type),void 0!==a.encoding&&(o.encoding=a.encoding),void 0!==a.minFilter&&(o.minFilter=n(a.minFilter,Vl)),void 0!==a.magFilter&&(o.magFilter=n(a.magFilter,Vl)),void 0!==a.anisotropy&&(o.anisotropy=a.anisotropy),void 0!==a.flipY&&(o.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(o.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(o.unpackAlignment=a.unpackAlignment),i[a.uuid]=o}return i},parseObject:function(e,t,n){let i,r,a;function o(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new Oe,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new xt(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new Qr(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new Kr(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new Dn(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new Cl(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new Pl(e.color,e.intensity);break;case"DirectionalLight":i=new Il(e.color,e.intensity);break;case"PointLight":i=new Ml(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new Ll(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new Al(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Tl(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=(new Ol).fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=o(e.geometry),a=s(e.material),i=new yn(r,a);break;case"InstancedMesh":r=o(e.geometry),a=s(e.material);const t=e.count,n=e.instanceMatrix;i=new Ca(r,a,t),i.instanceMatrix=new Ot(new Float32Array(n.array),16);break;case"LOD":i=new ya;break;case"Line":i=new Na(o(e.geometry),s(e.material),e.mode);break;case"LineLoop":i=new Ua(o(e.geometry),s(e.material));break;case"LineSegments":i=new Ba(o(e.geometry),s(e.material));break;case"PointCloud":case"Points":i=new Wa(o(e.geometry),s(e.material));break;case"Sprite":i=new pa(s(e.material));break;case"Group":i=new Hr;break;default:i=new De}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(i.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children){const r=e.children;for(let e=0;e<r.length;e++)i.add(this.parseObject(r[e],t,n))}if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=i.getObjectByProperty("uuid",n.object);void 0!==r&&i.addLevel(r,n.distance)}}return i}});const zl={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Hl={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Vl={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function Wl(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Hs.call(this,e),this.options={premultiplyAlpha:"none"}}function ql(){this.type="ShapePath",this.color=new xt,this.subPaths=[],this.currentPath=null}function Yl(e){this.type="Font",this.data=e}function Xl(e,t,n,i,r){const a=r.glyphs[e]||r.glyphs["?"];if(!a)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".");const o=new ql;let s,l,u,c,h,d,f,p;if(a.o){const e=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(let r=0,a=e.length;r<a;){switch(e[r++]){case"m":s=e[r++]*t+n,l=e[r++]*t+i,o.moveTo(s,l);break;case"l":s=e[r++]*t+n,l=e[r++]*t+i,o.lineTo(s,l);break;case"q":u=e[r++]*t+n,c=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,o.quadraticCurveTo(h,d,u,c);break;case"b":u=e[r++]*t+n,c=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,f=e[r++]*t+n,p=e[r++]*t+i,o.bezierCurveTo(h,d,f,p,u,c)}}}return{offsetX:a.ha*t,path:o}}function Kl(e){Hs.call(this,e)}let Ql;Wl.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Wl,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=js.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout((function(){t&&t(a),r.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,r.options)})).then((function(n){js.add(e,n),t&&t(n),r.manager.itemEnd(e)})).catch((function(t){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}}),Object.assign(ql.prototype,{moveTo:function(e,t){return this.currentPath=new _l,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this},bezierCurveTo:function(e,t,n,i,r,a){return this.currentPath.bezierCurveTo(e,t,n,i,r,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new bl;r.curves=i.curves,t.push(r)}return t}function i(e,t){const n=t.length;let i=!1;for(let r=n-1,a=0;a<n;r=a++){let n=t[r],o=t[a],s=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[a],s=-s,o=t[r],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-s*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const r=zo.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);let o,s,l,u=[];if(1===a.length)return s=a[0],l=new bl,l.curves=s.curves,u.push(l),u;let c=!r(a[0].getPoints());c=e?!c:c;const h=[],d=[];let f,p,m=[],g=0;d[g]=void 0,m[g]=[];for(let t=0,n=a.length;t<n;t++)s=a[t],f=s.getPoints(),o=r(f),o=e?!o:o,o?(!c&&d[g]&&g++,d[g]={s:new bl,p:f},d[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:f[0]});if(!d[0])return n(a);if(d.length>1){let e=!1;const t=[];for(let e=0,t=d.length;e<t;e++)h[e]=[];for(let n=0,r=d.length;n<r;n++){const r=m[n];for(let a=0;a<r.length;a++){const o=r[a];let s=!0;for(let r=0;r<d.length;r++)i(o.p,d[r].p)&&(n!==r&&t.push({froms:n,tos:r,hole:a}),s?(s=!1,h[r].push(o)):e=!0);s&&h[n].push(o)}}t.length>0&&(e||(m=h))}for(let e=0,t=d.length;e<t;e++){l=d[e].s,u.push(l),p=m[e];for(let e=0,t=p.length;e<t;e++)l.holes.push(p[e].h)}return u}}),Object.assign(Yl.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);const n=[],i=function(e,t,n){const i=Array.from?Array.from(e):String(e).split(""),r=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[];let s=0,l=0;for(let e=0;e<i.length;e++){const t=i[e];if("\n"===t)s=0,l-=a;else{const e=Xl(t,r,s,l,n);s+=e.offsetX,o.push(e.path)}}return o}(e,t,this.data);for(let e=0,t=i.length;e<t;e++)Array.prototype.push.apply(n,i[e].toShapes());return n}}),Kl.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Kl,load:function(e,t,n,i){const r=this,a=new Ws(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.load(e,(function(e){let n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}const i=r.parse(n);t&&t(i)}),n,i)},parse:function(e){return new Yl(e)}});const Zl=function(){return void 0===Ql&&(Ql=new(window.AudioContext||window.webkitAudioContext)),Ql};function Jl(e){Hs.call(this,e)}function $l(e,t,n){Ol.call(this,void 0,n);const i=(new xt).set(e),r=(new xt).set(t),a=new se(i.r,i.g,i.b),o=new se(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function eu(e,t){Ol.call(this,void 0,t);const n=(new xt).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Jl.prototype=Object.assign(Object.create(Hs.prototype),{constructor:Jl,load:function(e,t,n,i){const r=this,a=new Ws(r.manager);a.setResponseType("arraybuffer"),a.setPath(r.path),a.setRequestHeader(r.requestHeader),a.load(e,(function(n){try{const e=n.slice(0);Zl().decodeAudioData(e,(function(e){t(e)}))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)}}),$l.prototype=Object.assign(Object.create(Ol.prototype),{constructor:$l,isHemisphereLightProbe:!0,copy:function(e){return Ol.prototype.copy.call(this,e),this},toJSON:function(e){return Ol.prototype.toJSON.call(this,e)}}),eu.prototype=Object.assign(Object.create(Ol.prototype),{constructor:eu,isAmbientLightProbe:!0,copy:function(e){return Ol.prototype.copy.call(this,e),this},toJSON:function(e){return Ol.prototype.toJSON.call(this,e)}});const tu=new me,nu=new me;function iu(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Dn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Dn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const n=e.projectionMatrix.clone(),i=t.eyeSep/2,r=i*t.near/t.focus,a=t.near*Math.tan(X.DEG2RAD*t.fov*.5)/t.zoom;let o,s;nu.elements[12]=-i,tu.elements[12]=i,o=-a*t.aspect+r,s=a*t.aspect+r,n.elements[0]=2*t.near/(s-o),n.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(n),o=-a*t.aspect-r,s=a*t.aspect-r,n.elements[0]=2*t.near/(s-o),n.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(nu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(tu)}}),Object.assign(iu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});const ru=new se,au=new re,ou=new se,su=new se;function lu(){De.call(this),this.type="AudioListener",this.context=Zl(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new iu}function uu(e){De.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}lu.prototype=Object.assign(Object.create(De.prototype),{constructor:lu,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){De.prototype.updateMatrixWorld.call(this,e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ru,au,ou),su.set(0,0,-1).applyQuaternion(au),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ru.x,e),t.positionY.linearRampToValueAtTime(ru.y,e),t.positionZ.linearRampToValueAtTime(ru.z,e),t.forwardX.linearRampToValueAtTime(su.x,e),t.forwardY.linearRampToValueAtTime(su.y,e),t.forwardZ.linearRampToValueAtTime(su.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(ru.x,ru.y,ru.z),t.setOrientation(su.x,su.y,su.z,n.x,n.y,n.z)}}),uu.prototype=Object.assign(Object.create(De.prototype),{constructor:uu,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});const cu=new se,hu=new re,du=new se,fu=new se;function pu(e){uu.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function mu(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function gu(e,t,n){let i,r,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}pu.prototype=Object.assign(Object.create(uu.prototype),{constructor:pu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(De.prototype.updateMatrixWorld.call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(cu,hu,du),fu.set(0,0,1).applyQuaternion(hu);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(cu.x,e),t.positionY.linearRampToValueAtTime(cu.y,e),t.positionZ.linearRampToValueAtTime(cu.z,e),t.orientationX.linearRampToValueAtTime(fu.x,e),t.orientationY.linearRampToValueAtTime(fu.y,e),t.orientationZ.linearRampToValueAtTime(fu.z,e)}else t.setPosition(cu.x,cu.y,cu.z),t.setOrientation(fu.x,fu.y,fu.z)}}),Object.assign(mu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(gu.prototype,{accumulate:function(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==i;++e)n[r+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=a},accumulateAdditive:function(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e},apply:function(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let e=t,r=t+t;e!==r;++e)if(n[e]!==n[e+t]){o.setValue(n,i);break}},saveOriginalState:function(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let e=n,r=i;e!==r;++e)t[e]=t[i+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]},_select:function(e,t,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)e[t+i]=e[n+i]},_slerp:function(e,t,n,i){re.slerpFlat(e,t,e,t,e,n,i)},_slerpAdditive:function(e,t,n,i,r){const a=this._workIndex*r;re.multiplyQuaternionsFlat(e,a,e,t,e,n),re.slerpFlat(e,t,e,t,e,a,i)},_lerp:function(e,t,n,i,r){const a=1-i;for(let o=0;o!==r;++o){const r=t+o;e[r]=e[r]*a+e[n+o]*i}},_lerpAdditive:function(e,t,n,i,r){for(let a=0;a!==r;++a){const r=t+a;e[r]=e[r]+e[n+a]*i}}});const vu=new RegExp("[\\[\\]\\.:\\/]","g"),yu="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",_u=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),bu=/(WCOD+)?/.source.replace("WCOD",yu),Eu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Tu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),wu=new RegExp("^"+_u+bu+Eu+Tu+"$"),xu=["material","materials","bones"];function Au(e,t,n){const i=n||Su.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function Su(e,t,n){this.path=t,this.parsedPath=n||Su.parseTrackName(t),this.node=Su.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Mu(e,t,n,i){this._mixer=e,this._clip=t,this._localRoot=n||null,this.blendMode=i||t.blendMode;const r=t.tracks,a=r.length,o=new Array(a),s={endingStart:2400,endingEnd:2400};for(let e=0;e!==a;++e){const t=r[e].createInterpolant(null);o[e]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Cu(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Ru(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Iu(e,t,n){Zr.call(this,e,t),this.meshPerAttribute=n||1}function Pu(e,t,n,i){this.ray=new at(e,t),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new _e,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Lu(e,t){return e.distance-t.distance}function Du(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)Du(i[e],t,n,!0)}}Object.assign(Au.prototype,{getValue:function(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Su,{Composite:Au,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Su.Composite(e,t,n):new Su(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(vu,"")},parseTrackName:function(e){const t=wu.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==xu.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const a=n(r.children);if(a)return a}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(Su.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=Su.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const a=e[i];if(void 0===a){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Su.prototype,{_getValue_unbound:Su.prototype.getValue,_setValue_unbound:Su.prototype.setValue}),Object.assign(function(){this.uuid=X.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,a=r.length;let o=void 0,s=e.length,l=this.nCachedObjects_;for(let u=0,c=arguments.length;u!==c;++u){const c=arguments[u],h=c.uuid;let d=t[h];if(void 0===d){d=s++,t[h]=d,e.push(c);for(let e=0,t=a;e!==t;++e)r[e].push(new Su(c,n[e],i[e]))}else if(d<l){o=e[d];const s=--l,u=e[s];t[u.uuid]=d,e[d]=u,t[h]=s,e[s]=c;for(let e=0,t=a;e!==t;++e){const t=r[e],a=t[s];let o=t[d];t[d]=a,void 0===o&&(o=new Su(c,n[e],i[e])),t[s]=o}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a],s=o.uuid,l=t[s];if(void 0!==l&&l>=r){const a=r++,u=e[a];t[u.uuid]=l,e[l]=u,t[s]=a,e[a]=o;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[a],r=t[l];t[l]=i,t[a]=r}}}this.nCachedObjects_=r},uncache:function(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,a=e.length;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o].uuid,l=t[s];if(void 0!==l)if(delete t[s],l<r){const o=--r,s=e[o],u=--a,c=e[u];t[s.uuid]=l,e[l]=s,t[c.uuid]=o,e[o]=c,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],r=t[u];t[l]=i,t[o]=r,t.pop()}}else{const r=--a,o=e[r];t[o.uuid]=l,e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r},subscribe_:function(e,t){let n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(void 0!==i)return r[i];const a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[e]=i,a.push(e),o.push(t),r.push(c);for(let n=u,i=s.length;n!==i;++n){const i=s[n];c[n]=new Su(i,e,t)}return c},unsubscribe_:function(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}),Object.assign(Mu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,i=e._clip.duration,r=i/n,a=n/i;e.warp(1,r,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){const i=this._mixer,r=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+n,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulateAdditive(o);break;case 2500:default:for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulate(i,o)}}},_updateWeight:function(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const a=2202===n;if(0===e)return-1===r?i:a&&1==(1&r)?t-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(a&&1==(1&r))return t-i}return i},_setEndings:function(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){const i=this._mixer,r=i.time;let a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=t,o[1]=r+e,s[1]=n,this}}),Cu.prototype=Object.assign(Object.create(W.prototype),{constructor:Cu,_bindAction:function(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let u=l[s];void 0===u&&(u={},l[s]=u);for(let e=0;e!==r;++e){const r=i[e],l=r.name;let c=u[l];if(void 0!==c)a[e]=c;else{if(c=a[e],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,s,l));continue}const i=t&&t._propertyBindings[e].binding.parsedPath;c=new gu(Su.create(n,l,i),r.ValueTypeName,r.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,s,l),a[e]=c}o[e].resultBuffer=c.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){const i=this._actions,r=this._actionsByClip;let a=r[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackAction:function(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_addInactiveBinding:function(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let a=i[t];void 0===a&&(a={},i[t]=a),a[n]=e,e._cacheIndex=r.length,r.push(e)},_removeInactiveBinding:function(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[r],0===Object.keys(o).length&&delete a[i]},_lendBinding:function(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackBinding:function(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_lendControlInterpolant:function(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new Cs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,n){const i=t||this._root,r=i.uuid;let a="string"==typeof e?Bs.findByName(i,e):e;const o=null!==a?a.uuid:e;let s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:2500),void 0!==s){const e=s.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const u=new Mu(this,a,t,n);return this._bindAction(u,l),this._addInactiveAction(u,o,r),u},existingAction:function(e,t){const n=t||this._root,i=n.uuid,r="string"==typeof e?Bs.findByName(n,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[i]||null},stopAllAction:function(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==n;++o){t[o]._update(i,e,r,a)}const o=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e)o[e].apply(a);return this},setTime:function(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,a=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,a._cacheIndex=r,t[r]=a,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}},uncacheRoot:function(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const i=n[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const e in i){const t=i[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}},uncacheAction:function(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Ru.prototype.clone=function(){return new Ru(void 0===this.value.clone?this.value:this.value.clone())},Iu.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Iu,isInstancedInterleavedBuffer:!0,copy:function(e){return Zr.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){const t=Zr.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){const t=Zr.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.assign(Pu.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){const i=n||[];return Du(e,this,i,t),i.sort(Lu),i},intersectObjects:function(e,t,n){const i=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(let n=0,r=e.length;n<r;n++)Du(e[n],this,i,t);return i.sort(Lu),i}});Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});const Ou=new K;function Nu(e,t){this.min=void 0!==e?e:new K(1/0,1/0),this.max=void 0!==t?t:new K(-1/0,-1/0)}Object.assign(Nu.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const n=Ou.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new K),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new K),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new K),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new K),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Ou.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const ku=new se,Fu=new se;function Bu(e,t){this.start=void 0!==e?e:new se,this.end=void 0!==t?t:new se}function Uu(e){De.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(Bu.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new se),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new se),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new se),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){ku.subVectors(e,this.start),Fu.subVectors(this.end,this.start);const n=Fu.dot(Fu);let i=Fu.dot(ku)/n;return t&&(i=X.clamp(i,0,1)),i},closestPointToPoint:function(e,t,n){const i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new se),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Uu.prototype=Object.create(De.prototype),Uu.prototype.constructor=Uu,Uu.prototype.isImmediateRenderObject=!0;const ju=new se;function Gu(e,t){De.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new $t,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const r=e/n*Math.PI*2,a=t/n*Math.PI*2;i.push(Math.cos(r),Math.sin(r),1,Math.cos(a),Math.sin(a),1)}n.setAttribute("position",new zt(i,3));const r=new Ra({fog:!1,toneMapped:!1});this.cone=new Ba(n,r),this.add(this.cone),this.update()}Gu.prototype=Object.create(De.prototype),Gu.prototype.constructor=Gu,Gu.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Gu.prototype.update=function(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),ju.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ju),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const zu=new se,Hu=new me,Vu=new me;function Wu(e){const t=function e(t){const n=[];t&&t.isBone&&n.push(t);for(let i=0;i<t.children.length;i++)n.push.apply(n,e(t.children[i]));return n}(e),n=new $t,i=[],r=[],a=new xt(0,0,1),o=new xt(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new zt(i,3)),n.setAttribute("color",new zt(r,3));const s=new Ra({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Ba.call(this,n,s),this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function qu(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;const i=new Jo(t,4,2),r=new Pt({wireframe:!0,fog:!1,toneMapped:!1});yn.call(this,i,r),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Wu.prototype=Object.create(Ba.prototype),Wu.prototype.constructor=Wu,Wu.prototype.isSkeletonHelper=!0,Wu.prototype.updateMatrixWorld=function(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Vu.getInverse(this.root.matrixWorld);for(let e=0,n=0;e<t.length;e++){const r=t[e];r.parent&&r.parent.isBone&&(Hu.multiplyMatrices(Vu,r.matrixWorld),zu.setFromMatrixPosition(Hu),i.setXYZ(n,zu.x,zu.y,zu.z),Hu.multiplyMatrices(Vu,r.parent.matrixWorld),zu.setFromMatrixPosition(Hu),i.setXYZ(n+1,zu.x,zu.y,zu.z),n+=2)}n.getAttribute("position").needsUpdate=!0,De.prototype.updateMatrixWorld.call(this,e)},qu.prototype=Object.create(yn.prototype),qu.prototype.constructor=qu,qu.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},qu.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const Yu=new se,Xu=new xt,Ku=new xt;function Qu(e,t,n){De.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new ao(t);i.rotateY(.5*Math.PI),this.material=new Pt({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),a=new Float32Array(3*r.count);i.setAttribute("color",new Ot(a,3)),this.add(new yn(i,this.material)),this.update()}function Zu(e,t,n,i){e=e||10,t=t||10,n=new xt(void 0!==n?n:4473924),i=new xt(void 0!==i?i:8947848);const r=t/2,a=e/t,o=e/2,s=[],l=[];for(let e=0,u=0,c=-o;e<=t;e++,c+=a){s.push(-o,0,c,o,0,c),s.push(c,0,-o,c,0,o);const t=e===r?n:i;t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3}const u=new $t;u.setAttribute("position",new zt(s,3)),u.setAttribute("color",new zt(l,3));const c=new Ra({vertexColors:!0,toneMapped:!1});Ba.call(this,u,c),this.type="GridHelper"}function Ju(e,t,n,i,r,a){e=e||10,t=t||16,n=n||8,i=i||64,r=new xt(void 0!==r?r:4473924),a=new xt(void 0!==a?a:8947848);const o=[],s=[];for(let n=0;n<=t;n++){const i=n/t*(2*Math.PI),l=Math.sin(i)*e,u=Math.cos(i)*e;o.push(0,0,0),o.push(l,0,u);const c=1&n?r:a;s.push(c.r,c.g,c.b),s.push(c.r,c.g,c.b)}for(let t=0;t<=n;t++){const l=1&t?r:a,u=e-e/n*t;for(let e=0;e<i;e++){let t=e/i*(2*Math.PI),n=Math.sin(t)*u,r=Math.cos(t)*u;o.push(n,0,r),s.push(l.r,l.g,l.b),t=(e+1)/i*(2*Math.PI),n=Math.sin(t)*u,r=Math.cos(t)*u,o.push(n,0,r),s.push(l.r,l.g,l.b)}}const l=new $t;l.setAttribute("position",new zt(o,3)),l.setAttribute("color",new zt(s,3));const u=new Ra({vertexColors:!0,toneMapped:!1});Ba.call(this,l,u),this.type="PolarGridHelper"}Qu.prototype=Object.create(De.prototype),Qu.prototype.constructor=Qu,Qu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Qu.prototype.update=function(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Xu.copy(this.light.color),Ku.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?Xu:Ku;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Yu.setFromMatrixPosition(this.light.matrixWorld).negate())},Zu.prototype=Object.create(Ba.prototype),Zu.prototype.constructor=Zu,Ju.prototype=Object.create(Ba.prototype),Ju.prototype.constructor=Ju;const $u=new se,ec=new se,tc=new se;function nc(e,t,n){De.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let i=new $t;i.setAttribute("position",new zt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Ra({fog:!1,toneMapped:!1});this.lightPlane=new Na(i,r),this.add(this.lightPlane),i=new $t,i.setAttribute("position",new zt([0,0,0,0,0,1],3)),this.targetLine=new Na(i,r),this.add(this.targetLine),this.update()}nc.prototype=Object.create(De.prototype),nc.prototype.constructor=nc,nc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},nc.prototype.update=function(){$u.setFromMatrixPosition(this.light.matrixWorld),ec.setFromMatrixPosition(this.light.target.matrixWorld),tc.subVectors(ec,$u),this.lightPlane.lookAt(ec),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ec),this.targetLine.scale.z=tc.length()};const ic=new se,rc=new Ln;function ac(e){const t=new $t,n=new Ra({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],a={},o=new xt(16755200),s=new xt(16711680),l=new xt(43775),u=new xt(16777215),c=new xt(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(i.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),t.setAttribute("position",new zt(i,3)),t.setAttribute("color",new zt(r,3)),Ba.call(this,t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function oc(e,t,n,i,r,a,o){ic.set(r,a,o).unproject(i);const s=t[e];if(void 0!==s){const e=n.getAttribute("position");for(let t=0,n=s.length;t<n;t++)e.setXYZ(s[t],ic.x,ic.y,ic.z)}}ac.prototype=Object.create(Ba.prototype),ac.prototype.constructor=ac,ac.prototype.update=function(){const e=this.geometry,t=this.pointMap;rc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),oc("c",t,e,rc,0,0,-1),oc("t",t,e,rc,0,0,1),oc("n1",t,e,rc,-1,-1,-1),oc("n2",t,e,rc,1,-1,-1),oc("n3",t,e,rc,-1,1,-1),oc("n4",t,e,rc,1,1,-1),oc("f1",t,e,rc,-1,-1,1),oc("f2",t,e,rc,1,-1,1),oc("f3",t,e,rc,-1,1,1),oc("f4",t,e,rc,1,1,1),oc("u1",t,e,rc,.7,1.1,-1),oc("u2",t,e,rc,-.7,1.1,-1),oc("u3",t,e,rc,0,2,-1),oc("cf1",t,e,rc,-1,0,1),oc("cf2",t,e,rc,1,0,1),oc("cf3",t,e,rc,0,-1,1),oc("cf4",t,e,rc,0,1,1),oc("cn1",t,e,rc,-1,0,-1),oc("cn2",t,e,rc,1,0,-1),oc("cn3",t,e,rc,0,-1,-1),oc("cn4",t,e,rc,0,1,-1),e.getAttribute("position").needsUpdate=!0};const sc=new Xe;function lc(e,t){this.object=e,void 0===t&&(t=16776960);const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new $t;r.setIndex(new Ot(n,1)),r.setAttribute("position",new Ot(i,3)),Ba.call(this,r,new Ra({color:t,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function uc(e,t){this.type="Box3Helper",this.box=e,void 0===t&&(t=16776960);const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new $t;i.setIndex(new Ot(n,1)),i.setAttribute("position",new zt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ba.call(this,i,new Ra({color:t,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function cc(e,t,n){this.plane=e,this.size=void 0===t?1:t;const i=void 0!==n?n:16776960,r=new $t;r.setAttribute("position",new zt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),Na.call(this,r,new Ra({color:i,toneMapped:!1})),this.type="PlaneHelper";const a=new $t;a.setAttribute("position",new zt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new yn(a,new Pt({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}lc.prototype=Object.create(Ba.prototype),lc.prototype.constructor=lc,lc.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&sc.setFromObject(this.object),sc.isEmpty())return;const t=sc.min,n=sc.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()},lc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},lc.prototype.copy=function(e){return Ba.prototype.copy.call(this,e),this.object=e.object,this},uc.prototype=Object.create(Ba.prototype),uc.prototype.constructor=uc,uc.prototype.updateMatrixWorld=function(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),De.prototype.updateMatrixWorld.call(this,e))},cc.prototype=Object.create(Na.prototype),cc.prototype.constructor=cc,cc.prototype.updateMatrixWorld=function(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?1:0,this.lookAt(this.plane.normal),De.prototype.updateMatrixWorld.call(this,e)};const hc=new se;let dc,fc;function pc(e,t,n,i,r,a){De.call(this),this.type="ArrowHelper",void 0===e&&(e=new se(0,0,1)),void 0===t&&(t=new se(0,0,0)),void 0===n&&(n=1),void 0===i&&(i=16776960),void 0===r&&(r=.2*n),void 0===a&&(a=.2*r),void 0===dc&&(dc=new $t,dc.setAttribute("position",new zt([0,0,0,0,1,0],3)),fc=new ls(0,.5,1,5,1),fc.translate(0,-.5,0)),this.position.copy(t),this.line=new Na(dc,new Ra({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new yn(fc,new Pt({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,a)}function mc(e){const t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new $t;n.setAttribute("position",new zt(t,3)),n.setAttribute("color",new zt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const i=new Ra({vertexColors:!0,toneMapped:!1});Ba.call(this,n,i),this.type="AxesHelper"}pc.prototype=Object.create(De.prototype),pc.prototype.constructor=pc,pc.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{hc.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(hc,t)}},pc.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},pc.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},pc.prototype.copy=function(e){return De.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},mc.prototype=Object.create(Ba.prototype),mc.prototype.constructor=mc;const gc=Math.pow(2,8),vc=[.125,.215,.35,.446,.526,.582],yc=5+vc.length,_c={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},bc=new Cl,{_lodPlanes:Ec,_sizeLods:Tc,_sigmas:wc}=function(){const e=[],t=[],n=[];let i=8;for(let r=0;r<yc;r++){const a=Math.pow(2,i);t.push(a);let o=1/a;r>4?o=vc[r-8+4-1]:0==r&&(o=0),n.push(o);const s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=6,d=6,f=3,p=2,m=1,g=new Float32Array(f*d*h),v=new Float32Array(p*d*h),y=new Float32Array(m*d*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(i,f*d*e),v.set(c,p*d*e);const r=[e,e,e,e,e,e];y.set(r,m*d*e)}const _=new $t;_.setAttribute("position",new Ot(g,f)),_.setAttribute("uv",new Ot(v,p)),_.setAttribute("faceIndex",new Ot(y,m)),e.push(_),i>4&&i--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}();let xc=null;const Ac=(1+Math.sqrt(5))/2,Sc=1/Ac,Mc=[new se(1,1,1),new se(-1,1,1),new se(1,1,-1),new se(-1,1,-1),new se(0,Ac,Sc),new se(0,Ac,-Sc),new se(Sc,0,Ac),new se(-Sc,0,Ac),new se(Ac,Sc,0),new se(-Ac,Sc,0)];function Cc(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(e){const t=new Float32Array(e),n=new se(0,1,0);return new ms({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:_c[3e3]},outputEncoding:{value:_c[3e3]}},vertexShader:Oc(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${Nc()}\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function Rc(e){return void 0!==e&&1009===e.type&&(3e3===e.encoding||3001===e.encoding||3007===e.encoding)}function Ic(e){const t=new ne(3*gc,3*gc,e);return t.texture.mapping=306,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Pc(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function Lc(){return new ms({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new K(1,1)},inputEncoding:{value:_c[3e3]},outputEncoding:{value:_c[3e3]}},vertexShader:Oc(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${Nc()}\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1})}function Dc(){return new ms({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:_c[3e3]},outputEncoding:{value:_c[3e3]}},vertexShader:Oc(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${Nc()}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1})}function Oc(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Nc(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}Cc.prototype={constructor:Cc,fromScene:function(e,t=0,n=.1,i=100){xc=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r},fromEquirectangular:function(e){return this._fromTexture(e)},fromCubemap:function(e){return this._fromTexture(e)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=Dc(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Lc(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Ec.length;e++)Ec[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(xc),e.scissorTest=!1,Pc(e,0,0,e.width,e.height)},_fromTexture:function(e){xc=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},_allocateTargets:function(e){const t={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:Rc(e)?e.encoding:3002,depthBuffer:!1,stencilBuffer:!1},n=Ic(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Ic(t),n},_compileMaterial:function(e){const t=new yn(Ec[0],e);this._renderer.compile(t,bc)},_sceneToCubeUV:function(e,t,n,i){const r=new Dn(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.outputEncoding,u=s.toneMapping,c=s.getClearColor(),h=s.getClearAlpha();s.toneMapping=0,s.outputEncoding=3e3;let d=e.background;if(d&&d.isColor){d.convertSRGBToLinear();const t=Math.max(d.r,d.g,d.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);d=d.multiplyScalar(Math.pow(2,-n));const i=(n+128)/255;s.setClearColor(d,i),e.background=null}for(let t=0;t<6;t++){const n=t%3;0==n?(r.up.set(0,a[t],0),r.lookAt(o[t],0,0)):1==n?(r.up.set(0,0,a[t]),r.lookAt(0,o[t],0)):(r.up.set(0,a[t],0),r.lookAt(0,0,o[t])),Pc(i,n*gc,t>2?gc:0,gc,gc),s.setRenderTarget(i),s.render(e,r)}s.toneMapping=u,s.outputEncoding=l,s.setClearColor(c,h)},_textureToCubeUV:function(e,t){const n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Dc()):null==this._equirectShader&&(this._equirectShader=Lc());const i=e.isCubeTexture?this._cubemapShader:this._equirectShader,r=new yn(Ec[0],i),a=i.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=_c[e.encoding],a.outputEncoding.value=_c[t.texture.encoding],Pc(t,0,0,3*gc,2*gc),n.setRenderTarget(t),n.render(r,bc)},_applyPMREM:function(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<yc;t++){const n=Math.sqrt(wc[t]*wc[t]-wc[t-1]*wc[t-1]),i=Mc[(t-1)%Mc.length];this._blur(e,t-1,t,n,i)}t.autoClear=n},_blur:function(e,t,n,i,r){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",r),this._halfBlur(a,e,n,n,i,"longitudinal",r)},_halfBlur:function(e,t,n,i,r,a,o){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new yn(Ec[i],l),c=l.uniforms,h=Tc[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,f=r/d,p=isFinite(r)?1+Math.floor(3*f):20;p>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<20;++e){const t=e/f,n=Math.exp(-t*t/2);m.push(n),0==e?g+=n:e<p&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=_c[e.texture.encoding],c.outputEncoding.value=_c[e.texture.encoding];const v=Tc[i];Pc(t,3*Math.max(0,gc-2*v),(0===i?0:2*gc)+2*v*(i>4?i-8+4:0),3*v,2*v),s.setRenderTarget(t),s.render(u,bc)}};function kc(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ol.call(this,e),this.type="catmullrom"}Js.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Js.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(yl.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=new An;for(let n=0,i=e.length;n<i;n++){const i=e[n];t.vertices.push(new se(i.x,i.y,i.z||0))}return t}}),Object.assign(_l.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(ol.prototype),Object.create(ol.prototype),kc.prototype=Object.create(ol.prototype),Object.assign(kc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Zu.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Wu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Hs.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),kl(e)}}),Hs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Gl.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Nu.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Xe.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Ze.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Un.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Bu.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(X,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),X.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),X.ceilPowerOfTwo(e)}}),Object.assign(Q.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(me.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new se).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,a)}}),ut.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},re.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(at.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(bt.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(bt,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),bt.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),bt.getNormal(e,t,n,i)}}),Object.assign(bl.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Wo(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new is(this,e)}}),Object.assign(K.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(se.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(te.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(An.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(De.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(De.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(yn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(yn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ya.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ta.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),_a.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Js.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Dn.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(El.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Ot.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(Ot.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign($t.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Ot(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties($t.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Fl.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(Pu.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Zr.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Zr.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(qo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Ru.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(It.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new xt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ys.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(vs.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Pn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Yr.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Yr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Br.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ne.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(uu.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new Jl).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),mu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},On.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};J.crossOrigin=void 0,J.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new Zs;r.setCrossOrigin(this.crossOrigin);const a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a},J.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new Qs;r.setCrossOrigin(this.crossOrigin);const a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a},J.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},J.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function Fc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"119"}}));var Bc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=0,this.irs="",this.mediaUrl="",this.irUrl="",this.audioPlayer=null,this.sourceNode=null,this.audioSetupComplete=!1,this.videoSetupComplete=!1,this.xrActive=!1,this.context=null,this.rotator=null,this.multiplier=null,this.decoder=null,this.masterGain=0,this.numCh=0,this.videoPlayer=null,this.maxOrder=4,this.opusSupport=!0,this.zoomIndex=1,this.gazeEvent=null,this.scene=null;var t=window.AudioContext||window.webkitAudioContext;this.context=new t,console.log(this.context),this.playbackEventHandler=new N(this.context),this.audioElement=new Audio,""===this.audioElement.canPlayType('audio/ogg; codecs="opus"')&&(this.opusSupport=!1),this.sourceNode=this.context.createMediaElementSource(this.audioElement),this.videoPlayer=Object(a.a)("hoast360-player",{html5:{nativeCaptions:!1},liveui:!0,plugins:{httpSourceSelector:{default:"auto"}}})}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e,t,n){if(this.opusSupport){this.videoPlayer.xr(),console.log(this.videoPlayer),console.log(this.videoPlayer.xr()),this.audioSetupComplete=!1,this.videoSetupComplete=!1,this.order>this.maxOrder&&console.error("Ambisonic orders greater than 4 not supported!"),this.order=n,this.mediaUrl=e,this.irUrl=t,this._setOrderDependentVariables(),this.videoPlayer.src({type:"application/dash+xml",src:this.mediaUrl+"video.mpd"}),this.audioPlayer=i.MediaPlayer().create(),this.audioPlayer.initialize(this.audioElement),this.audioPlayer.setAutoPlay(!1),this.audioPlayer.attachSource(this.mediaUrl+"audio.mpd");var r=this;this.videoPlayer.xr().on("initialized",(function(){console.log("xr initialized"),r._startSetup(),r.playbackEventHandler.initialize(r.videoPlayer,r.audioPlayer)}))}else this.videoPlayer.error("Error: Your browser does not support the OPUS audio codec. Please use Firefox or Chrome-based browsers.")}},{key:"reset",value:function(){this.opusSupport?(this.playbackEventHandler.reset(),this.videoPlayer.pause(),this._disconnectAudio(),this.videoPlayer.xr().reset(),this.videoPlayer.dash.mediaPlayer.reset(),this.videoPlayer.reset(),this.audioPlayer.reset()):this.videoPlayer.reset()}},{key:"testFunction",value:function(){console.log("test message: "+this)}},{key:"makeGazeTarget",value:function(){var e=new yn(new Sn(2,2,2),new Es({color:15688960,opacity:1,transparent:!0}));e.castShadow=!0,e.position.set(100*Math.random()-50,50*Math.random()-10,100*Math.random()-50),this.scene.add(e),this.gazeEvent.on(e,"gazeEnter",(function(e){e.material.opacity=.5})),this.gazeEvent.on(e,"gazeTrigger",(function(e){e.rotation.y+=.02})),this.gazeEvent.on(e,"gazeLeave",(function(e){e.material.opacity=1}))}},{key:"_disconnectAudio",value:function(){this.sourceNode.disconnect(),this.rotator.out.disconnect(),this.multiplier.out.disconnect(),this.decoder.out.disconnect(),this.masterGain.disconnect()}},{key:"_startSetup",value:function(){this.audioSetupComplete||this.videoSetupComplete||(this._setupAudio(),this._setupVideo(),this._setupGaze())}},{key:"_setupAudio",value:function(){var e=this,t=this;this.rotator=new z(this.context,this.order),console.log(this.rotator),this.multiplier=new L(this.context,4),console.log(this.multiplier),this.decoder=new U(this.context,this.order),console.log(this.decoder),new F(this.context,this.order,this.irs,(function(t,n){e.decoder.updateFilters(t,n),e.playbackEventHandler.setAllBuffersLoaded(!0)})).load(),this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.videoPlayer.on("volumechange",(function(){t.masterGain&&(this.muted()?t.masterGain.gain.value=0:t.masterGain.gain.value=this.volume())})),this.sourceNode.channelCount=this.numCh,this.sourceNode.connect(this.rotator.in),this.rotator.out.connect(this.multiplier.in),this.multiplier.out.connect(this.decoder.in),this.decoder.out.connect(this.masterGain),this.masterGain.connect(this.context.destination),this.audioSetupComplete=!0}},{key:"_setupVideo",value:function(){this.videoPlayer.xr().camera.rotation.order="YZX";var e=this.videoPlayer.xr().controls3d;e.orbit.minDistance=-700,e.orbit.maxDistance=200;var t=this;e.orbit.addEventListener("change",(function(){t.xrActive||t.rotator.updateRotationFromCamera(t.videoPlayer.xr().camera.matrixWorld.elements)})),this.videoPlayer.xr().on("xrCameraUpdate",(function(){t.xrActive&&t.rotator.updateRotationFromCamera(this.xrPose.views[0].transform.matrix)})),e.orbit.addEventListener("zoom",(function(){t._updateZoom()})),this.videoPlayer.xr().on("xrSessionActivated",(function(){t.xrActive=!0,t.multiplier.bypass(!0)})),this.videoPlayer.xr().on("xrSessionDeactivated",(function(){t.xrActive=!1,t.multiplier.bypass(!1),t._updateZoom(),t.rotator.updateRotationFromCamera(this.camera.matrixWorld.elements)})),this.videoSetupComplete=!0}},{key:"_setupGaze",value:function(){var e=this;e.scene=e.videoPlayer.xr().scene;var t=e.videoPlayer.xr().controls3d,n=e.videoPlayer.xr().camera;n.position.set(0,0,0),e.gazeEvent=new V.a,t.orbit.enableZoom=!1,t.orbit.addEventListener("change",(function(){e.xrActive||e.gazeEvent.update(n)})),this.videoPlayer.xr().on("xrCameraUpdate",(function(){e.xrActive&&e.gazeEvent.update(n)})),console.log("gaze setup complete")}},{key:"_updateZoom",value:function(){var e=this.videoPlayer.xr().controls3d.orbit.currentDistance,t=this.videoPlayer.xr().controls3d.orbit.minDistance,n=(t+e)/t;if(n>=1&&n<=2.5){var i=Math.round((n-1)/.1);i!=this.zoomIndex&&(this.multiplier.updateMtx(D[i]),this.zoomIndex=i)}}},{key:"_setOrderDependentVariables",value:function(){var e=window.location,t=e.protocol+"//"+e.host+"/";this.numCh=(this.order+1)*(this.order+1),this.irUrl.includes("://")?this.irs=this.irUrl+"hoast_o"+this.order+".wav":this.irs=t+this.irUrl+"hoast_o"+this.order+".wav"}}])&&Fc(t.prototype,n),r&&Fc(t,r),e}()}])}));